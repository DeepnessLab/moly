alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP Openview Network Node Manager OvAcceptLang overflow attempt"; flow:to_server,established; content:"/OVCgi/Toolbar.exe"; fast_pattern:only; http_uri; pcre:"/OvAcceptLang\s*\x3d\s*[^\x3b\n]{300}/ismC"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34134; reference:cve,2009-0921; classtype:attempted-user; sid:16555; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI loadpage.cgi directory traversal attempt"; flow:to_server,established; content:"/loadpage.cgi"; http_uri; content:"file=../"; fast_pattern:only; reference:bugtraq,2109; reference:cve,2000-1092; reference:nessus,10065; classtype:web-application-attack; sid:1569; rev:14;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI store.cgi product directory traversal attempt"; flow:to_server,established; content:"/store.cgi"; http_uri; content:"product="; content:"../.."; fast_pattern:only; reference:bugtraq,2385; reference:cve,2001-0305; classtype:web-application-attack; sid:1306; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SonicWall Aventail EPInstaller ActiveX clsid access"; flow:established,to_client; file_data; content:"A7BC4157-A8EC-488F-9808-C63E2ACB0996"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A7BC4157-A8EC-488F-9808-C63E2ACB0996\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(AuthCredential|ConfigurationString)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A7BC4157-A8EC-488F-9808-C63E2ACB0996\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(AuthCredential|ConfigurationString))/siO"; metadata:policy security-ips drop; reference:url,osvdb.org/67286; classtype:attempted-user; sid:19108; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ACD Systems ACDSee XPM file format overflow attempt"; flow:to_client,established; content:"/* XPM */"; pcre:"/^\s*\x22[^\x22\n]{300}/mi"; metadata:policy security-ips drop; reference:bugtraq,23620; reference:cve,2007-2193; classtype:attempted-user; sid:15236; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS viewcode.asp access"; flow:to_server,established; content:"/viewcode.asp"; fast_pattern; http_uri; reference:cve,1999-0737; reference:nessus,10576; classtype:web-application-activity; sid:1043; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Internet Explorer navcancl.htm url spoofing attempt"; flow:established,to_client; content:"ieframe.dll/navcancl.htm|23|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,22966; reference:cve,2007-1499; reference:cve,2007-1752; reference:url,www.microsoft.com/technet/security/bulletin/MS07-033.mspx; classtype:misc-attack; sid:11834; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP eSupportDiagnostics 6 ActiveX clsid access"; flow:established,to_client; file_data; content:"60178279-6D62-43af-A336-77925651A4C6"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q37>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*60178279-6D62-43af-A336-77925651A4C6\s*}?\s*(?P=q37)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28929; reference:cve,2008-0712; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13726; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC MsmMask.exe access"; flow:to_server,established; content:"/MsmMask.exe"; http_uri; reference:nessus,11163; classtype:web-application-activity; sid:2059; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI cal_make.pl directory traversal attempt"; flow:to_server,established; content:"/cal_make.pl"; http_uri; content:"p0=../../"; fast_pattern:only; reference:bugtraq,2663; reference:cve,2001-0463; reference:nessus,10664; classtype:web-application-attack; sid:1704; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Input Method Editor ActiveX clsid access"; flow:established,to_client; file_data; content:"6E3197A3-BBC3-11D4-84C0-00C04F7A06E5"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6E3197A3-BBC3-11D4-84C0-00C04F7A06E5\s*}?\s*\1/si"; metadata:policy security-ips drop; reference:cve,2006-4697; reference:url,www.microsoft.com/technet/security/bulletin/MS07-016.mspx; classtype:attempted-user; sid:10137; rev:5;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-MISC Oracle Sun GlassFish Server successful authentication bypass attempt"; flow:established,to_client; flowbits:isset,glassfish_unauth_attempt; flowbits:unset,glassfish_unauth_attempt; content:"200"; http_stat_code; file_data; content:"Deploy"; fast_pattern:only; content:"Applications"; pcre:"/<title>Deploy\s*(Enterprise)?\s*Applications/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,47438; reference:cve,2011-0807; classtype:attempted-admin; sid:20160; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Checkpoint Firewall-1 HTTP parsing format string vulnerability attempt"; flow:to_server,established; content:"|3A|/"; offset:11; http_uri; pcre:"/^[^\x3a\x3f]{11,}\x3a\x2f/Usmi"; reference:bugtraq,9581; reference:cve,2004-0039; reference:nessus,12084; classtype:attempted-admin; sid:2381; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX German_German Stemmer ActiveX clsid access"; flow:established,to_client; file_data; content:"510A4910-7F1C-11CE-BE57-00AA0051FE20"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*510A4910-7F1C-11CE-BE57-00AA0051FE20/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8015; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS expression defined to empty selection attempt"; flow:to_client,established; content:"expression"; content:"document.selection.empty"; within:50; pcre:"/expression\s*\x28\s*document\x2eselection\x2eempty\s*\x28\s*\x29/si"; reference:cve,2011-1261; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-admin; sid:19246; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file rcsL record exploit attempt"; flow:to_client,established; content:"|8F 41 01 45 C2 AE 00 FF 45 B0 41 24 43 46 1F 42|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17187; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing cmt buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mp4; content:"|A9|cmt"; byte_test:4, >, 512, 0, relative; metadata:policy security-ips drop; reference:bugtraq,19976; reference:bugtraq,26773; reference:cve,2006-4386; reference:cve,2007-6401; classtype:attempted-user; sid:13318; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 901 (msg:"WEB-MISC Samba SWAT HTTP Authentication overflow attempt"; flow:to_server,established; content:"Authorization|3A 20|Basic|20 3D|"; http_header; metadata:policy security-ips drop; reference:bugtraq,10780; reference:cve,2004-0600; classtype:attempted-user; sid:18751; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox WOFF font processing integer overflow attempt - CFF-based"; flow:to_client,established; content:"wOFFOTTO"; content:"|00 00|"; within:2; distance:6; pcre:"/^.{28}([0-9A-Z\x20\x2F]{4}.{8}[^\xFF].{7})*([0-9A-Z\x20\x2F]{4}.{8}\xFF{3})/isR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,38298; reference:cve,2010-1028; reference:url,www.kb.cert.org/vuls/id/964549; classtype:attempted-user; sid:16502; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 18 ActiveX clsid access"; flow:established,to_client; file_data; content:"d1084c98-79f2-461d-81b8-7888228e77cc"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*d1084c98-79f2-461d-81b8-7888228e77cc\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14492; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT gAlan malformed file stack overflow attempt"; flow:to_client,established; file_data; content:"Mjik"; within:4; pcre:"/^[^\s\x00]{512}/R"; metadata:policy security-ips drop; reference:url,osvdb.org/60897; classtype:attempted-user; sid:16726; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION CFNEWINTERNALREGISTRY access"; flow:to_server,established; content:"CFNEWINTERNALREGISTRY|28 29|"; fast_pattern:only; reference:bugtraq,550; reference:cve,1999-0760; classtype:attempted-user; sid:8486; rev:7;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for www.google.com detected"; flow:to_client,established; ssl_state:server_hello; content:"www.google.com"; content:"|F5 C8 6A F3 61 62 F1 3A 64 F5 4F 6D C9 58 7C 06|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18566; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 27 ActiveX clsid access"; flow:established,to_client; file_data; content:"86C2B477-5382-4A09-8CA3-E63B1158A377"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q39>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*86C2B477-5382-4A09-8CA3-E63B1158A377\s*}?\s*(?P=q39)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14140; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS site server config access"; flow:to_server,established; content:"/adsamples/config/site.csc"; fast_pattern; http_uri; reference:bugtraq,256; reference:cve,1999-1520; classtype:web-application-activity; sid:1038; rev:16;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for login.skype.com detected"; flow:to_client,established; ssl_state:server_hello; content:"login.skype.com"; content:"|E9 02 8B 95 78 E4 15 DC 1A 71 0A 2B 88 15 44 47|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18570; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Common Browser Architecture ActiveX clsid access"; flow:established,to_client; file_data; content:"AF604EFE-8897-11D1-B944-00A0C90312E1"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*AF604EFE-8897-11D1-B944-00A0C90312E1/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:7948; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMListCtl Class ActiveX function call access"; flow:established,to_client; file_data; content:"Vmappsdk.VMListCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Vmappsdk\.VMListCtl\x22|\x27Vmappsdk\.VMListCtl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Vmappsdk\.VMListCtl\x22|\x27Vmappsdk\.VMListCtl\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14536; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Dynamic Casts ActiveX clsid access"; flow:established,to_client; file_data; content:"5DFB2651-9668-11D0-B17B-00C04FC2A0CA"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7435; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION admin decrypt attempt"; flow:to_server,established; content:"CFUSION_DECRYPT|28 29|"; fast_pattern:only; reference:bugtraq,550; reference:cve,1999-0760; classtype:web-application-attack; sid:924; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Kaspersky antivirus library heap buffer overflow - with optional fields"; flow:to_client,established; content:"|0D 0A 0D 0A|MSCF"; byte_test:2,&,0x0003,26,relative,little; byte_test:2,&,0x0004,26,relative,little; byte_jump:2,32,relative,little; pcre:"/^.{2}([^\x00]*\x00)?[^\x00]{256}/sR"; metadata:policy security-ips drop; reference:bugtraq,14998; reference:cve,2005-3142; classtype:attempted-user; sid:16296; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Windows Reporting Tool ActiveX object access"; flow:established,to_client; file_data; content:"167701E3-FDCF-11D0-A48E-006097C549FF"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*167701E3-FDCF-11D0-A48E-006097C549FF/si"; metadata:policy security-ips drop; reference:bugtraq,8454; reference:cve,2003-0530; reference:url,www.microsoft.com/technet/security/bulletin/MS03-032.mspx; classtype:attempted-user; sid:4160; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"WEB-MISC IBM WebSphere j_security_check overflow attempt"; flow:to_server,established; content:"POST"; content:"/admin/j_security_check"; pcre:"/j_(username|password)=[^\n|^&]{256,}/smi"; reference:bugtraq,13853; reference:cve,2005-1872; classtype:attempted-admin; sid:3693; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HotfixWz Class ActiveX clsid access"; flow:established,to_client; file_data; content:"dfef4b09-1b0a-4529-9775-ac437d6a93b3"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*dfef4b09-1b0a-4529-9775-ac437d6a93b3\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14526; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAPoint2.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAPoint2.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAPoint2.1\x22|\x27DirectAnimation.DAPoint2.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAPoint2.1\x22|\x27DirectAnimation.DAPoint2.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8794; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VieLib2.Vie2Process ActiveX function call access"; flow:established,to_client; file_data; content:"VieLib2.Vie2Process"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22VieLib2\.Vie2Process\x22|\x27VieLib2\.Vie2Process\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22VieLib2\.Vie2Process\x22|\x27VieLib2\.Vie2Process\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14280; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI htmlscript access"; flow:to_server,established; content:"/htmlscript"; fast_pattern; http_uri; reference:bugtraq,2001; reference:cve,1999-0264; reference:nessus,10106; classtype:attempted-recon; sid:826; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC renamed zip file handling code execution attempt - 1"; flow:to_client,established; flowbits:isset,http.avi; file_data; content:"|50 4B 03 04|"; within:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40428; classtype:attempted-user; sid:17148; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Office Web Components 10 Spreadsheet ActiveX function call access "; flow:established,to_client; file_data; content:"OWC10.Spreadsheet"; pcre:"/(?P<c>\w+)\s*=\s*(\x22OWC10\.Spreadsheet(\.\d)?\x22|\x27OWC10\.Spreadsheet(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22OWC10\.Spreadsheet(\.\d)?\x22|\x27OWC10\.Spreadsheet(\.\d)?\x27)\s*\)/smiO"; metadata:policy balanced-ips drop, policy security-ips alert, service http; reference:cve,2009-2496; reference:url,support.microsoft.com/kb/973472; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-043.mspx; classtype:attempted-user; sid:15687; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Repository Workspace ActiveX object access"; flow:established,to_client; file_data; content:"B1D4ED44-EE64-11D0-97E6-00C04FC30B4A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*B1D4ED44-EE64-11D0-97E6-00C04FC30B4A/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4913; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI csh access"; flow:to_server,established; content:"/csh"; fast_pattern; http_uri; reference:cve,1999-0509; reference:url,www.cert.org/advisories/CA-1996-11.html; classtype:attempted-recon; sid:862; rev:15;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI getdoc.cgi access"; flow:to_server,established; content:"/getdoc.cgi"; fast_pattern; http_uri; reference:bugtraq,4579; reference:cve,2000-0288; reference:nessus,11748; classtype:web-application-activity; sid:2209; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMT MuxDeMux Filter ActiveX clsid access"; flow:established,to_client; file_data; content:"01002B17-5D93-4551-81E4-831FEF780A53"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*01002B17-5D93-4551-81E4-831FEF780A53/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7482; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI viralator.cgi access"; flow:to_server,established; content:"/viralator.cgi"; http_uri; reference:bugtraq,3495; reference:cve,2001-0849; reference:nessus,11107; classtype:web-application-activity; sid:1996; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Talentsoft Web+ internal IP Address access"; flow:to_server,established; content:"/webplus.exe?about"; http_uri; reference:bugtraq,1720; reference:url,archives.neohapsis.com/archives/ntbugtraq/2000-q3/0168.html; classtype:web-application-activity; sid:1096; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Easy Grid ActiveX clsid access"; flow:established,to_client; file_data; content:"DD44C0EA-B2CF-31D1-8DD3-444553540000"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m13>\x22|\x27|)(?P<id1>.+?)(?P=m13)(\s|>)[^>]*\s*classid\s*=\s*(?P<q27>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DD44C0EA-B2CF-31D1-8DD3-444553540000\s*}?\s*(?P=q27)(\s|>).*(?P=id1)\s*\.\s*(DoSaveHTMLFile|DoSaveFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q28>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DD44C0EA-B2CF-31D1-8DD3-444553540000\s*}?\s*(?P=q28)(\s|>)[^>]*\s*id\s*=\s*(?P<m14>\x22|\x27|)(?P<id2>.+?)(?P=m14)(\s|>).*(?P=id2)\.(DoSaveHTMLFile|DoSaveFile))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,33272; classtype:attempted-user; sid:15232; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft HTML Popup Window ActiveX object access"; flow:established,to_client; file_data; content:"3050F667-98B5-11CF-BB82-00AA00BDCE0B"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*3050F667-98B5-11CF-BB82-00AA00BDCE0B/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4215; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DHTML Editing ActiveX function call access"; flow:established,to_client; file_data; content:"DHTMLSafe.DHTMLSafe"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22DHTMLSafe\.DHTMLSafe(\.\d)?\x22|\x27DHTMLSafe\.DHTMLSafe(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*LoadURL\s*|.*(?P=v)\s*\.\s*LoadURL\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22DHTMLSafe\.DHTMLSafe(\.\d)?\x22|\x27DHTMLSafe\.DHTMLSafe(\.\d)?\x27)\s*\)(\s*\.\s*LoadURL\s*|.*(?P=n)\s*\.\s*LoadURL\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:bugtraq,116; reference:bugtraq,12602; reference:bugtraq,1474; reference:cve,1999-0487; reference:cve,2005-0500; reference:cve,2009-2519; reference:url,www.microsoft.com/technet/security/bulletin/MS09-046.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS99-011.mspx; classtype:attempted-user; sid:15924; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS Indexing Service ciRestriction cross-site scripting attempt"; flow:to_server,established; content:"default.idq"; content:"ciRestriction"; distance:0; content:"script"; distance:0; pcre:"/default.idq[^\r\n]*ciRestriction[^\r\n]*script/smi"; reference:bugtraq,19927; reference:cve,2006-0032; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-053.mspx; classtype:misc-attack; sid:8349; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer createTextRange code execution attempt"; flow:to_client,established; file_data; content:".createTextRange|28 29 3B|"; fast_pattern:only; content:"<input type|3D 22|radio|22|"; pcre:"/\x3Cinput\s+type\x3D\x22radio\x22\s+id\x3D(?P<q1>(\x22|\x27|))(?P<t>\S+)(?P=q1).*?document\x2EgetElementById\x28(?P<q2>(\x22|\x27|))(?P=t)(?P=q2)\x29\x2EcreateTextRange/isO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,17196; reference:cve,2006-1359; classtype:attempted-user; sid:17262; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView Network Node Manager ovet_demandpoll.exe format string execution attempt"; flow:established,to_server; content:"/OvCgi/webappmon.exe"; fast_pattern; http_uri; content:"POST"; http_method; content:"sel="; http_client_body; pcre:"/^[^\x26]*?\x25/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40065; reference:cve,2010-1550; classtype:attempted-admin; sid:18795; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla regular expression heap corruption attempt"; flow:to_client,established; content:"new RegExp|28|"; pcre:"/^(?=[^\x29]*\x5c{2}[\x22\x27])[^\x29]*\x5b[^\x5d]*\x5c{2}[\x22\x27]/R"; metadata:policy security-ips drop; reference:bugtraq,20042; reference:cve,2006-4566; classtype:attempted-user; sid:8443; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer userdata behavior memory corruption attempt"; flow:to_client,established; content:"|2E|style|2E|behavior"; content:"|23|default|23|userData"; distance:0; content:"setAttribute"; pcre:"/(?P<obj>[A-Z\d_]+)\x2Estyle\x2Ebehavior\s*\x3D\s*\x22url\x28\x27\x23default\x23userData\x27\x29\x22.*?(?P=obj)\x2EsetAttribute\x28[^,]+,\s*[A-Z]/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0806; reference:url,support.microsoft.com/kb/980182; classtype:attempted-user; sid:17688; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox XBM image processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.xbm; content:"static|20|char|20|gopher|5F|binary|5F|bits|5B 5D|"; content:"0x71|2C 20|0x26|2C 20|0x01|20 20 20 20 20 20|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,14916; reference:cve,2005-2701; classtype:attempted-user; sid:17360; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Oracle iSQLPlus login.uix username overflow attempt"; flow:to_server,established; content:"/login.uix"; http_uri; pcre:"/username=[^&\x3b\r\n]{250}/smi"; reference:bugtraq,10871; reference:url,www.nextgenss.com/advisories/ora-isqlplus.txt; classtype:web-application-attack; sid:2703; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI envout.bat access"; flow:to_server,established; content:"/envout.bat"; http_uri; reference:bugtraq,762; reference:cve,1999-0947; reference:nessus,10016; classtype:web-application-activity; sid:1517; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Shortcut Handler ActiveX object access"; flow:established,to_client; file_data; content:"00021401-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*00021401-0000-0000-C000-000000000046/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4915; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Macrovision InstallShield Update Service ActiveX clsid access"; flow:established,to_client; file_data; content:"E9880553-B8A7-4960-A668-95C68BED571E"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E9880553-B8A7-4960-A668-95C68BED571E\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(DownloadAndExecute|AddFileEx|ExecuteRemote))\s*\(|<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E9880553-B8A7-4960-A668-95C68BED571E\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(DownloadAndExecute|AddFileEx|ExecuteRemote)/Osi"; metadata:policy security-ips alert; reference:bugtraq,26280; reference:bugtraq,31235; reference:cve,2007-5660; reference:url,support.installshield.com/kb/view.asp?articleid=Q113602; classtype:attempted-user; sid:8738; rev:10;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS uploadn.asp access"; flow:to_server,established; content:"/scripts/uploadn.asp"; fast_pattern; http_uri; reference:bugtraq,1811; reference:cve,1999-0360; classtype:web-application-activity; sid:1041; rev:16;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer spoofed MIME-Type auto-execution attempt"; flow:to_client,established; content:"Content-Type|3A|"; http_header; content:"audio/"; fast_pattern; http_header; pcre:"/Content-Type\x3A\s+audio\/(x-wav|mpeg|x-midi)/iH"; content:"filename="; http_header; pcre:"/filename=[\x22\x27]?.{1,221}\.(vbs|exe|scr|pif|bat)/Hi"; metadata:policy security-ips drop; reference:bugtraq,2524; reference:cve,2001-0154; reference:url,www.microsoft.com/technet/security/bulletin/MS01-020.mspx; classtype:attempted-admin; sid:3683; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Active Setup ActiveX object access"; flow:established,to_client; file_data; content:"6E449683-C509-11CF-AAFA-00AA00B6015C"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*6E449683-C509-11CF-AAFA-00AA00B6015C/si"; metadata:policy security-ips drop; reference:bugtraq,775; reference:cve,2000-0329; reference:url,www.microsoft.com/technet/security/bulletin/MS99-048.mspx; classtype:attempted-user; sid:4154; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX PSTypeInfo ActiveX object access"; flow:established,to_client; file_data; content:"00020422-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*00020422-0000-0000-C000-000000000046/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4895; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAPair.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAPair.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAPair.1\x22|\x27DirectAnimation.DAPair.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAPair.1\x22|\x27DirectAnimation.DAPair.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8800; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealPlayer RNX Download Handler ActiveX clsid access"; flow:established,to_client; file_data; content:"3B5E0503-DE28-4BE8-919C-76E0E894A3C2"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m11>\x22|\x27|)(?P<id1>.+?)(?P=m11)(\s|>)[^>]*\s*classid\s*=\s*(?P<q28>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3B5E0503-DE28-4BE8-919C-76E0E894A3C2\s*}?\s*(?P=q28)(\s|>).*(?P=id1)\s*\.\s*(Console|Controls)|<object\s*[^>]*\s*classid\s*=\s*(?P<q29>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3B5E0503-DE28-4BE8-919C-76E0E894A3C2\s*}?\s*(?P=q29)(\s|>)[^>]*\s*id\s*=\s*(?P<m12>\x22|\x27|)(?P<id2>.+?)(?P=m12)(\s|>).*(?P=id2)\s*\.\s*(Console|Controls))\s*=/si"; metadata:policy security-ips alert; reference:bugtraq,28157; reference:cve,2008-1309; reference:url,www.kb.cert.org/vuls/id/831457; classtype:attempted-user; sid:8387; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Microsoft IIS source code disclosure attempt"; flow:to_server,established; content:".asp"; http_uri; pcre:"/\x2easp([\?\x5c\x2f]|$)/smiU"; content:"host"; http_header; content:"localhost"; http_header; pcre:"/^Host\s*\x3A\s*localhost\s/miH"; reference:cve,2005-2678; reference:url,secunia.com/advisories/16548; classtype:misc-attack; sid:17653; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HtmlDlgSafeHelper.HtmlDlgSafeHelper ActiveX function call access"; flow:established,to_client; file_data; content:"HtmlDlgSafeHelper.HtmlDlgSafeHelper"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22HtmlDlgSafeHelper.HtmlDlgSafeHelper\x22|\x27HtmlDlgSafeHelper.HtmlDlgSafeHelper\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22HtmlDlgSafeHelper.HtmlDlgSafeHelper\x22|\x27HtmlDlgSafeHelper.HtmlDlgSafeHelper\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; classtype:attempted-user; sid:7011; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"WEB-MISC Linksys router default username and password login attempt"; flow:to_server,established; content:"YWRtaW46YWRtaW4"; pcre:"/^Authorization\x3a\s*Basic\s+(?-i)YWRtaW46YWRtaW4[=\s]/smi"; reference:nessus,10999; classtype:default-login-attempt; sid:1861; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MidiOut Class Manager ActiveX clsid access"; flow:established,to_client; file_data; content:"4EFE2452-168A-11D1-BC76-00C04FB9453B"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*4EFE2452-168A-11D1-BC76-00C04FB9453B/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8029; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealNetworks RealGames InstallerDlg.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"5818813e-d53d-47a5-abbb-37e2a07056b5"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5818813e-d53d-47a5-abbb-37e2a07056b5\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(CreateVistaTaskLow|Exec|ExecLow|ShellExec)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5818813e-d53d-47a5-abbb-37e2a07056b5\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(CreateVistaTaskLow|Exec|ExecLow|ShellExec))/siO"; metadata:policy security-ips drop; reference:url,osvdb.org/71559; classtype:attempted-user; sid:19562; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SonicWall Aventail EPInterrogator ActiveX clsid access"; flow:established,to_client; file_data; content:"2A1BE1E7-C550-4D67-A553-7F2D3A39233D"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2A1BE1E7-C550-4D67-A553-7F2D3A39233D\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(AuthCredential|ConfigurationString)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2A1BE1E7-C550-4D67-A553-7F2D3A39233D\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(AuthCredential|ConfigurationString))\s*=/siO"; metadata:policy security-ips drop; reference:url,osvdb.org/67286; classtype:attempted-user; sid:18321; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 4080 (msg:"WEB-MISC iChat directory traversal attempt"; flow:to_server,established; content:"/../../"; reference:cve,1999-0897; classtype:web-application-activity; sid:1604; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 34 ActiveX clsid access"; flow:established,to_client; file_data; content:"B0A08D67-9464-4E73-A549-2CC208AC60D3"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q55>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*B0A08D67-9464-4E73-A549-2CC208AC60D3\s*}?\s*(?P=q55)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14154; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC AuthChangeUrl access"; flow:to_server,established; content:"_AuthChangeUrl?"; http_uri; reference:bugtraq,2110; reference:cve,1999-0407; classtype:attempted-recon; sid:1126; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word SmartTag record code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|13 1F 14 FF 95 80 FF FF 01 00 00 00 00 00 28 2C|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30124; reference:cve,2008-2244; classtype:attempted-user; sid:17308; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 14 ActiveX clsid access"; flow:established,to_client; file_data; content:"AE6C4705-0F11-4ACB-BDD4-37F138BEF289"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q11>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*AE6C4705-0F11-4ACB-BDD4-37F138BEF289\s*}?\s*(?P=q11)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14114; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Nwz Class ActiveX clsid access"; flow:established,to_client; file_data; content:"eb80211b-ef44-463c-adab-b75ccd68c163"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*eb80211b-ef44-463c-adab-b75ccd68c163\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14548; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Data Dynamics ActiveReport ARViewer2 ActiveX clsid access"; flow:established,to_client; file_data; content:"8569D715-FF88-44BA-8D1D-AD3E59543DDE"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8569D715-FF88-44BA-8D1D-AD3E59543DDE\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Pages.Save|PrintReport|Canvas.Save)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8569D715-FF88-44BA-8D1D-AD3E59543DDE\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Pages.Save|PrintReport|Canvas.Save))\s*\(/Osi"; metadata:policy security-ips alert; reference:bugtraq,31227; classtype:attempted-user; sid:14603; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Twiki rdiff rev command injection attempt"; flow:to_server,established; content:"/rdiff/"; http_uri; pcre:"/rdiff[^\n]*rev[1|2]*=[^d\x20]+/smi"; reference:bugtraq,14834; reference:cve,2005-2877; classtype:attempted-admin; sid:4985; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI test-cgi access"; flow:to_server,established; content:"/test-cgi"; fast_pattern; http_uri; reference:arachnids,218; reference:bugtraq,2003; reference:cve,1999-0070; reference:nessus,10282; classtype:attempted-recon; sid:835; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Music JukeBox DataGrid ActiveX function call access"; flow:established,to_client; file_data; content:"YMP.YMPDatagrid"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22YMP\.YMPDatagrid\x22|\x27YMP\.YMPDatagrid\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(AddImage|AddButton)\s*|.*(?P=v)\s*\.\s*(AddImage|AddButton)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22YMP\.YMPDatagrid\x22|\x27YMP\.YMPDatagrid\x27)\s*\)(\s*\.\s*(AddImage|AddButton)\s*|.*(?P=n)\s*\.\s*(AddImage|AddButton)\s*)\s*\(/Osmi"; metadata:policy security-ips alert; reference:bugtraq,27579; classtype:attempted-user; sid:13428; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word rich text format unexpected field type memory corruption attempt 2"; flow:to_client,established; content:"|5C|datafield |5C|pngblip"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1901; reference:url,www.microsoft.com/technet/security/bulletin/ms10-056.mspx; classtype:attempted-user; sid:17121; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8300 (msg:"WEB-MISC Novell GroupWise Messenger Accept-Language header buffer overflow attempt"; flow:to_server,established; content:"Accept-Language"; pcre:"/^Accept-Language\x3A[^\r\n]{17}/smi"; reference:bugtraq,17503; reference:cve,2006-0992; classtype:attempted-admin; sid:6414; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DALineStyle.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BF2-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BF2-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8813; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"WEB-MISC Tomcat UNIX platform directory traversal"; flow:established,to_server; content:"%2E%2E/"; fast_pattern:only; content:"%2E%2E/"; http_raw_uri; pcre:"/\/(\\|%5C)%2E%2E\//"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,22960; reference:cve,2007-0450; reference:url,tomcat.apache.org/tomcat-6.0-doc/changelog.html; classtype:web-application-attack; sid:17502; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 9 ActiveX clsid access"; flow:established,to_client; file_data; content:"93beec8b-783e-4f87-a1d7-61936f3805cf"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*93beec8b-783e-4f87-a1d7-61936f3805cf\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14434; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Multiple MP3 player PLS buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.pls; file_data; content:"[playlist]"; fast_pattern; content:"File"; distance:0; content:"="; within:5; distance:1; isdataat:500,relative; content:!"|0A|"; within:500; metadata:policy security-ips drop; reference:bugtraq,16410; reference:bugtraq,33589; reference:cve,2006-0476; reference:cve,2009-0476; classtype:attempted-user; sid:15472; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Content-Length request offset smuggling attempt"; flow:established,to_server,no_stream; content:"Content-Length|3A|"; http_raw_header; byte_jump:10,0,string,relative,post_offset 4; pcre:"/^(GET|POST|TRACE|DESCRIBE|DELETE)/R"; reference:bugtraq,14106; reference:cve,2005-2088; classtype:misc-attack; sid:16218; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI alchemy http server NUL arbitrary command execution attempt"; flow:to_server,established; content:"/NUL/../../"; http_uri; reference:bugtraq,3599; reference:cve,2001-0871; reference:nessus,10818; classtype:web-application-activity; sid:1506; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Office 2000 and 2002 Web Components Data Source Control ActiveX clsid access"; flow:established,to_client; file_data; content:"0002E530-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0002E530-0000-0000-C000-000000000046\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28136; reference:bugtraq,4449; reference:cve,2002-0727; reference:cve,2007-1201; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-017.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS02-044.mspx; classtype:attempted-user; sid:4170; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbEnumTags Class ActiveX clsid access"; flow:established,to_client; file_data; content:"733a5dfa-084e-4ecf-af13-95b852358dd3"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*733a5dfa-084e-4ecf-af13-95b852358dd3\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14410; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel DbOrParamQry.fOdbcConn parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|DC 00 0C 00|"; byte_test:1,&,0x06,0,relative; byte_test:1,&,0x08,0,relative; content:"|CD 00|"; within:2; distance:12; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0264; reference:url,www.microsoft.com/technet/security/bulletin/MS10-017.mspx; classtype:attempted-user; sid:16469; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DiskManagement.Connection ActiveX clsid access"; flow:established,to_client; file_data; content:"FD78D554-4C6E-11D0-970D-00A0C9191601"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*FD78D554-4C6E-11D0-970D-00A0C9191601/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8005; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash use-after-free attack"; flow:to_client,established; file_data; content:"|53 68 68 68 20 64 6F 6E 27 74 20 74 65 6C 6C 20 61 6E 79 20 6F 6E 65 20 74 68 69 73 20 69 73 20 61 20 73 65 63 72 65 74 20 6B 65 79 21 16 54 68 65 20 74 72 75 74 68 20 69 73 20 6F 75 74 20 74 68 65 72 65 08 43 4F 4D 50 4C 45 54 45 0B 72 65 6D 6F 76 65 43 68 69 6C 64 0A 55 52 4C 52 65 71 75 65 73 74 30 68 74 74 70|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1297; classtype:attempted-user; sid:16634; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI yabb access"; flow:to_server,established; content:"/YaBB"; fast_pattern; http_uri; reference:arachnids,462; reference:bugtraq,1668; reference:cve,2000-0853; reference:nessus,10512; classtype:attempted-recon; sid:1637; rev:15;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Novell ZENworks Configuration Management UploadServlet code execution attempt"; flow:established,to_server; content:"/zenworks-fileupload/?"; fast_pattern; pcre:"/(filename|type)=[^\x26]*?\x2E\x2E/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39914; reference:url,www.novell.com/support/viewContent.do?externalId=7005573; classtype:attempted-admin; sid:18793; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Excel Add-in for SQL Analysis Services 1 ActiveX clsid access"; flow:established,to_client; file_data; content:"27A3D328-D206-4106-8D33-1AA39B13394B"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*27A3D328-D206-4106-8D33-1AA39B13394B\s*}?\s*(?P=q1)(\s|>)/siO"; metadata:policy security-ips drop; reference:cve,2009-2493; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-055.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-072.mspx; classtype:attempted-user; sid:16159; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT GNU tar PAX extended headers handling overflow attempt"; flow:to_client,established; content:"GNU.sparse.numblocks="; pcre:"/GNU\x2esparse\x2enumblocks\s*\x3d\s*(0|[6-9]\d{4})/smi"; metadata:policy security-ips drop; reference:bugtraq,16764; reference:cve,2006-0300; classtype:attempted-dos; sid:16053; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI Emumail init.emu access"; flow:to_server,established; content:"/init.emu"; fast_pattern; http_uri; reference:bugtraq,9861; reference:nessus,12095; classtype:web-application-activity; sid:2567; rev:10;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape Enterprise Server directory view"; flow:to_server,established; content:"?wp-ver-diff"; http_uri; reference:bugtraq,1063; reference:cve,2000-0236; classtype:attempted-recon; sid:1186; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"WEB-MISC Squid content length cache poisoning attempt"; flow:to_server,established; content:"Content-Length|3A|"; http_header; content:"Content-Length|3A|"; http_header; pcre:"/^Content-Length\x3a(?!\x0d\x0a\x0d\x0a).*?^Content-Length\x3a/smiH"; reference:bugtraq,12412; reference:bugtraq,13956; reference:cve,2005-0174; reference:cve,2005-1215; classtype:misc-attack; sid:3694; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION exampleapp access"; flow:to_server,established; content:"/cfdocs/exampleapp/"; fast_pattern; http_uri; reference:cve,2001-0535; classtype:attempted-recon; sid:928; rev:13;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 2301 (msg:"WEB-MISC Compaq web-based management agent denial of service attempt"; flow:to_server,established; content:"<!"; depth:75; content:">"; within:50; reference:bugtraq,8014; classtype:web-application-attack; sid:2394; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla multiple products JavaScript string replace buffer overflow attempt"; flow:to_client,established; file_data; content:".replace|28|"; pcre:"/(?P<var>\w+)\x2Ereplace\x28\s*(?P=var)\s*\x2C\s*(?P=var)\s*\x29/"; metadata:policy security-ips drop; reference:bugtraq,36343; reference:cve,2009-3075; classtype:attempted-user; sid:17166; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE cfgwiz.exe access"; flow:to_server,established; content:"/cfgwiz.exe"; fast_pattern; http_uri; classtype:web-application-activity; sid:950; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Visagesoft eXPert PDF Viewer ActiveX function call access"; flow:established,to_client; file_data; content:"VSPDFEditorX.VSPDFEdit"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22VSPDFEditorX\.VSPDFEdit(\.\d)?\x22|\x27VSPDFEditorX\.VSPDFEdit(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*savePageAsBitmap\s*|.*(?P=v)\s*\.\s*savePageAsBitmap\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22VSPDFEditorX\.VSPDFEdit(\.\d)?\x22|\x27VSPDFEditorX\.VSPDFEdit(\.\d)?\x27)\s*\)(\s*\.\s*savePageAsBitmap\s*|.*(?P=n)\s*\.\s*savePageAsBitmap\s*)\s*\(/smiO"; metadata:policy security-ips alert; reference:bugtraq,31984; reference:cve,2008-4919; classtype:attempted-user; sid:14995; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint PPT file parsing memory corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|A4 37 7A 00 81 00 00 00 00 00 82 00 00 00 00 00|"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,18993; reference:cve,2006-3656; classtype:attempted-user; sid:17285; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Windows Media Player 6.4 ActiveX object access"; flow:established,to_client; file_data; content:"22D6F312-B0F6-11D0-94AB-0080C74C7E95"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*22D6F312-B0F6-11D0-94AB-0080C74C7E95/si"; metadata:policy security-ips drop; reference:bugtraq,793; reference:cve,1999-1110; classtype:attempted-user; sid:4152; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC SalesLogix Eviewer web command attempt"; flow:to_server,established; content:"/slxweb.dll/admin?command="; http_uri; reference:bugtraq,1078; reference:bugtraq,1089; reference:cve,2000-0278; reference:cve,2000-0289; reference:nessus,10361; classtype:web-application-attack; sid:1187; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RDS.Dataspace ActiveX function call access"; flow:established,to_client; file_data; content:"RDS.DataSpace"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22RDS.DataSpace\x22|\x27RDS.DataSpace\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22RDS.DataSpace\x22|\x27RDS.DataSpace\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,17462; reference:cve,2006-0003; reference:url,www.microsoft.com/technet/security/bulletin/MS06-014.mspx; classtype:attempted-user; sid:7026; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime fpx file SectNumMiniFAT overflow attempt"; flow:to_client,established; content:"|D0 CF 11 E0 A1 B1 1A E1|"; depth:8; byte_test:4,>,8388606,56,little,relative; metadata:policy security-ips drop; reference:bugtraq,17074; reference:cve,2006-1249; classtype:attempted-user; sid:6505; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION onrequestend.cfm access"; flow:to_server,established; content:"/onrequestend.cfm"; fast_pattern; http_uri; reference:arachnids,269; reference:bugtraq,550; reference:cve,1999-0760; reference:cve,2000-0189; classtype:attempted-recon; sid:933; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp AMF file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.amf; file_data; content:"AMF"; depth:3; byte_test:1,>,12,3; byte_test:1,>,32,40; reference:url,forums.winamp.com/showthread.php?t=332010; reference:url,www.osvdb.org/show/osvdb/76635; classtype:attempted-user; sid:20566; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Xml2Dex ActiveX clsid access"; flow:established,to_client; file_data; content:"18C628EE-962A-11D2-8D08-00A0C9441E20"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*18C628EE-962A-11D2-8D08-00A0C9441E20/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:8379; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Agent Character Custom Proxy Class ActiveX clsid access"; flow:established,to_client; file_data; content:"D45FD31E-5C6E-11D1-9EC1-00C04FD7081F"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D45FD31E-5C6E-11D1-9EC1-00C04FD7081F\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:cve,2006-3445; reference:cve,2007-1205; reference:url,www.microsoft.com/technet/security/bulletin/MS06-068.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS07-020.mspx; classtype:attempted-user; sid:8846; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS Synchrologic Email Accelerator userid list access attempt"; flow:to_server,established; content:"/en/admin/aggregate.asp"; fast_pattern; http_uri; reference:nessus,11657; classtype:web-application-activity; sid:2132; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB CLIENT Microsoft Windows Media Player invalid data offset bitmap heap overflow attempt"; flow:to_client,established; file_data; content:"BM"; within:2; byte_test:4,<,14,8,little,relative; metadata:policy security-ips drop; reference:bugtraq,16633; reference:cve,2006-0006; reference:url,www.eeye.com/html/research/advisories/AD2006021.html; reference:url,www.microsoft.com/technet/security/bulletin/ms06-005.mspx; classtype:attempted-admin; sid:5712; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Excel Add-in for SQL Analysis Services 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"DB640C86-731C-484A-AAAF-750656C9187D"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q3>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DB640C86-731C-484A-AAAF-750656C9187D\s*}?\s*(?P=q3)(\s|>)/siO"; metadata:policy security-ips drop; reference:cve,2009-2493; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-055.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-072.mspx; classtype:attempted-user; sid:16161; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SAP Crystal Reports PrintControl.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"88DD90B6-C770-4CFF-B7A4-3AFD16BB8824"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*88DD90B6-C770-4CFF-B7A4-3AFD16BB8824\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(ServerResourceVersion)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*88DD90B6-C770-4CFF-B7A4-3AFD16BB8824\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(ServerResourceVersion))\s*=/siO"; metadata:policy security-ips drop; reference:bugtraq,45387; reference:cve,2010-2590; classtype:attempted-user; sid:18974; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer VML source file memory corruption attempt"; flow:to_client,established; content:"stroke"; pcre:"/<(?P<t>[\w\x2D\x2E]+)\x3A[^>]+>.*?<(?P=t)\x3Astroke\s+[^>]*src\s*=\s*(?P<q>\x22|\x27)[\w\x25\x2D\x2E\x2F\x3A]+\x2E\w{2,4}(?P=q)/smi"; reference:bugtraq,25310; reference:cve,2007-1749; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-050.mspx; classtype:attempted-user; sid:12281; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Crystal Reports crystalimagehandler.aspx access"; flow:to_server,established; content:"/crystalimagehandler.aspx"; http_uri; reference:cve,2004-0204; reference:url,www.microsoft.com/security/bulletins/200406_crystal.mspx; classtype:web-application-activity; sid:2581; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX reconfig.PopulatedDi ActiveX function call access"; flow:established,to_client; file_data; content:"reconfig.PopulatedDi"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22reconfig\.PopulatedDi\x22|\x27reconfig\.PopulatedDi\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22reconfig\.PopulatedDi\x22|\x27reconfig\.PopulatedDi\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14352; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Shockwave ActiveX Control ActiveX function call access"; flow:established,to_client; file_data; content:"SWCtl.SWCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22SWCtl\.SWCtl(\.\d)?\x22|\x27SWCtl\.SWCtl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(BGCOLOR|SRC|AutoStart|Sound|DrawLogo|DrawPress)\s*|.*(?P=v)\s*\.\s*(BGCOLOR|SRC|AutoStart|Sound|DrawLogo|DrawPress)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22SWCtl\.SWCtl(\.\d)?\x22|\x27SWCtl\.SWCtl(\.\d)?\x27)\s*\)(\s*\.\s*(BGCOLOR|SRC|AutoStart|Sound|DrawLogo|DrawPress)\s*|.*(?P=n)\s*\.\s*(BGCOLOR|SRC|AutoStart|Sound|DrawLogo|DrawPress)\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,22067; reference:bugtraq,22842; reference:cve,2006-6885; classtype:attempted-user; sid:10216; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Office 2000 and 2002 Web Components Spreadsheet ActiveX clsid access"; flow:established,to_client; file_data; content:"0002E510-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0002E510-0000-0000-C000-000000000046\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,4453; reference:cve,2002-0860; reference:cve,2006-3868; reference:cve,2006-4695; reference:url,www.microsoft.com/technet/security/bulletin/MS02-044.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS08-017.mspx; classtype:attempted-user; sid:4177; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RegVmsCtl Class ActiveX function call access"; flow:established,to_client; file_data; content:"Vmappsdk.RegVmsCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Vmappsdk\.RegVmsCtl\x22|\x27Vmappsdk\.RegVmsCtl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Vmappsdk\.RegVmsCtl\x22|\x27Vmappsdk\.RegVmsCtl\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14408; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMT Black Frame Generator ActiveX clsid access"; flow:established,to_client; file_data; content:"2EA10031-0033-450E-8072-E27D9E768142"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*2EA10031-0033-450E-8072-E27D9E768142/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7462; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8888 (msg:"WEB-MISC SiteScope Service access"; flow:to_server,established; content:"/SiteScope/cgi/go.exe/SiteScope"; reference:nessus,10778; classtype:web-application-activity; sid:1499; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8028 (msg:"WEB-MISC Novell eDirectory HTTP redirection buffer overflow attempt"; flow:established,to_server; content:"Host|3A|"; isdataat:63,relative; content:!"|0A|"; within:63; pcre:"/^(GET|POST)\s+[^\s]*(\x2fnds|\x2fdhost)[^\n]*\nHost\x3a\s*[^\n]{63}/i"; reference:bugtraq,20655; reference:cve,2006-5478; classtype:attempted-admin; sid:8711; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Webcam Viewer Wrapper ActiveX clsid access"; flow:established,to_client; file_data; content:"9D39223E-AE8E-11D4-8FD3-00D0B7730277"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*9D39223E-AE8E-11D4-8FD3-00D0B7730277\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(server)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*9D39223E-AE8E-11D4-8FD3-00D0B7730277\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(server))\s*=/si"; reference:bugtraq,24341; reference:cve,2007-3148; reference:url,www.frsirt.com/english/advisories/2007/2094; classtype:attempted-user; sid:11818; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC filemail access"; flow:to_server,established; content:"/filemail"; http_uri; reference:cve,1999-1154; reference:cve,1999-1155; reference:url,www.securityfocus.com/archive/1/11175; classtype:attempted-recon; sid:1216; rev:14;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION set odbc ini attempt"; flow:to_server,established; content:"CFUSION_SETODBCINI|28 29|"; fast_pattern:only; reference:bugtraq,550; reference:cve,1999-0760; classtype:web-application-attack; sid:926; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer devenum clsid attempt"; flow:to_client,established; content:"083863F1-70DE-11d0-BD40-00A0C911CE86"; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*083863F1-70DE-11d0-BD40-00A0C911CE86/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-user; sid:4133; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft COleSite ActiveX memory corruption attempt "; flow:established,to_client; file_data; content:"Pkmaxctl.VocabCtl"; content:"Pkmaxctl.VocabCtl"; distance:0; metadata:policy security-ips drop; reference:cve,2010-3340; reference:url,www.microsoft.com/technet/security/bulletin/MS10-090.mspx; classtype:attempted-user; sid:18199; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI flexform access"; flow:to_server,established; content:"/flexform"; fast_pattern; http_uri; reference:url,www.wiretrip.net/rfp/p/doc.asp/i2/d6.htm; classtype:attempted-recon; sid:883; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Office 2000 and 2002 Web Components Chart ActiveX object access"; flow:established,to_client; file_data; content:"0002E500-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*0002E500-0000-0000-C000-000000000046/si"; metadata:policy security-ips drop; reference:bugtraq,4449; reference:cve,2002-0727; reference:url,www.microsoft.com/technet/security/bulletin/MS02-044.mspx; classtype:attempted-user; sid:4176; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX NCTAudioGrabber2 ActiveX clsid access"; flow:established,to_client; file_data; content:"34A261F9-FC34-47F8-A35C-75FB73BB1358"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m15>\x22|\x27|)(?P<id1>.+?)(?P=m15)(\s|>)[^>]*\s*classid\s*=\s*(?P<q32>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*34A261F9-FC34-47F8-A35C-75FB73BB1358\s*}?\s*(?P=q32)(\s|>).*(?P=id1)\s*\.\s*(cddbServerAddress|cddbAgentName|cddbUserEmail|cddbCGIScript)|<object\s*[^>]*\s*classid\s*=\s*(?P<q33>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*34A261F9-FC34-47F8-A35C-75FB73BB1358\s*}?\s*(?P=q33)(\s|>)[^>]*\s*id\s*=\s*(?P<m16>\x22|\x27|)(?P<id2>.+?)(?P=m16)(\s|>).*(?P=id2)\s*\.\s*(cddbServerAddress|cddbAgentName|cddbUserEmail|cddbCGIScript))\s*=/siO"; metadata:policy security-ips drop; reference:cve,2008-0958; reference:url,www.kb.cert.org/vuls/id/656593; classtype:attempted-user; sid:15284; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Firefox defineSetter function pointer memory corruption attempt"; flow:to_client,established; content:".watch|28|"; content:"__defineSetter__|28|"; pcre:"/(?P<obj>\w+)\.watch\((?P<q1>\x22|\x27|)(?P<prop>[A-Z0-9\x2d\x5f]+)(?P=q1).*(?P=obj)\.__defineSetter__\((?P<q2>\x22|\x27|)(?P=prop)(?P=q2)/smi"; metadata:policy security-ips drop; reference:bugtraq,35758; reference:cve,2009-2469; classtype:attempted-user; sid:15872; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Forms 2.0 ListBox ActiveX function call access"; flow:established,to_client; file_data; content:"Forms.ListBox.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22Forms.ListBox.1\x22|\x27Forms.ListBox.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22Forms.ListBox.1\x22|\x27Forms.ListBox.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:url,browserfun.blogspot.com/2006/07/mobb-24-formslistbox1-listwidth.html; reference:url,osvdb.org/27372; classtype:attempted-user; sid:8424; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows wmf integer overflow attempt"; flow:to_client,established; flowbits:isset,wmf.download; content:"|D7 CD C6 9A 00 00|"; depth:6; content:"|00 00 00 00|"; within:4; distance:10; content:"|09 00|"; within:2; distance:4; content:"|00 00|"; within:2; distance:12; byte_test:4,>,0x7fffc002,0,little,; reference:bugtraq,25302; reference:cve,2007-3034; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-046.mspx; classtype:web-application-attack; sid:18583; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Ecommerce import.txt access"; flow:to_server,established; content:"/orders/import.txt"; http_uri; classtype:attempted-recon; sid:1148; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader shell metacharacter code execution attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"begin|20|"; within:6; pcre:"/^begin\s\d+\s[^\s\r\n\t]*\x60/sm"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,10931; reference:cve,2004-0630; classtype:attempted-user; sid:18527; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX McAfee NeoTrace ActiveX function call access"; flow:established,to_client; file_data; content:"NeoTraceExplorer.NeoTraceLoader"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22NeoTraceExplorer\.NeoTraceLoader\x22|\x27NeoTraceExplorer\.NeoTraceLoader\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*TraceTarget\s*|.*(?P=v)\s*\.\s*TraceTarget\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22NeoTraceExplorer\.NeoTraceLoader\x22|\x27NeoTraceExplorer\.NeoTraceLoader\x27)\s*\)(\s*\.\s*TraceTarget\s*|.*(?P=n)\s*\.\s*TraceTarget\s*)\s*\(/siO"; reference:bugtraq,21697; reference:cve,2006-6707; classtype:attempted-user; sid:12089; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DABbox3.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BDE-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BDE-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8837; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AcroPDF.PDF ActiveX function call access"; flow:established,to_client; file_data; content:"AcroPDF.PDF"; pcre:"/(?P<c>\w+)\s*=\s*(\x22AcroPDF\.PDF(\.\d)?\x22|\x27AcroPDF\.PDF(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(execCommand|LoadFile|src|setLayoutMode|setNamedDest|setPageMode)\s*|.*(?P=v)\s*\.\s*(execCommand|LoadFile|src|setLayoutMode|setNamedDest|setPageMode)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22AcroPDF\.PDF(\.\d)?\x22|\x27AcroPDF\.PDF(\.\d)?\x27)\s*\)(\s*\.\s*(execCommand|LoadFile|src|setLayoutMode|setNamedDest|setPageMode)\s*|.*(?P=n)\s*\.\s*(execCommand|LoadFile|src|setLayoutMode|setNamedDest|setPageMode)\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,21155; reference:cve,2005-0035; reference:cve,2006-6027; reference:cve,2006-6236; reference:url,www.adobe.com/support/security/advisories/apsa06-02.html; classtype:attempted-user; sid:13913; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 8 ActiveX clsid access"; flow:established,to_client; file_data; content:"8f2f3b54-43cc-4912-9b48-bd500a023d40"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8f2f3b54-43cc-4912-9b48-bd500a023d40\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14428; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DigWebX MSN ActiveX object access"; flow:established,to_client; file_data; content:"05E6787D-82D9-4D24-91DD-97FE8D199501"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*05E6787D-82D9-4D24-91DD-97FE8D199501/si"; metadata:policy security-ips drop; reference:bugtraq,13946; reference:url,www.microsoft.com/technet/security/bulletin/MS05-025.mspx; classtype:attempted-user; sid:4197; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView NNM getnnmdata.exe CGI hostname parameter buffer overflow attempt"; flow:to_server,established; content:"/OvCgi/getnnmdata|2E|exe"; fast_pattern:only; http_uri; content:"Hostname|3D|"; isdataat:300,relative; pcre:"/Hostname\x3D[^\x26\x3F\x3B\x0D\x0A\s]{300}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1555; classtype:attempted-user; sid:19138; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Media Player and shell extension ehtrace.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|ehtrace.dll"; http_uri; reference:cve,2011-0032; reference:cve,2011-2009; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-015.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-076.mspx; classtype:attempted-user; sid:18496; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VFW Capture Class Manager ActiveX clsid access"; flow:established,to_client; file_data; content:"860BB310-5D01-11D0-BD3B-00A0C911CE86"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*860BB310-5D01-11D0-BD3B-00A0C911CE86/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8041; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX TeamListViewWnd Class ActiveX clsid access"; flow:established,to_client; file_data; content:"13E86A0C-FE7D-4573-A41D-6B5B00CCFE22"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*13E86A0C-FE7D-4573-A41D-6B5B00CCFE22\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14298; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC sambar /search/results.stm access"; flow:to_server,established; content:"POST"; content:"/search/results.stm"; reference:bugtraq,7975; reference:bugtraq,9607; reference:cve,2004-2086; reference:nessus,18650; classtype:web-application-activity; sid:3629; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer cross-domain navigation cookie stealing attempt"; flow:to_client,established; content:"setInterval|28|'xDomainAccess|28 29|',1|29 3B|"; content:"setInterval|28 22|try { myWindow.location.href = victimLnk|3B|}"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-3091; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:misc-attack; sid:15529; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3128 (msg:"WEB-MISC Squid authentication headers handling denial of service attempt"; flow:to_server,established; flowbits:isset,ntlm_authentication; content:"Proxy-Authorization: "; content:!"NTLM"; within:4; metadata:policy security-ips drop; reference:bugtraq,14977; reference:cve,2005-2917; classtype:attempted-dos; sid:17371; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Apache Tomcat allowLinking URIencoding directory traversal attempt"; flow:to_server,established; content:"|25|ae|2F|"; pcre:"/(((\xc0|\xe0\x80|\xf0\x80\x80)\xaf|\x2f)((\xc0|\xe0\x80|\xf0\x80\x80)\xae|\x2e){2}|(((\xc0|\xe0\x80|\xf0\x80\x80)\xae|\x2e){2}(\xc0|\xe0\x80|\xf0\x80\x80)\xaf|\x2f))/"; reference:bugtraq,30633; reference:cve,2008-2938; classtype:suspicious-filename-detect; sid:17387; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT XMLHttpRequest attempt"; flow:to_client,established; content:"new XMLHttpRequest|28|"; content:"file|3A|//"; reference:bugtraq,4628; reference:cve,2002-0354; classtype:web-application-attack; sid:1735; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView Network Node Manager ovwebsnmpsrv.exe OVwSelection buffer overflow attempt - POST"; flow:to_server,established; content:"|2F|OvCgi|2F|jovgraph.exe"; http_uri; content:"OVwSelection"; http_client_body; pcre:"/(arg=[^\x26]*?OVwSelection[^\x26]*?\x26.*?sel=[^\s\x26]{1023}|sel=[^\x26]{1023,}\x26.*?arg=[^\s\x26]*?OVwSelection)/sP"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37343; reference:cve,2009-4181; classtype:attempted-user; sid:16713; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VieLib2.Vie2Process ActiveX clsid access"; flow:established,to_client; file_data; content:"7B9C5422-39AA-4c21-BEEF-645E42EB4529"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7B9C5422-39AA-4c21-BEEF-645E42EB4529\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14278; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI ministats admin access"; flow:to_server,established; content:"/ministats/admin.cgi"; fast_pattern; http_uri; classtype:web-application-activity; sid:1215; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealPlayer Ierpplug.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"FDC7A535-4070-4B92-A0EA-D9994BCC0DC5"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*FDC7A535-4070-4B92-A0EA-D9994BCC0DC5\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(GetComponentVersion|HandleAction|DoAutoUpdateRequest|Quoting|PlayerProperty|Import|RecordClip)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*FDC7A535-4070-4B92-A0EA-D9994BCC0DC5\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(GetComponentVersion|HandleAction|DoAutoUpdateRequest|Quoting|PlayerProperty|Import|RecordClip))/siO"; metadata:policy security-ips drop; reference:bugtraq,21802; reference:bugtraq,22811; reference:bugtraq,44443; reference:cve,2006-6847; reference:cve,2007-5601; reference:cve,2008-3066; reference:cve,2010-3749; classtype:attempted-user; sid:10192; rev:16;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS .asp chunked Transfer-Encoding"; flow:to_server,established; content:".asp"; http_uri; content:"Transfer-Encoding|3A|"; http_header; content:"chunked"; http_header; reference:bugtraq,4474; reference:bugtraq,4485; reference:cve,2002-0071; reference:cve,2002-0079; reference:nessus,10932; classtype:web-application-attack; sid:1618; rev:23;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI upload.pl access"; flow:to_server,established; content:"/upload.pl"; fast_pattern; http_uri; classtype:attempted-recon; sid:891; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS frontpage server extensions 2002 cross site scripting attempt"; flow:to_server,established; content:"_vti_bin/_vti_adm/fpadmdll.dll"; fast_pattern:only; http_uri; content:"command="; http_client_body; pcre:"/command\x3D[^\x26]*?(\x2D|\x252D){2}(\x3E|\x253E)/iP"; metadata:policy security-ips drop; reference:bugtraq,17452; reference:cve,2006-0015; reference:url,www.microsoft.com/technet/security/bulletin/ms06-017.mspx; classtype:attempted-user; sid:7028; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SAP GUI SAPBExCommonResources ActiveX function call access"; flow:established,to_client; file_data; content:"SAPBExCommonResources.BExGlobal"; pcre:"/(?P<c>\w+)\s*=\s*(\x22SAPBExCommonResources\.BExGlobal(\.\d)?\x22|\x27SAPBExCommonResources\.BExGlobal(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*Execute\s*|.*(?P=v)\s*\.\s*Execute\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22SAPBExCommonResources\.BExGlobal(\.\d)?\x22|\x27SAPBExCommonResources\.BExGlobal(\.\d)?\x27)\s*\)(\s*\.\s*Execute\s*|.*(?P=n)\s*\.\s*Execute\s*)/smiO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,securitytracker.com/alerts/2010/Mar/1023760.html; classtype:attempted-user; sid:17616; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-IIS SQLXML content type overflow"; flow:to_server,established; pcre:"/\.x[sm]l/Ui"; content:"contenttype="; http_uri; pcre:"/contenttype=[^\r\n\x3b\x38]{100}/smiU"; reference:bugtraq,5004; reference:cve,2002-0186; reference:nessus,11304; reference:url,www.microsoft.com/technet/security/bulletin/MS02-030.mspx; reference:url,www.westpoint.ltd.uk/advisories/wp-02-0007.txt; classtype:attempted-admin; sid:3150; rev:10;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI alert.cgi access"; flow:to_server,established; content:"/alert.cgi"; fast_pattern; http_uri; reference:bugtraq,4211; reference:bugtraq,4579; reference:cve,2002-0346; reference:nessus,11748; classtype:web-application-activity; sid:2195; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Symantec NavComUI AxSysListView32 ActiveX function call access"; flow:established,to_client; file_data; content:"NavComUI.AxSysListView32"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22NavComUI\.AxSysListView32\x22|\x27NavComUI\.AxSysListView32\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*AnomalyList\s*|.*(?P=v)\s*\.\s*AnomalyList\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22NavComUI\.AxSysListView32\x22|\x27NavComUI\.AxSysListView32\x27)\s*\)(\s*\.\s*AnomalyList\s*|.*(?P=n)\s*\.\s*AnomalyList)\s*=/Osmi"; reference:bugtraq,24983; reference:cve,2007-2955; reference:url,www.symantec.com/avcenter/security/Content/2007.08.09.html; classtype:attempted-user; sid:12248; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI webspeed access"; flow:to_server,established; content:"/wsisa.dll/WService="; fast_pattern; http_uri; content:"WSMadmin"; reference:arachnids,467; reference:bugtraq,969; reference:cve,2000-0127; reference:nessus,10304; classtype:attempted-user; sid:805; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft SysTray Invoker ActiveX object access"; flow:established,to_client; file_data; content:"730F6CDC-2C86-11D2-8773-92E220524153"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*730F6CDC-2C86-11D2-8773-92E220524153/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4232; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 47 ActiveX clsid access"; flow:established,to_client; file_data; content:"00D46195-B634-4C41-B53B-5093527FB791"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q83>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*00D46195-B634-4C41-B53B-5093527FB791\s*}?\s*(?P=q83)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14180; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 5 ActiveX clsid access"; flow:established,to_client; file_data; content:"055CB2D7-2969-45CD-914B-76890722F112"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q81>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*055CB2D7-2969-45CD-914B-76890722F112\s*}?\s*(?P=q81)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15668; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DABoolean.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DABoolean.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DABoolean.1\x22|\x27DirectAnimation.DABoolean.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DABoolean.1\x22|\x27DirectAnimation.DABoolean.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8836; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX FolderItems3 ActiveX clsid access"; flow:established,to_client; file_data; content:"53C74826-AB99-4D33-ACA4-3117F51D3788"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*53C74826-AB99-4D33-ACA4-3117F51D3788/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:7932; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; content:".mpkg"; http_uri; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Empkg/smi"; reference:cve,2007-0465; classtype:attempted-admin; sid:16004; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 808 (msg:"WEB-MISC Youngzsoft CCProxy CONNECT Request buffer overflow attempt"; flow:to_server,established; content:"CONNECT "; isdataat:1024,relative; pcre:"/^CONNECT\s[^\s]{1024}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,31416; reference:cve,2008-6415; classtype:attempted-user; sid:15190; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Intuit QuickBooks Online Import 4 ActiveX clsid access"; flow:established,to_client; file_data; content:"AF54BFA2-474E-4b82-A5F3-B79E6F7A80B1"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*AF54BFA2-474E-4b82-A5F3-B79E6F7A80B1\s*}?\s*(?P=q7)(\s|>)/si"; metadata:policy security-ips drop; reference:url,sc.accounting.quickbooks.com/Update/index.cfm?id=32; reference:url,www.microsoft.com/technet/security/bulletin/MS07-069.mspx; classtype:attempted-user; sid:12967; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAMatte.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAMatte.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAMatte.1\x22|\x27DirectAnimation.DAMatte.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAMatte.1\x22|\x27DirectAnimation.DAMatte.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8812; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Reader plugin bibutils.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|bibutils.dll"; http_uri; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18441; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows MSPaint jpeg with malformed SOFx field exploit attempt"; flow:to_client,established; flowbits:isset, file.jpeg; content:"|FF C0 00 11 08 FF 37 55 99 03 01 22 00 02 11 01 03 11 01|"; metadata:policy security-ips drop; reference:cve,2010-0028; reference:url,www.microsoft.com/technet/security/bulletin/MS10-003.mspx; classtype:attempted-user; sid:19130; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Communications Control v6 ActiveX clsid access"; flow:established,to_client; file_data; content:"648A5600-2C6E-101B-82B6-000000000014"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*648A5600-2C6E-101B-82B6-000000000014\s*}?\s*(?P=q1)(\s|>)/siO"; metadata:policy security-ips drop; reference:url,support.microsoft.com/kb/969898; classtype:attempted-user; sid:15543; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft HeartbeatCtl ActiveX function call access"; flow:established,to_client; file_data; content:"HeartbeatCtl.HeartbeatCt"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22HeartbeatCtl\.HeartbeatCt\x22|\x27HeartbeatCtl\.HeartbeatCt\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22HeartbeatCtl\.HeartbeatCt\x22|\x27HeartbeatCtl\.HeartbeatCt\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,28882; reference:cve,2007-6255; classtype:attempted-user; sid:13760; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Sun Java Web Server Webdav Stack Buffer Overflow attempt"; flow:to_server,established; content:"COPY"; depth:4; isdataat:200,relative; pcre:"/^COPY(?!\n)\s[^\n]{200}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37874; reference:cve,2010-0361; classtype:attempted-admin; sid:17609; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IBM Lotus Domino Web Access 7 ActiveX function call access"; flow:established,to_client; file_data; content:"dwa7.dwa7"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22dwa7\.dwa7\x22|\x27dwa7\.dwa7\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*InstallBrowserHelperDll\s*|.*(?P=v)\s*\.\s*InstallBrowserHelperDll\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22dwa7\.dwa7\x22|\x27dwa7\.dwa7\x27)\s*\)(\s*\.\s*InstallBrowserHelperDll\s*|.*(?P=n)\s*\.\s*InstallBrowserHelperDll\s*)\s*\(/Osmi"; metadata:policy security-ips alert; reference:bugtraq,26972; reference:cve,2007-4474; reference:cve,2010-0919; classtype:attempted-user; sid:13264; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 3 ActiveX clsid access"; flow:established,to_client; file_data; content:"3cdeda3a-114b-455e-8c8b-224db4bf29c2"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3cdeda3a-114b-455e-8c8b-224db4bf29c2\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14342; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX NOS Microsystems Adobe atl_getcom ActiveX clsid access "; flow:established,to_client; file_data; content:"E2883E8F-472F-4fb0-9522-AC9BF37916A7"; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E2883E8F-472F-4fb0-9522-AC9BF37916A7\s*}?\s*(?P=q1)(\s|>)/siO"; content:"<PARAM"; pcre:"/<PARAM[^>]+name\s*=\s*(?P<q2>\x22|\x27|)\s*(Service-Url|ItemID|Language)\s*(?P=q2)\s+value\s*=\s*[\x22\x27]?[^\x22\x27\s]{200}/siO"; metadata:policy security-ips drop; reference:bugtraq,37759; reference:cve,2009-3958; reference:url,www.adobe.com/support/security/bulletins/apsb10-02.html; classtype:attempted-user; sid:16371; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Swedish_Default Stemmer ActiveX clsid access"; flow:established,to_client; file_data; content:"9478F640-7F1C-11CE-BE57-00AA0051FE20"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*9478F640-7F1C-11CE-BE57-00AA0051FE20/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8037; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows GRE WMF Handling Memory Read Exception attempt"; flow:to_client,established; flowbits:isset,wmf.download; file_data; content:"|00 09 00 00 03|"; content:"|04 00 00 00|"; distance:0; pcre:"/^(\x01|\x02)\x00\x09\x00{2}\x03/m"; pcre:"/\x04\x00{3}(\x26|\xff)/Rm"; metadata:policy security-ips drop; reference:bugtraq,16167; reference:cve,2006-0143; classtype:attempted-user; sid:17330; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX FlexCell Grid ActiveX clsid access"; flow:established,to_client; file_data; content:"2A7D9CCE-211A-4654-9449-718F71ED9644"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m11>\x22|\x27|)(?P<id1>.+?)(?P=m11)(\s|>)[^>]*\s*classid\s*=\s*(?P<q24>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2A7D9CCE-211A-4654-9449-718F71ED9644\s*}?\s*(?P=q24)(\s|>).*(?P=id1)\s*\.\s*(SaveFile|ExportToXML)|<object\s*[^>]*\s*classid\s*=\s*(?P<q25>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2A7D9CCE-211A-4654-9449-718F71ED9644\s*}?\s*(?P=q25)(\s|>)[^>]*\s*id\s*=\s*(?P<m12>\x22|\x27|)(?P<id2>.+?)(?P=m12)(\s|>).*(?P=id2)\.(SaveFile|ExportToXML))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,33453; reference:cve,2009-0301; classtype:attempted-user; sid:15282; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel label record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|02 04|"; byte_test:2,>,35071,2,relative; metadata:policy security-ips drop; reference:bugtraq,28166; reference:cve,2006-1309; reference:cve,2008-0114; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7199; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC spamrule.dll access"; flow:to_server,established; content:"/spamrule.dll"; http_uri; reference:bugtraq,3327; reference:cve,2001-0958; reference:nessus,11747; classtype:web-application-activity; sid:2236; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI perl.exe command attempt"; flow:to_server,established; content:"/perl.exe?"; fast_pattern; http_uri; reference:arachnids,219; reference:cve,1999-0509; reference:nessus,10173; reference:url,www.cert.org/advisories/CA-1996-11.html; classtype:attempted-recon; sid:1648; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing des buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mp4; content:"|A9|des"; byte_test:4, >, 512, 0, relative; metadata:policy security-ips drop; reference:bugtraq,19976; reference:bugtraq,26773; reference:cve,2006-4386; reference:cve,2007-6401; classtype:attempted-user; sid:13319; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 60 ActiveX clsid access"; flow:established,to_client; file_data; content:"4614C49A-0B7D-4E0D-A877-38CCCFE7D589"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q113>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4614C49A-0B7D-4E0D-A877-38CCCFE7D589\s*}?\s*(?P=q113)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14206; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel OBJ record stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|5D 00|"; content:"|15 00 12 00 14 00|"; within:6; distance:2; content:"|0C 00 14 00|"; within:4; distance:16; content:"|13 00|"; within:2; distance:20; byte_test:2,>,0,0,relative,little; byte_jump:2,2,relative,little; byte_test:2,>,1024,14,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0822; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16638; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DABbox2.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DABbox2.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DABbox2.1\x22|\x27DirectAnimation.DABbox2.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DABbox2.1\x22|\x27DirectAnimation.DABbox2.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8842; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX iPIX Image Well ActiveX function call access"; flow:established,to_client; file_data; content:"iPIX.ImageWell"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22iPIX\.ImageWell\x22|\x27iPIX\.ImageWell\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22iPIX\.ImageWell\x22|\x27iPIX\.ImageWell\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,23379; reference:cve,2007-1687; reference:url,www.kb.cert.org/vuls/id/958609; classtype:attempted-user; sid:10468; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC ContentFilter.dll access"; flow:to_server,established; content:"/ContentFilter.dll"; http_uri; reference:bugtraq,3327; reference:cve,2001-0958; reference:nessus,11747; classtype:web-application-activity; sid:2232; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS Malformed Hit-Highlighting Argument File Access Attempt"; flow:to_server,established; content:"CiWebHitsFile="; http_uri; pcre:"/CiWebHitsFile=\/?([^\r\n\x3b\&]*\.\.\/)?/i"; content:"CiRestriction=none"; fast_pattern; http_uri; content:"ciHiliteType=Full"; http_uri; reference:bugtraq,950; reference:cve,2000-0097; reference:url,www.microsoft.com/technet/security/bulletin/ms00-006.mspx; reference:url,www.securityfocus.com/archive/1/43762; classtype:web-application-attack; sid:1019; rev:26;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RDS.DataControl ActiveX function call access"; flow:established,to_client; file_data; content:"RDS.DataControl"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22RDS.DataControl\x22|\x27RDS.DataControl\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22RDS.DataControl\x22|\x27RDS.DataControl\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,18900; reference:cve,2006-3510; classtype:attempted-user; sid:7017; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Office Data Source Control 9.0 ActiveX clsid access"; flow:established,to_client; file_data; content:"0002E533-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0002E533-0000-0000-C000-000000000046\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28136; reference:cve,2007-1201; reference:url,www.microsoft.com/technet/prodtechnol/office/office2000/proddocs/opg/part4/ch18.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-017.mspx; classtype:attempted-user; sid:7870; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Business Object Factory ActiveX clsid access"; flow:established,to_client; file_data; content:"AB9BCEDD-EC7E-47E1-9322-D4A210617116"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*AB9BCEDD-EC7E-47E1-9322-D4A210617116/si"; metadata:policy security-ips drop; reference:url,metasploit.com/projects/Framework/modules/exploits/ie_createobject.pm; classtype:attempted-user; sid:8363; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC ModPlug ReadS3M overflow attempt"; flow:to_client,established; flowbits:isset,http.s3m; file_data; content:"SCRM"; depth:4; offset:44; byte_test:2,>,65,-12,relative,little; metadata:policy security-ips drop; reference:cve,2011-1574; classtype:attempted-user; sid:20284; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC musicat empower attempt"; flow:to_server,established; content:"/empower?DB="; http_uri; reference:bugtraq,2374; reference:cve,2001-0224; reference:nessus,10609; classtype:web-application-attack; sid:1589; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX reconfig.PopulatedDi ActiveX clsid access"; flow:established,to_client; file_data; content:"41DF0779-3632-4790-B40F-C44CFCF55CB6"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*41DF0779-3632-4790-B40F-C44CFCF55CB6\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14350; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC MySQL MaxDB WebSQL wppassword buffer overflow"; flow:to_server,established; content:"websql?logon"; content:"wqPassword="; distance:0; pcre:"/wqPassword=[^\r\n\x26]{294}/i"; reference:bugtraq,12265; reference:cve,2005-0111; reference:url,www.osvdb.org/displayvuln.php?osvdb_id=12919; classtype:web-application-attack; sid:3518; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Basic DataGrid ActiveX clsid access "; flow:established,to_client; file_data; content:"CDE57A43-8B86-11D0-B3C6-00A0C90AEA82"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m7>\x22|\x27|)(?P<id1>.+?)(?P=m7)(\s|>)[^>]*\s*classid\s*=\s*(?P<q32>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CDE57A43-8B86-11D0-B3C6-00A0C90AEA82\s*}?\s*(?P=q32)(\s|>).*(?P=id1)\s*\.\s*(Text)|<object\s*[^>]*\s*classid\s*=\s*(?P<q33>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CDE57A43-8B86-11D0-B3C6-00A0C90AEA82\s*}?\s*(?P=q33)(\s|>)[^>]*\s*id\s*=\s*(?P<m8>\x22|\x27|)(?P<id2>.+?)(?P=m8)(\s|>).*(?P=id2)\s*\.\s*(Text))\s*=/siO"; metadata:policy security-ips drop; reference:cve,2008-4252; reference:url,support.microsoft.com/kb/960715; reference:url,www.microsoft.com/technet/security/bulletin/MS08-070.mspx; classtype:attempted-user; sid:15092; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Remote Desktop Client ActiveX clsid access"; flow:established,to_client; file_data; content:"7390f3d8-0439-4c05-91e3-cf5cb290c3d0"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7390f3d8-0439-4c05-91e3-cf5cb290c3d0\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(MsRdpClientShell.RdpFileContents)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7390f3d8-0439-4c05-91e3-cf5cb290c3d0\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(MsRdpClientShell.RdpFileContents))\s*=/siO"; metadata:policy security-ips alert; reference:cve,2009-1929; reference:url,www.microsoft.com/technet/security/bulletin/MS09-044.mspx; classtype:attempted-user; sid:20175; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMwareVpcCvt.VpcC ActiveX clsid access"; flow:established,to_client; file_data; content:"D428A135-8494-41DE-A4B5-8BB1B632E8DC"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D428A135-8494-41DE-A4B5-8BB1B632E8DC\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14500; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC xp_regdeletekey attempt"; flow:to_server,established; content:"xp_regdeletekey"; classtype:web-application-activity; sid:1978; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Macrovision InstallShield Update Service ActiveX function call access"; flow:established,to_client; file_data; content:"DWUSWebAgent.WebAgent"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22DWUSWebAgent\.WebAgent\x22|\x27DWUSWebAgent\.WebAgent\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(DownloadAndExecute|AddFileEx|ExecuteRemote)\s*|.*(?P=v)\s*\.\s*(DownloadAndExecute|AddFileEx|ExecuteRemote)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22DWUSWebAgent\.WebAgent\x22|\x27DWUSWebAgent\.WebAgent\x27)\s*\)(\s*\.\s*(DownloadAndExecute|AddFileEx|ExecuteRemote)\s*|.*(?P=n)\s*\.\s*(DownloadAndExecute|AddFileEx|ExecuteRemote)\s*)\s*\(/Osmi"; metadata:policy security-ips alert; reference:bugtraq,26280; reference:bugtraq,31235; reference:cve,2007-5660; reference:url,support.installshield.com/kb/view.asp?articleid=Q113602; classtype:attempted-user; sid:8740; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC SFNofitication.dll access"; flow:to_server,established; content:"/SFNofitication.dll"; http_uri; reference:bugtraq,3327; reference:cve,2001-0958; reference:nessus,11747; classtype:web-application-activity; sid:2233; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC ICQ Webfront HTTP DOS"; flow:to_server,established; content:"??????????"; http_uri; reference:bugtraq,1463; reference:cve,2000-1078; classtype:web-application-attack; sid:1091; rev:14;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI dcboard.cgi access"; flow:to_server,established; content:"/dcboard.cgi"; http_uri; reference:bugtraq,2728; reference:cve,2001-0527; reference:nessus,10583; classtype:attempted-recon; sid:1410; rev:13;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC BEA WebLogic Apache Oracle connector Transfer-Encoding buffer overflow"; flow:established,to_server; content:"POST"; depth:4; content:"Transfer-Encoding|3A|"; distance:0; isdataat:256,relative; pcre:"/^Transfer-Encoding\x3A\s*[^\r\n]{256}/smi"; metadata:policy security-ips drop; reference:cve,2008-4008; reference:url,support.bea.com/application_content/product_portlets/securityadvisories/2806.html; classtype:attempted-admin; sid:14771; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox nsTreeRange Use After Free attempt"; flow:to_client,established; file_data; content:"|2E|view|2E|selection"; content:"|2E|invalidateSelection"; distance:0; pcre:"/\x2Eview\x2Eselection.*?\x2Etree\s*\x3D\s*null.*?\x2Einvalidate/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-0073; reference:url,www.mozilla.org/security/announce/2011/mfsa2011-13.html; classtype:attempted-user; sid:20072; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer datasrc overflow attempt"; flow:to_client,established; content:"document.getElementById"; content:"onCellChange"; fast_pattern:only; pcre:"/function\s+([^\s]+)\x28.*document\x2egetElementById\x28\x22([^\x22]+)\x22\x29\x2einnerHTML=\x22\x22.*id\s*=\s*\x22\2\x22.*onCellChange\s*=\s*\x22\1\x28\x29\x3b\x22/smi"; reference:cve,2011-0035; reference:url,www.microsoft.com/technet/security/bulletin/MS11-003.mspx; classtype:attempted-user; sid:18403; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IBM Lotus Domino Web Access 6 ActiveX clsid access"; flow:established,to_client; file_data; content:"3BFFE033-BF43-11D5-A271-00A024A51325"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3BFFE033-BF43-11D5-A271-00A024A51325\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(InstallBrowserHelperDll)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3BFFE033-BF43-11D5-A271-00A024A51325\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(InstallBrowserHelperDll))\s*\(/Osi"; metadata:policy security-ips alert; reference:bugtraq,26972; reference:cve,2007-4474; reference:cve,2010-0919; classtype:attempted-user; sid:13258; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbQuery Class ActiveX function call access"; flow:established,to_client; file_data; content:"VmdbCOM.VmdbQuery"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22VmdbCOM\.VmdbQuery\x22|\x27VmdbCOM\.VmdbQuery\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22VmdbCOM\.VmdbQuery\x22|\x27VmdbCOM\.VmdbQuery\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14368; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AwingSoft Web3D Player ActiveX function call access"; flow:established,to_client; file_data; content:"WindsPlayerIE.View"; pcre:"/(?P<c>\w+)\s*=\s*(\x22WindsPlayerIE\.View(\.\d)?\x22|\x27WindsPlayerIE\.View(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SceneURL\s*|.*(?P=v)\s*\.\s*SceneURL\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22WindsPlayerIE\.View(\.\d)?\x22|\x27WindsPlayerIE\.View(\.\d)?\x27)\s*\)(\s*\.\s*SceneURL\s*|.*(?P=n)\s*\.\s*SceneURL\s*)/smiO"; metadata:policy security-ips drop; reference:cve,2009-4588; reference:cve,2009-4850; classtype:attempted-user; sid:16769; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 901 (msg:"WEB-MISC Samba SWAT Authorization port 901 overflow attempt"; flow:to_server,established; content:"Authorization|3A| Basic"; pcre:"/^Authorization\x3a(\s*|\s*\r?\n\s+)Basic\s+=/smi"; reference:bugtraq,10780; reference:cve,2004-0600; classtype:web-application-attack; sid:2598; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML DOM null DHTML element insertion attempt"; flow:to_client,established; file_data; content:"NULL"; pcre:"/(insertBefore|insertAfter|appendChild)\(\s*NULL\s*\)/sm"; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:3553; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player ASF codec list object parsing buffer overflow attempt"; flow:to_client,established; content:"@R|D1 86 1D|1|D0 11 A3 A4 00 A0 C9 03|H|F6|"; byte_test:4,>,134217727,24,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-4702; reference:cve,2009-2527; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-078.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-052.mspx; classtype:attempted-user; sid:9642; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Westbyte internet download accelerator ActiveX clsid access"; flow:established,to_client; file_data; content:"2A646672-9C3A-4C28-9A7A-1FB0F63F28B6"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2A646672-9C3A-4C28-9A7A-1FB0F63F28B6\s*}?\s*(?P=q1)(\s|>)/si"; reference:bugtraq,24400; classtype:attempted-user; sid:11942; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI phf access"; flow:to_server,established; content:"/phf"; fast_pattern; http_uri; reference:arachnids,128; reference:bugtraq,629; reference:cve,1999-0067; classtype:web-application-activity; sid:886; rev:18;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMT DirectX Transform Wrapper ActiveX clsid access"; flow:established,to_client; file_data; content:"AECF5D2E-7A18-4DD2-BDCD-29B6F615B448"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*AECF5D2E-7A18-4DD2-BDCD-29B6F615B448/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7468; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer invalid chunk size heap overflow attempt"; flow:to_client,established; content:"Transfer-Encoding"; http_header; content:"chunked"; fast_pattern; http_header; content:"Content-Type|3A|"; http_header; pcre:"/Content-Type\x3a[^\x10\x13]*real(audio|video)/smiH"; content:"HTTP"; within:4; rawbytes; content:"|0D 0A 0D 0A|"; distance:0; isdataat:1024,relative; pcre:"/([^\x0A]{1024,}|.*?\x0A[^\x0A]{1024,})/smiR"; metadata:policy security-ips drop; reference:bugtraq,17202; reference:cve,2005-2922; classtype:attempted-user; sid:17666; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML+TIME animatemotion property memory corruption attempt"; flow:to_client,established; content:"ANIMATEMOTION"; pcre:"/<[A-Z_]+\s*\x3A\s*ANIMATEMOTION[^>]+?id=(?P<q>\x22|\x27|)(?P<n>[A-Z][A-Z\d\x2D\x2E\x3A\x5F]*)(?P=q).*?(?P=n)\./Osmi"; reference:bugtraq,27666; reference:cve,2008-0077; reference:url,www.microsoft.com/technet/security/bulletin/ms08-010.mspx; classtype:attempted-user; sid:16382; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC NetObserve authentication bypass attempt"; flow:to_server,established; content:"login=0"; content:"Cookie|3A|"; http_header; pcre:"/^Cookie\x3a(\s*|\s*\r?\n\s+)[^\n]*?\blogin=0/smiH"; reference:bugtraq,9319; classtype:web-application-attack; sid:2441; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectFrame.DirectControl.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"39A2C2A6-4778-11D2-9BDB-204C4F4F5020"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*39A2C2A6-4778-11D2-9BDB-204C4F4F5020/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7431; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Excel REPT integer underflow attempt"; flow:to_client,established; flowbits:isset,xml.download; content:"|3D|rept|28|"; pcre:"/\x3ccell\s+[^\x3e]*\x3aFormula\s*\x3d\s*\x22\s*\x3drept\x28/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,31706; reference:cve,2008-4019; classtype:attempted-user; sid:17734; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.SpriteControl ActiveX clsid access"; flow:established,to_client; file_data; content:"FD179533-D86E-11D0-89D6-00A0C90833E6"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*FD179533-D86E-11D0-89D6-00A0C90833E6/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8756; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Admin_files access"; flow:to_server,established; content:"/admin_files"; http_uri; classtype:attempted-recon; sid:1212; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS cmd.exe access"; flow:to_server,established; content:"cmd.exe"; fast_pattern; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; classtype:web-application-attack; sid:1002; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbDatabase Class ActiveX clsid access"; flow:established,to_client; file_data; content:"7edd4fce-e178-47f2-ae05-c5936c843795"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7edd4fce-e178-47f2-ae05-c5936c843795\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14420; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 (msg:"WEB-MISC SSLv2 openssl get shared ciphers overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|01 00 02|"; depth:3; offset:2; byte_test:2, >, 256, 0, relative; reference:bugtraq,20249; reference:bugtraq,22083; reference:cve,2006-3738; reference:cve,2007-5135; reference:url,www.openssl.org/news/secadv_20060928.txt; classtype:attempted-admin; sid:8426; rev:13;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Domino cersvr.nsf access"; flow:to_server,established; content:"/cersvr.nsf"; http_uri; reference:nessus,10629; classtype:attempted-recon; sid:1576; rev:10;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI bb-histlog.sh access"; flow:to_server,established; content:"/bb-histlog.sh"; fast_pattern; http_uri; reference:bugtraq,142; reference:cve,1999-1462; reference:nessus,10025; classtype:attempted-recon; sid:1459; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RControl ActiveX clsid access"; flow:established,to_client; file_data; content:"2A515FCD-C0E9-4F38-9C77-2949514366F2"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2A515FCD-C0E9-4F38-9C77-2949514366F2\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,23914; reference:url,moaxb.blogspot.com/2007/05/moaxb-10-rcontroldll-v-1210-denial-of.html; classtype:attempted-user; sid:11274; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Java Web Start ActiveX launch command by CLSID"; flow:established,to_client; file_data; content:"CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA"; fast_pattern:only; content:"Launch"; pcre:"/<object[^>]+classid\s*=\s*(?P<q1>\x22|\x27|)clsid\s*\x3A\s*{?\s*CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA\s*}?(?P=q1)/smi"; pcre:"/([A-Z\d_]+)\.Launch\(/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16547; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI rsh access"; flow:to_server,established; content:"/rsh"; fast_pattern; http_uri; reference:cve,1999-0509; reference:url,www.cert.org/advisories/CA-1996-11.html; classtype:attempted-recon; sid:868; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WM VIH2 Fix ActiveX clsid access"; flow:established,to_client; file_data; content:"586FB486-5560-4FF3-96DF-1118C96AF456"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*586FB486-5560-4FF3-96DF-1118C96AF456/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7500; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Hewlett Packard HPQVWOCX.DL ActiveX clsid access"; flow:established,to_client; file_data; content:"BA726BF9-ED2F-461B-9447-CD5C7D66CE8D"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BA726BF9-ED2F-461B-9447-CD5C7D66CE8D\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(DeleteProfile|SaveToFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BA726BF9-ED2F-461B-9447-CD5C7D66CE8D\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(DeleteProfile|SaveToFile))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,23941; reference:bugtraq,24793; classtype:attempted-user; sid:11291; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SizerOne ActiveX clsid access"; flow:established,to_client; file_data; content:"2315B059-EDD7-4C66-933C-ECFF5B9DD593"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2315B059-EDD7-4C66-933C-ECFF5B9DD593\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(AddTab)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2315B059-EDD7-4C66-933C-ECFF5B9DD593\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(AddTab))\s*\(/siO"; metadata:policy security-ips alert; reference:bugtraq,33148; reference:cve,2008-4827; classtype:attempted-user; sid:15192; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX vmappsdk.CuiObj ActiveX clsid access"; flow:established,to_client; file_data; content:"68F1E07B-609F-4b87-9D57-A879023A75FC"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*68F1E07B-609F-4b87-9D57-A879023A75FC\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14398; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP Instant Support ActiveX clsid access"; flow:established,to_client; file_data; content:"156BF4B7-AE3A-4365-BD88-95A75AF8F09D"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*156BF4B7-AE3A-4365-BD88-95A75AF8F09D\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(queryHub)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*156BF4B7-AE3A-4365-BD88-95A75AF8F09D\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(queryHub))\s*=/si"; reference:bugtraq,24730; reference:cve,2007-3554; reference:url,h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c01077597; classtype:attempted-user; sid:12062; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC .FBCIndex access"; flow:to_server,established; content:"/.FBCIndex"; http_uri; reference:url,www.securiteam.com/securitynews/5LP0O005FS.html; classtype:web-application-activity; sid:1770; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CommuniCrypt Mail ANSMTP.dll/AOSMTP.dll ActiveX function call access"; flow:established,to_client; file_data; content:"AOSMTP.Mail"; pcre:"/(?P<c>\w+)\s*=\s*(\x22AOSMTP\.Mail(\.\d)?\x22|\x27AOSMTP\.Mail(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*AddAttachments\s*|.*(?P=v)\s*\.\s*AddAttachments\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22AOSMTP\.Mail(\.\d)?\x22|\x27AOSMTP\.Mail(\.\d)?\x27)\s*\)(\s*\.\s*AddAttachments\s*|.*(?P=n)\s*\.\s*AddAttachments\s*)/smiO"; metadata:policy security-ips drop; reference:url,osvdb.org/show/osvdb/64839; classtype:attempted-user; sid:17101; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS +.htr code fragment attempt"; flow:to_server,established; content:" .htr"; fast_pattern; http_uri; reference:bugtraq,1488; reference:cve,2000-0630; reference:cve,2001-0004; reference:nessus,10680; reference:url,technet.microsoft.com/en-us/security/bulletin/ms01-004 ; reference:url,www.microsoft.com/technet/security/bulletin/MS00-044.mspx; classtype:web-application-attack; sid:1725; rev:19;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes DAAP protocol handler stack buffer overflow attempt"; flow:to_client,established; file_data; content:"daap|3A|//"; isdataat:256,relative; pcre:"/(\x22|\x27)daap\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15706; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI yabb directory traversal attempt"; flow:to_server,established; content:"/YaBB"; fast_pattern; http_uri; content:"../"; reference:arachnids,462; reference:bugtraq,1668; reference:cve,2000-0853; reference:nessus,10512; classtype:attempted-recon; sid:806; rev:19;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MksCtl Class ActiveX clsid access"; flow:established,to_client; file_data; content:"ec24c86e-34dd-45f3-928d-ecb7c2b3afb4"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*ec24c86e-34dd-45f3-928d-ecb7c2b3afb4\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14556; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Cryptographic API COM 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"FBAB033B-CDD0-4C5E-81AB-AEA575CD1338"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q5>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*FBAB033B-CDD0-4C5E-81AB-AEA575CD1338\s*}?\s*(?P=q5)(\s|>)/si"; metadata:policy security-ips drop; reference:cve,2007-0940; reference:url,www.microsoft.com/technet/security/bulletin/ms07-028.mspx; classtype:attempted-user; sid:11234; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Kodak Thumbnail Image ActiveX object access"; flow:established,to_client; file_data; content:"E1A6B8A0-3603-101C-AC6E-040224009C02"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*E1A6B8A0-3603-101C-AC6E-040224009C02/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/bulletin/MS99-037.mspx; classtype:attempted-user; sid:4190; rev:5;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Hello from the VRT"; flow:to_server,established; content:"What a long strange trip it's been.  Welcome to sid 20000"; fast_pattern:only; classtype:policy-violation; sid:20000; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Debug Diagnostic Tool ActiveX function call access"; flow:established,to_client; file_data; content:"CrashHangExt.Utils"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22CrashHangExt\.Utils(\.\d)?\x22|\x27CrashHangExt\.Utils(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*GetEntryPointForThread\s*|.*(?P=v)\s*\.\s*GetEntryPointForThread\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22CrashHangExt\.Utils(\.\d)?\x22|\x27CrashHangExt\.Utils(\.\d)?\x27)\s*\)(\s*\.\s*GetEntryPointForThread\s*|.*(?P=n)\s*\.\s*GetEntryPointForThread\s*)\s*\(/smiO"; metadata:policy security-ips alert; reference:bugtraq,31996; reference:cve,2008-4800; classtype:attempted-user; sid:15001; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DivXBrowserPlugin ActiveX function call access"; flow:established,to_client; file_data; content:"npdivx.DivXBrowserPlugin"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22npdivx\.DivXBrowserPlugin\x22|\x27npdivx\.DivXBrowserPlugin\x27)\s*\x3b.*(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)(\s*\.\s*(Resize)\s*\(|.*\3\s*\.\s*(Resize)\s*\()|(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22npdivx\.DivXBrowserPlugin\x22|\x27npdivx\.DivXBrowserPlugin\x27)\s*\)(\s*\.\s*(Resize)\s*\(|.*\7\s*\.\s*(Resize)\s*\()/smi"; metadata:policy security-ips drop; classtype:attempted-user; sid:10191; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LeadTools Raster Dialog File Object ActiveX function call access"; flow:established,to_client; file_data; content:"LEADRasterDlgFile.LEADRasterDlgFile"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22LEADRasterDlgFile\.LEADRasterDlgFile\x22|\x27LEADRasterDlgFile\.LEADRasterDlgFile\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*Directory\s*|.*(?P=v)\s*\.\s*Directory\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22LEADRasterDlgFile\.LEADRasterDlgFile\x22|\x27LEADRasterDlgFile\.LEADRasterDlgFile\x27)\s*\)(\s*\.\s*Directory\s*|.*(?P=n)\s*\.\s*Directory)\s*=/smi"; reference:bugtraq,24133; reference:url,moaxb.blogspot.com/2007/05/moaxb-24-leadtools-raster-dialog-file.html; classtype:attempted-user; sid:11632; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Persits Software XUpload ActiveX clsid access"; flow:established,to_client; file_data; content:"E87F6C8E-16C0-11D3-BEF7-009027438003"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E87F6C8E-16C0-11D3-BEF7-009027438003\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(AddFolder|AddFile|MakeHttpRequest)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E87F6C8E-16C0-11D3-BEF7-009027438003\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(AddFolder|AddFile|MakeHttpRequest))\s*\(/siO"; reference:bugtraq,27025; reference:bugtraq,27456; reference:bugtraq,36550; reference:cve,2007-6530; reference:cve,2008-0492; reference:cve,2009-3693; classtype:attempted-user; sid:13232; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Windows Media Player Active Movie ActiveX object access"; flow:established,to_client; file_data; content:"05589FA1-C356-11CE-BF01-00AA0055595A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*05589FA1-C356-11CE-BF01-00AA0055595A/si"; metadata:policy security-ips drop; reference:bugtraq,1221; reference:cve,2000-0400; classtype:attempted-user; sid:4158; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SonicWall Aventail EPInterrogator ActiveX function call access"; flow:established,to_client; file_data; content:"Aventail.EPInterrogator"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Aventail\.EPInterrogator(\.\d)?\x22|\x27Aventail\.EPInterrogator(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(AuthCredential|ConfigurationString)\s*|.*(?P=v)\s*\.\s*(AuthCredential|ConfigurationString)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Aventail\.EPInterrogator(\.\d)?\x22|\x27Aventail\.EPInterrogator(\.\d)?\x27)\s*\)(\s*\.\s*(AuthCredential|ConfigurationString)\s*|.*(?P=n)\s*\.\s*(AuthCredential|ConfigurationString))\s*=/smiO"; metadata:policy security-ips drop; reference:url,osvdb.org/67286; classtype:attempted-user; sid:18322; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Multiple vendor Antivirus magic byte detection evasion attempt"; flow:to_client,established; flowbits:isset,http.htm; content:"Content|2D|Type|3A 20|text|2F|html"; http_header; file_data; pcre:"/(MZ|PK|BZh|BZ|GIF8|BM|IC|PI|CI|CP)/R"; reference:cve,2005-3370; reference:cve,2005-3371; reference:cve,2005-3372; reference:cve,2005-3373; reference:cve,2005-3374; reference:cve,2005-3375; reference:cve,2005-3376; reference:cve,2005-3377; reference:cve,2005-3378; reference:cve,2005-3379; reference:cve,2005-3380; reference:cve,2005-3381; reference:cve,2005-3382; classtype:attempted-user; sid:17276; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Web on Windows ActiveX function call access"; flow:established,to_client; file_data; content:"All_In_The_Box.AllBox"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22All_In_The_Box\.AllBox(\.\d)?\x22|\x27All_In_The_Box\.AllBox(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(WriteIniFileString|ShellExecute)\s*|.*(?P=v)\s*\.\s*(WriteIniFileString|ShellExecute)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22All_In_The_Box\.AllBox(\.\d)?\x22|\x27All_In_The_Box\.AllBox(\.\d)?\x27)\s*\)(\s*\.\s*(WriteIniFileString|ShellExecute)\s*|.*(?P=n)\s*\.\s*(WriteIniFileString|ShellExecute)\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:bugtraq,33515; reference:cve,2009-0389; classtype:attempted-user; sid:15352; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Forms 2.0 ComboBox ActiveX clsid access"; flow:established,to_client; file_data; content:"8BD21D30-EC42-11CE-9E0D-00AA006002F3"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*8BD21D30-EC42-11CE-9E0D-00AA006002F3/si"; metadata:policy security-ips drop; reference:cve,1999-0384; reference:url,www.microsoft.com/technet/security/bulletin/ms99-001.mspx; classtype:attempted-user; sid:7954; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI adcycle access"; flow:to_server,established; content:"/adcycle"; fast_pattern; http_uri; reference:bugtraq,3741; reference:cve,2001-1226; classtype:web-application-activity; sid:1721; rev:13;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC VsSetCookie.exe access"; flow:to_server,established; content:"/VsSetCookie.exe"; http_uri; reference:bugtraq,3784; reference:cve,2002-0236; reference:nessus,11731; classtype:web-application-activity; sid:2244; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Certificate Enrollment ActiveX object access"; flow:established,to_client; file_data; content:"43F8F289-7A20-11D0-8F06-00C04FC295E1"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*43F8F289-7A20-11D0-8F06-00C04FC295E1/si"; metadata:policy security-ips drop; reference:bugtraq,5593; reference:cve,2002-0699; reference:url,www.microsoft.com/technet/security/bulletin/MS02-048.mspx; classtype:attempted-user; sid:4184; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS scripts-browse access"; flow:to_server,established; content:"/scripts/ "; fast_pattern:only; reference:nessus,11032; classtype:web-application-attack; sid:1029; rev:15;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"WEB-MISC Apache mod_rewrite buffer overflow attempt"; flow:established,to_server; content:"GET"; content:"ldap|3A|"; distance:0; pcre:"/ldap\x3A\x2F\x2F[^\x0A]*(%3f|\x3F)[^\x0A]*(%3f|\x3F)[^\x0A]*(%3f|\x3F)[^\x0A]*(%3f|\x3F)/smi"; reference:cve,2006-3747; classtype:attempted-admin; sid:11679; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MW6 Technologies QRCode ActiveX clsid access"; flow:established,to_client; file_data; content:"3BB56637-651D-4D1D-AFA4-C0506F57EAF8"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m9>\x22|\x27|)(?P<id1>.+?)(?P=m9)(\s|>)[^>]*\s*classid\s*=\s*(?P<q21>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3BB56637-651D-4D1D-AFA4-C0506F57EAF8\s*}?\s*(?P=q21)(\s|>).*(?P=id1)\s*\.\s*(SaveAsBMP|SaveAsWMF)|<object\s*[^>]*\s*classid\s*=\s*(?P<q22>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3BB56637-651D-4D1D-AFA4-C0506F57EAF8\s*}?\s*(?P=q22)(\s|>)[^>]*\s*id\s*=\s*(?P<m10>\x22|\x27|)(?P<id2>.+?)(?P=m10)(\s|>).*(?P=id2)\.(SaveAsBMP|SaveAsWMF))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,25702; reference:cve,2007-4982; classtype:attempted-user; sid:12466; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMT Audio Analyzer ActiveX clsid access"; flow:established,to_client; file_data; content:"1CB1623E-BBEC-4E8D-B2DF-DC08C6F4627C"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*1CB1623E-BBEC-4E8D-B2DF-DC08C6F4627C/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7460; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Basic 6 PDWizard.File ActiveX function call access"; flow:established,to_client; file_data; content:"PDWizard.File"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22PDWizard\.File\x22|\x27PDWizard\.File\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22PDWizard\.File\x22|\x27PDWizard\.File\x27)\s*\)/Osmi"; reference:cve,2007-3041; reference:url,www.microsoft.com/technet/security/bulletin/ms07-045.mspx; classtype:attempted-user; sid:12263; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 7 ActiveX clsid access"; flow:established,to_client; file_data; content:"15D6504A-5494-499C-886C-973C9E53B9F1"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15672; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Agent v1.5 ActiveX function call access"; flow:established,to_client; file_data; content:"Agent.Control.1"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Agent\.Control\.1\x22|\x27Agent\.Control\.1\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Agent\.Control\.1\x22|\x27Agent\.Control\.1\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:cve,2005-1214; reference:cve,2006-3445; reference:cve,2007-1205; reference:url,www.microsoft.com/technet/security/bulletin/MS05-032.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS06-068.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS07-020.mspx; classtype:attempted-user; sid:8856; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC ExAir access"; flow:to_server,established; content:"/exair/search/"; http_uri; reference:bugtraq,193; reference:cve,1999-0449; reference:nessus,10002; reference:nessus,10003; reference:nessus,10004; classtype:web-application-activity; sid:1500; rev:15;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-FRONTPAGE frontpage server extension long host string overflow attempt"; flow:to_server,established; content:"fp40reg.dll"; fast_pattern; http_uri; content:"Host|3A|"; isdataat:300,relative; pcre:"/^Host\x3A\s[^\r\n]{300}/smi"; reference:bugtraq,9008; reference:cve,2003-0824; reference:url,www.microsoft.com/technet/security/Bulletin/MS03-051.mspx; classtype:attempted-admin; sid:6411; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 1220 (msg:"WEB-CGI streaming server view_broadcast.cgi access"; flow:to_server,established; content:"/view_broadcast.cgi"; fast_pattern; http_uri; reference:bugtraq,8257; reference:cve,2003-0422; classtype:web-application-activity; sid:2388; rev:11;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Report Viewer reflect XSS attempt"; flow:to_server,established; content:"ReportID|3D|"; http_uri; content:"ControlID|3D|"; http_uri; content:"TimerMethod|3D|"; http_uri; pcre:"/TimerMethod\x3D[^\x26]*[\x3C\x28\x22\x27]/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1976; reference:url,www.microsoft.com/technet/security/bulletin/MS11-067.mspx; classtype:attempted-user; sid:19681; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Pq2vcom.Pq2v ActiveX function call access"; flow:established,to_client; file_data; content:"Pq2vcom.Pq2v"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Pq2vcom\.Pq2v\x22|\x27Pq2vcom\.Pq2v\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Pq2vcom\.Pq2v\x22|\x27Pq2vcom\.Pq2v\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14384; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 41 ActiveX clsid access"; flow:established,to_client; file_data; content:"C6B14B32-76AA-4A86-A7AC-5C79AAF58DA7"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q71>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C6B14B32-76AA-4A86-A7AC-5C79AAF58DA7\s*}?\s*(?P=q71)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15658; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbContext Class ActiveX clsid access"; flow:established,to_client; file_data; content:"2e1c00eb-6468-40ae-94b3-2c8d80080f21"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2e1c00eb-6468-40ae-94b3-2c8d80080f21\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14330; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI txt2html.cgi access"; flow:to_server,established; content:"/txt2html.cgi"; fast_pattern; http_uri; classtype:web-application-activity; sid:1304; rev:14;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Java floating point number denial of service - via URI"; flow:established,to_server; content:"2.2250738585072012e-308"; http_uri; metadata:policy security-ips drop; reference:cve,2010-4476; reference:url,www.oracle.com/technetwork/topics/security/alert-cve-2010-4476-305811.html; classtype:attempted-dos; sid:18470; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX GeoVision LiveX 7000 ActiveX clsid access"; flow:established,to_client; file_data; content:"DA8484DE-52DB-4860-A986-61A8682E298A"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m5>\x22|\x27|)(?P<id1>.+?)(?P=m5)(\s|>)[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DA8484DE-52DB-4860-A986-61A8682E298A\s*}?\s*(?P=q7)(\s|>).*(?P=id1)\s*\.\s*(SnapShotToFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q8>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DA8484DE-52DB-4860-A986-61A8682E298A\s*}?\s*(?P=q8)(\s|>)[^>]*\s*id\s*=\s*(?P<m6>\x22|\x27|)(?P<id2>.+?)(?P=m6)(\s|>).*(?P=id2)\.(SnapShotToFile))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,33782; classtype:attempted-user; sid:15334; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI talkback.cgi access"; flow:to_server,established; content:"/talkbalk.cgi"; fast_pattern; http_uri; reference:bugtraq,2547; reference:cve,2001-0420; classtype:web-application-activity; sid:1720; rev:13;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC OpenView Network Node Manager cookie buffer overflow attempt"; flow:to_server,established; content:"/OVCgi/webappmon.exe"; fast_pattern:only; http_uri; pcre:"/(OvJavaScript|OvTitleFrame|OvHelpWindow|OvMap|OvSession|OvJavaLocale|OvOSLocale|OvLogin|OvDebug|OvDeveloper|OvTreeControl|OvJavaScript|OvProduct|OvPort|OvLocale|OvWebSession)\s*\x3D[^\x3B\x2C]{1024}/iC"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,42154; reference:cve,2010-2709; classtype:attempted-user; sid:17140; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe PDF CIDFont dictionary glyph width corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|2F|Subtype|20 2F|CIDFontType2"; content:"|2F|W|20 5B|0|20 5B|778|20|0|5D 20|2|20|3|20|250|20|4|20 5B|333|20|408|5D|"; distance:0; content:"|5B|556|20|722|20|667|20|556|20|611|5D|"; distance:0; reference:cve,2011-2105; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19251; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC cs.exe access"; flow:to_server,established; content:"/cgi-bin/cs.exe"; http_uri; reference:bugtraq,3375; reference:cve,2001-1252; classtype:attempted-recon; sid:1303; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAEndStyle.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BEC-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BEC-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8747; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI db2www access"; flow:to_server,established; content:"/db2www"; http_uri; reference:cve,2000-0677; classtype:web-application-activity; sid:1643; rev:10;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI ksh access"; flow:to_server,established; content:"/ksh"; fast_pattern; http_uri; reference:cve,1999-0509; reference:url,www.cert.org/advisories/CA-1996-11.html; classtype:attempted-recon; sid:865; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Logitech Video Call 4 ActiveX clsid access"; flow:established,to_client; file_data; content:"bef0f488-3562-435f-8e89-79d94c9a528c"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*bef0f488-3562-435f-8e89-79d94c9a528c\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Start)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*bef0f488-3562-435f-8e89-79d94c9a528c\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Start))/siO"; metadata:policy security-ips drop; reference:bugtraq,24254; reference:cve,2007-2918; classtype:attempted-user; sid:17069; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC source.jsp access"; flow:to_server,established; content:"/source.jsp"; http_uri; reference:nessus,12119; classtype:web-application-activity; sid:2484; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI DCShop access"; flow:to_server,established; content:"/dcshop"; fast_pattern; http_uri; reference:bugtraq,2889; reference:cve,2001-0821; classtype:web-application-activity; sid:1555; rev:14;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Twiki view rev command injection attempt"; flow:to_server,established; content:"/view/"; http_uri; pcre:"/view/[^\n]*rev[1|2]*=[^d\x20]+/smi"; reference:bugtraq,14834; reference:cve,2005-2877; classtype:attempted-admin; sid:4986; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 8 ActiveX clsid access"; flow:established,to_client; file_data; content:"1BE49F30-0E1B-11D3-9D8E-00C04F72D980"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q87>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*1BE49F30-0E1B-11D3-9D8E-00C04F72D980\s*}?\s*(?P=q87)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15674; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer span tag memory corruption attempt"; flow:to_client,established; content:"white|2D|space|3A|normal|3B|"; pcre:"/pre\s*\x7b\s*white\x2dspace\x3a\s*normal\s*\x3b\s*\x7d/i"; content:"span|20 2F|"; distance:0; content:"span|20 2F|"; within:14; pcre:"/(\x26lt\x3b|\x3c)pre(\x26gt\x3b|\x3e)\s*(\x26lt\x3b|\x3c)span\s\x2f(\x26gt\x3b|\x3e)(\x26lt\x3b|\x3c)span\s\x2f(\x26gt\x3b|\x3e)\s*(\x26lt\x3b|\x3c)\x2fpre(\x26gt\x3b|\x3e)/i"; metadata:policy security-ips drop; reference:cve,2006-1188; classtype:attempted-user; sid:18304; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel cf record arbitrary code excecution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|B1 01|"; byte_test:2,&,1,12,relative,little; byte_test:2,>,69,14,relative,little; byte_test:2,>,13,0,relative,little; byte_test:2,<,8225,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0117; reference:url,www.microsoft.com/technet/security/bulletin/MS08-014.mspx; classtype:attempted-user; sid:13570; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer nested object tag memory corruption attempt"; flow:to_client,established; content:"<STYLE></STYLE>|0A|<OBJECT"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,17658; reference:cve,2006-1992; classtype:attempted-user; sid:16031; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.SequencerControl ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.SequencerControl"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.SequencerControl\x22|\x27DirectAnimation.SequencerControl\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.SequencerControl\x22|\x27DirectAnimation.SequencerControl\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8761; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAPath2.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BD0-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BD0-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8795; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Possible generic javascript heap spray attempt"; flow:to_client,established; content:"%u0a0a%u0a0a"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,35660; classtype:attempted-user; sid:20137; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 23 ActiveX clsid access"; flow:established,to_client; file_data; content:"e54b2aa7-52ab-431c-a1fa-3f807ee3578d"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*e54b2aa7-52ab-431c-a1fa-3f807ee3578d\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14542; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader Linux malformed U3D mesh deceleration block exploit attempt"; flow:to_client,established; flowbits:isset, http.pdf; content:"stream|0A|U3D"; fast_pattern:only; pcre:"/stream\nU3D[^<]*\x31\xff\xff\xff/si"; byte_jump:2, 8, relative, little; byte_test:4, >, 97612893, 32, relative, little; metadata:policy security-ips drop; reference:cve,2010-0196; classtype:attempted-user; sid:16603; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS ISAPI .idq attempt"; flow:to_server,established; content:".idq?"; fast_pattern; http_uri; reference:arachnids,553; reference:bugtraq,1065; reference:bugtraq,968; reference:cve,2000-0071; reference:cve,2000-0126; reference:cve,2001-0500; reference:nessus,10115; classtype:web-application-attack; sid:1244; rev:23;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI classifieds.cgi access"; flow:to_server,established; content:"/classifieds.cgi"; fast_pattern; http_uri; reference:bugtraq,2020; reference:cve,1999-0934; classtype:attempted-recon; sid:854; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 6 ActiveX clsid access"; flow:established,to_client; file_data; content:"69C462E1-CD41-49E3-9EC2-D305155718C1"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q111>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*69C462E1-CD41-49E3-9EC2-D305155718C1\s*}?\s*(?P=q111)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14098; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Photoshop CS4 GRD file processing buffer overflow attempt"; flow:to_client,established; content:"|00|G|00|r|00|a|00|d|00|i|00|e|00|n|00|t"; byte_test:4,>,1020,13,relative,big; content:"8BGR"; metadata:policy security-ips drop; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17146; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC windmail.exe access"; flow:to_server,established; content:"/windmail.exe"; http_uri; reference:arachnids,465; reference:bugtraq,1073; reference:cve,2000-0242; reference:nessus,10365; classtype:attempted-recon; sid:1158; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer daxctle.ocx spline method buffer overflow attempt"; flow:to_client,established; file_data; content:"|28 28|0x200c-4|29 2F|2|29|"; fast_pattern; content:"|28|14|2F|2|29|"; within:150; metadata:policy security-ips drop; reference:cve,2006-4446; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-067; classtype:attempted-user; sid:19885; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI way-board.cgi access"; flow:to_server,established; content:"/way-board.cgi"; fast_pattern; http_uri; reference:nessus,10610; classtype:web-application-activity; sid:1850; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla multiple products CSSValue array memory corruption attempt"; flow:to_client,established; content:"counter|2D|reset|3A|"; content:"counter|2D|increment|3A|"; distance:0; content:"|3C|ol|20|id|3D 22|id1|22 3E 0A|"; distance:0; content:"|3C|li|3E 3C 2F|li|3E 0A 3C|li|3E 3C 2F|li|3E 0A 3C|li|3E 3C 2F|li|3E 0A|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,29802; reference:cve,2008-2785; classtype:attempted-user; sid:17630; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION startstop DOS access"; flow:to_server,established; content:"/cfide/administrator/startstop.html"; fast_pattern; http_uri; reference:bugtraq,247; reference:cve,1999-0756; classtype:web-application-attack; sid:935; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected sBIT overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"sBIT"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6691; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI Ipswitch WhatsUp Gold dos attempt"; flow:to_server,established; content:"/prn"; fast_pattern; http_uri; pcre:"/\/prn\.(asp|cgi|html?)/Ui"; reference:bugtraq,11110; reference:cve,2004-0799; reference:url,www.idefense.com/application/poi/display?id=142&type=vulnerabilities; reference:url,www.ipswitch.com/Support/WhatsUp/patch-upgrades.html; reference:url,www.secunia.com/advisories/12578/; classtype:attempted-dos; sid:3469; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbEnumTags Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmdbCOM.VmdbEnumTags"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmdbCOM\.VmdbEnumTags\x22|\x27vmdbCOM\.VmdbEnumTags\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmdbCOM\.VmdbEnumTags\x22|\x27vmdbCOM\.VmdbEnumTags\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14412; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Bitmap width integer overflow multipacket attempt"; flow:to_client,established; flowbits:isset,http.bmp; content:"BM"; byte_test:4,>,83386080,16,relative,little; metadata:policy security-ips drop; reference:bugtraq,11171; reference:cve,2004-0904; reference:cve,2008-3015; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=255067; reference:url,www.microsoft.com/technet/security/bulletin/MS08-052.mspx; classtype:attempted-admin; sid:3634; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Pq2vcom.Pq2v ActiveX clsid access"; flow:established,to_client; file_data; content:"5647DAF6-85BE-4173-88E7-749322B243BE"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5647DAF6-85BE-4173-88E7-749322B243BE\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14382; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAPoint2.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BC8-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BC8-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8792; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Vantage Linguistics 1 ActiveX clsid access"; flow:established,to_client; file_data; content:"c1908682-7b2c-4ab0-b98e-183649a0bf84"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*c1908682-7b2c-4ab0-b98e-183649a0bf84\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/bulletin/MS07-069.mspx; reference:url,www.vantagelinguistics.com/answerworks/release/; classtype:attempted-user; sid:12948; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Sun Java System Web Server 7.0 WebDAV format string exploit attempt - LOCK method"; flow:to_server,established; content:"LOCK"; http_method; content:"<?xml"; fast_pattern; content:"encoding"; within:50; pcre:"/\<\?xml[^\>]+encoding\s*\=\s*(\'|\")[^\'\"\>\%]*\%/"; reference:bugtraq,37910; reference:cve,2010-0388; classtype:attempted-user; sid:16427; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView Network Node Manager OpenView5 CGI buffer overflow attempt"; flow:to_server,established; content:"/OvCgi/OpenView5.exe"; fast_pattern:only; http_uri; pcre:"/(Context|Action)\x3D[^\x26\x3b]{1024}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33147; reference:cve,2008-0067; classtype:attempted-user; sid:18579; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ICM Class Manager ActiveX clsid access"; flow:established,to_client; file_data; content:"33D9A760-90C8-11D0-BD43-00A0C911CE86"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*33D9A760-90C8-11D0-BD43-00A0C911CE86/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8017; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 35 ActiveX clsid access"; flow:established,to_client; file_data; content:"C531D9FD-9685-4028-8B68-6E1232079F1E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q57>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C531D9FD-9685-4028-8B68-6E1232079F1E\s*}?\s*(?P=q57)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15644; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 71 ActiveX clsid access"; flow:established,to_client; file_data; content:"CC7DA087-B7F4-4829-B038-DA01DFB5D879"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q137>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CC7DA087-B7F4-4829-B038-DA01DFB5D879\s*}?\s*(?P=q137)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14228; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMStatusbarCtl Class ActiveX function call access"; flow:established,to_client; file_data; content:"Vmappsdk.VMStatusbarCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Vmappsdk\.VMStatusbarCtl\x22|\x27Vmappsdk\.VMStatusbarCtl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Vmappsdk\.VMStatusbarCtl\x22|\x27Vmappsdk\.VMStatusbarCtl\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14304; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows afd.sys kernel-mode memory corruption attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|8B 45 FC 50 6A|"; byte_test:1,>,24,0,relative; content:"|8D 8D A0 FD FF FF 51 68 BB 20 01 00 8B 55 F8 52 FF 15 18|"; fast_pattern; content:"|40 00|"; within:2; distance:1; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2005; reference:url,www.microsoft.com/technet/security/bulletin/MS11-080.mspx; classtype:attempted-admin; sid:20270; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Vector Markup Language recolorinfo tag numcolors parameter buffer overflow attempt"; flow:to_client,established; content:"recolorinfo"; content:"numcolors"; pcre:"/recolorinfo[^>]*numcolors\s*=\s*\x22/si"; byte_test:10,>,24403223,0,relative,string; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2007-0024; reference:url,www.microsoft.com/technet/security/bulletin/ms07-004.mspx; classtype:attempted-user; sid:9849; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer IE6/7/8 reload stylesheet attempt"; flow:to_client,established; file_data; content:".href"; content:".rel"; distance:0; content:"stylesheet"; distance:0; fast_pattern; content:".href"; distance:0; content:"location.reload"; distance:0; pcre:"/(?P<q1>[a-zA-Z0-9]*)\x2ehref\s*\x3d.*(?P=q1)\x2erel\s*\x3d.*(?P=q1)\x2ehref\s*\x3d/smi"; reference:cve,2011-1250; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-user; sid:19240; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.Redirect ActiveX clsid access"; flow:established,to_client; file_data; content:"42B07B28-2280-4937-B035-0293FB812781"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*42B07B28-2280-4937-B035-0293FB812781\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/bulletin/ms06-013.mspx; classtype:attempted-user; sid:11239; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Logitech Video Call 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"6577b09d-c39d-4e22-9913-c99803f9c388"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6577b09d-c39d-4e22-9913-c99803f9c388\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Start)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6577b09d-c39d-4e22-9913-c99803f9c388\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Start))/siO"; metadata:policy security-ips drop; reference:bugtraq,24254; reference:cve,2007-2918; classtype:attempted-user; sid:17065; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft PNG large colour depth download attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:1,>,16,8,relative; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:3134; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash ActionScript float index memory corruption"; flow:to_client,established; flowbits:isset,http.swf; content:"|5F 30 64 61 79 32 5F 66 6C 61 0C 4D 61 69 6E 54 69 6D 65 6C 69 6E 65|"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:19257; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows DirectX SAMI file parsing buffer overflow attempt"; flow:to_client,established; content:"<SAMI"; content:"<STYLE"; distance:0; content:"text/css"; within:200; isdataat:600,relative; content:!"</STYLE"; within:600; pcre:"/\x3Cstyle[^\x3E]+?type\s*\x3D\s*(?P<q>(\x22|\x27|))text\x2Fcss(?P=q)[^\x3E]*\x3E.*^\s*\S+\s*\x7b[^\x7d]{500}/smiO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-1444; reference:url,www.microsoft.com/technet/security/bulletin/MS08-033.mspx; classtype:attempted-user; sid:13823; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DB Software Laboratory DeWizardX ActiveX function call access"; flow:established,to_client; file_data; content:"DEWizardAX.DEWizardX"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22DEWizardAX\.DEWizardX\x22|\x27DEWizardAX\.DEWizardX\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SaveToFile\s*|.*(?P=v)\s*\.\s*SaveToFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22DEWizardAX\.DEWizardX\x22|\x27DEWizardAX\.DEWizardX\x27)\s*\)(\s*\.\s*SaveToFile\s*|.*(?P=n)\s*\.\s*SaveToFile\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,23986; reference:url,www.microsoft.com/technet/security/bulletin/ms07-027.mspx; classtype:attempted-user; sid:11303; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Windows Shell User Enumeration Object ActiveX clsid access"; flow:established,to_client; file_data; content:"60664CAF-AF0D-0004-A300-5C7D25FF22A0"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*60664CAF-AF0D-0004-A300-5C7D25FF22A0\s*}?\s*\1/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:10176; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Real Player realtext file bad version buffer overflow attempt"; flow:to_client,established; flowbits:isset,realtext.request; content:"<window"; content:"version"; distance:0; pcre:"/<window\s+version\s*=\s*(?!(1\.(0|2|4|5|6)))/smi"; reference:bugtraq,14048; reference:cve,2005-1766; reference:nessus,18558; classtype:attempted-user; sid:3823; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office RTF malformed second pfragments field"; flow:to_client,established; flowbits:isset,http.rtf; file_data; content:"pFragments"; distance:0; content:"{|5C|sv"; within:15; pcre:"/^[^\x3B\x7D]{0,10}\x3B[^\x3B\x7D]{64}/smiR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,44652; reference:cve,2010-3333; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:18706; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC bad HTTP/1.1 request, Potentially worm attack"; flow:to_server,established; content:"GET / HTTP/1.1|0D 0A 0D 0A|"; depth:18; reference:url,securityresponse.symantec.com/avcenter/security/Content/2002.09.13.html; classtype:web-application-activity; sid:1881; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Intuit QuickBooks Online Edition 6 ActiveX clsid access"; flow:established,to_client; file_data; content:"A80D199B-CFDD-4da4-8C47-2310D5B8DD97"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m13>\x22|\x27|)(?P<id1>.+?)(?P=m13)(\s|>)[^>]*\s*classid\s*=\s*(?P<q19>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A80D199B-CFDD-4da4-8C47-2310D5B8DD97\s*}?\s*(?P=q19)(\s|>).*(?P=id1)\s*\.\s*(httpGETToFile|httpPOSTFromFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q20>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A80D199B-CFDD-4da4-8C47-2310D5B8DD97\s*}?\s*(?P=q20)(\s|>)[^>]*\s*id\s*=\s*(?P<m14>\x22|\x27|)(?P<id2>.+?)(?P=m14)(\s|>).*(?P=id2)\.(httpGETToFile|httpPOSTFromFile))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,25544; reference:cve,2007-0322; reference:cve,2007-4471; reference:url,sc.accounting.quickbooks.com/Update/index.cfm?id=32; reference:url,www.kb.cert.org/vuls/id/907481; reference:url,www.kb.cert.org/vuls/id/979638; reference:url,www.microsoft.com/technet/security/bulletin/MS07-069.mspx; classtype:attempted-user; sid:12403; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Xunlei Thunder PPLAYER.DLL ActiveX function call access"; flow:established,to_client; file_data; content:"PPlayer.XPPlayer"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22PPlayer\.XPPlayer\x22|\x27PPlayer\.XPPlayer\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*FlvPlayerUrl\s*|.*(?P=v)\s*\.\s*FlvPlayerUrl\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22PPlayer\.XPPlayer\x22|\x27PPlayer\.XPPlayer\x27)\s*\)(\s*\.\s*FlvPlayerUrl\s*|.*(?P=n)\s*\.\s*FlvPlayerUrl\s*)\s*\(/smi"; reference:bugtraq,26536; reference:cve,2007-6144; classtype:attempted-user; sid:12739; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX EnjoySAP kweditcontrol ActiveX clsid access"; flow:established,to_client; file_data; content:"2137278D-EF5C-11D3-96CE-0004AC965257"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2137278D-EF5C-11D3-96CE-0004AC965257\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(PrepareToPostHTML|Comp_Download)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2137278D-EF5C-11D3-96CE-0004AC965257\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(PrepareToPostHTML|Comp_Download))/siO"; metadata:policy security-ips drop; reference:bugtraq,24772; reference:bugtraq,34524; reference:cve,2007-3605; reference:cve,2008-4830; classtype:attempted-user; sid:16569; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX NMSA.MediaDescription ActiveX function call access"; flow:established,to_client; file_data; content:"NMSA.MediaDescription"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22NMSA.MediaDescription\x22|\x27NMSA.MediaDescription\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22NMSA.MediaDescription\x22|\x27NMSA.MediaDescription\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; classtype:attempted-user; sid:7015; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime udta atom parsing heap overflow vulnerability"; flow:to_client,established; flowbits:isset,http.quicktime; content:"udta"; content:"|A9|nam|FF|"; distance:0; byte_test:2,>,251,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,22844; reference:cve,2007-0714; classtype:attempted-user; sid:17372; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IDAutomation Linear Bar Code ActiveX clsid access"; flow:established,to_client; file_data; content:"0C3874AA-AB39-4B5E-A768-45F3CE6C6819"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q3>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0C3874AA-AB39-4B5E-A768-45F3CE6C6819\s*}?\s*(?P=q3)(\s|>).*(?P=id1)\s*\.\s*(SaveEnhWMF)|<object\s*[^>]*\s*classid\s*=\s*(?P<q4>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0C3874AA-AB39-4B5E-A768-45F3CE6C6819\s*}?\s*(?P=q4)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(SaveEnhWMF))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,23954; reference:url,moaxb.blogspot.com/2007/05/moaxb-13-id-automation-linear-barcode.html; classtype:attempted-user; sid:11293; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Media Player asf streaming audio spread error correction data length integer overflow attempt"; flow:to_client,established; content:"BFC3CD50-618F-11CF-8BB2-00AA00B4E220"; byte_test:4, >, 65522, 12, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0064; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-068.mspx; classtype:attempted-user; sid:13160; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Basic FlexGrid ActiveX clsid access "; flow:established,to_client; file_data; content:"6262D3A0-531B-11CF-91F6-C2863C385E30"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m5>\x22|\x27|)(?P<id1>.+?)(?P=m5)(\s|>)[^>]*\s*classid\s*=\s*(?P<q27>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6262D3A0-531B-11CF-91F6-C2863C385E30\s*}?\s*(?P=q27)(\s|>).*(?P=id1)\s*\.\s*(FormatString)|<object\s*[^>]*\s*classid\s*=\s*(?P<q28>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6262D3A0-531B-11CF-91F6-C2863C385E30\s*}?\s*(?P=q28)(\s|>)[^>]*\s*id\s*=\s*(?P<m6>\x22|\x27|)(?P<id2>.+?)(?P=m6)(\s|>).*(?P=id2)\s*\.\s*(FormatString))\s*=/siO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4253; reference:url,support.microsoft.com/kb/960715; reference:url,www.microsoft.com/technet/security/bulletin/MS08-070.mspx; classtype:attempted-user; sid:15096; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Repository Method Definition ActiveX object access"; flow:established,to_client; file_data; content:"6E22710B-F799-11CF-9227-00AA00A1EB95"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*6E22710B-F799-11CF-9227-00AA00A1EB95/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4908; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC Media Player SMB module Win32AddConnection buffer overflow attempt"; flow:to_client,established; flowbits:isset, http.m3u.download; content:"smb|3A 2F 2F|"; pcre:"/smb\x3A\x2F\x2F[^\s\x0D\x0A\x3C]{251}/mi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35500; reference:cve,2009-2484; classtype:attempted-user; sid:16751; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION application.cfm access"; flow:to_server,established; content:"/cfdocs/exampleapp/publish/admin/application.cfm"; fast_pattern; http_uri; reference:bugtraq,1021; reference:cve,2000-0189; reference:cve,2001-0535; classtype:attempted-recon; sid:905; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel IMDATA buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|7F 00 54 01 09 00 01 00 00 00 00 00 0C 00 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,21856; reference:cve,2007-0027; classtype:attempted-user; sid:17362; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE form_results access"; flow:to_server,established; content:"/_private/form_results.txt"; fast_pattern; http_uri; reference:cve,1999-1052; classtype:web-application-activity; sid:948; rev:15;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI gozila.cgi access"; flow:to_server,established; content:"/gozila.cgi"; fast_pattern; http_uri; reference:bugtraq,6086; reference:cve,2002-1236; reference:nessus,11773; classtype:web-application-activity; sid:2225; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Sopcast SopCore ActiveX clsid access"; flow:established,to_client; file_data; content:"8FEFF364-6A5F-4966-A917-A3AC28411659"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m5>\x22|\x27|)(?P<id1>.+?)(?P=m5)(\s|>)[^>]*\s*classid\s*=\s*(?P<q11>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8FEFF364-6A5F-4966-A917-A3AC28411659\s*}?\s*(?P=q11)(\s|>).*(?P=id1)\s*\.\s*(SetExternalPlayer)|<object\s*[^>]*\s*classid\s*=\s*(?P<q12>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8FEFF364-6A5F-4966-A917-A3AC28411659\s*}?\s*(?P=q12)(\s|>)[^>]*\s*id\s*=\s*(?P<m6>\x22|\x27|)(?P<id2>.+?)(?P=m6)(\s|>).*(?P=id2)\.(SetExternalPlayer))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,33920; classtype:attempted-user; sid:15376; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AwingSoft Web3D Player ActiveX clsid access"; flow:established,to_client; file_data; content:"17A54E7D-A9D4-11D8-9552-00E04CB09903"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*17A54E7D-A9D4-11D8-9552-00E04CB09903\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SceneURL)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*17A54E7D-A9D4-11D8-9552-00E04CB09903\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(SceneURL))/siO"; metadata:policy security-ips drop; reference:cve,2009-4588; reference:cve,2009-4850; classtype:attempted-user; sid:16767; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SAP AG SAPgui EnjoySAP ActiveX clsid access"; flow:established,to_client; file_data; content:"F6908F83-ADA6-11D0-87AA-00AA00198702"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F6908F83-ADA6-11D0-87AA-00AA00198702\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Accept)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F6908F83-ADA6-11D0-87AA-00AA00198702\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Accept))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,35256; classtype:attempted-user; sid:15557; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Office Web Components 11 Spreadsheet ActiveX function call access "; flow:established,to_client; file_data; content:"OWC11.Spreadsheet"; pcre:"/(?P<c>\w+)\s*=\s*(\x22OWC11\.Spreadsheet(\.\d)?\x22|\x27OWC11\.Spreadsheet(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22OWC11\.Spreadsheet(\.\d)?\x22|\x27OWC11\.Spreadsheet(\.\d)?\x27)\s*\)/smiO"; metadata:policy balanced-ips drop, policy security-ips alert, service http; reference:cve,2009-1136; reference:url,support.microsoft.com/kb/973472; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-043.mspx; classtype:attempted-user; sid:15691; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [8008,8010,8028,8030] (msg:"WEB-MISC Novell eDirectory HTTP request content-length heap buffer overflow attempt"; flow:to_server,established; content:"POST /SOAP"; depth:10; pcre:"/^Content-Length\s*\x3A\s*[1-9][0-9]{8}/mi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2008-4478; classtype:attempted-user; sid:16194; rev:1;)
alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"WEB-MISC TLSv1 Server_Hello request"; flow:to_client,established; flowbits:isset,tlsv1.client_hello.request; content:"|16 03 01|"; depth:3; content:"|02|"; depth:1; offset:5; flowbits:set,tlsv1.server_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:2662; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Vmc2vmx.CoVPCDrive ActiveX function call access"; flow:established,to_client; file_data; content:"Vmc2vmx.CoVPCDrive"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Vmc2vmx\.CoVPCDrive\x22|\x27Vmc2vmx\.CoVPCDrive\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Vmc2vmx\.CoVPCDrive\x22|\x27Vmc2vmx\.CoVPCDrive\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14510; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI pagelog.cgi directory traversal attempt"; flow:to_server,established; content:"/pagelog.cgi"; http_uri; content:"name=../"; fast_pattern:only; reference:bugtraq,1864; reference:cve,2000-0940; reference:nessus,10591; classtype:web-application-activity; sid:1657; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC oracle web application server access"; flow:to_server,established; content:"/ows-bin/"; http_uri; reference:bugtraq,1053; reference:cve,2000-0169; reference:nessus,10348; classtype:web-application-activity; sid:1880; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC changepw.exe access"; flow:to_server,established; content:"/changepw.exe"; http_uri; reference:bugtraq,1256; reference:cve,2000-0401; reference:nessus,11723; classtype:web-application-activity; sid:2240; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 23 ActiveX clsid access"; flow:established,to_client; file_data; content:"B85537E9-2D9C-400A-BC92-B04F4D9FF17D"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q31>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*B85537E9-2D9C-400A-BC92-B04F4D9FF17D\s*}?\s*(?P=q31)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14132; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player JPEG parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|FF D8 FF E0|"; content:"JFIF|00|"; within:5; distance:2; content:"|FF C0|"; distance:0; pcre:"/^.{3}([\x80-\xFF]|.{2}[\x80-\xFF])/sR"; reference:cve,2009-3794; classtype:attempted-user; sid:16331; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE frontpage rad fp4areg.dll access"; flow:to_server,established; content:"/fp4areg.dll"; fast_pattern; http_uri; reference:bugtraq,2906; reference:cve,2001-0341; reference:nessus,10699; classtype:web-application-activity; sid:1249; rev:20;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS outlook web dos"; flow:to_server,established; content:"/exchange/LogonFrm.asp?"; fast_pattern; http_uri; content:"mailbox="; content:"%%%"; reference:bugtraq,3223; classtype:web-application-attack; sid:1283; rev:17;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI phf arbitrary command execution attempt"; flow:to_server,established; content:"/phf"; fast_pattern; http_uri; content:"QALIAS"; content:"%0a"; reference:arachnids,128; reference:bugtraq,629; reference:cve,1999-0067; classtype:web-application-attack; sid:1762; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Symantec Altirix Deployment Solution AeXNSPkgDLLib.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"63716E93-033D-48B0-8A2F-8E8473FD7AC7"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*63716E93-033D-48B0-8A2F-8E8473FD7AC7\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Download|DownloadAndInstall)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*63716E93-033D-48B0-8A2F-8E8473FD7AC7\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Download|DownloadAndInstall))/siO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36346; reference:cve,2009-3028; classtype:attempted-user; sid:17092; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3443 (msg:"WEB-MISC HP Openview NNM connectedNodes.ovpl port 3443 Unix command execution attempt"; flow:to_server,established; content:"/connectedNodes.ovpl"; http_uri; content:"node="; http_uri; pcre:"/connectedNodes.ovpl[^\r\n]*node=[^\r\n]*(\x2c|\x24|\x7c|\x3b|\x22|\x26|\x3c|\x3f)/Usmi"; reference:bugtraq,14662; reference:cve,2005-2773; classtype:web-application-attack; sid:8085; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape Enterprise Server directory view"; flow:to_server,established; content:"?wp-usr-prop"; http_uri; reference:bugtraq,1063; reference:cve,2000-0236; classtype:web-application-attack; sid:1198; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DABbox3.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DABbox3.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DABbox3.1\x22|\x27DirectAnimation.DABbox3.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DABbox3.1\x22|\x27DirectAnimation.DABbox3.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8839; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VhdCvtCom.DiskLibHelper ActiveX clsid access"; flow:established,to_client; file_data; content:"FDE6485C-53E6-4E1F-BBFD-12D92384ECD2"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*FDE6485C-53E6-4E1F-BBFD-12D92384ECD2\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14590; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC InteractiveQuery.jsp access"; flow:to_server,established; content:"/InteractiveQuery.jsp"; http_uri; reference:bugtraq,8938; reference:cve,2003-0624; classtype:web-application-activity; sid:2395; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS as_web4.exe access"; flow:to_server,established; content:"/as_web4.exe"; fast_pattern; http_uri; reference:bugtraq,4670; classtype:web-application-activity; sid:1754; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel DbOrParamQry.fWeb parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|DC 00 0C 00|"; byte_test:1,!&,0x07,0,relative; byte_test:1,&,0x48,0,relative; content:"|CD 00|"; within:2; distance:12; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0264; reference:url,www.microsoft.com/technet/security/bulletin/MS10-017.mspx; classtype:attempted-user; sid:16471; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape Servers suite DOS"; flow:to_server,established; content:"/dsgw/bin/search?context="; http_uri; reference:bugtraq,1868; reference:cve,2000-1025; classtype:web-application-attack; sid:1081; rev:14;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC iPlanet .perf access"; flow:to_server,established; content:"/.perf"; http_uri; reference:nessus,11220; classtype:web-application-activity; sid:2062; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI pfdispaly.cgi access"; flow:to_server,established; content:"/pfdispaly.cgi"; fast_pattern; http_uri; reference:bugtraq,64; reference:cve,1999-0270; reference:nessus,10174; classtype:web-application-activity; sid:1656; rev:14;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC SecureSite authentication bypass attempt"; flow:to_server,established; content:"secure_site, ok"; reference:bugtraq,4621; classtype:web-application-attack; sid:1744; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.SequencerControl ActiveX clsid access"; flow:established,to_client; file_data; content:"B0A6BAE2-AAF0-11D0-A152-00A0C908DB96"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*B0A6BAE2-AAF0-11D0-A152-00A0C908DB96/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8759; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Help Workshop CNT Help contents buffer overflow attempt"; flow:to_client,established; flowbits:isset,MS_Help_content_file; content:"Content-Type: text/plain"; fast_pattern:only; file_data; pcre:"/[^\n]{513}/Rsi"; metadata:policy security-ips drop; reference:bugtraq,22100; reference:cve,2007-0352; classtype:web-application-attack; sid:17365; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC console.exe access"; flow:to_server,established; content:"/cgi-bin/console.exe"; http_uri; reference:bugtraq,3375; reference:cve,2001-1252; classtype:attempted-recon; sid:1302; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 35 ActiveX clsid access"; flow:established,to_client; file_data; content:"3D6A1A85-DE54-4768-9951-053B3B02B9B0"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q57>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3D6A1A85-DE54-4768-9951-053B3B02B9B0\s*}?\s*(?P=q57)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14156; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION snippets attempt"; flow:to_server,established; content:"/cfdocs/snippets/"; fast_pattern; http_uri; reference:bugtraq,550; reference:cve,1999-0760; classtype:attempted-recon; sid:930; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IBM Lotus SameTime STJNILoader Alt CLSID ActiveX function call access"; flow:established,to_client; file_data; content:"JNILOADER.JNILoaderCtrl"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22JNILOADER\.JNILoaderCtrl\x22|\x27JNILOADER\.JNILoaderCtrl\x27)\s*\x3b.*(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)(\s*\.\s*(LoadLibrary)\s*\(|.*\3\s*\.\s*(LoadLibrary)\s*\()|(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22JNILOADER\.JNILoaderCtrl\x22|\x27JNILOADER\.JNILoaderCtrl\x27)\s*\)(\s*\.\s*(LoadLibrary)\s*\(|.*\7\s*\.\s*(LoadLibrary)\s*\()/smi"; metadata:policy security-ips drop; reference:bugtraq,23201; reference:url,www-1.ibm.com/support/docview.wss?uid=swg21257029; reference:url,www.securityfocus.com/archive/1/464185; classtype:attempted-user; sid:10414; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC OpenView Network Node Manager cookie buffer overflow attempt"; flow:to_server,established; content:"/OVCgi/Main/Snmp.exe"; fast_pattern:only; http_uri; pcre:"/(OvJavaScript|OvTitleFrame|OvHelpWindow|OvMap|OvSession|OvJavaLocale|OvOSLocale|OvLogin|OvDebug|OvDeveloper|OvTreeControl|OvJavaScript|OvProduct|OvPort|OvLocale|OvWebSession)\s*\x3D[^\x3B\x2C]{1024}/iC"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,42154; reference:cve,2010-2709; classtype:attempted-user; sid:18905; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS ism.dll attempt"; flow:to_server,established; content:" .htr"; fast_pattern; http_uri; pcre:"/\s{230,}.htr/U"; reference:bugtraq,1193; reference:cve,2000-0457; reference:nessus,10680; reference:url,www.microsoft.com/technet/security/bulletin/MS00-031.mspx; classtype:web-application-attack; sid:1021; rev:23;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox XUL tree element code execution attempt"; flow:to_client,established; content:"selection|2E|timedSelect|28|1|2C|8000|29 3B|"; content:"tree|2E|view|2E|selection|3D|null|3B|"; distance:0; content:"delete|20|tree"; distance:0; content:"delete|20|selection"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34181; reference:cve,2009-1044; classtype:attempted-user; sid:17258; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 9850 (msg:"WEB-CLIENT Novell Groupwise internet agent http uri buffer overflow attempt"; flow:to_server,established; content:"gwia|2E|css"; fast_pattern; content:"|3F|"; distance:0; isdataat:239,relative; content:!"|20| HTTP"; within:239; reference:cve,2011-0334; classtype:attempted-user; sid:20608; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player ASnative command execution attempet"; flow:to_client,established; content:"|00|airappinstaller|00|ASnative|00|"; pcre:"/\x00[\x3b\x7c\x26\x60][^\x00]+\x00airappinstaller\x00ASnative\x00/smi"; content:"|99 08|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32896; reference:cve,2008-5499; classtype:attempted-user; sid:15869; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI test.bat arbitrary command execution attempt"; flow:to_server,established; content:"/test.bat|7C|"; http_uri; reference:bugtraq,762; reference:cve,1999-0947; reference:nessus,10016; classtype:web-application-attack; sid:1510; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX TEC-IT TBarCode ActiveX clsid access"; flow:established,to_client; file_data; content:"D8541765-F6D2-4EE1-AEAA-4016BE1D9859"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D8541765-F6D2-4EE1-AEAA-4016BE1D9859\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SaveImage)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D8541765-F6D2-4EE1-AEAA-4016BE1D9859\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(SaveImage))\s*\(/si"; reference:bugtraq,24440; classtype:attempted-user; sid:11839; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Hummingbird HostExplorer ActiveX clsid access"; flow:established,to_client; file_data; content:"FFB6CC68-702D-4FE2-A8E7-4DE23835F0D2"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*FFB6CC68-702D-4FE2-A8E7-4DE23835F0D2\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,31783; classtype:attempted-user; sid:14744; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1000 (msg:"WEB-MISC ALT-N WebAdmin user param overflow attempt"; flow:to_server,established; content:"POST"; content:"/WebAdmin.dll?"; content:"View=Logon"; distance:0; pcre:"/WebAdmin\x2Edll\x3F[^\r\n]*?View=Logon.*?\r\n\r\n[^\r\n\x26]*User=[^\r\n\x26]{100}/smi"; reference:bugtraq,8024; classtype:attempted-admin; sid:6511; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Oracle iSQLPlus sid overflow attempt"; flow:to_server,established; content:"/isqlplus"; http_uri; pcre:"/sid=[^&\x3b\r\n]{255}/si"; reference:bugtraq,10871; reference:url,www.nextgenss.com/advisories/ora-isqlplus.txt; classtype:web-application-attack; sid:2701; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX BitDefender Online Scanner ActiveX function call access"; flow:established,to_client; file_data; content:"BDSCANONLINE.BDSCANONLINECtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22BDSCANONLINE\.BDSCANONLINECtrl(\.\d)?\x22|\x27BDSCANONLINE\.BDSCANONLINECtrl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*InitX\s*|.*(?P=v)\s*\.\s*InitX\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BDSCANONLINE\.BDSCANONLINECtrl(\.\d)?\x22|\x27BDSCANONLINE\.BDSCANONLINECtrl(\.\d)?\x27)\s*\)(\s*\.\s*InitX\s*|.*(?P=n)\s*\.\s*InitX\s*)\s*\(/smiO"; reference:bugtraq,26210; reference:cve,2007-5775; classtype:attempted-user; sid:12749; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS doctodep.btr access"; flow:to_server,established; content:"doctodep.btr"; http_uri; classtype:web-application-activity; sid:1726; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft GDI WMF file parsing integer overflow attempt"; flow:to_client,established; flowbits:isset, wmf.download; content:"|01 00 09 00|"; pcre:"/(\x40.{20}|\x41.{24})[\xf0-\xff].{8}\x01\x00[\x00\x01\x02\x04\x08\x10\x18\x20]\x00/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-2249; reference:url,www.microsoft.com/technet/security/bulletin/MS08-071.mspx; classtype:attempted-admin; sid:15105; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT HCP URI uplddrvinfo access"; flow:to_client,established; content:"hcp|3A|"; content:"uplddrvinfo.htm?"; distance:0; content:"file|3A|"; distance:0; pcre:"/hcp\x3A[^\r\n]+uplddrvinfo\x2Ehtm\x3F[^\r\n]*file\x3A/smi"; reference:bugtraq,5478; reference:cve,2002-0974; reference:url,www.microsoft.com/technet/security/bulletin/ms02-060.mspx; classtype:misc-activity; sid:8413; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ACM Class Manager ActiveX clsid access"; flow:established,to_client; file_data; content:"33D9A761-90C8-11D0-BD43-00A0C911CE86"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*33D9A761-90C8-11D0-BD43-00A0C911CE86/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:7991; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMClientHost Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmdbCOM.VMClientHost"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmdbCOM\.VMClientHost\x22|\x27vmdbCOM\.VMClientHost\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmdbCOM\.VMClientHost\x22|\x27vmdbCOM\.VMClientHost\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14438; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML DOM invalid DHTML comment creation attempt"; flow:to_client,established; file_data; content:"window.open"; fast_pattern:only; content:"createComment"; pcre:"/(\w+)\s*=\s*\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)\s*\;.*?\w+\.(insertBefore|insertAfter|appendChild)\(\1\)\;|window.open\(\)\.\w\.(insertBefore|insertAfter|appendChild)\(\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:policy security-ips drop; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:20277; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WM Color Converter Filter ActiveX clsid access"; flow:established,to_client; file_data; content:"CC45B0B0-72D8-4652-AE5F-5E3E266BE7ED"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*CC45B0B0-72D8-4652-AE5F-5E3E266BE7ED/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7452; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ACD Systems ACDSee Products XBM file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.xbm; file_data; content:"|23|define"; content:"|5F|width"; distance:0; pcre:"/\x23define\s*(?=[\S]{57})\S*\x5Fwidth/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37685; reference:url,osvdb.org/show/osvdb/63643; classtype:attempted-user; sid:17238; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS site/iisamples access"; flow:to_server,established; content:"/site/iisamples"; fast_pattern; http_uri; reference:nessus,10370; classtype:web-application-activity; sid:1046; rev:16;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP Intelligent Management Center database credentials information disclosure attempt - 2"; flow:to_server,established; content:"/rpt/reportscript/sqlserver/deploypara.properties"; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40298; reference:url,secunia.com/advisories/39891; classtype:attempted-user; sid:17158; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IntraProcessLogging.Logger ActiveX function call access"; flow:established,to_client; file_data; content:"IntraProcessLogging.Logger"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22IntraProcessLogging\.Logger\x22|\x27IntraProcessLogging\.Logger\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22IntraProcessLogging\.Logger\x22|\x27IntraProcessLogging\.Logger\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14284; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Office Services on the Web Free/Busy ActiveX object access"; flow:established,to_client; file_data; content:"F28D867A-DDB1-11D3-B8E8-00A0C981AEEB"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*F28D867A-DDB1-11D3-B8E8-00A0C981AEEB/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4217; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office GIF image descriptor memory corruption attempt"; flow:to_client,established; file_data; content:"GIF8"; within:4; content:"a"; within:1; distance:1; byte_test:1,&,0x80,4,relative; pcre:"/^(.{13}|.{19}|.{31}|.{55}|.{103}|.{199}|.{391}|.{775})\x2C.{5}([\xE0-\xFF]|.{2}[\xE0-\xFF])/sR"; reference:bugtraq,18915; reference:bugtraq,22630; reference:cve,2006-0007; reference:cve,2007-1071; reference:url,www.microsoft.com/technet/security/bulletin/ms06-039.mspx; classtype:attempted-user; sid:8414; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX FlexLabel ActiveX function call access"; flow:established,to_client; file_data; content:"FlexLabelControl.FlexLabel"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22FlexLabelControl\.FlexLabel\x22|\x27FlexLabelControl\.FlexLabel\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22FlexLabelControl\.FlexLabel\x22|\x27FlexLabelControl\.FlexLabel\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:url,www.securityfocus.com/archive/1/468070; classtype:attempted-user; sid:11282; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ShockwaveFlash.ShockwaveFlash ActiveX function call access"; flow:established,to_client; file_data; content:"ShockwaveFlash.ShockwaveFlash"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ShockwaveFlash\.ShockwaveFlash(\.\d)?\x22|\x27ShockwaveFlash\.ShockwaveFlash(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*CreateObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*LoadMovie\s*|.*(?P=v)\s*\.\s*LoadMovie\s*)|(?P<n>\w+)\s*=\s*CreateObject\s*\(\s*(\x22ShockwaveFlash\.ShockwaveFlash(\.\d)?\x22|\x27ShockwaveFlash\.ShockwaveFlash(\.\d)?\x27)\s*\)(\s*\.\s*LoadMovie\s*|.*(?P=n)\s*\.\s*LoadMovie\s*)/siO"; reference:url,www.securitytracker.com/id/1009674; classtype:attempted-user; sid:19610; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player malformed getPropertyLate actioncode attempt"; flow:to_client,established; flowbits:isset,http.swf; content:",|BD 06|J|C6 01 01 80 C6 01 D6 D1 D2|O|97 06 01 D1|`|81 04|g|9D 08|f|9E 08|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3797; classtype:attempted-user; sid:16316; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS webhits access"; flow:to_server,established; content:".htw"; http_uri; reference:arachnids,237; reference:bugtraq,950; reference:cve,2000-0097; classtype:web-application-activity; sid:1044; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Outlook arbitrary command line attempt"; flow:to_client,established; content:"mailto|3A|"; pcre:"/<[^>]+mailto\x3a[^>]*\?[^>]*(\x22|%22)(\x2c|%2c)/smi"; reference:cve,2008-0110; reference:url,www.microsoft.com/technet/security/bulletin/MS08-015.mspx; classtype:misc-attack; sid:13573; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed Graphic Code Execution"; flow:to_client,established; flowbits:isset,http.xls; content:"|00 0D 10 38 00 00 00 18 01 61 00 61 00 61 00|"; pcre:"/(\x51\x10..\x01(\x02|\x00)|\x01(\x02|\x00)..\x51\x10)/smi"; metadata:policy security-ips drop; reference:bugtraq,16181; reference:cve,2006-0030; classtype:attempted-user; sid:17511; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LexRefStEsObject Class ActiveX object access"; flow:established,to_client; file_data; content:"4CFB5280-800B-4367-848F-5A13EBF27F1D"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*4CFB5280-800B-4367-848F-5A13EBF27F1D/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4208; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft WMI Administrator Tools Object Viewer ActiveX function call access"; flow:established,to_client; file_data; content:"AddContextRef"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22AddContextRef(\.\d)?\x22|\x27AddContextRef(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22AddContextRef(\.\d)?\x22|\x27AddContextRef(\.\d)?\x27)\s*\)/smiO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3973; reference:cve,2010-4588; reference:url,secunia.com/advisories/42693/; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-027.mspx; classtype:attempted-user; sid:18242; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS anot.htr access"; flow:to_server,established; content:"/iisadmpwd/anot"; fast_pattern; http_uri; reference:bugtraq,2110; reference:cve,1999-0407; classtype:web-application-activity; sid:996; rev:16;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI test.bat access"; flow:to_server,established; content:"/test.bat"; http_uri; reference:bugtraq,762; reference:cve,1999-0947; reference:nessus,10016; classtype:web-application-activity; sid:1511; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Shell.Explorer 2 ActiveX function call access "; flow:established,to_client; file_data; content:"Shell.Explorer"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Shell\.Explorer(\.\d)?\x22|\x27Shell\.Explorer(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(Navigate|Navigate2)\s*|.*(?P=v)\s*\.\s*(Navigate|Navigate2)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Shell\.Explorer(\.\d)?\x22|\x27Shell\.Explorer(\.\d)?\x27)\s*\)(\s*\.\s*(Navigate|Navigate2)\s*|.*(?P=n)\s*\.\s*(Navigate|Navigate2)\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,11466; reference:cve,2005-0053; reference:cve,2008-4258; reference:url,www.microsoft.com/technet/security/Bulletin/MS05-014.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS04-038.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS08-073.mspx; classtype:attempted-user; sid:15112; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX NCTsoft NCTAudioFile2 NCTWMAFile ActiveX function call access"; flow:established,to_client; file_data; content:"NCTWMAFile2.WMAFile2"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22NCTWMAFile2\.WMAFile2\x22|\x27NCTWMAFile2\.WMAFile2\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*CreateFile\s*|.*(?P=v)\s*\.\s*CreateFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22NCTWMAFile2\.WMAFile2\x22|\x27NCTWMAFile2\.WMAFile2\x27)\s*\)(\s*\.\s*CreateFile\s*|.*(?P=n)\s*\.\s*CreateFile\s*)\s*\(/smi"; reference:bugtraq,24613; reference:url,nctsoft.com/products/NCTAudioEditor2/; classtype:attempted-user; sid:12021; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SonicWall Aventail EPInstaller ActiveX clsid access"; flow:established,to_client; file_data; content:"5EDB10D9-7E95-4833-A218-62F375DAFCF1"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5EDB10D9-7E95-4833-A218-62F375DAFCF1\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(InstallComponentMsi|Install3rdPartyComponent|InstallComponentVer|InstallComponent)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5EDB10D9-7E95-4833-A218-62F375DAFCF1\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(InstallComponentMsi|Install3rdPartyComponent|InstallComponentVer|InstallComponent))/siO"; metadata:policy security-ips drop; reference:bugtraq,44535; reference:cve,2010-2583; classtype:attempted-user; sid:18323; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 49 ActiveX clsid access"; flow:established,to_client; file_data; content:"7A12547F-B772-4F2D-BE36-CE5D0FA886A1"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q87>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7A12547F-B772-4F2D-BE36-CE5D0FA886A1\s*}?\s*(?P=q87)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14184; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Music JukeBox MediaGrid ActiveX clsid access"; flow:established,to_client; file_data; content:"22FD7C0A-850C-4A53-9821-0B0915C96139"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*22FD7C0A-850C-4A53-9821-0B0915C96139\s*}?\s*(?P=q6)(\s|>).*(?P=id1)\s*\.\s*(AddBitmap)|<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*22FD7C0A-850C-4A53-9821-0B0915C96139\s*}?\s*(?P=q7)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\.(AddBitmap))\s*\(/Osi"; metadata:policy security-ips alert; reference:bugtraq,27578; classtype:attempted-user; sid:13430; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC globals.jsa access"; flow:to_server,established; content:"/globals.jsa"; http_uri; reference:bugtraq,4034; reference:cve,2002-0562; reference:nessus,10850; classtype:web-application-activity; sid:1873; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Messenger CYFT ActiveX clsid access"; flow:established,to_client; file_data; content:"24F3EAD6-8B87-4C1A-97DA-71C126BDA08F"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*24F3EAD6-8B87-4C1A-97DA-71C126BDA08F\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(GetFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*24F3EAD6-8B87-4C1A-97DA-71C126BDA08F\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(GetFile))\s*\(/si"; reference:bugtraq,25727; reference:cve,2007-5017; classtype:attempted-user; sid:12476; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Bitmap ActiveX clsid access"; flow:established,to_client; file_data; content:"4F3E50BD-A9D7-4721-B0E1-00CB42A0A747"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*4F3E50BD-A9D7-4721-B0E1-00CB42A0A747/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7429; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX YMMAPI.YMailAttach ActiveX clsid access"; flow:established,to_client; file_data; content:"AA218328-0EA8-4D70-8972-E987A9190FF4"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*id\s*=((\x22|\x27)([^\2]*)\2)\s*classid\s*=\s*(\x22|\x27|)clsid\s*\x3a\s*{?\s*AA218328-0EA8-4D70-8972-E987A9190FF4\s*}?\4.*\3\.(TextETACalculating)\(|<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*AA218328-0EA8-4D70-8972-E987A9190FF4\s*}?\s*\6\s*id\s*=\s*((\x22|\x27)([^\8]*)\8).*\9\.(TextETACalculating)\(/si"; metadata:policy security-ips drop; reference:bugtraq,21607; reference:cve,2006-6603; reference:url,messenger.yahoo.com/security_update.php?id=120806; classtype:attempted-user; sid:9793; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC nessus 1.X 404 probe"; flow:to_server,established; content:"/nessus_is_probing_you_"; depth:32; http_uri; reference:arachnids,301; classtype:web-application-attack; sid:1102; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime pict image poly structure memory corruption attempt"; flow:to_client,established; content:"|00 11 02 FF 0C 00|"; pcre:"/\x00[\x70-\x74]\x00[\x00-\x09]/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26345; reference:bugtraq,34938; reference:cve,2007-4676; reference:cve,2009-0010; classtype:attempted-user; sid:15384; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VisualExec Control ActiveX clsid access"; flow:established,to_client; file_data; content:"99EA8527-6A6A-40FE-A67C-82CF763902D0"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*99EA8527-6A6A-40FE-A67C-82CF763902D0/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:8407; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF single packet heap overflow - NETSCAPE2.0"; flow:to_client,established; content:"image/"; http_header; pcre:"/^Content-Type\s*\x3a(\s*|\s*\r?\n\s+)image\x2fgif/smiH"; content:"GIF"; content:"!|FF 0B|NETSCAPE2.0"; distance:0; content:"|02|"; within:1; distance:1; byte_test:4,>,0x7f,3,relative; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:3534; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer covered object memory corruption attempt"; flow:to_client,established; content:".body.innerHTML +="; content:"function |28 29| |7B|"; within:50; content:!"|7D|"; within:200; reference:cve,2011-1256; reference:url,www.microsoft.com/technet/security/bulletin/ms11-050.mspx; classtype:attempted-user; sid:19808; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word XP PLFLSInTableStream heap overflow attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|5C FE 00 01 02 5C FE 00 01 02 5C FE 00 01 02 5C FE 00 01 02 51 4A|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3220; reference:url,www.microsoft.com/technet/security/bulletin/MS10-079.mspx; classtype:attempted-user; sid:17756; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Certification service XSS attempt"; flow:to_server,established; content:"certfnsh|2E|asp"; http_uri; content:"TargetStoreFlagsObserve"; http_client_body; pcre:"/^=[^\s\x26]*[\x3C\x3E\x22\x27\x28\x29]/R"; reference:cve,2011-1264; reference:url,www.microsoft.com/technet/security/bulletin/MS11-051.mspx; classtype:attempted-user; sid:19186; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS jet vba access"; flow:to_server,established; content:"/advworks/equipment/catalog_type.asp"; fast_pattern; http_uri; reference:bugtraq,286; reference:cve,1999-0874; reference:url,www.microsoft.com/technet/security/bulletin/ms99-030.mspx; classtype:web-application-activity; sid:1022; rev:17;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Invision Power Board search.pl access"; flow:to_server,established; content:"/search.pl"; http_uri; content:"st="; reference:bugtraq,9766; classtype:web-application-activity; sid:2408; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC .bash_history access"; flow:to_server,established; content:"/.bash_history"; http_uri; reference:bugtraq,337; reference:cve,1999-0408; classtype:web-application-attack; sid:1434; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT xpdf ObjectStream integer overflow"; flow:to_client,established; content:"Type/ObjStm"; pcre:"/Type\x2FObjStm[^>]*?\x2FN\s+\d{7}/smi"; metadata:policy security-ips drop; reference:bugtraq,36703; reference:bugtraq,37167; reference:cve,2009-3608; classtype:attempted-user; sid:16335; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC CISCO VoIP Portinformation access"; flow:to_server,established; content:"/PortInformation"; http_uri; reference:bugtraq,4798; reference:cve,2002-0882; classtype:web-application-activity; sid:3467; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CStyleSheetRule array memory corruption attempt"; flow:to_client,established; content:"document.styleSheets"; fast_pattern; content:"removeRule"; within:200; metadata:policy security-ips drop; reference:bugtraq,43705; reference:cve,2010-3328; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:19436; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT GStreamer QuickTime file parsing multiple heap overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"stss"; content:"|00 00 00 00 00 00 00 03 00 00 00 01 00 FF FF FF|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33405; reference:cve,2009-0398; classtype:attempted-user; sid:17611; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI awstats.pl configdir command execution attempt"; flow:to_server,established; content:"/awstats.pl?"; fast_pattern; http_uri; content:"configdir="; http_uri; pcre:"/awstats.pl?[^\r\n]*configdir=\x7C/Ui"; reference:bugtraq,12298; reference:cve,2005-0116; reference:nessus,16189; classtype:attempted-user; sid:3813; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape PublishingXpert access"; flow:to_server,established; content:"/PSUser/PSCOErrPage.htm"; http_uri; reference:cve,2000-1196; reference:nessus,10364; classtype:web-application-activity; sid:1157; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RemoteBrowseDlg Class ActiveX clsid access"; flow:established,to_client; file_data; content:"6b681417-abe9-46ca-9615-8b96ec724d0c"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6b681417-abe9-46ca-9615-8b96ec724d0c\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14402; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS viewcode access"; flow:to_server,established; content:"/Sites/Knowledge/Membership/Inspiredtutorial/ViewCode.asp"; fast_pattern; http_uri; reference:cve,1999-0737; reference:nessus,10576; reference:url,www.microsoft.com/technet/security/bulletin/ms99-013.mspx; classtype:web-application-activity; sid:1033; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows DirectShow QuickTime file stsc atom parsing heap corruption attempt"; flow:to_client,established; content:"stbl"; content:"stsd"; within:4; distance:4; content:"ima4"; distance:8; content:"stsc"; distance:0; byte_jump:4,4,relative,multiplier 12,big; isdataat:7,relative; content:!"stsz"; within:4; distance:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1538; reference:url,www.microsoft.com/technet/security/bulletin/MS09-028.mspx; classtype:attempted-user; sid:15682; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS iisadmin access"; flow:to_server,established; content:"/iisadmin"; fast_pattern; http_uri; reference:bugtraq,189; reference:cve,1999-1538; reference:nessus,11032; classtype:web-application-attack; sid:993; rev:18;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat/Reader JpxDecode invalid crgn memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"jp2c|FF 4F|"; content:"|FF 5E 00|"; distance:0; pcre:"/\xff\x5e\x00(\x05[\x80-\xff]|\x06\x00[\x80-\xff]|\x06[^\x00])/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37757; reference:cve,2009-3955; classtype:attempted-user; sid:18801; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel object record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|5D 00|"; byte_test:2,>,8224,0,relative,little; content:"|15 00 12 00|"; within:4; distance:2; metadata:policy security-ips drop; reference:bugtraq,18886; reference:cve,2006-1306; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7048; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape Enterprise Server directory view"; flow:to_server,established; content:"?wp-uncheckout"; http_uri; reference:bugtraq,1063; reference:cve,2000-0236; classtype:attempted-recon; sid:1190; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime Movie link file URI security bypass attempt"; flow:to_client,established; content:"<?xml version"; content:"<?quicktime type=|22|application/x-quicktime-media-link"; distance:0; content:"qtnext=|22|"; distance:0; pcre:"/qtnext=\x22((-e\s+|-chrome\s+)?(file|javascript))/smi"; metadata:policy security-ips drop; reference:bugtraq,20138; reference:cve,2006-4965; classtype:attempted-user; sid:9430; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Windows Media Services DRM Storage ActiveX clsid access"; flow:established,to_client; file_data; content:"760C4B83-E211-11D2-BF3E-00805FBE84A6"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*760C4B83-E211-11D2-BF3E-00805FBE84A6/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:8401; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime FlashPix Movie file integer overflow attempt"; flow:to_client,established; content:"|00 01 00 54 C1 CE 11 85 53 00 AA 00 A1 F9 5B 01 00 00 00|"; byte_test:4,>,0x0FFFFFFF,12,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39020; reference:cve,2010-0519; classtype:attempted-user; sid:18510; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-MISC potential malware - download of svchost.exe"; flow:established,to_server; content:"/svchost.exe"; http_uri; metadata:policy security-ips drop; classtype:suspicious-filename-detect; sid:17811; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Possible generic javascript heap spray attempt"; flow:to_client,established; content:"%u9090%u9090"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,35660; classtype:attempted-user; sid:18167; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sophos Anti-Virus CAB file overflow attempt"; flow:to_client,established; file_data; content:"MSCF"; byte_test:2,>,8192,22,little,relative; metadata:policy security-ips drop; reference:bugtraq,17876; reference:cve,2006-0994; classtype:attempted-admin; sid:6504; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer MDAC remote code execution attempt"; flow:to_client,established; file_data; content:"eval|28 22|r|3D|o|22|"; content:"ect|28|n|2C 27 27 29|"; distance:0; pcre:"/bj\x22[\x0D\x0A\s\t]*\x2b[\x0D\x0A\s\t]*\x22ect\x28n\x2C\x27\x27\x29/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-014; classtype:attempted-user; sid:19872; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS sgdynamo.exe access"; flow:to_server,established; content:"/sgdynamo.exe"; fast_pattern; http_uri; reference:bugtraq,4720; reference:cve,2002-0375; reference:nessus,11955; classtype:web-application-activity; sid:2326; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel out-of-bounds structure read memory corruption attempt"; flow:to_client,established; content:"|C6 00 1A 00 02 00 00 00 01 00 21 00 AA 0A 03 00 00 00 02 00|"; reference:cve,2010-2562; reference:url,www.microsoft.com/technet/security/bulletin/ms10-057.mspx; classtype:attempted-user; sid:17134; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel sheet name memory corruption attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"Sheet1"; content:"|8C 00 04 00 56 00 56 00 C1 01 08 00 C1 01 00 00 80 38 01 00|"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24691; reference:cve,2007-3490; classtype:attempted-user; sid:17227; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 38 ActiveX clsid access"; flow:established,to_client; file_data; content:"C5702CCE-9B79-11D3-B654-00C04F79498E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q63>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C5702CCE-9B79-11D3-B654-00C04F79498E\s*}?\s*(?P=q63)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15650; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari invalid FRAME tag remote code execution attempt"; flow:to_client,established; file_data; content:"<frame"; content:"scrolling"; within:100; isdataat:10,relative; content:!"auto"; within:10; content:!"yes"; within:10; content:!"no"; within:10; pcre:"/\x3Cframe([^\x3E]+scrolling\s*\x3D(?!\s*(\x22|\x27)?\s*(yes|no|auto))){2}/i"; reference:bugtraq,17634; reference:cve,2006-1987; classtype:attempted-user; sid:17217; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Webcam Upload ActiveX clsid access"; flow:established,to_client; content:"DCE2F8B1-A520-11D4-8FD0-00D0B7730277"; fast_pattern:only; file_data; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DCE2F8B1-A520-11D4-8FD0-00D0B7730277\s*}?\s*(?P=q6)(\s|>).*(?P=id1)\s*\.\s*(server)|<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DCE2F8B1-A520-11D4-8FD0-00D0B7730277\s*}?\s*(?P=q7)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\s*\.\s*(server))\s*=/siO"; metadata:policy security-ips drop; reference:bugtraq,24341; reference:cve,2007-3147; classtype:attempted-user; sid:11822; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave Flash memory corruption attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"|FF FF FF FF 01 1F 02|H|00 00 00|6|00 00 FF FF 01 1F 1F EE|"; content:!"|FF FF FF FF|"; within:4; distance:-24; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3463; classtype:attempted-user; sid:16293; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.Sequence ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.Sequence"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.Sequence\x22|\x27DirectAnimation.Sequence\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.Sequence\x22|\x27DirectAnimation.Sequence\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8764; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC intranet access"; flow:to_server,established; content:"/intranet/"; http_uri; reference:nessus,11626; classtype:attempted-recon; sid:1214; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Trident HTMLEditor ActiveX object access"; flow:established,to_client; file_data; content:"3050F4F5-98B5-11CF-BB82-00AA00BDCE0B"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*3050F4F5-98B5-11CF-BB82-00AA00BDCE0B/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4893; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI enter_bug.cgi access"; flow:to_server,established; content:"/enter_bug.cgi"; fast_pattern; http_uri; reference:bugtraq,3272; reference:cve,2002-0008; classtype:web-application-activity; sid:2055; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MSN Setup BBS 4.71.0.10 ActiveX object access"; flow:established,to_client; file_data; content:"8F0F5093-0A70-11D0-BCA9-00C04FD85AA6"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*8F0F5093-0A70-11D0-BCA9-00C04FD85AA6/si"; metadata:policy security-ips drop; reference:bugtraq,668; reference:cve,1999-1484; classtype:attempted-user; sid:4157; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MTSEvents Class ActiveX object access"; flow:established,to_client; file_data; content:"ECABB0AB-7F19-11D2-978E-0000F8757E2A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*ECABB0AB-7F19-11D2-978E-0000F8757E2A/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4892; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CLSID_ApprenticeICW ActiveX clsid access"; flow:established,to_client; file_data; content:"8EE42293-C315-11D0-8D6F-00A0C9A06E1F"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*8EE42293-C315-11D0-8D6F-00A0C9A06E1F/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:7997; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes playlist URL overflow attempt"; flow:to_client,established; file_data; content:"[playlist]"; pcre:"/^File[0-9]+=http\x3a\x2f\x2f[^\n]{150}/Rsmi"; metadata:policy security-ips drop; reference:bugtraq,12238; reference:cve,2005-0043; classtype:attempted-user; sid:3471; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI awstats access"; flow:to_server,established; content:"/awstats.pl"; fast_pattern; http_uri; reference:bugtraq,12572; reference:nessus,16456; classtype:web-application-activity; sid:3463; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ffdshow codec URL parsing buffer overflow attempt"; flow:to_client,established; content:"6BF52A52-394A-11d3-B153-00C04F79FAA6"; fast_pattern:only; content:"<param "; content:"URL"; distance:0; pcre:"/<param\s+name\s*=\s*(?P<q1>\x22|\x27|)URL(?P=q1)[^>]+?value\s*=\s*(\x22|\x27)[^\x22\x27]{500}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32438; reference:cve,2008-5381; classtype:attempted-user; sid:17573; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft XML core services cross-domain information disclosure attempt"; flow:to_client,established; file_data; content:"XMLHttpRequest"; pcre:"/setRequestHeader.*chunked/smiR"; content:"send"; distance:0; content:"0|5C|r|5C|n|5C|r|5C|n"; distance:0; metadata:policy security-ips drop; reference:cve,2008-4033; reference:url,www.microsoft.com/technet/security/bulletin/MS08-069.mspx; classtype:attempted-recon; sid:19818; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Cisco Catalyst command execution attempt"; flow:to_server,established; content:"/exec/show/config/cr"; http_uri; reference:bugtraq,1846; reference:cve,2000-0945; reference:nessus,10545; classtype:web-application-activity; sid:1544; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Content.mbcontent.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"52CA3BCF-3B9B-419E-A3D6-5D28C0B0B50C"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*52CA3BCF-3B9B-419E-A3D6-5D28C0B0B50C/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8003; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION CFADMIN_REGISTRY_GET access"; flow:to_server,established; content:"CFADMIN_REGISTRY_GET|28 29|"; fast_pattern:only; reference:bugtraq,550; reference:cve,1999-0760; classtype:attempted-user; sid:8488; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF multipacket heap overflow - ANIMEXTS1.0"; flow:to_client,established; flowbits:isset,file.gif; content:"GIF"; content:"!|FF 0B|ANIMEXTS1.0"; distance:0; content:"|02|"; within:1; distance:1; byte_test:4,>,0x7f,3,relative; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:6503; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Music JukeBox MediaGrid ActiveX function call access"; flow:established,to_client; file_data; content:"YMG.YMGMediaGridAx"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22YMG\.YMGMediaGridAx\x22|\x27YMG\.YMGMediaGridAx\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*AddBitmap\s*|.*(?P=v)\s*\.\s*AddBitmap\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22YMG\.YMGMediaGridAx\x22|\x27YMG\.YMGMediaGridAx\x27)\s*\)(\s*\.\s*AddBitmap\s*|.*(?P=n)\s*\.\s*AddBitmap\s*)\s*\(/Osmi"; metadata:policy security-ips alert; reference:bugtraq,27578; classtype:attempted-user; sid:13432; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; content:"<"; content:"onmouseup"; within:22; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^(\n|\s|>)]|\(|\))*\s*){21}/Rmi"; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17514; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MS Access multiple control instantiation memory corruption attempt "; flow:established,to_client; file_data; content:"4D2F086C-6EA3-101B-A18A-00AA00446E07"; content:"53230327-172B-11D0-AD40-00A0C90DC8D9"; distance:0; content:"6BC0989F-0CE6-11D1-BAAE-00C04FC2E20D"; distance:0; metadata:policy security-ips drop; reference:cve,2010-0814; reference:url,www.microsoft.com/technet/security/bulletin/MS10-044.mspx; classtype:attempted-user; sid:17037; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected tRNS overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"tRNS"; byte_test:4,>,3000,-8,relative; reference:bugtraq,13941; reference:bugtraq,18385; reference:cve,2005-1211; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6695; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Exploerer blnmgr clsid attempt"; flow:to_client,established; content:"3F8A6C33-E0FD-11D0-8A8C-00A0C90C2BC5"; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*3F8A6C33-E0FD-11D0-8A8C-00A0C90C2BC5/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-user; sid:4134; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft creator.dll 1 ActiveX clsid access"; flow:established,to_client; file_data; content:"606EF130-9852-11D3-97C6-0060084856D4"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,19636; reference:cve,2006-4495; reference:url,www.xsec.org/index.php?module=Releases&act=view&type=1&id=16; classtype:attempted-user; sid:17594; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Folder GUID Code Execution attempt"; flow:to_client,established; content:".|7B|3050F4D8-98B5-11CF-BB82-00AA00BDCE0B|7D|"; fast_pattern:only; pcre:"/\x252e\x252e\x255c[^\s\x2e]*?\x2e\x7B3050F4D8-98B5-11CF-BB82-00AA00BDCE0B\x7d/smi"; metadata:policy security-ips drop; reference:bugtraq,19389; reference:cve,2006-3281; classtype:attempted-user; sid:17316; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX iseemedia LPViewer ActiveX function call access"; flow:established,to_client; file_data; content:"LPViewer.LPViewer"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22LPViewer\.LPViewer\x22|\x27LPViewer\.LPViewer\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(url|toolbar|enableZoomPastMax)\s*|.*(?P=v)\s*\.\s*(url|toolbar|enableZoomPastMax)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22LPViewer\.LPViewer\x22|\x27LPViewer\.LPViewer\x27)\s*\)(\s*\.\s*(url|toolbar|enableZoomPastMax)\s*|.*(?P=n)\s*\.\s*(url|toolbar|enableZoomPastMax))\s*=/Osmi"; metadata:policy security-ips drop; reference:bugtraq,31604; reference:cve,2008-4384; classtype:attempted-user; sid:14762; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Visio Malformed IconBitsComponent arbitrary code execution attempt"; flow:to_client,established; flowbits:isset,visio.request; content:"|00 00| |00| |FF 00 00 14 01 00 00 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0095; reference:url,www.microsoft.com/technet/security/bulletin/ms09-005.mspx; classtype:attempted-user; sid:15303; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS achg.htr access"; flow:to_server,established; content:"/iisadmpwd/achg.htr"; fast_pattern; http_uri; reference:bugtraq,2110; reference:cve,1999-0407; classtype:web-application-activity; sid:991; rev:16;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 749 (msg:"WEB-MISC MIT Kerberos V% KAdminD klog_vsyslog server overflow attempt"; flow:to_server,established; content:"|90|D|FA A0 B1|^C|07|m'|1C|m|08 02 D0 C7 C0|q|EE|q|E3|R|B3 1C|}K|DE D2 C1 F8 5C|{"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,23285; reference:cve,2007-0957; classtype:attempted-user; sid:16207; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows metafile SetPaletteEntries heap overflow attempt"; flow:to_client,established; flowbits:isset,wmf.download; content:"|00 09 00|"; content:"|FF FF FF|"; distance:12; content:"|00|"; within:1; distance:2; pcre:"/[\x00\x01]\x00\x09\x00.*?\xff\xff\xff[\xff\xf7][\x36\x37]\x00/smi"; reference:bugtraq,15356; reference:cve,2005-2124; reference:url,www.microsoft.com/technet/security/bulletin/ms05-053.mspx; classtype:attempted-user; sid:13807; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CurrentVMCtl Class ActiveX clsid access"; flow:established,to_client; file_data; content:"fd99f74c-9d06-415e-8c60-a249d16f1d77"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*fd99f74c-9d06-415e-8c60-a249d16f1d77\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14586; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC client negative Content-Length attempt"; flow:to_server,established; content:"Content-Length|3A|"; byte_test:10,>,0x7FFFFFFF,1,relative,string,dec; metadata:policy security-ips drop; reference:bugtraq,16354; reference:bugtraq,17879; reference:bugtraq,9098; reference:bugtraq,9476; reference:bugtraq,9576; reference:cve,2004-0095; reference:cve,2005-3653; reference:cve,2006-2162; classtype:misc-attack; sid:2278; rev:21;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SuperBuddy Class ActiveX clsid access"; flow:established,to_client; file_data; content:"189504B8-50D1-4AA8-B4D6-95C8F58A6414"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*189504B8-50D1-4AA8-B4D6-95C8F58A6414/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:7983; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI store.cgi access"; flow:to_server,established; content:"/store.cgi"; fast_pattern; http_uri; reference:bugtraq,2385; reference:cve,2001-0305; reference:nessus,10639; classtype:web-application-activity; sid:1307; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Vmc2vmx.CoVPCDrive ActiveX clsid access"; flow:established,to_client; file_data; content:"D9902D56-1F2A-47D6-89AA-08F49A40AE8C"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D9902D56-1F2A-47D6-89AA-08F49A40AE8C\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14508; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Shell.Explorer 2 ActiveX clsid access "; flow:established,to_client; file_data; content:"8856F961-340A-11D0-A96B-00C04FD705A2"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8856F961-340A-11D0-A96B-00C04FD705A2\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Navigate|Navigate2)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8856F961-340A-11D0-A96B-00C04FD705A2\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Navigate|Navigate2))/siO"; metadata:policy security-ips drop; reference:bugtraq,11466; reference:cve,2005-0053; reference:cve,2008-4258; reference:url,www.microsoft.com/technet/security/Bulletin/MS05-014.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS04-038.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS08-073.mspx; classtype:attempted-user; sid:15122; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbTreeCtl Class ActiveX clsid access"; flow:established,to_client; file_data; content:"e669547d-ae52-459f-9c07-cc5f17b4b16f"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*e669547d-ae52-459f-9c07-cc5f17b4b16f\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14544; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI quickstore.cgi access"; flow:to_server,established; content:"/quickstore.cgi"; fast_pattern; http_uri; reference:bugtraq,9282; reference:nessus,11975; classtype:web-application-activity; sid:2323; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Kodak Image Editing ActiveX object access"; flow:established,to_client; file_data; content:"6D940285-9F11-11CE-83FD-02608C3EC08A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*6D940285-9F11-11CE-83FD-02608C3EC08A/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/bulletin/MS99-037.mspx; classtype:attempted-user; sid:4186; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE services.cnf access"; flow:to_server,established; content:"/_vti_pvt/services.cnf"; fast_pattern; http_uri; reference:bugtraq,4078; reference:cve,2002-1717; reference:nessus,10575; classtype:web-application-activity; sid:961; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IBM Access Support ActiveX function call access"; flow:established,to_client; file_data; content:"IbmEgath.IbmEgathCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22IbmEgath\.IbmEgathCtl(\.\d)?\x22|\x27IbmEgath\.IbmEgathCtl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*GetXMLValue\s*|.*(?P=v)\s*\.\s*GetXMLValue\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22IbmEgath\.IbmEgathCtl(\.\d)?\x22|\x27IbmEgath\.IbmEgathCtl(\.\d)?\x27)\s*\)(\s*\.\s*GetXMLValue\s*|.*(?P=n)\s*\.\s*GetXMLValue\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,34228; reference:cve,2009-0215; classtype:attempted-user; sid:16748; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Skype Extras Manager ActiveX function call access"; flow:established,to_client; file_data; content:"ezPMUtils.WindowGroup"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ezPMUtils\.WindowGroup(\.\d)?\x22|\x27ezPMUtils\.WindowGroup(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*RegisterWindow\s*|.*(?P=v)\s*\.\s*RegisterWindow\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ezPMUtils\.WindowGroup(\.\d)?\x22|\x27ezPMUtils\.WindowGroup(\.\d)?\x27)\s*\)(\s*\.\s*RegisterWindow\s*|.*(?P=n)\s*\.\s*RegisterWindow)\s*=/smiO"; metadata:policy security-ips drop; reference:bugtraq,36459; reference:cve,2009-4741; classtype:attempted-user; sid:17676; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI AlienForm af.cgi access"; flow:established,to_server; content:"/af.cgi"; http_uri; reference:bugtraq,4983; reference:cve,2002-0934; reference:nessus,11027; classtype:web-application-activity; sid:1825; rev:10;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Microsoft Windows CSRSS double free attempt"; flow:to_client,established; content:"|4A 10 33 C0 8B 4D FC 66 89 41 16 33 D2 8B 45 FC 66 89 50 12 8B 4D FC C7 41 0C 11 14 14 14 6A 1C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1284; reference:url,www.microsoft.com/technet/security/bulletin/MS11-056.mspx; classtype:attempted-user; sid:19463; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX OWC11.DataSourceControl.11 ActiveX function call access"; flow:established,to_client; file_data; content:"OWC11.DataSourceControl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22OWC11\.DataSourceControl(\.\d+)?\x22|\x27OWC11\.DataSourceControl(\.\d+)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22OWC11\.DataSourceControl(\.\d+)?\x22|\x27OWC11\.DataSourceControl(\.\d+)?\x27)\s*\)/smiO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,19069; reference:cve,2006-3729; reference:url,browserfun.blogspot.com/2006/07/mobb-19-datasourcecontrol.html; reference:url,osvdb.org/27111; classtype:attempted-user; sid:9820; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI environ.cgi access"; flow:to_server,established; content:"/environ.cgi"; fast_pattern; http_uri; classtype:attempted-recon; sid:856; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC DirBuster brute forcing tool detected"; flow:established,to_server; content:"User-Agent|3A| DirBuster"; fast_pattern:only; http_header; reference:url,sourceforge.net/projects/dirbuster/; classtype:web-application-attack; sid:19933; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC amazon 1-click cookie theft"; flow:to_server,established; content:"ref%3Cscript%20language%3D%22Javascript"; reference:bugtraq,1194; reference:cve,2000-0439; classtype:web-application-attack; sid:1082; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java Web Start arbitrary command execution attempt"; flow:to_client,established; content:"application/x-java-applet"; content:"-XXaltjvm"; fast_pattern:only; content:"launchjnlp"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16585; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox html tag attributes memory corruption"; flow:to_client,established; content:"var tags = new Array|28 22|audio|22|, |22|a|22|, |22|base|22 29|"; content:"var html = |22|<|22| + tags[i] + |22| |22| + atts[j]"; distance:0; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3765; classtype:attempted-user; sid:17804; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows win32k.sys kernel mode null pointer dereference attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|68 A2 01 00 00 68 FF FF 00 00 FF 15 30|"; fast_pattern; content:"|41 00|"; within:2; distance:1; reference:cve,2011-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS11-077.mspx; classtype:attempted-admin; sid:20261; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Excel Viewer ActiveX clsid access"; flow:established,to_client; file_data; content:"18A295DA-088E-42D1-BE31-5028D7F9B965"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*18A295DA-088E-42D1-BE31-5028D7F9B965\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(DoOleCommand|FTPDownloadFile|FTPUploadFile|HttpUploadFile|HttpDownloadFile|Save|SaveWebFile|OpenWebFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*18A295DA-088E-42D1-BE31-5028D7F9B965\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(DoOleCommand|FTPDownloadFile|FTPUploadFile|HttpUploadFile|HttpDownloadFile|Save|SaveWebFile|OpenWebFile))/siO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,23755; reference:bugtraq,33222; reference:bugtraq,33243; reference:url,moaxb.blogspot.com/2007/05/moaxb-02-excelviewerocx-v-31-multiple.html; classtype:attempted-user; sid:11181; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI NetScreen SA 5000 delhomepage.cgi access"; flow:to_server,established; content:"/delhomepage.cgi"; http_uri; reference:bugtraq,9791; reference:cve,2004-0347; classtype:web-application-activity; sid:3062; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer SWF frame handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|78 00 05 5F 00 00 0F A0 00 00 0C 01 00 43 02 FF FF FF BF 00 39|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30370; reference:cve,2007-5400; classtype:attempted-user; sid:17633; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 15 ActiveX clsid access"; flow:established,to_client; file_data; content:"37B03544-A4C8-11D2-B634-00C04F79498E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q13>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*37B03544-A4C8-11D2-B634-00C04F79498E\s*}?\s*(?P=q13)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15600; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SAP Crystal Reports PrintControl.dll ActiveX function call access"; flow:established,to_client; file_data; content:"CrystalReports12.CrystalPrintControl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22CrystalReports12\.CrystalPrintControl(\.\d)?\x22|\x27CrystalReports12\.CrystalPrintControl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*ServerResourceVersion\s*|.*(?P=v)\s*\.\s*ServerResourceVersion\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22CrystalReports12\.CrystalPrintControl(\.\d)?\x22|\x27CrystalReports12\.CrystalPrintControl(\.\d)?\x27)\s*\)(\s*\.\s*ServerResourceVersion\s*|.*(?P=n)\s*\.\s*ServerResourceVersion)\s*=/smiO"; metadata:policy security-ips drop; reference:bugtraq,45387; reference:cve,2010-2590; classtype:attempted-user; sid:18975; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Wmm2ae.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"44C79591-D0DE-49C4-BA3C-A45AB7003356"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*44C79591-D0DE-49C4-BA3C-A45AB7003356/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7454; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS MDAC Content-Type overflow attempt"; flow:to_server,established; content:"/msadcs.dll"; http_uri; content:"Content-Type|3A|"; isdataat:50,relative; content:!"|0A|"; within:50; pcre:"/^POST\s/smi"; reference:bugtraq,6214; reference:cve,2002-1142; reference:nessus,11161; reference:url,www.foundstone.com/knowledge/randd-advisories-display.html?id=337; reference:url,www.microsoft.com/technet/security/bulletin/MS02-065.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS98-004.mspx; classtype:web-application-attack; sid:1970; rev:18;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 15 ActiveX clsid access"; flow:established,to_client; file_data; content:"FA8932FF-E064-4378-901C-69CB94E3A20A"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q13>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*FA8932FF-E064-4378-901C-69CB94E3A20A\s*}?\s*(?P=q13)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14116; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Dart Communications PowerTCP FTP ActiveX function call access"; flow:established,to_client; file_data; content:"Dart.Ftp"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Dart\.Ftp\x22|\x27Dart\.Ftp\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SecretKey\s*|.*(?P=v)\s*\.\s*SecretKey\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Dart\.Ftp\x22|\x27Dart\.Ftp\x27)\s*\)(\s*\.\s*SecretKey\s*|.*(?P=n)\s*\.\s*SecretKey)\s*=/Osmi"; metadata:policy security-ips drop; reference:bugtraq,31814; classtype:attempted-user; sid:14780; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI book.cgi arbitrary command execution attempt"; flow:to_server,established; content:"/book.cgi"; fast_pattern; http_uri; content:"current=|7C|"; reference:bugtraq,3178; reference:cve,2001-1114; reference:nessus,10721; classtype:web-application-attack; sid:1879; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Symantec CLIProxy.dll ActiveX function call access"; flow:established,to_client; file_data; content:"cliproxy.objects"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22cliproxy\.objects(\.\d)?\x22|\x27cliproxy\.objects(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SetRemoteComputerName\s*|.*(?P=v)\s*\.\s*SetRemoteComputerName\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22cliproxy\.objects(\.\d)?\x22|\x27cliproxy\.objects(\.\d)?\x27)\s*\)(\s*\.\s*SetRemoteComputerName\s*|.*(?P=n)\s*\.\s*SetRemoteComputerName\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,38222; reference:cve,2010-0108; reference:url,www.symantec.com/business/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=2010&suid=20100217_02; classtype:attempted-user; sid:19103; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX GeoVision LiveX 8120 ActiveX function call access"; flow:established,to_client; file_data; content:"LiveX_v8120"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22LiveX_v8120(\.\d)?\x22|\x27LiveX_v8120(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SnapShotToFile\s*|.*(?P=v)\s*\.\s*SnapShotToFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22LiveX_v8120(\.\d)?\x22|\x27LiveX_v8120(\.\d)?\x27)\s*\)(\s*\.\s*SnapShotToFile\s*|.*(?P=n)\s*\.\s*SnapShotToFile\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:bugtraq,33782; classtype:attempted-user; sid:15340; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC /~ftp access"; flow:to_server,established; content:"/~ftp"; http_uri; classtype:attempted-recon; sid:1662; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS users.xml access"; flow:to_server,established; content:"/users.xml"; fast_pattern; http_uri; classtype:web-application-activity; sid:1750; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java Web Start arbitrary command execution attempt - Internet Explorer"; flow:to_client,established; content:"8AD9C840-044E-11D1-B3E9-00805F499D93"; fast_pattern:only; content:"-XXaltjvm"; content:"launchjnlp"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16584; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AcroPDF.PDF ActiveX clsid access "; flow:established,to_client; file_data; content:"CA8A9780-280D-11CF-A24D-444553540000"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CA8A9780-280D-11CF-A24D-444553540000\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(execCommand)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CA8A9780-280D-11CF-A24D-444553540000\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(execCommand))\s*\(/siO"; reference:cve,2009-2987; classtype:attempted-user; sid:16386; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Eyeball MessengerSDK ActiveX clsid access"; flow:established,to_client; file_data; content:"CA06EE71-7348-44C4-9540-AAF0E6BD1515"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CA06EE71-7348-44C4-9540-AAF0E6BD1515\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(BgColor)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CA06EE71-7348-44C4-9540-AAF0E6BD1515\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(BgColor))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,30424; reference:cve,2008-3430; classtype:attempted-user; sid:14247; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX vmhwcfg.NwzCompleted ActiveX clsid access"; flow:established,to_client; file_data; content:"9F625D90-A74B-4dd8-9847-9CFD6F928FEF"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*9F625D90-A74B-4dd8-9847-9CFD6F928FEF\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14452; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC jigsaw dos attempt"; flow:established,to_server; content:"/servlet/con"; http_uri; pcre:"/\x2Fcon\b/Ui"; reference:bugtraq,5258; reference:cve,2002-1052; reference:nessus,11047; classtype:web-application-attack; sid:1831; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7510 (msg:"WEB-MISC HP OpenView Network Node Manager server name exploit attempt"; flow:to_server,established; content:"/topology/pathView"; http_uri; content:"|02 65 6E 74 00 00 73 71 00 7E 00 00 00 00 00 02|"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,45762; reference:cve,2011-0263; reference:url,h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c02670501; classtype:attempted-admin; sid:18993; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC OpenView Network Node Manager cookie buffer overflow attempt"; flow:to_server,established; content:"/OVCgi/nnmRptConfig.exe"; fast_pattern:only; http_uri; pcre:"/(OvJavaScript|OvTitleFrame|OvHelpWindow|OvMap|OvSession|OvJavaLocale|OvOSLocale|OvLogin|OvDebug|OvDeveloper|OvTreeControl|OvJavaScript|OvProduct|OvPort|OvLocale|OvWebSession)\s*\x3D[^\x3B\x2C]{1024}/iC"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,42154; reference:cve,2010-2709; classtype:attempted-user; sid:18910; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Visual Studio MFC applications mfc42.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc42.dll"; http_uri; reference:cve,2010-3190; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-025.mspx; classtype:attempted-user; sid:18620; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Agent Custom Proxy Class ActiveX clsid access"; flow:established,to_client; file_data; content:"4BAC124B-78C8-11D1-B9A8-00C04FD97575"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4BAC124B-78C8-11D1-B9A8-00C04FD97575\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:cve,2006-3445; reference:cve,2007-1205; reference:url,www.microsoft.com/technet/security/bulletin/MS06-068.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS07-020.mspx; classtype:attempted-user; sid:8850; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC IBM Lotus Domino Web Server Accept-Language header buffer overflow attempt"; flow:to_server,established; content:"Accept-Language|3A|"; isdataat:110,relative; pcre:"/^Accept-Language\x3A[^\n]{110}/smi"; content:".nsf?"; http_uri; reference:bugtraq,29310; reference:cve,2008-2240; classtype:attempted-admin; sid:13819; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT javascript uuencoded eval statement"; flow:to_client,established; content:"unescape"; content:"%u0065"; distance:0; content:"%u0076"; distance:0; content:"%u0061"; distance:0; content:"%u006c"; distance:0; pcre:"/unescape\s*\x28[\x22\x27]\s*\x25u0065\s*\x25u0076\s*\x25u0061\s*\x25u006c/i"; metadata:policy security-ips drop; classtype:misc-activity; sid:19075; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT UltraISO CUE file handling stack buffer overflow attempt"; flow:to_client,established; file_data; content:"FILE |22|"; within:6; isdataat:512,relative; content:!"|22|"; within:512; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24140; reference:cve,2007-2888; classtype:attempted-user; sid:16734; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Apache newline exploit attempt"; flow:to_server,established; content:"|0D 0A 0D 0A|"; pcre:"/(\x0d\x0a){100}/"; reference:bugtraq,7254; reference:cve,2003-0132; classtype:web-application-attack; sid:11272; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 389 (msg:" WEB-MISC OpenLDAP Modrdn utf-8 string code execution attempt"; flow:to_server, established; content:"|30|"; depth:1; content:"|6C|"; within:20; content:"cn="; pcre:"/cn=[^\x00]*\x23[^\x00]*\x01\x01\x00/i"; metadata:policy security-ips drop; reference:bugtraq,41770; reference:cve,2010-0211; classtype:attempted-admin; sid:18804; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [80,8000] (msg:"WEB-MISC IceCast header buffer overflow attempt"; flow:to_server,established; content:"HTTP/1."; pcre:"/HTTP\/1\.[01].*?\n([^\r\n]+?\r?\n){32}/i"; reference:bugtraq,11271; reference:cve,2004-1561; reference:url,archives.neohapsis.com/archives/bugtraq/2004-09/0366.html; classtype:attempted-admin; sid:8701; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Vista feed headlines cross-site scripting attack attempt"; flow:to_client,established; content:"<rss"; content:"<channel"; distance:0; content:"expression|28|"; distance:0; pcre:"/<title>[^>]*?(&lt|<).*?expression\x28.*?<\/title>/i"; metadata:policy security-ips drop; reference:bugtraq,25287; reference:cve,2007-3033; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-048.mspx; classtype:web-application-attack; sid:19174; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint out of bounds value remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; file_data; content:"|C3 0B 08|"; fast_pattern; byte_test:1,<,0x1,7,relative,little; content:"|C3 0B|"; distance:0; metadata:policy security-ips drop; reference:cve,2010-0032; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:19303; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SizerOne ActiveX function call access"; flow:established,to_client; file_data; content:"TabOne.TabOne"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22TabOne\.TabOne(\.\d)?\x22|\x27TabOne\.TabOne(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*AddTab\s*|.*(?P=v)\s*\.\s*AddTab\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22TabOne\.TabOne(\.\d)?\x22|\x27TabOne\.TabOne(\.\d)?\x27)\s*\)(\s*\.\s*AddTab\s*|.*(?P=n)\s*\.\s*AddTab\s*)\s*\(/smiO"; metadata:policy security-ips alert; reference:bugtraq,33148; reference:cve,2008-4827; classtype:attempted-user; sid:15194; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Kaspersky AntiVirus SysInfo ActiveX function call access"; flow:established,to_client; file_data; content:"KL.SysInfo"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22KL\.SysInfo\x22|\x27KL\.SysInfo\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*|.*(?P=v)\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22KL\.SysInfo\x22|\x27KL\.SysInfo\x27)\s*\)(\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*|.*(?P=n)\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,23325; reference:cve,2007-1112; reference:url,www.kaspersky.com/technews?id=203038693; reference:url,www.kaspersky.com/technews?id=203038694; classtype:attempted-user; sid:10429; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS MSProxy access"; flow:to_server,established; content:"/scripts/proxy/w3proxy.dll"; fast_pattern; http_uri; reference:url,support.microsoft.com/?kbid=331066; classtype:web-application-activity; sid:986; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AudioCDRipper ActiveX clsid access"; flow:established,to_client; file_data; content:"BE604333-B029-44E6-8367-1566B0AD7084"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q12>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BE604333-B029-44E6-8367-1566B0AD7084\s*}?\s*(?P=q12)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,23900; classtype:attempted-user; sid:11284; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX gopher Asychronous Pluggable Protocol Handler ActiveX clsid access"; flow:established,to_client; file_data; content:"79EAC9E4-BAF9-11CE-8C82-00AA004BA90B"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q5>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*79EAC9E4-BAF9-11CE-8C82-00AA004BA90B\s*}?\s*(?P=q5)(\s|>)/si"; metadata:policy security-ips drop; reference:cve,2007-0218; reference:url,www.microsoft.com/technet/security/bulletin/MS07-033.mspx; classtype:attempted-user; sid:7938; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DADashStyle.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BF0-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BF0-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8825; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"WEB-MISC Tomcat UNIX platform directory traversal"; flow:established,to_server; content:"/%2E%2E"; fast_pattern:only; content:"/%2E%2E"; http_raw_uri; pcre:"/\/%2E%2E(\\|%5C)\//"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,22960; reference:cve,2007-0450; reference:url,tomcat.apache.org/tomcat-6.0-doc/changelog.html; classtype:web-application-attack; sid:17501; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Dart Communications PowerTCP FTP ActiveX clsid access"; flow:established,to_client; file_data; content:"39FDA070-61BA-11D2-AD84-00105A17B608"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*39FDA070-61BA-11D2-AD84-00105A17B608\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SecretKey)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*39FDA070-61BA-11D2-AD84-00105A17B608\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(SecretKey))\s*=/Osi"; metadata:policy security-ips drop; reference:bugtraq,31814; classtype:attempted-user; sid:14778; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Adodb.Stream ActiveX object access"; flow:established,to_client; file_data; content:"00000566-0000-0010-8000-00AA006D2EA4"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*00000566-0000-0010-8000-00AA006D2EA4/si"; metadata:policy security-ips drop; reference:bugtraq,10514; reference:cve,2004-0549; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;KB870669; reference:url,www.microsoft.com/technet/security/bulletin/ms04-025.mspx; classtype:attempted-user; sid:4982; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime PICT file overread buffer overflow attempt"; flow:to_client,established; content:"|00 11 02 FF 0C 00 FF|"; byte_jump:2,-17,relative,post_offset -4,big; isdataat:1,relative; content:!"|00 FF|"; within:2; metadata:policy security-ips drop; reference:bugtraq,28583; reference:cve,2008-1019; classtype:attempted-user; sid:18561; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC oracle web arbitrary command execution attempt"; flow:to_server,established; content:"/ows-bin/"; http_uri; content:"?&"; http_uri; reference:bugtraq,1053; reference:cve,2000-0169; reference:nessus,10348; classtype:web-application-attack; sid:1193; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer orphan DOM objects memory corruption attempt"; flow:to_client,established; content:"createElement"; content:"appendChild"; within:50; content:"innerHTML"; within:100; pcre:"/(?P<first>\S+)\x2EappendChild\x28\s*(?P<second>\S+)\s*\x29.*(?P=second)\x2E\S+\s*\x3D\s*(?P=first)\x2E\S+/is"; pcre:"/(\S+)\x2EappendChild[^\x7D]+\1\x2EinnerHTML\s*\x3D\s*\x27{2}/i"; reference:cve,2009-3674; reference:url,www.microsoft.com/technet/security/bulletin/MS09-072.mspx; classtype:attempted-user; sid:16330; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Free Download Manager .torrent parsing announce overflow attempt"; flow:to_client,established; flowbits:isset,http.torrent; file_data; content:"8|3A|announce"; byte_test:6,>,100000,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16518; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LM.LMBehaviorFactory.1 ActiveX function call access"; flow:established,to_client; file_data; content:"LM.LMBehaviorFactory.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22LM.LMBehaviorFactory.1\x22|\x27LM.LMBehaviorFactory.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22LM.LMBehaviorFactory.1\x22|\x27LM.LMBehaviorFactory.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8752; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 29 ActiveX clsid access"; flow:established,to_client; file_data; content:"68BBCA71-E1F6-47B2-87D3-369E1349D990"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q43>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*68BBCA71-E1F6-47B2-87D3-369E1349D990\s*}?\s*(?P=q43)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14144; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC ?PageServices access"; flow:to_server,established; content:"?PageServices"; http_uri; reference:bugtraq,1063; reference:bugtraq,7621; reference:cve,1999-0269; classtype:attempted-recon; sid:1123; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer playlist http URL overflow attempt"; flow:to_client,established; flowbits:isset,realplayer.playlist; content:"http|3A|//"; pcre:"/^http\x3a\x2f\x2f[^\n]{400}/smi"; reference:bugtraq,13264; reference:bugtraq,9579; reference:cve,2004-0258; reference:cve,2005-0755; classtype:attempted-user; sid:2439; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC malformed ipv6 uri overflow attempt"; flow:to_server,established; content:"|3A|/["; http_uri; pcre:"/\x3a\x2f\x5b\s*([\x2F\x3F\x23]*)|([\x2F\x3F\x23]+.+)|(\x3a[^\x3a^\x5d]*)$/U"; reference:bugtraq,11187; reference:cve,2004-0786; classtype:web-application-attack; sid:5715; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player ActionScript 3 integer overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|0A 5C 94 BF 42 D9 62 00 00 F3 45 3D D4 6E C2 7F 22 D1 11 DD B9 EC D8 84 72 2B DD 44 F2 BB 00 05 E6 8A 7B A8 DD 89 DE 4A 86 00 FF 09 10 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2416; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19682; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare IntraProcessLogging ActiveX clsid access"; flow:established,to_client; file_data; content:"AF13B07E-28A1-4CAC-9C9A-EC582E354A24"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*AF13B07E-28A1-4CAC-9C9A-EC582E354A24\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SetLogFileName)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*AF13B07E-28A1-4CAC-9C9A-EC582E354A24\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(SetLogFileName))\s*\(/si"; reference:bugtraq,25110; reference:cve,2007-4059; classtype:attempted-user; sid:12200; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS iisadmpwd attempt"; flow:to_server,established; content:"/iisadmpwd/aexp"; fast_pattern; http_uri; reference:bugtraq,2110; reference:cve,1999-0407; reference:nessus,10371; classtype:web-application-attack; sid:1018; rev:19;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI Poll-it access"; flow:to_server,established; content:"/pollit/Poll_It_SSI_v2.0.cgi"; fast_pattern; http_uri; reference:bugtraq,1431; reference:cve,2000-0590; reference:nessus,10459; classtype:web-application-activity; sid:1106; rev:18;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Trend Micro OfficeScan access"; flow:to_server,established; content:"/officescan/cgi/jdkRqNotify.exe"; http_uri; reference:bugtraq,1057; classtype:attempted-recon; sid:1192; rev:10;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI php.cgi access"; flow:to_server,established; content:"/php.cgi"; fast_pattern; http_uri; reference:arachnids,232; reference:bugtraq,2250; reference:bugtraq,712; reference:cve,1999-0058; reference:cve,1999-0238; reference:nessus,10178; classtype:attempted-recon; sid:824; rev:21;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX iDefense COMRaider ActiveX function call access"; flow:established,to_client; file_data; content:"vbDevKit.CVariantFileSystem"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vbDevKit\.CVariantFileSystem(\.\d)?\x22|\x27vbDevKit\.CVariantFileSystem(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*DeleteFile\s*|.*(?P=v)\s*\.\s*DeleteFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vbDevKit\.CVariantFileSystem(\.\d)?\x22|\x27vbDevKit\.CVariantFileSystem(\.\d)?\x27)\s*\)(\s*\.\s*DeleteFile\s*|.*(?P=n)\s*\.\s*DeleteFile\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:bugtraq,33867; classtype:attempted-user; sid:15374; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 17 ActiveX clsid access"; flow:established,to_client; file_data; content:"65FB3073-CA8E-42A1-9A9A-2F826D05A843"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q17>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*65FB3073-CA8E-42A1-9A9A-2F826D05A843\s*}?\s*(?P=q17)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14120; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Oracle Document Capture ActiveX clsid access"; flow:established,to_client; file_data; content:"D63891F1-E026-11D3-A6C3-005004055C6C"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D63891F1-E026-11D3-A6C3-005004055C6C\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(WriteJPG)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D63891F1-E026-11D3-A6C3-005004055C6C\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(WriteJPG))/siO"; metadata:policy security-ips drop; reference:bugtraq,45856; reference:cve,2010-3599; classtype:attempted-user; sid:19193; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC encoded cross site scripting attempt"; flow:to_server,established; content:"<SCRIPT"; http_uri; reference:cve,2009-1140; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:web-application-attack; sid:7070; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Xunlei Thunder PPLAYER.DLL ActiveX clsid access"; flow:established,to_client; file_data; content:"F3E70CEA-956E-49CC-B444-73AFE593AD7F"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F3E70CEA-956E-49CC-B444-73AFE593AD7F\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(FlvPlayerUrl)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F3E70CEA-956E-49CC-B444-73AFE593AD7F\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(FlvPlayerUrl))\s*\(/si"; reference:bugtraq,26536; reference:cve,2007-6144; classtype:attempted-user; sid:12737; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Whale Client Components ActiveX clsid access"; flow:established,to_client; file_data; content:"8D9563A9-8D5F-459B-87F2-BA842255CB9A"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,34532; reference:cve,2007-2238; classtype:attempted-user; sid:18490; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer .hlp samba share download attempt"; flow:to_client,established; file_data; content:"vbscript"; content:".hlp"; content:"|5C|"; pcre:"/\\\\[^\x20\x0a\x0d]*\.hlp/smi"; metadata:policy security-ips drop; reference:cve,2010-0483; classtype:attempted-user; sid:16452; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader media.newPlayer memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/S/JavaScript"; content:"this.media.newPlayer"; pcre:"/^\x5C?\x28null\x5C?\x29/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37331; reference:cve,2009-4324; classtype:attempted-user; sid:16333; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint malformed data record code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|F2 03|"; content:"|AA AA AA 2F 00 C8 0F 0C 00 00 00 30 00 D2 0F 04 00|"; within:17; distance:1; metadata:policy security-ips drop; reference:bugtraq,20322; reference:cve,2006-3876; classtype:attempted-user; sid:17292; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java Virtual Machine malformed GIF buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.gif; content:"GIF"; byte_test:1,!&,128,7,relative; content:","; within:1; distance:10; content:"|00 00|"; within:2; distance:4; metadata:policy security-ips drop; reference:bugtraq,22085; reference:cve,2007-0243; classtype:attempted-user; sid:10062; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel BIFF5 ExternSheet record stack overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|16 00 02 00|"; content:"|17 00|"; within:2; distance:2; byte_test:1,>,250,2,relative; reference:cve,2010-1252; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16656; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX PPStream PPSMediaList ActiveX clsid access"; flow:established,to_client; file_data; content:"D22DE742-04CD-4B5C-A8A3-82AB3DAEC43D"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D22DE742-04CD-4B5C-A8A3-82AB3DAEC43D\s*}?\s*(?P=q1)(\s|>)/siO"; metadata:policy security-ips drop; reference:bugtraq,36234; classtype:attempted-user; sid:15926; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player SWF scene and label data memory corruption attempt"; flow:to_client,established; content:"|BF 15 84 03 00 00|"; content:"|BF 14|D|02 00 00|"; within:6; distance:900; content:"?|13 1F 00 00 00|"; within:6; distance:640; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28695; reference:bugtraq,29386; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:13821; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Studio 6 PDWizard.ocx ActiveX clsid access"; flow:established,to_client; file_data; content:"0DDF3C0B-E692-11D1-AB06-00AA00BDD685"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0DDF3C0B-E692-11D1-AB06-00AA00BDD685\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(StartProcess)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0DDF3C0B-E692-11D1-AB06-00AA00BDD685\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(StartProcess))/siO"; metadata:policy security-ips drop; reference:bugtraq,25638; reference:cve,2007-4891; classtype:attempted-user; sid:12459; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT mozilla compareTo arbitrary code execution attempt"; flow:to_client,established; file_data; content:"InstallVersion"; content:"compareTo"; distance:0; pcre:"/InstallVersion\s*\x29?\s*\.\s*compareTo/smi"; metadata:policy security-ips drop; reference:bugtraq,14242; reference:cve,2005-2265; reference:url,www.mozilla.org/security/announce/2005/mfsa2005-50.html; classtype:attempted-user; sid:10131; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-FRONTPAGE frontpage server extension long host string overflow attempt"; flow:to_server,established; content:"fp30reg.dll"; fast_pattern; http_uri; content:"Host|3A|"; isdataat:300,relative; pcre:"/^Host\x3A\s[^\r\n]{300}/smi"; reference:bugtraq,9008; reference:cve,2003-0822; reference:cve,2003-0824; reference:url,www.microsoft.com/technet/security/Bulletin/MS03-051.mspx; classtype:attempted-admin; sid:6410; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE writeto.cnf access"; flow:to_server,established; content:"/_vti_pvt/writeto.cnf"; fast_pattern; http_uri; reference:bugtraq,4078; reference:cve,2002-1717; reference:nessus,10575; classtype:web-application-activity; sid:965; rev:17;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC RSA authentication agent for web redirect buffer overflow attempt"; flow:to_server,established; content:"IISWebAgent"; http_uri; content:"Redirect"; http_uri; content:"url|3D|"; http_uri; pcre:"/IISWebAgent[^\r\n]*\x2edll\x3F[^\r\n]*?url\x3d[^\r\n]{257}/Ui"; metadata:policy security-ips drop; reference:bugtraq,26424; reference:cve,2005-4734; classtype:attempted-user; sid:17440; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Multiple Products PNG large image width download attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32767,0,relative; metadata:policy security-ips drop; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:cve,2007-5503; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:3132; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX OWC11.DataSourceControl.11 ActiveX function call access"; flow:established,to_client; file_data; content:"OWC11.DataSourceControl.11"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22OWC11.DataSourceControl.11\x22|\x27OWC11.DataSourceControl.11\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22OWC11.DataSourceControl.11\x22|\x27OWC11.DataSourceControl.11\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; reference:url,browserfun.blogspot.com/2006/07/mobb-19-datasourcecontrol.html; reference:url,osvdb.org/27111; classtype:attempted-user; sid:8421; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Oracle Document Capture ActiveX function call access"; flow:established,to_client; file_data; content:"NCSECWLib.NCSRenderer"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22NCSECWLib\.NCSRenderer(\.\d)?\x22|\x27NCSECWLib\.NCSRenderer(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*WriteJPG\s*|.*(?P=v)\s*\.\s*WriteJPG\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22NCSECWLib\.NCSRenderer(\.\d)?\x22|\x27NCSECWLib\.NCSRenderer(\.\d)?\x27)\s*\)(\s*\.\s*WriteJPG\s*|.*(?P=n)\s*\.\s*WriteJPG\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,45856; reference:cve,2010-3599; classtype:attempted-user; sid:19194; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word malformed index code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|02 00 60 00 0C 14 FF 00 04 61 D5 00 B0 00 08 00 53 00 75 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,43766; reference:cve,2010-2750; classtype:attempted-user; sid:19153; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 2301 (msg:"WEB-MISC Compaq Insight directory traversal"; flow:to_server,established; content:"../"; reference:arachnids,244; reference:bugtraq,282; reference:cve,1999-0771; classtype:web-application-attack; sid:1199; rev:14;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI ttawebtop.cgi access"; flow:to_server,established; content:"/ttawebtop.cgi"; fast_pattern; http_uri; reference:bugtraq,2890; reference:cve,2001-0805; reference:nessus,10696; classtype:attempted-recon; sid:1480; rev:16;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC wwwboard.pl access"; flow:to_server,established; content:"/wwwboard.pl"; http_uri; reference:bugtraq,1795; reference:bugtraq,649; reference:cve,1999-0930; reference:cve,1999-0954; classtype:attempted-recon; sid:1175; rev:14;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP Universal CMDB server axis2 default credentials attempt"; flow:established,to_server; content:"/axis2/axis2-admin/login"; fast_pattern:only; http_uri; content:"POST"; http_method; content:"username=admin"; http_client_body; content:"password="; http_client_body; pcre:"/^(admin|axis2)/iR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,secunia.com/advisories/42763/; classtype:attempted-admin; sid:19157; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MW6 Technologies Barcode ActiveX clsid access"; flow:established,to_client; file_data; content:"14D09688-CFA7-11D5-995A-005004CE563B"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*14D09688-CFA7-11D5-995A-005004CE563B\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Supplement|SaveAsBMP|SaveAsWMF)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*14D09688-CFA7-11D5-995A-005004CE563B\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(Supplement|SaveAsBMP|SaveAsWMF))\s*=/siO"; metadata:policy security-ips drop; reference:bugtraq,33451; reference:cve,2008-4924; reference:cve,2009-0298; classtype:attempted-user; sid:15266; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Outlook Recipient Control ActiveX function call access"; flow:established,to_client; file_data; content:"RECIP.RecipCtl.1"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22RECIP.RecipCtl.1\x22|\x27RECIP.RecipCtl.1\x27)\s*\x3b.*\w+\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)|\w+\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22RECIP.RecipCtl.1\x22|\x27RECIP.RecipCtl.1\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,21649; classtype:attempted-user; sid:9670; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC webplus access"; flow:to_server,established; content:"/webplus?script"; http_uri; reference:bugtraq,1174; reference:bugtraq,1720; reference:bugtraq,1722; reference:bugtraq,1725; reference:cve,2000-1005; classtype:attempted-recon; sid:1159; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Generic javascript obfuscation attempt"; flow:to_client,established; file_data; content:"unescape"; pcre:"/var[^=]+=\s*unescape\s*\x3b/i"; metadata:policy security-ips drop; reference:bugtraq,35660; classtype:attempted-user; sid:15697; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI eXtropia webstore directory traversal"; flow:to_server,established; content:"/web_store.cgi"; http_uri; content:"page=../"; reference:bugtraq,1774; reference:cve,2000-1005; reference:nessus,10532; classtype:web-application-attack; sid:1088; rev:15;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Symantec Sygate Policy Manager SQL injection"; flow:established,to_server; content:"/servlet/Sygate.Servlet.login"; http_uri; pcre:"/[^\x26\x20\x0a]*insert[^\x26\x20\x0a]*Login[^\x26\x20\x0a]*Admin/smi"; reference:bugtraq,16452; reference:cve,2006-0522; classtype:attempted-admin; sid:11616; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LeadTools Raster Dialog File_D Object ActiveX clsid access"; flow:established,to_client; file_data; content:"00140BB5-B1BA-11CE-ABC6-F5B2E79D9E3F"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m7>\x22|\x27|)(?P<id1>.+?)(?P=m7)(\s|>)[^>]*\s*classid\s*=\s*(?P<q16>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*00140BB5-B1BA-11CE-ABC6-F5B2E79D9E3F\s*}?\s*(?P=q16)(\s|>).*(?P=id1)\s*\.\s*(DestinationPath)|<object\s*[^>]*\s*classid\s*=\s*(?P<q17>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*00140BB5-B1BA-11CE-ABC6-F5B2E79D9E3F\s*}?\s*(?P=q17)(\s|>)[^>]*\s*id\s*=\s*(?P<m8>\x22|\x27|)(?P<id2>.+?)(?P=m8)(\s|>).*(?P=id2)\s*\.\s*(DestinationPath))\s*=/si"; reference:bugtraq,24153; reference:url,moaxb.blogspot.com/2007/05/moaxb-25-leadtools-raster-dialog-filed.html; classtype:attempted-user; sid:11634; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Image Control 1.0 ActiveX object access"; flow:established,to_client; file_data; content:"D4A97620-8E8F-11CF-93CD-00AA00C08FDF"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*D4A97620-8E8F-11CF-93CD-00AA00C08FDF/si"; metadata:policy security-ips drop; reference:bugtraq,12477; reference:url,www.microsoft.com/technet/security/bulletin/MS05-014.mspx; classtype:attempted-user; sid:4165; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC telnet attempt"; flow:to_server,established; content:"telnet.exe"; classtype:web-application-activity; sid:1066; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Explorer invalid url file overflow attempt"; flow:to_client,established; file_data; content:"[InternetShortcut]"; within:100; content:"url="; distance:0; content:"file|3A|file|3A|file|3A|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,18838; reference:cve,2006-3351; classtype:denial-of-service; sid:7022; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX OutlookExpress.AddressBook ActiveX function call access"; flow:established,to_client; file_data; content:"OutlookExpress.AddressBook"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22OutlookExpress\.AddressBook\x22|\x27OutlookExpress\.AddressBook\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22OutlookExpress\.AddressBook\x22|\x27OutlookExpress\.AddressBook\x27)\s*\)/smi"; metadata:policy security-ips drop; classtype:attempted-user; sid:7005; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Photoshop CS4 ASL file processing buffer overflow attempt"; flow:to_client,established; content:"Stylenum"; byte_test:4,>,1020,8,relative,big; content:"8BSL"; metadata:policy security-ips drop; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17145; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel SST record remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|FC 00|"; byte_test:4,>,0x10000000,6,relative,little; byte_test:2,>,10,0,relative,little; byte_test:2,<,8225,0,relative,little; byte_jump:2,0,relative,little; pcre:"/^(\xFF|\x3C)\x00/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36042; reference:cve,2009-0561; reference:cve,2009-3037; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21396492; reference:url,www.microsoft.com/technet/security/bulletin/MS09-021.mspx; classtype:attempted-user; sid:15541; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VhdCvtCom.DiskLibHelper ActiveX function call access"; flow:established,to_client; file_data; content:"VhdCvtCom.DiskLibHelper"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22VhdCvtCom\.DiskLibHelper\x22|\x27VhdCvtCom\.DiskLibHelper\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22VhdCvtCom\.DiskLibHelper\x22|\x27VhdCvtCom\.DiskLibHelper\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14592; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Publisher 2007 pointer dereference attempt"; flow:to_client,established; flowbits:isset,http.pub; file_data; content:"|01 2C 01 2B 01 2A 01 2F 01 2E 01 2D 01 52 00 12 12 00 00 00|"; content:"|02 00 13 00|"; within:4; distance:11; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35599; reference:cve,2009-0566; reference:url,www.microsoft.com/technet/security/bulletin/MS09-030.mspx; classtype:attempted-user; sid:19932; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Intuit QuickBooks Online Edition 1 ActiveX clsid access"; flow:established,to_client; file_data; content:"CF9DEB90-8DE3-11D5-BAE4-00105AAAFF94"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CF9DEB90-8DE3-11D5-BAE4-00105AAAFF94\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(httpGETToFile|httpPOSTFromFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CF9DEB90-8DE3-11D5-BAE4-00105AAAFF94\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(httpGETToFile|httpPOSTFromFile))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,25544; reference:cve,2007-0322; reference:cve,2007-4471; reference:url,sc.accounting.quickbooks.com/Update/index.cfm?id=32; reference:url,www.kb.cert.org/vuls/id/907481; reference:url,www.kb.cert.org/vuls/id/979638; reference:url,www.microsoft.com/technet/security/bulletin/MS07-069.mspx; classtype:attempted-user; sid:12393; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint MCAtom remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|F8 0F 04 00 00 00|"; byte_test:4,>,2,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,20495; reference:cve,2006-5296; classtype:attempted-user; sid:17318; rev:4;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for addons.mozilla.org detected"; flow:to_client,established; ssl_state:server_hello; content:"addons.mozilla.org"; content:"|92 39 D5 34 8F 40 D1 69 5A 74 54 70 E1 F2 3F 43|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18571; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Novell ZENworks patch management SQL injection attempt"; flow:to_server, established; content:"/packages/default.asp?"; http_uri; pcre:"/sort\x3d[^\s]*\x3b+/Ui"; metadata:policy security-ips drop; reference:bugtraq,15220; reference:cve,2005-3315; classtype:web-application-attack; sid:17449; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Symantec Altiris Deployment Solution ActiveX function call access"; flow:established,to_client; file_data; content:"Altiris.AeXNSConsoleUtilities"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Altiris\.AeXNSConsoleUtilities(\.\d)?\x22|\x27Altiris\.AeXNSConsoleUtilities(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(BrowseAndSaveFile|RunCMD)\s*|.*(?P=v)\s*\.\s*(BrowseAndSaveFile|RunCMD)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Altiris\.AeXNSConsoleUtilities(\.\d)?\x22|\x27Altiris\.AeXNSConsoleUtilities(\.\d)?\x27)\s*\)(\s*\.\s*(BrowseAndSaveFile|RunCMD)\s*|.*(?P=n)\s*\.\s*(BrowseAndSaveFile|RunCMD)\s*)\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,36698; reference:bugtraq,37092; reference:cve,2009-3031; reference:cve,2009-3033; classtype:attempted-user; sid:16307; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-IIS IIS 5.1 alternate data stream authentication bypass attempt"; flow:established,to_server; content:"$i30:$INDEX_ALLOCATION"; http_uri; metadata:policy security-ips drop; reference:cve,2010-2731; reference:url,www.microsoft.com/technet/security/bulletin/MS10-065.mspx; classtype:web-application-attack; sid:17103; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX obfuscated instantiation of ActiveX object - likely malicious"; flow:established,to_client; file_data; content:"new ActiveXObject|28|"; content:"unescape|28|"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3558; classtype:attempted-user; sid:17571; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word rich text format invalid field size memory corruption attempt"; flow:to_client,established; content:"|5C|dpcallout"; content:"|5C|dppolycount"; within:50; byte_test:5,>,50,0,string,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1902; reference:url,www.microsoft.com/technet/security/bulletin/ms10-056.mspx; classtype:attempted-user; sid:17123; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI fileseek.cgi access"; flow:to_server,established; content:"/fileseek.cgi"; fast_pattern; http_uri; reference:bugtraq,4579; reference:bugtraq,6784; reference:cve,2002-0611; reference:nessus,11748; classtype:web-application-activity; sid:2207; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IBM Lotus SameTime STJNILoader ActiveX function call access"; flow:established,to_client; file_data; content:"JNILOADER.JNILoaderCtrl"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22JNILOADER\.JNILoaderCtrl\x22|\x27JNILOADER\.JNILoaderCtrl\x27)\s*\x3b.*(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)(\s*\.\s*(LoadLibrary)\s*\(|.*\3\s*\.\s*(LoadLibrary)\s*\()|(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22JNILOADER\.JNILoaderCtrl\x22|\x27JNILOADER\.JNILoaderCtrl\x27)\s*\)(\s*\.\s*(LoadLibrary)\s*\(|.*\7\s*\.\s*(LoadLibrary)\s*\()/smi"; metadata:policy security-ips drop; reference:bugtraq,23201; reference:url,www-1.ibm.com/support/docview.wss?uid=swg21257029; reference:url,www.securityfocus.com/archive/1/464185; classtype:attempted-user; sid:10417; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CGI Microsoft .NET Chart Control directory traversal attempt"; flow:to_server,established; content:"charImg.axd?"; content:"i=/"; distance:0; http_uri; content:".."; distance:0; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1977; reference:url,www.microsoft.com/technet/security/bulletin/MS11-066.mspx; classtype:attempted-recon; sid:19694; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Internet.PopupMenu.1 ActiveX function call access"; flow:established,to_client; file_data; content:"Internet.PopupMenu.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22Internet.PopupMenu.1\x22|\x27Internet.PopupMenu.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22Internet.PopupMenu.1\x22|\x27Internet.PopupMenu.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; classtype:attempted-user; sid:7012; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Oracle Java Web Start BasicServiceImpl security policy bypass attempt"; flow:to_server,established; content:"java.security.policy"; fast_pattern:only; http_uri; pcre:"/jnlp\x22\x09\x22-J-Djava\.security\.policy/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,43999; reference:cve,2010-3563; classtype:attempted-user; sid:20430; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Second Sight Software ActiveMod ActiveX function call access"; flow:established,to_client; file_data; content:"ACTIVEMOD.ActiveModCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ACTIVEMOD\.ActiveModCtrl\x22|\x27ACTIVEMOD\.ActiveModCtrl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ACTIVEMOD\.ActiveModCtrl\x22|\x27ACTIVEMOD\.ActiveModCtrl\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,23554; reference:cve,2007-1691; reference:url,www.kb.cert.org/vuls/id/962305; classtype:attempted-user; sid:10984; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS strings parsing memory corruption attempt"; flow:to_client,established; content:"text-decoration"; pcre:"/\x2E[A-Z\d_]+\s*\x7b\s*text-decoration[^\x3A]*?\x7d/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0943; reference:url,www.microsoft.com/technet/security/bulletin/ms07-045.mspx; classtype:attempted-user; sid:17645; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI webdist.cgi arbitrary command attempt"; flow:to_server,established; content:"/webdist.cgi"; http_uri; content:"distloc=|3B|"; fast_pattern:only; reference:bugtraq,374; reference:cve,1999-0039; reference:nessus,10299; classtype:web-application-attack; sid:1865; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView Network Node Manager OvOSLocale parameter buffer overflow attempt"; flow:to_server,established; content:"/OVCgi/Toolbar.exe"; http_uri; content:"OvOSLocale"; http_cookie; pcre:"/OvOSLocale\s*\x3d\s*[^\x3b\s]{249}/Cmi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34134; reference:cve,2008-0067; reference:cve,2009-0920; classtype:attempted-user; sid:15434; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Earth Resource Mapper NCSView ActiveX clsid access"; flow:established,to_client; file_data; content:"8EC18CE2-D7B4-11D2-88C8-006008A717FD"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8EC18CE2-D7B4-11D2-88C8-006008A717FD\s*}?\s*(?P=q1)(\s|>)/si"; reference:bugtraq,25584; reference:cve,2007-4470; classtype:attempted-user; sid:12413; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS Directory transversal attempt"; flow:to_server,established; content:"..|5C|.."; fast_pattern:only; reference:bugtraq,2218; reference:cve,1999-0229; classtype:web-application-attack; sid:974; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer use-after-free memory corruption attempt"; flow:to_client,established; content:"location.protocol"; fast_pattern:only; pcre:"/location.protocol\s*=[^=]/smi"; reference:cve,2010-2556; reference:url,www.microsoft.com/technet/security/bulletin/ms10-053.mspx; classtype:attempted-dos; sid:17129; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer javascript onload overflow attempt"; flow:to_client,established; content:"body"; content:"on"; within:20; content:"window"; within:20; pcre:"/<body\s+[^>]*on(Load|Blur)\s*=\s*[\x22\x27]?window\(\)/smi"; metadata:policy security-ips drop; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4647; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Microsoft IIS source code disclosure attempt"; flow:to_server,established; content:"http|3A 2F|localhost"; http_uri; metadata:policy security-ips drop; reference:cve,2005-2678; reference:url,secunia.com/advisories/16548; classtype:misc-attack; sid:17652; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 18 ActiveX clsid access"; flow:established,to_client; file_data; content:"577FAA18-4518-445E-8F70-1473F8CF4BA4"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q19>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*577FAA18-4518-445E-8F70-1473F8CF4BA4\s*}?\s*(?P=q19)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15606; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.Sequence ActiveX clsid access"; flow:established,to_client; file_data; content:"4F241DB1-EE9F-11D0-9824-006097C99E51"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*4F241DB1-EE9F-11D0-9824-006097C99E51/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8762; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Sony ImageStation ActiveX clsid access"; flow:established,to_client; file_data; content:"E9A7F56F-C40F-4928-8C6F-7A72F2A25222"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E9A7F56F-C40F-4928-8C6F-7A72F2A25222\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SetLogging)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E9A7F56F-C40F-4928-8C6F-7A72F2A25222\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(SetLogging))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,27715; reference:cve,2008-0748; classtype:attempted-user; sid:13547; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SonicWall Aventail EPInstaller ActiveX function call access"; flow:established,to_client; file_data; content:"Aventail.EPInstaller"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Aventail\.EPInstaller(\.\d)?\x22|\x27Aventail\.EPInstaller(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(InstallComponentMsi|Install3rdPartyComponent|InstallComponentVer|InstallComponent)\s*|.*(?P=v)\s*\.\s*(InstallComponentMsi|Install3rdPartyComponent|InstallComponentVer|InstallComponent)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Aventail\.EPInstaller(\.\d)?\x22|\x27Aventail\.EPInstaller(\.\d)?\x27)\s*\)(\s*\.\s*(InstallComponentMsi|Install3rdPartyComponent|InstallComponentVer|InstallComponent)\s*|.*(?P=n)\s*\.\s*(InstallComponentMsi|Install3rdPartyComponent|InstallComponentVer|InstallComponent)\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,44535; reference:cve,2010-2583; classtype:attempted-user; sid:18324; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI a1stats access"; flow:to_server,established; content:"/a1stats/"; http_uri; reference:bugtraq,2705; reference:cve,2001-0561; reference:nessus,10669; classtype:web-application-activity; sid:1731; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC mod-plsql administration access"; flow:to_server,established; content:"/admin_/"; http_uri; reference:bugtraq,3726; reference:bugtraq,3727; reference:cve,2001-1216; reference:cve,2001-1217; reference:nessus,10849; classtype:web-application-activity; sid:1385; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed named graph information ascii overflow"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|95 00|"; isdataat:133,relative; pcre:"/^(.{92}[^\x00]{41}|.{148}[^\x00]{41}|.{172}[^\x00]{41}|.{212}[^\x00]{41}|.{252}[^\x00]{22}|.{272}[^\x00]{22}|.{292}[^\x00]{22}|.{312}[^\x00]{22}|.{332}[^\x00]{22})/Rs"; metadata:policy security-ips drop; reference:cve,2007-0215; reference:url,www.microsoft.com/technet/security/bulletin/ms07-023.mspx; classtype:attempted-user; sid:11290; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape Enterprise DOS"; flow:to_server,established; content:"REVLOG / "; depth:9; reference:bugtraq,2294; reference:cve,2001-0251; classtype:web-application-attack; sid:1047; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Oracle Secure Backup Administration Server authentication bypass attempt via POST"; flow:to_server,established; content:"login.php"; http_uri; content:"attempt"; http_client_body; content:"uname="; http_client_body; pcre:"/uname\x3D[^\x26\x2D\s]*?\x2D/iP"; metadata:policy security-ips drop; reference:bugtraq,41596; reference:cve,2010-0907; classtype:attempted-admin; sid:17049; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI listrec.pl access"; flow:to_server,established; content:"/listrec.pl"; fast_pattern; http_uri; reference:bugtraq,3328; reference:cve,2001-0997; reference:nessus,10769; classtype:attempted-recon; sid:1470; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Agent Control ActiveX function call access"; flow:established,to_client; file_data; content:"Agent.Control"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Agent\.Control\.\d+\x22|\x27Agent\.Control\.\d+\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*Characters.Load\s*|.*(?P=v)\s*\.\s*Characters.Load\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Agent\.Control\.\d+\x22|\x27Agent\.Control\.\d+\x27)\s*\)(\s*\.\s*Characters.Load\s*|.*(?P=n)\s*\.\s*Characters.Load\s*)\s*\(/Osmi"; reference:bugtraq,25566; reference:cve,2007-3040; reference:url,www.microsoft.com/technet/security/bulletin/MS07-051.mspx; classtype:attempted-user; sid:12450; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Internet Explorer navcancl.htm url spoofing attempt"; flow:established,to_client; content:"about|3A|cancel|23|"; reference:bugtraq,22966; reference:cve,2007-1499; reference:url,www.microsoft.com/technet/security/bulletin/MS07-033.mspx; classtype:misc-attack; sid:12014; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Office Sharepoint Server elevation of privilege exploit attempt"; flow:to_server,established; content:!"/ssp/admin/_layouts"; http_uri; content:"mode=ssp"; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4032; reference:url,www.microsoft.com/technet/security/bulletin/MS08-077.mspx; classtype:attempted-admin; sid:15108; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows GDI VML gradient size heap overflow attempt"; flow:to_client,established; content:"v:fill"; content:"focussize"; pcre:"/focussize\s*\x3d\s*\x22[^\x2d\x2c\x22]*\x2d[^\x2d\x22]+\x2d/smi"; metadata:policy security-ips drop; reference:cve,2007-5348; reference:url,www.microsoft.com/technet/security/bulletin/MS08-052.mspx; classtype:attempted-user; sid:14261; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla multiple content-disposition headers malicious redirect attempt"; flow:to_client,established; content:"Content|2D|Disposition|3A|"; http_header; content:"|0A|Content|2D|Disposition|3A|"; distance:0; http_header; reference:cve,2011-3000; classtype:web-application-attack; sid:20586; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8888 (msg:"WEB-MISC answerbook2 admin attempt"; flow:to_server,established; content:"/cgi-bin/admin/admin"; reference:bugtraq,5383; reference:cve,2000-0696; classtype:web-application-activity; sid:1946; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC .wwwacl access"; flow:to_server,established; content:".www_acl"; http_uri; classtype:attempted-recon; sid:1131; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SAP GUI SAPBExCommonResources ActiveX clsid access"; flow:established,to_client; file_data; content:"A009C90D-814B-11D3-BA3E-080009D22344"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A009C90D-814B-11D3-BA3E-080009D22344\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Execute)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A009C90D-814B-11D3-BA3E-080009D22344\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Execute))/siO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,securitytracker.com/alerts/2010/Mar/1023760.html; classtype:attempted-user; sid:17614; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Logitech Video Call 3 ActiveX clsid access"; flow:established,to_client; file_data; content:"917b29f8-e72a-4761-8371-bf7fca27eb31"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*917b29f8-e72a-4761-8371-bf7fca27eb31\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Start)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*917b29f8-e72a-4761-8371-bf7fca27eb31\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Start))/siO"; metadata:policy security-ips drop; reference:bugtraq,24254; reference:cve,2007-2918; classtype:attempted-user; sid:17067; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"WEB-MISC Novell iManager eDirectory plugin schema buffer overflow attempt - POST request"; flow:to_server,established; content:"POST"; http_method; content:"/nps/servlet/"; http_uri; content:"taskId=base.ExtendSchema"; http_uri; pcre:"/(((DestFile|encryptPass)\x3D[^\x26]{50})|((BaseDN|SearchFilter)\x3D[^\x26]{128}))/Pi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37672; reference:cve,2009-4486; classtype:attempted-admin; sid:16430; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX StreamAudio ProxyManager ActiveX clsid access"; flow:established,to_client; file_data; content:"2253F320-AB68-4A07-917D-4F12D8884A06"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2253F320-AB68-4A07-917D-4F12D8884A06\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(InternalTuneIn)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2253F320-AB68-4A07-917D-4F12D8884A06\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(InternalTuneIn))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,27247; reference:cve,2008-0248; classtype:attempted-user; sid:13312; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 8 toStaticHTML XSS attempt"; flow:to_client,established; content:"toStaticHTML("; fast_pattern; content:"expression("; within:100; pcre:"/toStaticHTML\x28.*?[\x26\x22].=expression\x28/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1252; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-user; sid:19239; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel ContinueFRT12 and MDXSet heap overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|87 08|"; byte_jump:2,0,relative,little; content:"|7F 08|"; within:2; metadata:policy security-ips drop; reference:cve,2010-0261; reference:url,www.microsoft.com/technet/security/bulletin/MS10-017.mspx; classtype:attempted-user; sid:16465; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMT DV Extract Filter ActiveX clsid access"; flow:established,to_client; file_data; content:"E476CBFF-E229-4524-B6B7-228A3129D1C7"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*E476CBFF-E229-4524-B6B7-228A3129D1C7/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7470; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC webadmin.dll access"; flow:to_server,established; content:"/webadmin.dll"; http_uri; reference:bugtraq,7438; reference:bugtraq,7439; reference:bugtraq,8024; reference:cve,2003-0471; reference:nessus,11771; classtype:web-application-activity; sid:2246; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Toshiba Surveillance Surveillix DVR ActiveX function call access"; flow:established,to_client; file_data; content:"RecordSend"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22RecordSend\x22|\x27RecordSend\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(SetPort|SetIPAddress)\s*|.*(?P=v)\s*\.\s*(SetPort|SetIPAddress)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22RecordSend\x22|\x27RecordSend\x27)\s*\)(\s*\.\s*(SetPort|SetIPAddress)\s*|.*(?P=n)\s*\.\s*(SetPort|SetIPAddress)\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,27360; reference:cve,2008-0399; classtype:attempted-user; sid:13331; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAEndStyle.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAEndStyle.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAEndStyle.1\x22|\x27DirectAnimation.DAEndStyle.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAEndStyle.1\x22|\x27DirectAnimation.DAEndStyle.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8749; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS ctss.idc access"; flow:to_server,established; content:"/ctss.idc"; fast_pattern; http_uri; reference:nessus,10359; classtype:web-application-activity; sid:1486; rev:14;)
