alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAMontage.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BD6-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BD6-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8804; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 34 ActiveX clsid access"; flow:established,to_client; file_data; content:"BB530C63-D9DF-4B49-9439-63453962E598"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q55>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BB530C63-D9DF-4B49-9439-63453962E598\s*}?\s*(?P=q55)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15642; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Office Web Components 10 Spreadsheet ActiveX clsid access "; flow:established,to_client; file_data; content:"0002E541-0000-0000-C000-000000000046"; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0002E541-0000-0000-C000-000000000046\s*}?\s*(?P=q1)(\s|>)/siO"; metadata:policy balanced-ips drop, policy security-ips alert, service http; reference:cve,2009-2496; reference:url,support.microsoft.com/kb/973472; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-043.mspx; classtype:attempted-user; sid:15685; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX McSubMgr ActiveX CLSID access"; flow:established,to_client; file_data; content:"9be8d7b2-329c-442a-a4ac-aba9d7572602"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*9be8d7b2-329c-442a-a4ac-aba9d7572602/si"; metadata:policy security-ips drop; reference:bugtraq,19265; reference:cve,2006-3961; classtype:attempted-user; sid:7864; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Frame Eater ActiveX clsid access"; flow:established,to_client; file_data; content:"6C68955E-F965-4249-8E18-F0977B1D2899"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*6C68955E-F965-4249-8E18-F0977B1D2899/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7437; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file pamm record exploit attempt"; flow:to_client,established; content:"pamm"; byte_test:4,>,4294967118,20,relative; content:!"|FF FF FF FF|"; within:4; distance:20; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17179; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CLSID_CDIDeviceActionConfigPage ActiveX clsid access"; flow:established,to_client; file_data; content:"18AB439E-FCF4-40D4-90DA-F79BAA3B0655"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*18AB439E-FCF4-40D4-90DA-F79BAA3B0655/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:7999; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI SoftCart.exe CGI buffer overflow attempt"; flow:established,to_server; content:"/SoftCart.exe"; fast_pattern; http_uri; pcre:"/\/SoftCart.exe\?[^\s]{100}/smi"; reference:bugtraq,10926; reference:cve,2004-2221; classtype:web-application-attack; sid:3638; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft DT DDS OrgChart GDD Layout ActiveX object access"; flow:established,to_client; file_data; content:"4CECCEB1-8359-11D0-A34E-00AA00BDCDFD"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*4CECCEB1-8359-11D0-A34E-00AA00BDCDFD/si"; metadata:policy security-ips drop; reference:cve,2006-1186; reference:url,www.microsoft.com/technet/security/bulletin/MS06-013.mspx; classtype:attempted-user; sid:6007; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"WEB-MISC TLSv1 Client_Hello via SSLv2 handshake request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; byte_test:1,>,127,0; content:"|01|"; depth:1; offset:2; content:"|03 01|"; depth:2; offset:3; flowbits:set,tlsv1.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3059; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS MS BizTalk server access"; flow:to_server,established; content:"/biztalkhttpreceive.dll"; fast_pattern; http_uri; reference:bugtraq,7469; reference:bugtraq,7470; reference:cve,2003-0117; reference:cve,2003-0118; reference:nessus,11638; reference:url,www.microsoft.com/technet/security/bulletin/MS03-016.mspx; classtype:web-application-activity; sid:2133; rev:14;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI wayboard attempt"; flow:to_server,established; content:"/way-board/way-board.cgi"; http_uri; content:"db="; content:"../.."; reference:bugtraq,2370; reference:cve,2001-0214; reference:nessus,10610; classtype:web-application-attack; sid:1397; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX EldoS SecureBlackbox PGPBBox ActiveX clsid access"; flow:established,to_client; file_data; content:"C22BB435-9B7F-4B1F-ACBD-CD36D34D6DFF"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C22BB435-9B7F-4B1F-ACBD-CD36D34D6DFF\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SaveToFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C22BB435-9B7F-4B1F-ACBD-CD36D34D6DFF\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(SaveToFile))\s*\(/si"; reference:bugtraq,24882; reference:cve,2007-3785; classtype:attempted-user; sid:12091; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT javascript uuencoded noop sled attempt"; flow:to_client,established; content:"unescape"; content:"%u9090%u9090"; distance:0; pcre:"/unescape\s*\x28[\x22\x27]\s*\x25u9090\x25u9090/i"; metadata:policy security-ips drop; classtype:misc-activity; sid:19074; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows MSXML2 ActiveX malformed HTTP response"; flow:to_client,established; content:"HTTP 99|0A|"; depth:8; reference:cve,2010-2561; reference:url,www.microsoft.com/technet/security/bulletin/ms10-051.mspx; classtype:attempted-dos; sid:18961; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Internet Explorer 8 ieshims.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|ieshims.dll"; http_uri; reference:bugtraq,46159; reference:cve,2011-0038; reference:url,www.microsoft.com/technet/security/bulletin/ms11-003.mspx; classtype:attempted-user; sid:19171; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC IBM WebSphere Expect header cross-site scripting"; flow:established,to_server; content:"Expect|3A|"; http_header; content:"<script>"; http_header; pcre:"/^Expect\x3A[^\r\n]+<script>/smiH"; metadata:policy security-ips drop; reference:bugtraq,26457; reference:cve,2007-5944; classtype:web-application-attack; sid:18742; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare Vielib.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"7B9C5422-39AA-4C21-BEEF-645E42EB4529"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7B9C5422-39AA-4C21-BEEF-645E42EB4529\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(StartProcess)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7B9C5422-39AA-4C21-BEEF-645E42EB4529\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(StartProcess))\s*\(/Osi"; reference:bugtraq,25118; reference:cve,2007-4058; classtype:attempted-user; sid:12203; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Download Manger dm.ini stack overflow attempt"; flow:to_client,established; content:"<?aom"; content:"<url>"; isdataat:271; content:!"</url>"; within:271; metadata:policy security-ips drop; reference:bugtraq,21453; reference:cve,2006-5856; classtype:attempted-user; sid:9637; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla products graphics and XML features integer overflows attempt"; flow:to_client,established; content:"<?xml"; content:"<svg"; distance:0; content:"<filter"; distance:0; pcre:"/^[^\x3E]*(width|height)\s*\x3D\s*(\x22|\x27)([3-9]\d{4}|\d{6})/R"; metadata:policy security-ips drop; reference:bugtraq,16476; reference:cve,2006-0297; classtype:attempted-user; sid:16037; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows CSRSS SrvDeviceEvent exploit attempt"; flow:to_client,established; flowbits:isset,file.exe; content:"|06 7C BD EB 05 BA CC CC CC CC 8B 75 08 33 FF 8B C6 85 F6 74 56 8B 40 04 47 85 C0 75 F8 85 F6 74 4A 39 16 75 0F 39 56 14 75 0A 39 56 18 75 05 39|"; fast_pattern:only; reference:cve,2011-1967; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-063.mspx; classtype:attempted-user; sid:19680; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Messenger YVerInfo ActiveX clsid access"; flow:established,to_client; file_data; content:"D5184A39-CBDF-4A4F-AC1A-7A45A852C883"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D5184A39-CBDF-4A4F-AC1A-7A45A852C883\s*}?\s*(?P=q6)(\s|>).*(?P=id1)\s*\.\s*(fvCom|info)|<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D5184A39-CBDF-4A4F-AC1A-7A45A852C883\s*}?\s*(?P=q7)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\.(fvCom|info))\s*\(/siO"; reference:bugtraq,25494; reference:cve,2007-4515; reference:url,messenger.yahoo.com/security_update.php?id=082907; classtype:attempted-user; sid:12384; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI Armada Style Master Index directory traversal"; flow:to_server,established; content:"/search.cgi?keys"; http_uri; content:"catigory=../"; reference:bugtraq,1772; reference:cve,2000-0924; reference:nessus,10562; reference:url,www.synnergy.net/downloads/advisories/SLA-2000-16.masterindex.txt; classtype:web-application-attack; sid:1092; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Basic FlexGrid ActiveX function call access "; flow:established,to_client; file_data; content:"MSFlexGridLib.MSFlexGrid"; pcre:"/(?P<c>\w+)\s*=\s*(\x22MSFlexGridLib\.MSFlexGrid(\.\d)?\x22|\x27MSFlexGridLib\.MSFlexGrid(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*FormatString\s*|.*(?P=v)\s*\.\s*FormatString\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22MSFlexGridLib\.MSFlexGrid(\.\d)?\x22|\x27MSFlexGridLib\.MSFlexGrid(\.\d)?\x27)\s*\)(\s*\.\s*FormatString\s*|.*(?P=n)\s*\.\s*FormatString)\s*=/smiO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4253; reference:url,support.microsoft.com/kb/960715; reference:url,www.microsoft.com/technet/security/bulletin/MS08-070.mspx; classtype:attempted-user; sid:15098; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 26 ActiveX clsid access"; flow:established,to_client; file_data; content:"fd1e7da6-fbda-49aa-9488-4a1fc2ec7826"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*fd1e7da6-fbda-49aa-9488-4a1fc2ec7826\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14584; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer span frontier parsing memory corruption"; flow:to_client,established; content:"span"; pcre:"/span\s+ID\s*\x3d\s*(\w+).*\1\s*\x2e\s*\w+\x3d/smi"; metadata:policy security-ips drop; reference:cve,2008-2254; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-045.mspx; classtype:attempted-user; sid:13964; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE author.exe access"; flow:to_server,established; content:"/_vti_bin/_vti_aut/author.exe"; fast_pattern; http_uri; classtype:web-application-activity; sid:952; rev:13;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS foxweb.dll access"; flow:to_server,established; content:"/foxweb.dll"; fast_pattern; http_uri; reference:nessus,11939; classtype:web-application-activity; sid:2322; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer object clone deletion memory corruption attempt - obfuscated"; flow:to_client,established; dsize:<800; content:"<html>"; content:"createElement"; distance:0; content:"cloneNode"; content:"clearAttributes"; content:"CollectGarbage"; content:"</html>"; distance:0; metadata:policy balanced-ips alert, policy security-ips alert, service http; reference:cve,2009-0075; reference:url,www.microsoft.com/technet/security/bulletin/MS09-002.mspx; classtype:attempted-user; sid:16339; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected sPLT overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"sPLT"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6697; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla multiple content-length headers malicious redirect attempt"; flow:to_client,established; content:"Content|2D|Length|3A|"; http_header; content:"|0A|Content|2D|Length|3A|"; distance:0; http_header; reference:cve,2011-3000; classtype:web-application-attack; sid:20585; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX iPIX Media Send Class ActiveX function call access"; flow:established,to_client; file_data; content:"iPIX.Rimfire4.1"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22iPIX\.Rimfire4\.1\x22|\x27iPIX\.Rimfire4\.1\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22iPIX\.Rimfire4\.1\x22|\x27iPIX\.Rimfire4\.1\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,23379; reference:cve,2007-1687; reference:url,www.kb.cert.org/vuls/id/958609; classtype:attempted-user; sid:10473; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE rad fp30reg.dll access"; flow:to_server,established; content:"/fp30reg.dll"; fast_pattern; http_uri; reference:arachnids,555; reference:bugtraq,2906; reference:cve,2001-0341; reference:cve,2003-0822; reference:nessus,10699; reference:url,www.microsoft.com/technet/security/bulletin/MS01-035.mspx; classtype:web-application-activity; sid:1248; rev:24;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox tag order memory corruption attempt"; flow:to_client,established; content:"BGCOLOR=|22|http|3A 22|-|9D 22 22| DP=-|B3| UNITS=|22 E2 E2 E2 E2|"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,17516; reference:cve,2006-0749; classtype:attempted-user; sid:16050; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected iCCP overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"iCCP"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6690; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft DDS Generic Class ActiveX object access"; flow:established,to_client; file_data; content:"4FAAB301-CEF6-477C-9F58-F601039E9B78"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*4FAAB301-CEF6-477C-9F58-F601039E9B78/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4212; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DADashStyle.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DADashStyle.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DADashStyle.1\x22|\x27DirectAnimation.DADashStyle.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DADashStyle.1\x22|\x27DirectAnimation.DADashStyle.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8827; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Repository Collection Definition ActiveX object access"; flow:established,to_client; file_data; content:"6E22710A-F799-11CF-9227-00AA00A1EB95"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*6E22710A-F799-11CF-9227-00AA00A1EB95/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4907; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX BarcodeWiz ActiveX clsid access"; flow:established,to_client; file_data; content:"CD3B09F1-26FB-41CD-B3F2-E178DFD3BCC6"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CD3B09F1-26FB-41CD-B3F2-E178DFD3BCC6\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Verify)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CD3B09F1-26FB-41CD-B3F2-E178DFD3BCC6\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Verify))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,23891; reference:url,moaxb.blogspot.com/2007/05/moaxb-09-barcodewiz-activex-control-20.html; classtype:attempted-user; sid:11259; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC pajax call_dispatcher remote exec attempt"; flow:to_server,established; content:"pajax_call_dispatcher.php"; http_uri; pcre:"/\x22method\x22\s*\x3a\s*\x22[^\x22]*\x3b\s*system\s*\x28/smi"; reference:bugtraq,17519; reference:cve,2006-1551; reference:url,www.redteam-pentesting.de/advisories/rt-sa-2006-001.php; classtype:attempted-user; sid:9620; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player ActionScript 3 buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|E9 3F 00 00 00 00 00 00 D0 3F 33 33 33 33 33 33 E3 3F 7B 14 AE 47 E1 7A A4 3F 66 66 66 66 66 66 F6 3F 9A 99 99 99 99 99 B9 3F EB 09 00 07 42 6F 6F 6C 65 61 6E 04 76 6F 69 64 03 69 6E 74 0B 66|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2415; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19683; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX PSTypeComp ActiveX object access"; flow:established,to_client; file_data; content:"00020425-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*00020425-0000-0000-C000-000000000046/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4898; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Outlook View OVCtl ActiveX clsid access"; flow:established,to_client; file_data; content:"0006F063-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0006F063-0000-0000-C000-000000000046\s*}?\s*\1/si"; metadata:policy security-ips drop; reference:bugtraq,3025; reference:bugtraq,3026; reference:cve,2001-0538; reference:url,browserfun.blogspot.com/2006/07/mobb-20-ovctl-newdefaultitem.html; reference:url,osvdb.org/27112; reference:url,www.microsoft.com/technet/security/bulletin/MS01-038.mspx; classtype:attempted-user; sid:8422; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape Enterprise directory listing attempt"; flow:to_server,established; content:"INDEX "; depth:6; reference:bugtraq,2285; reference:cve,2001-0250; reference:nessus,10691; classtype:web-application-attack; sid:1048; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DigWebX MSN ActiveX object access"; flow:established,to_client; file_data; content:"FF2BBC4A-6881-4294-BE0C-17535B1FCCFA"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*FF2BBC4A-6881-4294-BE0C-17535B1FCCFA/si"; metadata:policy security-ips drop; reference:bugtraq,13946; reference:url,www.microsoft.com/technet/security/bulletin/MS05-025.mspx; classtype:attempted-user; sid:4161; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC logicworks.ini access"; flow:to_server,established; content:"/logicworks.ini"; http_uri; reference:bugtraq,6996; reference:nessus,11639; classtype:web-application-activity; sid:2138; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DExplore.AppObj.8.0 ActiveX clsid access"; flow:established,to_client; file_data; content:"639F725F-1B2D-4831-A9FD-874847682010"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*639F725F-1B2D-4831-A9FD-874847682010/si"; metadata:policy security-ips drop; reference:url,metasploit.com/projects/Framework/modules/exploits/ie_createobject.pm; classtype:attempted-user; sid:8365; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Internet Explorer Outllib.dll ActiveX object access"; flow:established,to_client; file_data; content:"0006F02A-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*0006F02A-0000-0000-C000-000000000046/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4222; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word document stream handling code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|A8 00 00 00 00 00 00 00 41 41 41 41 10 00 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,25567; reference:cve,2007-0870; classtype:attempted-user; sid:17368; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Adobe Premier Pro iacenc.dll dll-load exploit attempt"; flow:to_server,established; content:"iacenc.dll"; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3150; reference:url,osvdb.org/show/osvdb/67554; classtype:attempted-user; sid:18531; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI dfire.cgi access"; flow:to_server,established; content:"/dfire.cgi"; fast_pattern; http_uri; reference:bugtraq,564; reference:cve,1999-0913; classtype:web-application-activity; sid:1219; rev:18;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer cross domain setExpression exploit attempt"; flow:to_client,established; content:"setexpression"; content:"clearattributes"; distance:0; fast_pattern; pcre:"/(\w+)\x2Esetexpression\s*\x28\x29.+\1\x2Eclearattributes\s*\x28\x29/smi"; metadata:policy security-ips drop; reference:cve,2008-3476; reference:url,www.microsoft.com/technet/security/bulletin/MS08-058.mspx; classtype:attempted-user; sid:14645; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Oracle Java Runtime CMM readMabCurveData buffer overflow attempt"; flow:to_client, established; content:"curv|00 00 00 00|"; byte_test:4,>,0x1015,0,relative; metadata:policy security-ips drop; reference:bugtraq,39069; reference:cve,2010-0838; classtype:attempted-user; sid:18803; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC google proxystylesheet arbitrary command execution attempt"; flow:to_server,established; content:"proxystylesheet"; http_uri; content:"/search"; http_uri; pcre:"/proxystylesheet=[-a-z0-9_\.]*[^-a-z0-9_\.&\s]/sUmi"; reference:bugtraq,15509; reference:cve,2005-3757; reference:url,metasploit.com/research/vulns/google_proxystylesheet/; classtype:web-application-attack; sid:11223; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle JRE Java Platform SE and Java Deployment Toolkit plugins code execution attempt - npruntime-scriptable-plugin"; flow:to_client,established; content:"application/npruntime-scriptable-plugin|3B|deploymenttoolkit"; content:"-J-jar"; pcre:"/http\x3A\s+-J-jar\s+-J[^\s]+\x2Ejar/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16549; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java Web Start Splashscreen PNG processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; within:16; pcre:"/^([^\x00]|\x00[^\x00]|.{4}[^\x00]|.{4}\x00[^\x00]|.{8}[\x11-\xff])/Rs"; metadata:policy security-ips drop; reference:bugtraq,34240; reference:cve,2009-1097; classtype:attempted-user; sid:16716; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Chilkat HTTP 1 ActiveX clsid access"; flow:established,to_client; file_data; content:"39E861BD-E606-4733-8C79-FADDFD61DC8A"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m5>\x22|\x27|)(?P<id1>.+?)(?P=m5)(\s|>)[^>]*\s*classid\s*=\s*(?P<q9>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*39E861BD-E606-4733-8C79-FADDFD61DC8A\s*}?\s*(?P=q9)(\s|>).*(?P=id1)\s*\.\s*(SaveLastError)|<object\s*[^>]*\s*classid\s*=\s*(?P<q10>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*39E861BD-E606-4733-8C79-FADDFD61DC8A\s*}?\s*(?P=q10)(\s|>)[^>]*\s*id\s*=\s*(?P<m6>\x22|\x27|)(?P<id2>.+?)(?P=m6)(\s|>).*(?P=id2)\.(SaveLastError))\s*\(/si"; metadata:policy security-ips alert; reference:bugtraq,28546; reference:cve,2008-1647; classtype:attempted-user; sid:13685; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI spin_client.cgi access"; flow:to_server,established; content:"/spin_client.cgi"; http_uri; reference:nessus,10393; classtype:web-application-activity; sid:1496; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION mainframeset access"; flow:to_server,established; content:"/cfdocs/examples/mainframeset.cfm"; fast_pattern; http_uri; reference:bugtraq,550; reference:cve,1999-0760; classtype:attempted-recon; sid:925; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Internet Explorer Blnmgrps.dll ActiveX object access"; flow:established,to_client; file_data; content:"F27CE930-4CA3-11D1-AFF2-006097C9A284"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*F27CE930-4CA3-11D1-AFF2-006097C9A284/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4199; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel FngGroupCount record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|9C 00 02 00|"; byte_test:2,>,14,0,relative,little; byte_test:2,!=,16,0,relative,little; reference:bugtraq,18890; reference:cve,2006-1308; reference:cve,2008-0320; classtype:attempted-user; sid:7205; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CheckedListViewWnd Class ActiveX function call access"; flow:established,to_client; file_data; content:"Vmappsdk.CheckedListViewWnd"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Vmappsdk\.CheckedListViewWnd\x22|\x27Vmappsdk\.CheckedListViewWnd\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Vmappsdk\.CheckedListViewWnd\x22|\x27Vmappsdk\.CheckedListViewWnd\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14540; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealPlayer RAM Download Handler ActiveX function call access"; flow:established,to_client; file_data; content:"rmocx.RealPlayer RAM Download Handler"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22rmocx\.RealPlayer\s*RAM\s*Download\s*Handler\x22|\x27rmocx\.RealPlayer\s*RAM\s*Download\s*Handler\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(Console|Controls)\s*|.*(?P=v)\s*\.\s*(Console|Controls)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22rmocx\.RealPlayer\s*RAM\s*Download\s*Handler\x22|\x27rmocx\.RealPlayer\s*RAM\s*Download\s*Handler\x27)\s*\)(\s*\.\s*(Console|Controls)\s*|.*(?P=n)\s*\.\s*(Console|Controls))\s*=/Osmi"; metadata:policy security-ips alert; reference:bugtraq,28157; reference:cve,2008-1309; reference:url,www.kb.cert.org/vuls/id/831457; classtype:attempted-user; sid:13605; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp AMF file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.amf; file_data; content:"AMF"; depth:3; byte_test:1,<,12,3; byte_test:1,>,16,40; reference:url,forums.winamp.com/showthread.php?t=332010; reference:url,www.osvdb.org/show/osvdb/76635; classtype:attempted-user; sid:20565; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Basic 6 TLIApplication ActiveX clsid access"; flow:established,to_client; file_data; content:"8B21775E-717D-11CE-AB5B-D41203C10000"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2007-2216; reference:url,www.microsoft.com/technet/security/bulletin/ms07-045.mspx; classtype:attempted-user; sid:12269; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT JPEG parser multipacket heap overflow"; flow:to_client,established; flowbits:isset,file.jpeg; content:"|FF|"; pcre:"/\xFF[\xE1\xE2\xED\xFE]\x00[\x00\x01]/"; metadata:policy security-ips drop; reference:bugtraq,11173; reference:cve,2004-0200; reference:url,www.microsoft.com/security/bulletins/200409_jpeg.mspx; classtype:attempted-admin; sid:2707; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC ans.pl attempt"; flow:to_server,established; content:"/ans.pl?p=../../"; http_uri; reference:bugtraq,4147; reference:bugtraq,4149; reference:cve,2002-0306; reference:cve,2002-0307; reference:nessus,10875; classtype:web-application-attack; sid:1522; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP eSupportDiagnostics 14 ActiveX clsid access"; flow:established,to_client; file_data; content:"B9C13CD0-5A97-4C6B-8A50-7638020E2462"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q12>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*B9C13CD0-5A97-4C6B-8A50-7638020E2462\s*}?\s*(?P=q12)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28929; reference:cve,2008-0712; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13742; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI loadpage.cgi access"; flow:to_server,established; content:"/loadpage.cgi"; fast_pattern; http_uri; reference:bugtraq,2109; reference:cve,2000-1092; reference:nessus,10065; classtype:web-application-activity; sid:1570; rev:15;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI swsrv.cgi access"; flow:to_server,established; content:"/swsrv.cgi"; fast_pattern; http_uri; reference:bugtraq,7510; reference:cve,2003-0217; reference:nessus,11608; classtype:web-application-activity; sid:2128; rev:13;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC /.... access"; flow:to_server,established; content:"/...."; classtype:attempted-recon; sid:1142; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows DirectX malformed mjpeg arbitrary code execution attempt"; flow:to_client,established; content:"strf"; byte_test:4,>,2147483648,12,little,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0011; reference:url,www.microsoft.com/technet/security/bulletin/MS08-033.mspx; classtype:attempted-user; sid:13824; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer msdds clsid attempt"; flow:to_client,established; content:"EC444CB6-3E7E-4865-B1C3-0DE72EF39B3F"; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*EC444CB6-3E7E-4865-B1C3-0DE72EF39B3F/si"; metadata:policy security-ips drop; reference:bugtraq,14594; reference:cve,2005-1990; reference:cve,2005-2127; reference:url,www.frsirt.com/english/advisories/2005/1450; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-user; sid:4132; rev:8;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Microsoft Office Visio invalid ho tag attempt"; flow:to_client,established; flowbits:isset,visio.request; content:"|0D 14 00 03 00 01 00 16 00 03 00 01 01 02 FF 00 A4 02 A7 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33660; reference:cve,2009-0096; reference:url,www.microsoft.com/technet/security/bulletin/MS09-005; classtype:attempted-user; sid:15299; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Download of PowerPoint 4.0 file"; flow:to_client,established; content:"R|00|o|00|o|00|t|00| |00|E|00|n|00|t|00|r|00|y|00|"; content:"P|00|P|00|4|00|0|00|"; within:8; distance:108; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0220; reference:cve,2009-0223; reference:cve,2009-0226; reference:cve,2009-0227; reference:cve,2009-1137; reference:url,www.microsoft.com/technet/security/bulletin/MS09-017.mspx; classtype:attempted-user; sid:15504; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RemoteBrowseDlg Class ActiveX function call access"; flow:established,to_client; file_data; content:"Vmappsdk.RemoteBrowseDlg"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Vmappsdk\.RemoteBrowseDlg\x22|\x27Vmappsdk\.RemoteBrowseDlg\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Vmappsdk\.RemoteBrowseDlg\x22|\x27Vmappsdk\.RemoteBrowseDlg\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14404; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Photoshop PNG file handling stack buffer overflow attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"PLTE"; byte_test:4,>,768,-8,relative,big; metadata:policy security-ips drop; reference:bugtraq,23698; reference:cve,2007-2365; classtype:attempted-user; sid:11267; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX COWON America JetAudio JetFlExt.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"8D1636FD-CA49-4B4E-90E4-0A20E03A15E8"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8D1636FD-CA49-4B4E-90E4-0A20E03A15E8\s*}?\s*(?P=q1)(\s|>)/si"; reference:bugtraq,25723; reference:cve,2007-4983; classtype:attempted-user; sid:12468; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Potential obfuscated javascript eval unescape attack attempt"; flow:to_client,established; content:"eval|28|"; content:"unescape|28|"; within:15; content:!"|29|"; within:250; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.cs.ucsb.edu/~marco/blog/2008/10/dom-based-obfuscation-in-malicious-javascript.html; classtype:misc-activity; sid:15363; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox image dragging exploit attempt"; flow:to_client,established; content:"|3C|img|20|"; content:"|2E|bat"; distance:0; fast_pattern; pcre:"/\x3cimg\s[^\x3e]*\x2ebat/i"; metadata:policy security-ips drop; reference:cve,2005-0230; classtype:attempted-user; sid:17245; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word TextBox sub-document memory corruption attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|09 04 16 00 22 0C 00 00 80 57 00 00 80 57 00 00 02|"; content:"|00 00 00 00 00 00 00 00 FF FF 0F 00|"; within:12; distance:23; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,23380; reference:cve,2007-1910; classtype:attempted-user; sid:17301; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime movie file component name integer overflow multipacket attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"hdlr"; byte_test:1,>,250,24,relative; metadata:policy security-ips drop; reference:bugtraq,15308; reference:cve,2005-2754; reference:url,docs.info.apple.com/article.html?artnum=302772; classtype:attempted-user; sid:4679; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS bdir.htr access"; flow:to_server,established; content:"/bdir.htr"; fast_pattern; http_uri; reference:bugtraq,2280; reference:nessus,10577; classtype:web-application-activity; sid:1000; rev:19;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer object management memory corruption attempt"; flow:to_client,established; content:".onpropertychange"; content:".attributes"; within:50; content:".onpropertychange"; distance:0; content:"null"; within:50; pcre:"/([A-Z\d_]+)\.onpropertychange\s*=\s*\1\.attributes.*?\1\.onpropertychange\s*=\s*null.*?\1\.onpropertychange/smi"; metadata:policy security-ips drop; reference:cve,2011-1345; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-018.mspx; classtype:attempted-user; sid:18670; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 28 ActiveX clsid access"; flow:established,to_client; file_data; content:"8CC18E3F-4E2B-4D27-840E-CB2F99A3A003"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q41>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8CC18E3F-4E2B-4D27-840E-CB2F99A3A003\s*}?\s*(?P=q41)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14142; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI MDaemon form2raw.cgi access"; flow:to_server,established; content:"/form2raw.cgi"; fast_pattern:only; reference:bugtraq,9317; reference:cve,2003-1200; reference:url,secunia.com/advisories/10512/; classtype:web-application-activity; sid:2434; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI test-cgi attempt"; flow:to_server,established; content:"/test-cgi/*?*"; fast_pattern; http_uri; reference:arachnids,218; reference:bugtraq,2003; reference:cve,1999-0070; reference:nessus,10282; classtype:web-application-attack; sid:1644; rev:15;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Novell Groupwise gwweb.exe access"; flow:to_server,established; content:"/GWWEB.EXE"; reference:bugtraq,879; reference:cve,1999-1005; reference:cve,1999-1006; reference:nessus,10877; classtype:attempted-recon; sid:1165; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI bb-histsvc.sh access"; flow:to_server,established; content:"/bb-histsvc.sh"; fast_pattern; http_uri; reference:bugtraq,142; reference:cve,1999-1462; classtype:attempted-recon; sid:1460; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX reconfig.GuestInfo ActiveX function call access"; flow:established,to_client; file_data; content:"reconfig.GuestInfo"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22reconfig\.GuestInfo\x22|\x27reconfig\.GuestInfo\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22reconfig\.GuestInfo\x22|\x27reconfig\.GuestInfo\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14478; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT known JavaScript obfuscation routine"; flow:to_client,established; content:"String.fromCharCode|28|parseInt"; content:"String.fromCharCode|28|"; within:1000; content:".charCodeAt|28|"; within:100; content:".replace"; within:100; pcre:"/\.replace\x28\x2F[^\x2F]+\x2F[A-Z]*\x2C(\x22\x22|\x27\x27)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:attempted-user; sid:17111; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word array data handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|01 00 00 02 01 00 00 9E 01 00 00 02 01 00 00 96 01 00 00 FF|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,23804; reference:cve,2007-0035; classtype:attempted-user; sid:17649; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VhdCvtCom.VhdConverter ActiveX function call access"; flow:established,to_client; file_data; content:"VhdCvtCom.VhdConverter"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22VhdCvtCom\.VhdConverter\x22|\x27VhdCvtCom\.VhdConverter\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22VhdCvtCom\.VhdConverter\x22|\x27VhdCvtCom\.VhdConverter\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14486; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft MHTML XSS attempt"; flow:to_client,established; file_data; content:"mhtml"; fast_pattern; pcre:"/^\x3A(http|file)\x3A\x2F\x2F/Rsmi"; reference:cve,2011-0096; reference:url,www.microsoft.com/technet/security/bulletin/MS11-026.mspx; classtype:attempted-user; sid:18335; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Lotus Notes .pl script source download attempt"; flow:to_server,established; content:".pl"; http_uri; content:".pl"; content:"."; within:1; reference:bugtraq,6841; classtype:web-application-attack; sid:2066; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FFmpeg OGV file format memory corruption attempt"; flow:to_client,established; content:"OggS"; content:"|82|theora"; distance:0; byte_test:1,!&,0xE0,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36465; reference:url,secunia.com/advisories/36805; classtype:attempted-user; sid:16353; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI sdbsearch.cgi access"; flow:to_server,established; content:"/sdbsearch.cgi"; fast_pattern; http_uri; reference:bugtraq,1658; reference:cve,2001-1130; reference:nessus,10503; reference:nessus,10720; classtype:attempted-recon; sid:1476; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 37 ActiveX clsid access"; flow:established,to_client; file_data; content:"47AF06DD-8E1B-4CA4-8F55-6B1E9FF36ACB"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q61>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*47AF06DD-8E1B-4CA4-8F55-6B1E9FF36ACB\s*}?\s*(?P=q61)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14160; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC WinProxy overly long host header buffer overflow attempt"; flow:to_server,established; content:"Host|3A|"; http_header; pcre:"/^Host\x3A\s+[A-Z\d\x5F\x2E\x2E]*\x3A[^\r\n]{100}/smiH"; reference:bugtraq,16147; reference:cve,2005-4085; reference:url,www.bluecoat.com/support/knowledge/advisory_host_header_stack_overflow.html; classtype:attempted-admin; sid:5997; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC sresult.exe access"; flow:to_server,established; content:"/sresult.exe"; http_uri; reference:bugtraq,10837; reference:nessus,14186; classtype:web-application-activity; sid:2672; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI AT-admin.cgi access"; flow:to_server,established; content:"/AT-admin.cgi"; fast_pattern; http_uri; reference:cve,1999-1072; classtype:attempted-recon; sid:845; rev:14;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 38292 (msg:"WEB-MISC Symantec Alert Management System pin number buffer overflow attempt"; flow:to_server,established; content:"|FF FF FF FF|"; depth:4; content:"PAGE"; depth:4; offset:30; content:"PinNumber|00|"; distance:0; byte_test:2,>,256,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2010-0110; reference:url,www.symantec.com/business/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=2011&suid=20110126_00; classtype:attempted-user; sid:18460; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 457 (msg:"WEB-MISC Netscape Unixware overflow"; flow:to_server,established; content:"|EB|_|9A FF FF FF FF 07 FF C3|^1|C0 89|F|9D|"; reference:arachnids,180; reference:bugtraq,908; reference:cve,1999-0744; classtype:attempted-recon; sid:1132; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX BOWebAgent.Webagent.1 ActiveX function call access"; flow:established,to_client; file_data; content:"BOWebAgent.Webagent.1"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22BOWebAgent.Webagent.1\x22|\x27BOWebAgent.Webagent.1\x27)\s*\x3b.*(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)(\s*\.\s*(DownloadAndExecute|AddFileEx)\s*\(|.*\3\s*\.\s*(DownloadAndExecute|AddFileEx)\s*\()|(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BOWebAgent.Webagent.1\x22|\x27BOWebAgent.Webagent.1\x27)\s*\)(\s*\.\s*(DownloadAndExecute|AddFileEx)\s*\(|.*\7\s*\.\s*(DownloadAndExecute|AddFileEx)\s*\()/smi"; metadata:policy security-ips drop; classtype:attempted-user; sid:8737; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows malformed shortcut file buffer overflow attempt"; flow:to_client,established; content:"L|00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00|F"; byte_test:1,!&,4,0,relative,little; byte_jump:2,56,relative,little; byte_jump:2,0,relative,little; byte_jump:2,-2,relative,multiplier 2,little; byte_jump:2,0,relative,multiplier 2,little; byte_jump:2,0,relative,little; content:"|CC 00 00 00|"; within:4; distance:-2; isdataat:72,relative; content:!"|00 00|"; within:32; distance:40; metadata:policy security-ips drop; reference:bugtraq,15069; reference:bugtraq,15070; reference:cve,2005-2118; reference:cve,2005-2122; reference:url,www.microsoft.com/technet/security/bulletin/MS05-049.mspx; classtype:attempted-user; sid:4643; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"WEB-MISC Delegate whois overflow attempt"; flow:to_server,established; content:"whois|3A|//"; reference:cve,2000-0165; reference:nessus,10054; classtype:web-application-activity; sid:1558; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer argument validation in print preview handling vulnerability"; flow:to_client,established; content:"|2E|ExecWB"; pcre:"/\x2eExecWB\s*\x28(IDM_PRINTPREVIEW|7)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-2259; reference:url,www.microsoft.com/technet/security/bulletin/ms08-045.mspx; classtype:attempted-user; sid:13963; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed Label record exploit attempt"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|09 08 08 00 00 05 05 00|"; content:"|04 02|"; distance:0; byte_test:1,&,0x80,9,relative; byte_test:2,>,8,0,relative,little; byte_test:2,<,8225,0,relative,little; metadata:policy security-ips drop; reference:cve,2004-0846; reference:cve,2011-0098; reference:url,www.microsoft.com/technet/security/bulletin/MS04-033.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS11-021.mspx; classtype:attempted-user; sid:18632; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player zero length bitmap heap overflow attempt"; flow:to_client,established; flowbits:isset,http.bmp; file_data; content:"BM|00 00 00 00|"; depth:6; pcre:"/^BM\x00\x00\x00\x00/sm"; metadata:policy security-ips drop; reference:bugtraq,16633; reference:cve,2006-0006; reference:url,www.eeye.com/html/research/advisories/AD20060214.html; reference:url,www.microsoft.com/technet/security/bulletin/ms06-005.mspx; classtype:attempted-admin; sid:5711; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FeedDemon unicode OPML file handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|3C 00|o|00|p|00|m|00|l|00|"; content:"|3C 00|o|00|u|00|t|00|l|00|i|00|n|00|e|00|"; distance:0; pcre:"/[^\x3E]*?t\x00e\x00x\x00t\x00(\s\x00)*\x3D\x00(\s\x00)*(\x27\x00(?!(..){0,500}\x27\x00)|\x22\x00(?!(..){0,500}\x22\x00)|(?!(..){0,500}\s\x00))/isOR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33630; reference:cve,2009-0546; classtype:attempted-user; sid:17105; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI CCBill whereami.cgi access"; flow:to_server,established; content:"/whereami.cgi"; fast_pattern; http_uri; reference:bugtraq,8095; reference:url,secunia.com/advisories/9191/; classtype:web-application-activity; sid:2397; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Plugin JavaScript parameter double free attempt"; flow:to_client,established; content:".pdf|23|"; content:"document."; distance:0; pcre:"/\x2Epdf\x23[^\r\n]+\x3Djavascript\x3A[^\r\n]*document\x2E\w+/smi"; metadata:policy security-ips drop; reference:cve,2007-0046; reference:url,www.adobe.com/support/security/advisories/apsa07-01.html; classtype:attempted-user; sid:9843; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI cached_feed.cgi moreover shopping cart access"; flow:to_server,established; content:"/cached_feed.cgi"; http_uri; reference:bugtraq,1762; reference:cve,2000-0906; classtype:web-application-activity; sid:2051; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CheckedListViewWnd Class ActiveX clsid access"; flow:established,to_client; file_data; content:"e3aa8d10-02e2-4615-b524-908a3b8716e9"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*e3aa8d10-02e2-4615-b524-908a3b8716e9\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14538; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX 4xem VatCtrl ActiveX function call access"; flow:established,to_client; file_data; content:"VATDecoder.VatCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22VATDecoder\.VatCtrl\x22|\x27VATDecoder\.VatCtrl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*url\s*|.*(?P=v)\s*\.\s*url\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22VATDecoder\.VatCtrl\x22|\x27VATDecoder\.VatCtrl\x27)\s*\)(\s*\.\s*url\s*|.*(?P=n)\s*\.\s*url)\s*=/smi"; metadata:policy security-ips drop; reference:bugtraq,28010; classtype:attempted-user; sid:13533; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Virtual Machine ActiveX clsid access"; flow:established,to_client; file_data; content:"0D43FE01-F093-11CF-8940-00A0C9054228"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*0D43FE01-F093-11CF-8940-00A0C9054228/si"; reference:bugtraq,1754; reference:cve,2000-1061; reference:url,www.microsoft.com/technet/security/bulletin/ms00-075.mspx; classtype:attempted-user; sid:8069; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word information string overflow attempt"; flow:to_client,established; file_data; content:"|E0 85 9F F2 F9|Oh|10 AB 91 08 00|+'|B3 D9|"; content:"|1E 00 00 00|"; distance:0; byte_test:4,>,2147483646,0,relative; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7203; rev:4;)
alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-MISC excessive HTTP 304 Not Modified responses exploit attempt"; flow:to_client,established,only_stream; content:"HTTP/1.1 304 Not Modified"; detection_filter:track by_dst, count 40, seconds 1; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0947; reference:cve,2007-6239; classtype:misc-activity; sid:16008; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel rtWnDesk record memory corruption exploit attempt"; flow:to_client,established; content:"8|00 04 00|"; byte_test:2,>,32767,0,relative,little; flowbits:isset,http.xlw; reference:cve,2007-3890; reference:url,www.microsoft.com/technet/security/Bulletin/ms07-044.mspx; classtype:attempted-user; sid:12284; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC L3retriever HTTP Probe"; flow:to_server,established; content:"User-Agent|3A| Java1.2.1|0D 0A|"; http_header; reference:arachnids,310; classtype:web-application-activity; sid:1100; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI anform2 access"; flow:to_server,established; content:"/AnForm2"; fast_pattern; http_uri; reference:arachnids,225; reference:bugtraq,719; reference:cve,1999-0066; classtype:attempted-recon; sid:843; rev:16;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION parks access"; flow:to_server,established; content:"/cfdocs/examples/parks/detail.cfm"; fast_pattern; http_uri; reference:bugtraq,550; reference:cve,1999-0760; classtype:attempted-recon; sid:912; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player directory traversal via Content-Disposition attempt"; flow:to_client,established; content:".wmz"; fast_pattern; http_header; content:"Content-Disposition|3A|"; http_header; content:"filename="; http_header; pcre:"/filename=[^\x3b\x3a\r\n]*(\x25\x2e\x25\x2e\x25\x5c|\x25\x32\x65\x25\x35\x63|\x2e\x2e\x5c)[^\x3b\x3a\r\n]*\x2ewmz/smiH"; reference:bugtraq,7517; reference:cve,2003-0228; reference:nessus,11595; reference:url,www.microsoft.com/technet/security/bulletin/MS03-017.mspx; classtype:attempted-user; sid:3192; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CA DSM gui_cm_ctrls ActiveX function call access"; flow:established,to_client; file_data; content:"CommonActiveX.ITRMLegendsCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22CommonActiveX\.ITRMLegendsCtrl\x22|\x27CommonActiveX\.ITRMLegendsCtrl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(SetColumnColor|SetColumnLabel)\s*|.*(?P=v)\s*\.\s*(SetColumnColor|SetColumnLabel)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22CommonActiveX\.ITRMLegendsCtrl\x22|\x27CommonActiveX\.ITRMLegendsCtrl\x27)\s*\)(\s*\.\s*(SetColumnColor|SetColumnLabel)\s*|.*(?P=n)\s*\.\s*(SetColumnColor|SetColumnLabel)\s*)\s*\(/Osmi"; metadata:policy security-ips drop; reference:bugtraq,28809; reference:cve,2008-1786; classtype:attempted-user; sid:14027; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Animation Control ActiveX clsid access"; flow:established,to_client; file_data; content:"1E216240-1B7D-11CF-9D53-00AA003C9CB6"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*1E216240-1B7D-11CF-9D53-00AA003C9CB6\s*}?\s*(?P=q1)(\s|>)/siO"; metadata:policy security-ips drop; reference:url,support.microsoft.com/kb/960715; classtype:attempted-user; sid:15307; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MSAuth ActiveX clsid access"; flow:established,to_client; file_data; content:"D4FE6227-1288-11D0-9097-00AA004254A0"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D4FE6227-1288-11D0-9097-00AA004254A0\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SaveAs)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D4FE6227-1288-11D0-9097-00AA004254A0\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(SaveAs))\s*\(/si"; metadata:policy security-ips drop; reference:cve,2007-2221; reference:url,www.microsoft.com/technet/security/bulletin/ms07-027.mspx; classtype:attempted-user; sid:11224; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel ExternName record stack buffer overflow attempt - 1"; flow:to_client,established; flowbits:isset,http.xls; content:"|AE 01|"; byte_jump:2,0,relative,little; content:"|23 00|"; within:2; byte_test:2,>,250,0,relative,little; byte_test:2,<,8225,0,relative,little; byte_test:1,!&,0x01,0,relative; byte_test:1,!&,0x01,7,relative; byte_test:1,!&,0x08,7,relative; content:"|01|"; within:1; distance:10; reference:cve,2010-1249; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16650; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Access Wizard control memory corruption ActiveX clsid access"; flow:to_client,established; flowbits:isset,http.doc; content:"|27 03 23 53 2B 17 D0 11 AD 40 00 A0 C9 0D C8 D9|"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,41442; reference:cve,2010-1881; classtype:attempted-user; sid:19141; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC sqlmap SQL injection scan attempt"; flow:established,to_server; content:"User-Agent|3A| sqlmap"; fast_pattern:only; http_header; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,sqlmap.sourceforge.net; classtype:web-application-activity; sid:19779; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WM TV Out Smooth Picture Filter ActiveX clsid access"; flow:established,to_client; file_data; content:"41D2B841-7692-4C83-AFD3-F60E845341AF"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*41D2B841-7692-4C83-AFD3-F60E845341AF/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7498; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel macro validation arbitrary code execution attempt"; flow:to_client,established; content:"|FF FF FF FF 09 08|"; content:"|00 00|"; within:2; distance:1; content:"|05 00|"; within:2; distance:1; pcre:"/\xff\xff\xff\xff\x09\x08[\x08\x10]\x00\x00[\x05\x06]\x05\x00[^\x85]*\xdf/sm"; reference:cve,2008-0081; reference:url,www.microsoft.com/technet/security/bulletin/MS08-014.mspx; classtype:attempted-user; sid:13569; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft SilverLight ImageSource remote code execution attempt"; flow:to_client,established; flowbits:isset,imagesource.redefine; content:"ImageBrush"; content:"ImageSource"; distance:0; pcre:"/ImageBrush[^\x3e]+ImageSource\s*\x3d\s*(\x22|\x27)/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0019; reference:url,www.microsoft.com/technet/security/bulletin/MS10-060.mspx; classtype:attempted-user; sid:17114; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Kaspersky Online Scanner KAVWebScan.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"0EB0E74A-2A76-4AB3-A7FB-9BD8C29F7F75"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0EB0E74A-2A76-4AB3-A7FB-9BD8C29F7F75\s*}?\s*(?P=q1)(\s|>)/si"; reference:bugtraq,26004; reference:cve,2007-3675; classtype:attempted-user; sid:12637; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 9999 (msg:"WEB-MISC MySQL MaxDB WebSQL wppassword buffer overflow default port"; flow:to_server,established; content:"websql?logon"; content:"wqPassword="; distance:0; pcre:"/wqPassword=[^\r\n\x26]{294}/i"; reference:bugtraq,12265; reference:cve,2005-0111; reference:url,www.osvdb.org/displayvuln.php?osvdb_id=12919; classtype:web-application-attack; sid:3519; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Domino mail.box access"; flow:to_server,established; content:"/mail.box"; http_uri; reference:bugtraq,881; reference:nessus,10629; classtype:attempted-recon; sid:1586; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader CCITT stream compression filter invalid image size heap overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|2F|CCITTFaxDecode"; content:"|2F|Columns"; within:500; byte_test:10,>,65535,0,relative,string; pcre:"/\x2FCCITTFaxDecode[^\x3E]*\x2fColumns\s+\d{5}/i"; reference:cve,2011-0567; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18507; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Akamai DownloadManager ActiveX clsid access"; flow:established,to_client; file_data; content:"FFBB3F3B-0A5A-4106-BE53-DFE1E2340CB1"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q9>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*FFBB3F3B-0A5A-4106-BE53-DFE1E2340CB1\s*}?\s*(?P=q9)(\s|>)/siO"; metadata:policy security-ips drop; reference:url,support.microsoft.com/kb/960715; classtype:attempted-user; sid:15315; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Black Ice Barcode SDK ActiveX clsid access"; flow:established,to_client; file_data; content:"79956462-F148-497F-B247-DF35A095F80B"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*79956462-F148-497F-B247-DF35A095F80B\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(DownloadImageFileURL)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*79956462-F148-497F-B247-DF35A095F80B\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(DownloadImageFileURL))/siO"; metadata:policy security-ips drop; reference:cve,2008-2683; classtype:attempted-user; sid:20285; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView Network Node Manager ovwebsnmpsrv.exe displayWidth buffer overflow attempt - POST"; flow:to_server,established; content:"|2F|OvCgi|2F|jovgraph.exe"; http_uri; content:"displayWidth"; http_client_body; pcre:"/(displayWidth[\x2b\x20]\d[^\x2b\s\n]{128})/sP"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,45762; reference:cve,2011-0262; classtype:attempted-user; sid:18759; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer cross domain unfocusable HTML element"; content:"tabindex"; fast_pattern:only; content:"Content-Type|3A| text/html"; pcre:"/<s*(div|span|p)\s+[^>]*tabindex/smi"; reference:cve,2008-3472; reference:url,www.microsoft.com/technet/security/bulletin/MS08-058.mspx; classtype:attempted-user; sid:14644; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Sun Java System Web Server 7.0u7 authorization digest heap overflow"; flow:to_server,established; content:!"GET"; http_method; content:!"POST"; http_method; content:"Authorization"; content:"Digest"; distance:0; fast_pattern; pcre:"/^Authorization\s*\x3A\s*Digest\s+([^\n\x2C]*\x2C){15}/im"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37896; reference:cve,2010-0387; classtype:attempted-user; sid:16392; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Address Book msoeres32.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|msoeres32.dll"; http_uri; reference:cve,2010-3147; reference:cve,2011-2016; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-096.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-085.mspx; classtype:attempted-user; sid:18205; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Marquee Control ActiveX object access"; flow:established,to_client; file_data; content:"250770F3-6AF2-11CF-A915-008029E31FCD"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*250770F3-6AF2-11CF-A915-008029E31FCD/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4203; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAJoinStyle.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAJoinStyle.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAJoinStyle.1\x22|\x27DirectAnimation.DAJoinStyle.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAJoinStyle.1\x22|\x27DirectAnimation.DAJoinStyle.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8818; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DABoolean.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BC1-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BC1-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8834; rev:5;)
# do we really need two of these?
alert tcp $EXTERNAL_NET any -> $HOME_NET [1521,5560] (msg:"WEB-MISC Oracle Database Server buffer overflow attempt"; flow:established,to_server; content:"DBMS_AQELM"; pcre:"/SET_(SENDFROM|MAILHOST)\x28\x27[^\x27]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,30177; reference:cve,2008-2607; classtype:misc-attack; sid:13951; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Facebook Photo Uploader ActiveX function call access"; flow:established,to_client; file_data; content:"TheFacebook.FacebookPhotoUploader4.4.1"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22TheFacebook\.FacebookPhotoUploader4\.4\.1\x22|\x27TheFacebook\.FacebookPhotoUploader4\.4\.1\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(Action|ExtractExif|ExtractIptc|FileMask)\s*|.*(?P=v)\s*\.\s*(Action|ExtractExif|ExtractIptc|FileMask)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22TheFacebook\.FacebookPhotoUploader4\.4\.1\x22|\x27TheFacebook\.FacebookPhotoUploader4\.4\.1\x27)\s*\)(\s*\.\s*(Action|ExtractExif|ExtractIptc|FileMask)\s*|.*(?P=n)\s*\.\s*(Action|ExtractExif|ExtractIptc|FileMask))\s*=/siO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,27534; reference:bugtraq,27756; reference:cve,2008-5711; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13421; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows uniscribe fonts parsing memory corruption attempt"; flow:to_client,established; content:"url|28|data|3A|font|2F|ttf|3B|"; content:"base64|2C|AAEAAAAT"; within:15; content:"A2hMVFNI5UGsngAA"; within:16; distance:48; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2738; reference:url,www.microsoft.com/technet/security/bulletin/MS10-063.mspx; classtype:attempted-user; sid:17256; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Symantec SupportSoft SmartIssue ActiveX clsid access"; flow:established,to_client; file_data; content:"01010e00-5e80-11d8-9e86-0007e96c65ae"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*01010e00-5e80-11d8-9e86-0007e96c65ae\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(EnableExtension)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*01010e00-5e80-11d8-9e86-0007e96c65ae\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(EnableExtension))\s*\(/siO"; reference:bugtraq,22564; reference:cve,2006-6490; reference:url,securityresponse.symantec.com/avcenter/security/Content/2007.02.22.html; classtype:attempted-user; sid:10393; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT readme.eml download attempt"; flow:to_server,established; content:"/readme.eml"; http_uri; reference:url,www.cert.org/advisories/CA-2001-26.html; classtype:attempted-user; sid:1284; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Citrix.ICAClient ActiveX function call access"; flow:established,to_client; file_data; content:"Citrix.ICAClient"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Citrix\.ICAClient(\.\d)?\x22|\x27Citrix\.ICAClient(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SendChannelData\s*|.*(?P=v)\s*\.\s*SendChannelData\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Citrix\.ICAClient(\.\d)?\x22|\x27Citrix\.ICAClient(\.\d)?\x27)\s*\)(\s*\.\s*SendChannelData\s*|.*(?P=n)\s*\.\s*SendChannelData\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,23246; reference:cve,2006-6334; reference:url,support.citrix.com/article/CTX111827; classtype:attempted-user; sid:9631; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Sony Rootkit Uninstaller ActiveX clsid access"; flow:established,to_client; file_data; content:"4EA7C4C5-C5C0-4F5C-A008-8293505F71CC"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4EA7C4C5-C5C0-4F5C-A008-8293505F71CC\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:url,wiki.castlecops.com/SONY_XCP_DRM_Rootkit_Detection_and_Removal_Instructions; reference:url,www.microsoft.com/technet/security/bulletin/ms05-054.mspx; classtype:attempted-user; sid:11250; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI bigconf.cgi access"; flow:to_server,established; content:"/bigconf.cgi"; http_uri; reference:bugtraq,778; reference:cve,1999-1550; reference:nessus,10027; classtype:web-application-activity; sid:1172; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX NOS Microsystems / Adobe getPlus Download Manager ActiveX clsid access"; flow:established,to_client; file_data; content:"CF40ACC5-E1BB-4aff-AC72-04C2F616BCA7"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CF40ACC5-E1BB-4aff-AC72-04C2F616BCA7\s*}?\s*(?P=q1)(\s|>)/siO"; metadata:policy security-ips alert; reference:bugtraq,32105; reference:cve,2008-4817; classtype:attempted-user; sid:15007; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Help Centre escape sequence XSS attempt"; flow:to_client,established; file_data; content:"hcp|3A 2F 2F|"; content:"script"; distance:0; content:"defer"; distance:0; pcre:"/hcp\x3a\x2f\x2f[^\n]*(\x3c|\x253c)script(\s|\x2520|\x2f)+defer/iO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40725; reference:cve,2010-1885; reference:url,osvdb.org/show/osvdb/65264; reference:url,www.microsoft.com/technet/security/bulletin/MS10-042.mspx; classtype:attempted-user; sid:16665; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Mozilla Firefox browser engine  memory corruption attempt"; flow:to_client, established; content:"first-letter"; content:"direction"; distance:0; content:"rtl"; within:8; content:"whitespace |3D| "; distance:0; content:"pre"; within:10; content:"|3C|span"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,35326; reference:cve,2009-1392; classtype:attempted-user; sid:17613; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAImage.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAImage.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAImage.1\x22|\x27DirectAnimation.DAImage.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAImage.1\x22|\x27DirectAnimation.DAImage.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8821; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows AVI DirectShow quicktime parsing overflow attempt"; flow:to_client,established; content:"moov"; content:"vide"; distance:0; content:"stsd"; distance:0; fast_pattern; byte_test:1,>,31,58,relative,big; metadata:policy balanced-ips alert, policy security-ips alert, service http; reference:bugtraq,35139; reference:cve,2009-1537; reference:url,www.microsoft.com/technet/security/advisory/971778.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS09-028.mspx; classtype:attempted-user; sid:15517; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ICQ Toolbar toolbaru.dll ActiveX function call access"; flow:established,to_client; file_data; content:"XTTB00001.XTTB00001"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22XTTB00001\.XTTB00001\x22|\x27XTTB00001\.XTTB00001\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(IsChecked|GetPropertyById)\s*|.*(?P=v)\s*\.\s*(IsChecked|GetPropertyById)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22XTTB00001\.XTTB00001\x22|\x27XTTB00001\.XTTB00001\x27)\s*\)(\s*\.\s*(IsChecked|GetPropertyById)\s*|.*(?P=n)\s*\.\s*(IsChecked|GetPropertyById)\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,28086; reference:bugtraq,28118; classtype:attempted-user; sid:13597; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3057 (msg:"WEB-MISC Borland StarTeam Multicast Service buffer overflow attempt"; flow:established,to_server; content:"GET AAAAAAAAAAAAAAAAAAAAA"; depth:25; reference:bugtraq,28602; reference:cve,2008-0311; classtype:attempted-admin; sid:16283; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Kingsoft Antivirus Online Update Module ActiveX clsid access"; flow:established,to_client; file_data; content:"D82303B7-A754-4DCB-8AFC-8CF99435AACE"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D82303B7-A754-4DCB-8AFC-8CF99435AACE\s*}?\s*(?P=q6)(\s|>).*(?P=id1)\s*\.\s*(SetUninstallName)|<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D82303B7-A754-4DCB-8AFC-8CF99435AACE\s*}?\s*(?P=q7)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\.(SetUninstallName))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,28172; reference:cve,2008-1307; classtype:attempted-user; sid:13599; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5555 (msg:"WEB-CLIENT CoreHTTP Long buffer overflow attempt"; flow:to_server,established; content:"GET"; depth:3; isdataat:500; content:!"|0A|"; within:500; reference:bugtraq,25120; reference:cve,2007-4060; reference:url,osvdb.org/46831; reference:url,www.exploit-db.com/exploits/4243/; classtype:attempted-user; sid:20620; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1812 (msg:"WEB-MISC VirusWall catinfo access"; flow:to_server,established; content:"/catinfo"; reference:bugtraq,2579; reference:bugtraq,2808; reference:cve,2001-0432; reference:nessus,10650; classtype:attempted-recon; sid:1232; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Tabular Control ActiveX overflow by CLSID / param tag"; flow:established,to_client; file_data; content:"333C7BC4-460F-11D0-BC04-0080C7055A83"; content:"<param"; distance:0; content:"DataURL"; distance:0; pcre:"/<object[^>]+classid\s*=\s*(?P<q1>\x22|\x27|)clsid\s*\x3A\s*{?\s*333C7BC4-460F-11D0-BC04-0080C7055A83\s*}?(?P=q1)/smi"; pcre:"/<param[^>]+(name\s*=\s*(?P<q2>\x22|\x27|)DataURL(?P=q2)[^>]+value\s*=\s*(\x22[^\x22]{128}|\x27[^\x27]{128})|value\s*=\s*(\x22[^\x22]{128}|\x27[^\x27]{128})[^>]+name\s*=\s*(?P<q3>\x22|\x27|)DataURL(?P=q3))/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0805; reference:url,www.microsoft.com/technet/security/bulletin/MS10-018.mspx; classtype:attempted-user; sid:19893; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8090 (msg:"WEB-MISC TrackerCam overly long php parameter overflow attempt"; flow:to_server,established; content:"php"; pcre:"/php.*\x3f[^\n]{256}/smi"; reference:bugtraq,12592; reference:cve,2005-0481; classtype:web-application-attack; sid:3547; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Vmc2vmx.CoVPCConfiguration ActiveX clsid access"; flow:established,to_client; file_data; content:"17376C4D-A75F-4535-82EB-FF80EE02E405"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*17376C4D-A75F-4535-82EB-FF80EE02E405\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14306; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ISSimpleCommandCreator.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C7B6C04A-CBB5-11D0-BB4C-00C04FC2F410"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C7B6C04A-CBB5-11D0-BB4C-00C04FC2F410/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8021; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC mylog.phtml access"; flow:to_server,established; content:"/mylog.phtml"; http_uri; reference:bugtraq,713; reference:cve,1999-0068; reference:cve,1999-0346; classtype:attempted-recon; sid:1120; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Internet Explorer Address Bar ActiveX clsid access"; flow:established,to_client; file_data; content:"01E04581-4EEE-11D0-BFE9-00AA005B4383"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*01E04581-4EEE-11D0-BFE9-00AA005B4383/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8019; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX PSEnumVariant ActiveX object access"; flow:established,to_client; file_data; content:"00020421-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*00020421-0000-0000-C000-000000000046/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4894; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 16 ActiveX clsid access"; flow:established,to_client; file_data; content:"bea48e3e-5990-4f52-ad0c-4fee8b00b3dd"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*bea48e3e-5990-4f52-ad0c-4fee8b00b3dd\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14472; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ComponentOne VSFlexGrid ActiveX function call access"; flow:established,to_client; file_data; content:"VSFlexGrid8.VSFlexGridADO"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22VSFlexGrid8\.VSFlexGridADO\x22|\x27VSFlexGrid8\.VSFlexGridADO\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*Archive\s*|.*(?P=v)\s*\.\s*Archive\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22VSFlexGrid8\.VSFlexGridADO\x22|\x27VSFlexGrid8\.VSFlexGridADO\x27)\s*\)(\s*\.\s*Archive\s*|.*(?P=n)\s*\.\s*Archive\s*)\s*\(/Osmi"; metadata:policy security-ips alert; reference:bugtraq,31200; classtype:attempted-user; sid:14598; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAArray.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"D17506C3-6B26-11D0-8914-00C04FC2A0CA"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*D17506C3-6B26-11D0-8914-00C04FC2A0CA/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8843; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Timecode header RCE attempt"; flow:to_client,established; flowbits:isset,http.asf; content:"|CB A5 E6 14 72 C6 32 43 83 99 A9 69 52 06 5B 5A|"; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,objectsize,relative,little; content:"|EC 95 95|9g|86|-N|8F DB 98 81|L|E7|l|1E|"; distance:68; fast_pattern; byte_test:4,>,objectsize,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2498; reference:url,www.microsoft.com/technet/security/bulletin/ms09-047.mspx; classtype:attempted-user; sid:19445; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma Image Uploader 5 Vulnerable Methods ActiveX clsid access"; flow:established,to_client; file_data; content:"BA162249-F2C5-4851-8ADC-FC58CB424243"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m5>\x22|\x27|)(?P<id1>.+?)(?P=m5)(\s|>)[^>]*\s*classid\s*=\s*(?P<q11>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BA162249-F2C5-4851-8ADC-FC58CB424243\s*}?\s*(?P=q11)(\s|>).*(?P=id1)\s*\.\s*(GotoFolder|CanGotoFolder)|<object\s*[^>]*\s*classid\s*=\s*(?P<q12>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BA162249-F2C5-4851-8ADC-FC58CB424243\s*}?\s*(?P=q12)(\s|>)[^>]*\s*id\s*=\s*(?P<m6>\x22|\x27|)(?P<id2>.+?)(?P=m6)(\s|>).*(?P=id2)\.(GotoFolder|CanGotoFolder))\s*\(/si"; reference:bugtraq,27577; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13438; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI archie access"; flow:to_server,established; content:"/archie"; fast_pattern; http_uri; classtype:attempted-recon; sid:881; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS MS Site Server default login attempt"; flow:to_server,established; content:"/SiteServer/Admin/knowledge/persmbr/"; fast_pattern; http_uri; pcre:"/^Authorization|3A|\s*Basic\s+TERBUF9Bbm9ueW1vdXM6TGRhcFBhc3N3b3JkXzE=/smi"; reference:nessus,11018; classtype:web-application-attack; sid:1817; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft MS Audio Decompressor Control Property Page ActiveX object access"; flow:established,to_client; file_data; content:"8FE7E181-BB96-11D2-A1CB-00609778EA66"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*8FE7E181-BB96-11D2-A1CB-00609778EA66/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4207; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IBM Informix Client SDK NFX file InformixServerList processing stack buffer overflow attempt"; flow:to_client,established; content:"[Setnet32]"; fast_pattern; content:"ServerSize="; distance:0; byte_test:4,>,293,0,relative,dec,string; pcre:"/InformixServerList=([^\r\n\x3B]{,293}\x3B)*[^\r\n\x3B]{294}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36588; reference:cve,2009-3691; classtype:attempted-user; sid:16346; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma Image Uploader 4 Vulnerable Methods ActiveX function call access"; flow:established,to_client; file_data; content:"Aurigma.ImageUploader"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Aurigma\.ImageUploader\x22|\x27Aurigma\.ImageUploader\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(GotoFolder|CanGotoFolder)\s*|.*(?P=v)\s*\.\s*(GotoFolder|CanGotoFolder)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Aurigma\.ImageUploader\x22|\x27Aurigma\.ImageUploader\x27)\s*\)(\s*\.\s*(GotoFolder|CanGotoFolder)\s*|.*(?P=n)\s*\.\s*(GotoFolder|CanGotoFolder)\s*)\s*\(/smi"; reference:bugtraq,26537; reference:bugtraq,27577; reference:url,blogs.aurigma.com/post/2007/11/Security-issue-in-Image-Uploader.aspx; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:12782; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CDL Asychronous Pluggable Protocol Handler ActiveX clsid access"; flow:established,to_client; file_data; content:"3DD53D40-7B8B-11D0-B013-00AA0059CE02"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q13>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3DD53D40-7B8B-11D0-B013-00AA0059CE02\s*}?\s*(?P=q13)(\s|>)/si"; metadata:policy security-ips drop; reference:cve,2007-0218; reference:url,www.microsoft.com/technet/security/bulletin/MS07-033.mspx; classtype:attempted-user; sid:7904; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [8030,8028,8008,8010] (msg:"WEB-MISC Novell eDirectory SOAP Accept Language header overflow attempt"; flow:to_server,established; content:"Accept-Language|3A|"; pcre:"/^Accept\x2dLanguage\x3a\s*(\w{1,36}\s*(\x2e|\x2d|\x3b|\x3d|\x2c)\s*)*[^\x2d\x3b\x2c\x3d\n]{37}/smi"; metadata:policy security-ips drop; reference:cve,2008-4479; classtype:attempted-user; sid:14989; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX GOM Player GomWeb ActiveX clsid access"; flow:established,to_client; file_data; content:"DC07C721-79E0-4BD4-A89F-C90871946A31"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DC07C721-79E0-4BD4-A89F-C90871946A31\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(OpenURL)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DC07C721-79E0-4BD4-A89F-C90871946A31\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(OpenURL))/siO"; metadata:policy security-ips drop; reference:bugtraq,26236; reference:cve,2007-5779; classtype:attempted-user; sid:17078; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel SerAuxTrend biff record corruption attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|4B 10|"; fast_pattern; content:"|00|"; within:1; distance:2; pcre:"/^[\x00\x01\x07-\xFF]\xFF\xFF\xFF\xFF/R"; metadata:policy security-ips drop; reference:cve,2011-1274; reference:url,www.microsoft.com/technet/security/bulletin/MS11-045.mspx; classtype:attempted-user; sid:19225; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer onreadystatechange memory corruption attempt"; flow:to_client,established; content:"doc.replaceChild|28|doc,doc|29|"; content:"doc.removeChild|28|doc,doc|29|"; distance:0; content:"onreadystatechange"; distance:0; reference:cve,2009-1531; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:misc-attack; sid:15538; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft COleSite ActiveX memory corruption attempt "; flow:established,to_client; file_data; content:"0E92978A-036B-4353-AFE1-7A8F2129C6C3"; content:"Pkmaxctl.VocabCtl"; metadata:policy security-ips drop; reference:cve,2010-3340; reference:url,www.microsoft.com/technet/security/bulletin/MS10-090.mspx; classtype:attempted-user; sid:18198; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI calendar_admin.pl arbitrary command execution attempt"; flow:to_server,established; content:"/calendar_admin.pl?config=|7C|"; http_uri; reference:bugtraq,1215; reference:cve,2000-0432; reference:nessus,10506; classtype:web-application-attack; sid:1536; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word rich text format unexpected field type memory corruption attempt 1"; flow:to_client,established; content:"|5C|datafield |5C|emfblip"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1901; reference:url,www.microsoft.com/technet/security/bulletin/ms10-056.mspx; classtype:attempted-user; sid:17120; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS codebrowser Exair access"; flow:to_server,established; content:"/iissamples/exair/howitworks/codebrws.asp"; fast_pattern; http_uri; reference:cve,1999-0499; reference:cve,1999-0815; classtype:web-application-activity; sid:1004; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected iTXt overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"iTXt"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6699; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma Image Uploader 5 Property Overflows ActiveX clsid access"; flow:established,to_client; file_data; content:"BA162249-F2C5-4851-8ADC-FC58CB424243"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m7>\x22|\x27|)(?P<id1>.+?)(?P=m7)(\s|>)[^>]*\s*classid\s*=\s*(?P<q16>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BA162249-F2C5-4851-8ADC-FC58CB424243\s*}?\s*(?P=q16)(\s|>).*(?P=id1)\s*\.\s*(ExtractIptc|ExtractExif)|<object\s*[^>]*\s*classid\s*=\s*(?P<q17>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BA162249-F2C5-4851-8ADC-FC58CB424243\s*}?\s*(?P=q17)(\s|>)[^>]*\s*id\s*=\s*(?P<m8>\x22|\x27|)(?P<id2>.+?)(?P=m8)(\s|>).*(?P=id2)\s*\.\s*(ExtractIptc|ExtractExif))\s*=/si"; reference:bugtraq,27577; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13442; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC webalizer access"; flow:established,to_server; content:"/webalizer/"; http_uri; reference:bugtraq,3473; reference:cve,2001-0835; reference:nessus,10816; classtype:web-application-activity; sid:1847; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Microsoft Windows Font Library file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.fon; file_data; content:"MZ"; within:2; byte_test:4,>,50,120,little; reference:cve,2011-2003; reference:url,secunia.com/advisories/46405/; reference:url,www.exploit-db.com/exploits/17978/; reference:url,www.kb.cert.org/vuls/id/619281; classtype:attempted-user; sid:20572; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft OpenCable Class ActiveX object access"; flow:established,to_client; file_data; content:"ABBA001B-3075-11D6-88A4-00B0D0200F88"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*ABBA001B-3075-11D6-88A4-00B0D0200F88/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4223; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAImage.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BD4-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BD4-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8819; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Oracle Siebel Option Pack 5 ActiveX clsid access"; flow:established,to_client; file_data; content:"81a81dd2-a261-442a-b9b1-df10a2542020"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q9>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*81a81dd2-a261-442a-b9b1-df10a2542020\s*}?\s*(?P=q9)(\s|>)/siO"; metadata:policy security-ips drop; reference:cve,2009-3737; reference:url,www.kb.cert.org/vuls/id/174089; classtype:attempted-user; sid:17175; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMList Class ActiveX clsid access"; flow:established,to_client; file_data; content:"f76e4799-379b-4362-bcc4-68b753d10744"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*f76e4799-379b-4362-bcc4-68b753d10744\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14578; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DB Software Laboratory VImpX ActiveX clsid access"; flow:established,to_client; file_data; content:"7600707B-9F47-416D-8AB5-6FD96EA37968"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7600707B-9F47-416D-8AB5-6FD96EA37968\s*}?\s*(?P=q6)(\s|>)/si"; reference:bugtraq,26064; reference:cve,2007-5445; classtype:attempted-user; sid:12648; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RemoteDirDlg Class ActiveX clsid access"; flow:established,to_client; file_data; content:"0ce412d9-4520-4e5a-893d-88b3a8f29c97"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0ce412d9-4520-4e5a-893d-88b3a8f29c97\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14294; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Repository Script Definition ActiveX object access"; flow:established,to_client; file_data; content:"D675E22B-CAE9-11D2-AF7B-00C04F99179F"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*D675E22B-CAE9-11D2-AF7B-00C04F99179F/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4914; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer javascript onload document.write obfuscation overflow attempt"; flow:to_client,established; content:"document.write"; pcre:"/document\.write\(([^\x22\x27\x29\x3B]*([\x22\x27]))((?(?=\2)\2(?1)))\x3C(?3)b(?3)o(?3)d(?3)y(?3)\s*(?3)o(?3)n(?3)l(?3)o(?3)a(?3)d(?3)\s*(?3)=(?3)\s*(?3)w(?3)i(?3)n(?3)d(?3)o(?3)w(?3)\x28(?3)\x29/smi"; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4916; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VeryDOC PDF Viewer ActiveX function call access"; flow:established,to_client; file_data; content:"PDFVIEW.PdfviewCtrl"; pcre:"/(?P<c>\w+)\s*=\s*(\x22PDFVIEW\.PdfviewCtrl(\.\d)?\x22|\x27PDFVIEW\.PdfviewCtrl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*OpenPDF\s*|.*(?P=v)\s*\.\s*OpenPDF\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22PDFVIEW\.PdfviewCtrl(\.\d)?\x22|\x27PDFVIEW\.PdfviewCtrl(\.\d)?\x27)\s*\)(\s*\.\s*OpenPDF\s*|.*(?P=n)\s*\.\s*OpenPDF\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,32313; reference:cve,2008-5492; classtype:attempted-user; sid:17089; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft HeartbeatCtl ActiveX clsid access"; flow:established,to_client; file_data; content:"E5D419D6-A846-4514-9FAD-97E826C84822"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E5D419D6-A846-4514-9FAD-97E826C84822\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28882; reference:cve,2007-6255; classtype:attempted-user; sid:13758; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing nam buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mp4; content:"|A9|nam"; byte_test:4, >, 512, 0, relative; metadata:policy security-ips drop; reference:bugtraq,19976; reference:bugtraq,26773; reference:cve,2006-4386; reference:cve,2007-6401; classtype:attempted-user; sid:13317; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft HTML help workshop buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.hhp.download; file_data; content:"["; depth:1; content:"]"; within:12; content:"file"; distance:0; content:"="; distance:0; pcre:"/\x5B(OPTIONS|WINDOWS|MERGE FILES|MAP|ALIAS|TEXT\x20POPUPS|INFOTYPES|SUBSETS)\x5D.*?(Contents|Index|Compiled|Sample List|Full text search stop list)\x20file\s*\x3D[^\r\n]{200}/smi"; metadata:policy security-ips drop; reference:cve,2006-0564; reference:cve,2009-0133; reference:url,users.pandora.be/bratax/advisories/b008.html; reference:url,www.frsirt.com/english/advisories/2006/0446; classtype:attempted-user; sid:5741; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC SpamExcp.dll access"; flow:to_server,established; content:"/SpamExcp.dll"; http_uri; reference:bugtraq,3327; reference:cve,2001-0958; reference:nessus,11747; classtype:web-application-activity; sid:2235; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Multiple vendor Antivirus magic byte detection evasion attempt"; flow:to_client,established; flowbits:isset,http.eml; content:"Content|2D|Type|3A 20|message|2F|rfc822"; http_header; file_data; pcre:"/(MZ|PK|BZh|BZ|GIF8|BM|IC|PI|CI|CP)/R"; metadata:policy security-ips drop; reference:cve,2005-3370; reference:cve,2005-3371; reference:cve,2005-3372; reference:cve,2005-3373; reference:cve,2005-3374; reference:cve,2005-3375; reference:cve,2005-3376; reference:cve,2005-3377; reference:cve,2005-3378; reference:cve,2005-3379; reference:cve,2005-3380; reference:cve,2005-3381; reference:cve,2005-3382; classtype:attempted-user; sid:17277; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ADODB.Connection ActiveX function call access"; flow:established,to_client; file_data; content:"ADODB.Connection.2.7"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22ADODB.Connection.2.7\x22|\x27ADODB.Connection.2.7\x27)\s*\x3b.*(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)(\s*\.\s*(Execute)\s*\(|.*\3\s*\.\s*(Execute)\s*\()|(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ADODB.Connection.2.7\x22|\x27ADODB.Connection.2.7\x27)\s*\)(\s*\.\s*(Execute)\s*\(|.*\7\s*\.\s*(Execute)\s*\()/smi"; metadata:policy security-ips drop; reference:cve,2006-5559; reference:url,archives.neohapsis.com/archives/ntbugtraq/2004-q4/0083.html; reference:url,www.microsoft.com/technet/security/bulletin/ms07-009.mspx; classtype:attempted-user; sid:9640; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMClientVM Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmdbCOM.VMClientVM"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmdbCOM\.VMClientVM\x22|\x27vmdbCOM\.VMClientVM\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmdbCOM\.VMClientVM\x22|\x27vmdbCOM\.VMClientVM\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14516; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC active.log access"; flow:to_server,established; content:"/active.log"; http_uri; reference:bugtraq,1497; reference:cve,2000-0642; reference:nessus,10470; classtype:web-application-activity; sid:1851; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAString.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BC4-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BC4-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8783; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7510 (msg:"WEB-MISC HP OpenView Network Node Manager HTTP handling buffer overflow attempt"; flow:to_server,established; content:"GET "; depth:4; isdataat:165,relative; content:"/topology/homeBaseView"; pcre:"/GET\s+\w[^\x0a\x20]{165}/i"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,28569; reference:cve,2008-1697; classtype:attempted-admin; sid:13715; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Domino domcfg.nsf access"; flow:to_server,established; content:"/domcfg.nsf"; http_uri; reference:nessus,10629; classtype:attempted-recon; sid:1151; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Novell ZENworks Configuration Management UploadServlet code execution attempt"; flow:established,to_server; content:"/zenworks/UploadServlet"; fast_pattern; http_uri; content:"filename="; pcre:"/^[^\x26]*?\x2E\x2E/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39914; reference:url,www.novell.com/support/viewContent.do?externalId=7005573; classtype:attempted-admin; sid:18792; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Crystal Reports crystalImageHandler.aspx directory traversal attempt"; flow:to_server,established; content:"/crystalimagehandler.aspx"; http_uri; content:"dynamicimage=../"; reference:bugtraq,10260; reference:cve,2004-0204; reference:nessus,12271; reference:url,www.microsoft.com/technet/security/bulletin/ms04-017.mspx; classtype:web-application-attack; sid:2582; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMIScriptUtils.WMIObjectBroker2.1 ActiveX CLSID access"; flow:to_client,established; file_data; content:"XMLHttpRequest|28 29|"; distance:0; content:"document|2E|location"; content:"|27 2F|p|27|"; distance:0; content:"|27|ay|27|"; distance:0; content:"|27|lo|27|"; distance:0; pcre:"/document\x2elocation\s*\x2b\s*\x27\x2fp\x27\s*\x2b\s*\x27ay\x27\s*\x2b\s*\x27lo\x27/"; metadata:policy security-ips drop; reference:cve,2006-4704; reference:url,metasploit.com/projects/Framework/modules/exploits/ie_createobject.pm; reference:url,www.microsoft.com/technet/security/bulletin/ms06-073.mspx; classtype:attempted-user; sid:20071; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAMontage.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAMontage.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAMontage.1\x22|\x27DirectAnimation.DAMontage.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAMontage.1\x22|\x27DirectAnimation.DAMontage.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8806; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS source code disclosure attempt"; flow:to_server,established; content:"Translate|3A| "; byte_test:1,=,102,0,relative; pcre:"/%.*%/smiI"; reference:bugtraq,14764; classtype:attempted-recon; sid:17648; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft TipGW Init ActiveX object access"; flow:established,to_client; file_data; content:"F117831B-C052-11D1-B1C0-00C04FC2F3EF"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*F117831B-C052-11D1-B1C0-00C04FC2F3EF/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4214; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Intuit QuickBooks Online Edition 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"4F720B9C-24B1-4948-A035-8853DC01F19E"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m5>\x22|\x27|)(?P<id1>.+?)(?P=m5)(\s|>)[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4F720B9C-24B1-4948-A035-8853DC01F19E\s*}?\s*(?P=q7)(\s|>).*(?P=id1)\s*\.\s*(httpGETToFile|httpPOSTFromFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q8>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4F720B9C-24B1-4948-A035-8853DC01F19E\s*}?\s*(?P=q8)(\s|>)[^>]*\s*id\s*=\s*(?P<m6>\x22|\x27|)(?P<id2>.+?)(?P=m6)(\s|>).*(?P=id2)\.(httpGETToFile|httpPOSTFromFile))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,25544; reference:cve,2007-0322; reference:cve,2007-4471; reference:url,sc.accounting.quickbooks.com/Update/index.cfm?id=32; reference:url,www.kb.cert.org/vuls/id/907481; reference:url,www.kb.cert.org/vuls/id/979638; reference:url,www.microsoft.com/technet/security/bulletin/MS07-069.mspx; classtype:attempted-user; sid:12395; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE administrators.pwd access"; flow:to_server,established; content:"/administrators.pwd"; fast_pattern; http_uri; reference:bugtraq,1205; classtype:web-application-activity; sid:953; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari Webkit SVG memory corruption attempt"; flow:to_client,established; file_data; flowbits:isset,svg_file.request; content:"|2E|svg"; distance:0; content:"documentElement"; distance:0; pcre:"/\x3cscript.*documentElement\x2e(height|preserveAspectRatio|viewBox|width|x|y)/smi"; reference:bugtraq,48844; reference:cve,2011-0222; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:19807; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC cat%20 access"; flow:to_server,established; content:"cat "; http_uri; reference:bugtraq,374; reference:cve,1999-0039; classtype:attempted-recon; sid:1147; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LM.AutoEffectBvr.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"BB339A46-7C49-11d2-9BF3-00C04FA34789"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*BB339A46-7C49-11d2-9BF3-00C04FA34789/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8753; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Queued Components Recorder ActiveX object access"; flow:established,to_client; file_data; content:"ECABAFC2-7F19-11D2-978E-0000F8757E2A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*ECABAFC2-7F19-11D2-978E-0000F8757E2A/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4201; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat embedded TIFF DotRange structure memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"Subtype|2F|image"; content:"tiff"; within:7; content:"II|2A 00|"; within:250; content:"|50 01|"; distance:0; byte_test:2,<,14,0,relative,little; byte_test:2,>,8,2,relative,little; reference:cve,2011-2432; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20144; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectX Files Viewer ActiveX object access"; flow:established,to_client; file_data; content:"970C7E08-05A7-11D0-89AA-00A0C9054129"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*970C7E08-05A7-11D0-89AA-00A0C9054129/si"; metadata:policy security-ips drop; reference:bugtraq,5489; reference:cve,2002-0975; reference:url,www.microsoft.com/technet/security/bulletin/MS02-066.mspx; classtype:attempted-user; sid:4179; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT asp file upload"; flow:to_server,established; content:".asp"; flowbits:set,asp.upload; flowbits:noalert; classtype:protocol-command-decode; sid:15471; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI a1stats a1disp3.cgi access"; flow:to_server,established; content:"/a1disp3.cgi"; http_uri; reference:bugtraq,2705; reference:cve,2001-0561; reference:nessus,10669; classtype:web-application-activity; sid:1502; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SwiftView ActiveX clsid access"; flow:established,to_client; file_data; content:"7DD62E58-5FA8-11D2-AFB7-00104B64F126"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7DD62E58-5FA8-11D2-AFB7-00104B64F126\s*}?\s*(?P=q6)(\s|>)/si"; metadata:policy security-ips alert; reference:bugtraq,27527; reference:cve,2007-5602; reference:url,www.swiftview.com/tech/security/bulletins/SBSV-07-10-02.htm; classtype:attempted-user; sid:13423; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft DirectAnimation Control ActiveX clsid access"; flow:established,to_client; file_data; content:"B6FFC24C-7E13-11D0-9B47-00C04FC2F51D"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*B6FFC24C-7E13-11D0-9B47-00C04FC2F51D/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:7950; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MW6 Technologies Aztec ActiveX clsid access"; flow:established,to_client; file_data; content:"F359732D-D020-40ED-83FF-F381EFE36B54"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m7>\x22|\x27|)(?P<id1>.+?)(?P=m7)(\s|>)[^>]*\s*classid\s*=\s*(?P<q16>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F359732D-D020-40ED-83FF-F381EFE36B54\s*}?\s*(?P=q16)(\s|>).*(?P=id1)\s*\.\s*(SaveAsWMF|SaveAsBMP)|<object\s*[^>]*\s*classid\s*=\s*(?P<q17>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F359732D-D020-40ED-83FF-F381EFE36B54\s*}?\s*(?P=q17)(\s|>)[^>]*\s*id\s*=\s*(?P<m8>\x22|\x27|)(?P<id2>.+?)(?P=m8)(\s|>).*(?P=id2)\.(SaveAsWMF|SaveAsBMP))\s*\(/siO"; metadata:policy security-ips drop; reference:cve,2008-4923; classtype:attempted-user; sid:15278; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DHTML Editing ActiveX clsid access"; flow:established,to_client; file_data; content:"2D360201-FFF5-11d1-8D03-00A0C959BC0A"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2D360201-FFF5-11d1-8D03-00A0C959BC0A\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(LoadURL)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2D360201-FFF5-11d1-8D03-00A0C959BC0A\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(LoadURL))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,116; reference:bugtraq,12602; reference:bugtraq,1474; reference:cve,1999-0487; reference:cve,2005-0500; reference:cve,2009-2519; reference:url,www.microsoft.com/technet/security/bulletin/MS09-046.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS99-011.mspx; classtype:attempted-user; sid:4148; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI dcforum.cgi access"; flow:to_server,established; content:"/dcforum.cgi"; http_uri; reference:bugtraq,2728; reference:cve,2001-0527; reference:nessus,10583; classtype:attempted-recon; sid:818; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP eSupportDiagnostics 18 ActiveX clsid access"; flow:established,to_client; file_data; content:"CF6866F9-B67C-4B24-9957-F91E91E788DC"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q20>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CF6866F9-B67C-4B24-9957-F91E91E788DC\s*}?\s*(?P=q20)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28929; reference:cve,2008-0712; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13750; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ComponentOne FlexGrid ActiveX clsid access"; flow:established,to_client; file_data; content:"C0A63B86-4B21-11d3-BD95-D426EF2C7949"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C0A63B86-4B21-11d3-BD95-D426EF2C7949\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Text|EditSelText|EditText|CellFontName)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C0A63B86-4B21-11d3-BD95-D426EF2C7949\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(Text|EditSelText|EditText|CellFontName))\s*=/si"; reference:bugtraq,26467; reference:cve,2007-6028; classtype:attempted-user; sid:12733; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI count.cgi access"; flow:to_server,established; content:"/count.cgi"; fast_pattern; http_uri; reference:bugtraq,128; reference:cve,1999-0021; reference:nessus,10049; classtype:web-application-activity; sid:1149; rev:19;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SaschArt SasCam Webcam Server ActiveX clsid access"; flow:established,to_client; file_data; content:"0297D24A-F425-47EE-9F3B-A459BCE593E3"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q10>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0297D24A-F425-47EE-9F3B-A459BCE593E3\s*}?\s*(?P=q10)(\s|>).*(?P=id1)\s*\.\s*(Get)|<object\s*[^>]*\s*classid\s*=\s*(?P<q11>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0297D24A-F425-47EE-9F3B-A459BCE593E3\s*}?\s*(?P=q11)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\.(Get))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,33053; classtype:attempted-user; sid:15181; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer nested tag memory corruption attempt"; flow:to_client,established; file_data; content:"datasrc"; distance:0; content:"datafld"; pcre:"/<(?P<t1>button|div|input[^>]+?type\s*=\s*(\x22|\x27)button(\x22|\x27)|label|legend|marquee|param|span)\s+[^>]*(datasrc\s*=\s*(?P<q1>\x22|\x27|)(?P<d1>\S+)(?P=q1)\s+[^>]*datafld\s*=\s*(?P<q2>\x22|\x27|)(?P<d2>\S+)(?P=q2)|datafld\s*=\s*(?P<q3>\x22|\x27|)(?P<d3>\S+)(?P=q3)\s+[^>]*datasrc\s*=\s*(?P<q4>\x22|\x27|)(?P<d4>\S+)(?P=q4))[^>]*>(?!.*?<\/\s*(?P=t1)\s*>.*?<(?P=t1)).*?<(?P=t1)\s+[^>]*(datasrc\s*=\s*(?P<q5>\x22|\x27|)((?P=d1)|(?P=d3))(?P=q5)\s+datafld\s*=\s*(?P<q6>\x22|\x27|)((?P=d2)|(?P=d4))(?P=q6)|(datafld\s*=\s*(?P<q7>\x22|\x27|)(?P=d1)(?P=q7)\s+datasrc\s*=\s*(?P<q8>\x22|\x27|)(?P=d2)(?P=q8)))/Osi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32721; reference:cve,2008-4844; reference:url,www.microsoft.com/technet/security/bulletin/ms08-078.mspx; classtype:attempted-user; sid:15126; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView NNM ovlogin.exe CGI userid parameter buffer overflow attempt"; flow:to_server,established; content:"/OvCgi/ovlogin|2E|exe"; fast_pattern:only; http_uri; content:"userid|3D|"; http_client_body; isdataat:29,relative; pcre:"/userid\x3D[^\x26\x3F\x3B\x0D\x0A]{29}/iP"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3846; reference:url,h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c01950877; classtype:attempted-user; sid:20179; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Reader plugin cooltype.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|cooltype.dll"; http_uri; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18442; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader U3D CLODMeshDeceleration code execution attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"U3D|00|"; content:"|31 FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,>,200,12,relative,little; content:"|3C FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,<,200,12,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3953; classtype:attempted-user; sid:20429; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ShockwaveFlash.ShockwaveFlash ActiveX function call access"; flow:established,to_client; file_data; content:"ShockwaveFlash.ShockwaveFlash"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ShockwaveFlash\.ShockwaveFlash\x22|\x27ShockwaveFlash\.ShockwaveFlash\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*navigateToURL\s*|.*?(?P=v)\s*\.\s*navigateToURL\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ShockwaveFlash\.ShockwaveFlash\x22|\x27ShockwaveFlash\.ShockwaveFlash\x27)\s*\)(\s*\.\s*navigateToURL\s*|.*?(?P=n)\s*\.\s*navigateToURL\s*)\s*\(/smi"; metadata:policy security-ips alert; reference:cve,2007-6244; reference:url,marc.theaimsgroup.com/?l=bugtraq&m=102039374017185&w=2; reference:url,www.adobe.com/support/security/bulletins/apsb07-20.html; classtype:attempted-user; sid:13216; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer tRNS overflow attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:4; distance:4; content:"tRNS"; distance:0; byte_test:4,>,256,-8,relative,big; reference:bugtraq,13941; reference:cve,2005-1211; reference:nessus,18490; reference:url,www.microsoft.com/technet/security/bulletin/MS05-025.mspx; classtype:attempted-user; sid:3689; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Oracle Java Runtime Environment .hotspot_compiler file load exploit attempt"; flow:to_server,established; content:"|2F|.hotspot_compiler"; http_uri; reference:url,secunia.com/advisories/45173; classtype:attempted-user; sid:19604; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file file rcsL overflow attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"rcsL"; byte_test:1,>,127,76,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2867; classtype:attempted-user; sid:17203; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IBM Informix Client SDK NFX file HostList processing stack buffer overflow attempt"; flow:to_client,established; content:"[Setnet32]"; fast_pattern; content:"HostSize="; distance:0; byte_test:4,>,296,0,relative,dec,string; pcre:"/HostList=([^\r\n\x3B]{,296}\x3B)*[^\r\n\x3B]{297}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36588; reference:cve,2009-3691; classtype:attempted-user; sid:16345; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Evans FTP ActiveX clsid access"; flow:established,to_client; file_data; content:"7E864D3E-3E6A-48F0-88AF-CEAEE322F9FD"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7E864D3E-3E6A-48F0-88AF-CEAEE322F9FD\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(RemoteAddress|ProxyPrefix|ProxyName|Password|ProxyBypassList|LoginName|CurrentDirectory)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7E864D3E-3E6A-48F0-88AF-CEAEE322F9FD\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(RemoteAddress|ProxyPrefix|ProxyName|Password|ProxyBypassList|LoginName|CurrentDirectory))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,32814; classtype:attempted-user; sid:15159; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Telnet protocol specifier in web page attempt"; flow:to_client,established; content:"telnet|3A 2F 2F|"; pcre:"/(src|href)\s*=\s*(\x22|\x27|)telnet\x3a\x2f\x2f/i"; classtype:policy-violation; sid:19669; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI awstats.pl command execution attempt"; flow:to_server,established; content:"/awstats.pl?"; fast_pattern; http_uri; content:"update="; http_uri; pcre:"/update=[^\r\n\x26]+/Ui"; content:"logfile="; http_uri; pcre:"/awstats.pl?[^\r\n]*logfile=\x7C/Ui"; reference:bugtraq,12572; reference:nessus,16456; classtype:web-application-attack; sid:3464; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iOS 4.3.3 jailbreak for iPhone download attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|78 DA ED DD 07 3C D7 7B FF 3F 7E 2A 29 15 1A 94 64 A5 32 B2 25 45 94 0A 89 22 85 64 25 7B CB DE|"; fast_pattern:only; metadata:policy security-ips drop; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19418; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-MISC Microsoft Office XP URL Handling Buffer Overflow attempt"; flow:to_server,established; content:"|00|"; http_uri; pcre:"/\w{3}\x25\x30\x30[^\r\n]{2000}/Ii"; metadata:policy security-ips drop; reference:bugtraq,12480; reference:cve,2004-0848; classtype:attempted-admin; sid:17568; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Content Advisor memory corruption attempt"; flow:to_client,established; flowbits:isset,http.rat; file_data; content:"name"; pcre:"/rating\x2Dservice.{0,300}\x28\s*name\s*\x22[^\x22]{261}/smi"; metadata:policy security-ips drop; reference:cve,2005-0555; reference:url,www.microsoft.com/technet/security/Bulletin/MS05-020.mspx; classtype:attempted-user; sid:3686; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS ASP contents view"; flow:to_server,established; content:"%20"; content:"&CiRestriction=none"; content:"&CiHiliteType=Full"; fast_pattern:only; reference:bugtraq,1084; reference:cve,2000-0302; reference:nessus,10356; reference:url,www.microsoft.com/technet/security/bulletin/MS00-006.mspx; classtype:web-application-attack; sid:978; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file rcsL record exploit attempt"; flow:to_client,established; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00 00 00 05 0E 00 00 05 0E 00 5C 00 40|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17185; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS Alternate Data streams ASP file access attempt"; flow:to_server,established; content:".asp|3A 3A 24|DATA"; fast_pattern; http_uri; reference:bugtraq,149; reference:cve,1999-0278; reference:nessus,10362; reference:url,support.microsoft.com/default.aspx?scid=kb\;EN-US\;q188806; classtype:web-application-attack; sid:975; rev:22;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 45 ActiveX clsid access"; flow:established,to_client; file_data; content:"FA7C375B-66A7-4280-879D-FD459C84BB02"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q79>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*FA7C375B-66A7-4280-879D-FD459C84BB02\s*}?\s*(?P=q79)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15666; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMStatusbarCtl Class ActiveX clsid access"; flow:established,to_client; file_data; content:"164bdf7b-5c67-4daf-85a3-c6c927cb3d36"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*164bdf7b-5c67-4daf-85a3-c6c927cb3d36\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14302; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel url unicode overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|E0 C9 EA|y|F9 BA CE 11 8C 82 00 AA 00|K|A9 0B|"; byte_test:4,>,3628,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,18422; reference:bugtraq,18500; reference:cve,2006-3059; reference:cve,2006-3086; reference:cve,2011-0104; reference:url,www.microsoft.com/technet/security/bulletin/MS11-021.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7002; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Ultra Crypto Component CryptoX.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"09C282FE-7DE7-4697-9BE2-1C4F4DA825B3"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*09C282FE-7DE7-4697-9BE2-1C4F4DA825B3\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(AcquireContext)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*09C282FE-7DE7-4697-9BE2-1C4F4DA825B3\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(AcquireContext))\s*\(/si"; reference:bugtraq,25609; reference:url,www.ultrashareware.com/Ultra-Crypto-Component.htm; classtype:attempted-user; sid:12438; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI bash access"; flow:to_server,established; content:"/bash"; fast_pattern; http_uri; reference:cve,1999-0509; reference:url,www.cert.org/advisories/CA-1996-11.html; classtype:web-application-activity; sid:885; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CommunicationManager ActiveX clsid access"; flow:established,to_client; file_data; content:"67DCC487-AA48-11D1-8F4F-00C04FB611C7"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*67DCC487-AA48-11D1-8F4F-00C04FB611C7/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8001; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Facebook Photo Uploader ActiveX clsid access"; flow:established,to_client; file_data; content:"5C6698D9-7BE4-4122-8EC5-291D84DBD4A0"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C6698D9-7BE4-4122-8EC5-291D84DBD4A0\s*}?\s*(?P=q6)(\s|>).*(?P=id1)\s*\.\s*(Action|ExtractExif|ExtractIptc|FileMask)|<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5C6698D9-7BE4-4122-8EC5-291D84DBD4A0\s*}?\s*(?P=q7)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\s*\.\s*(Action|ExtractExif|ExtractIptc|FileMask))\s*=/smiO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,27534; reference:bugtraq,27756; reference:cve,2008-5711; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13419; rev:12;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-MISC Sun Java class file request"; flow:to_server,established; content:".class"; http_uri; flowbits:set,http.class; flowbits:noalert; classtype:misc-activity; sid:20056; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION datasource attempt"; flow:to_server,established; content:"CF_ISCOLDFUSIONDATASOURCE|28 29|"; fast_pattern:only; reference:bugtraq,550; reference:cve,1999-0760; classtype:web-application-attack; sid:920; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office WordPad and Office text converters integer underflow attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|DC A5|"; byte_test:2,<,4,140,relative,little; metadata:policy security-ips drop; reference:cve,2009-0087; reference:url,www.microsoft.com/technet/security/bulletin/MS09-010.mspx; classtype:attempted-user; sid:15469; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Flashpix graphics filter fpx32.flt remote code execution attempt"; flow:to_client,established; content:"|FE FF 00 00|"; content:"|00 64 61 56 54 C1 CE 11 85 53 00 AA 00 A1 F9 5B 01 00 00 00 00 64 61 56 54 C1 CE 11 85 53 00 AA 00 A1 F9 5B|"; within:36; distance:4; byte_jump:4,0,relative,little; byte_test:4,>,0,-44,relative; content:"|00 00 00 00|"; within:4; distance:-40; byte_jump:4,0,relative,little; byte_test:4,>,0x100,-8,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3951; reference:url,www.microsoft.com/technet/security/bulletin/MS10-105.mspx; classtype:attempted-user; sid:18237; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX D-Link MPEG4 SHM Audio Control ActiveX function call access"; flow:established,to_client; file_data; content:"VAPgDecoder.VaPgCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22VAPgDecoder\.VaPgCtrl\x22|\x27VAPgDecoder\.VaPgCtrl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*url\s*|.*(?P=v)\s*\.\s*url\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22VAPgDecoder\.VaPgCtrl\x22|\x27VAPgDecoder\.VaPgCtrl\x27)\s*\)(\s*\.\s*url\s*|.*(?P=n)\s*\.\s*url)\s*=/smi"; metadata:policy security-ips drop; reference:bugtraq,28010; classtype:attempted-user; sid:13529; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI wguest.exe access"; flow:to_server,established; content:"/wguest.exe"; fast_pattern; http_uri; reference:bugtraq,2024; reference:cve,1999-0287; reference:cve,1999-0467; classtype:attempted-recon; sid:852; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint out of bounds value remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; file_data; content:"|C3 0B 08|"; fast_pattern; byte_test:1,>,0x18,7,relative,little; content:"|C3 0B|"; distance:0; metadata:policy security-ips drop; reference:cve,2010-0032; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:20590; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Whale Client Components ActiveX ProgID access"; flow:established,to_client; file_data; content:"ComponentManager.Installer"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,34532; reference:cve,2007-2238; classtype:attempted-user; sid:18491; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX BarcodeWiz ActiveX function call access"; flow:established,to_client; file_data; content:"BarcodeWiz.BarcodeWiz"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22BarcodeWiz\.BarcodeWiz\x22|\x27BarcodeWiz\.BarcodeWiz\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*Verify\s*|.*(?P=v)\s*\.\s*Verify\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BarcodeWiz\.BarcodeWiz\x22|\x27BarcodeWiz\.BarcodeWiz\x27)\s*\)(\s*\.\s*Verify\s*|.*(?P=n)\s*\.\s*Verify\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,23891; reference:url,moaxb.blogspot.com/2007/05/moaxb-09-barcodewiz-activex-control-20.html; classtype:attempted-user; sid:11261; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe tiff oversized image length attempt"; flow:to_client,established; content:"|14 01 00 00 01 01 04 00 01 00 00 00 01 01 01 01 02 01 03 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2995; classtype:attempted-user; sid:16321; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Apache Chunked-Encoding worm attempt"; flow:to_server,established; content:"CCCCCCC|3A| AAAAAAAAAAAAAAAAAAA"; reference:bugtraq,4474; reference:bugtraq,4485; reference:bugtraq,5033; reference:cve,2002-0071; reference:cve,2002-0079; reference:cve,2002-0392; reference:nessus,10932; classtype:web-application-attack; sid:1809; rev:15;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI Nortel Contivity cgiproc DOS attempt"; flow:to_server,established; content:"/cgiproc?|24|"; http_uri; reference:bugtraq,938; reference:cve,2000-0063; reference:cve,2000-0064; reference:nessus,10160; classtype:web-application-attack; sid:1764; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Novell QuickFinder server cross-site-scripting attempt"; flow:to_server, established; content:"AdminServlet"; http_uri; pcre:"/AdminServlet.*(userid|adminurl)[^\x26\x20\x0a]*<script/smiU"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0611; classtype:web-application-attack; sid:16522; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint integer underflow heap corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|42 F1 00 00 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2573; reference:url,www.microsoft.com/technet/security/bulletin/MS10-088; classtype:attempted-user; sid:18066; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMT Screen capture Filter ActiveX clsid access"; flow:established,to_client; file_data; content:"31087270-D348-432C-899E-2D2F38FF29A0"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*31087270-D348-432C-899E-2D2F38FF29A0/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7488; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC basilix sendmail.inc access"; flow:to_server,established; content:"/inc/sendmail.inc"; http_uri; reference:bugtraq,2198; reference:cve,2001-1044; reference:nessus,10601; classtype:web-application-activity; sid:1526; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer implicit drag and drop file installation attempt"; flow:to_client,established; content:"folder"; content:"|22|shell|3A|"; distance:0; pcre:"/folder\s*=\s*\x22shell\x3a/i"; metadata:policy security-ips drop; reference:bugtraq,10973; reference:cve,2004-0839; classtype:attempted-user; sid:18299; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC philboard_admin.asp authentication bypass attempt"; flow:to_server,established; content:"/philboard_admin.asp"; http_uri; content:"Cookie"; content:"philboard_admin=True"; distance:0; reference:bugtraq,7739; reference:nessus,11675; classtype:web-application-attack; sid:2136; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Media Encoder wmerrorenu.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|wmerrorenu.dll"; http_uri; reference:cve,2010-3965; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-094.mspx; classtype:attempted-user; sid:18222; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FLAC libFLAC picture metadata buffer overflow attempt"; flow:to_client,established; content:"fLaC"; content:"|06|"; content:"|FF FF FF FF|"; within:4; distance:7; metadata:policy security-ips drop; reference:bugtraq,26042; reference:cve,2007-4619; classtype:attempted-user; sid:12745; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Symantec IM manager IMAdminReportTrendFormRun.asp sql injection attempt"; flow:to_server, established; content:"|2F|IMManager|2F|admin|2F|IMAdminReportTrendFormRun|2E|asp|3F|"; http_uri; pcre:"/groupList\x3d[^\x26]*\x3b/Ui"; metadata:policy security-ips drop; reference:bugtraq,44299; reference:cve,2010-0112; classtype:attempted-user; sid:18556; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ebCrypt IncrementalHash ActiveX function call access"; flow:established,to_client; file_data; content:"EbCrypt.eb_c_IncrementalHash"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22EbCrypt\.eb_c_IncrementalHash\x22|\x27EbCrypt\.eb_c_IncrementalHash\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*AddString\s*|.*(?P=v)\s*\.\s*AddString\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22EbCrypt\.eb_c_IncrementalHash\x22|\x27EbCrypt\.eb_c_IncrementalHash\x27)\s*\)(\s*\.\s*AddString\s*|.*(?P=n)\s*\.\s*AddString\s*)\s*\(/smi"; reference:bugtraq,25789; reference:cve,2007-5111; classtype:attempted-user; sid:12602; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS .asa HTTP header buffer overflow attempt"; flow:to_server,established; content:"HTTP/"; content:".asa"; fast_pattern; http_uri; content:"|3A|"; content:"|0A|"; content:"|00|"; reference:bugtraq,4476; reference:cve,2002-0150; reference:nessus,10936; reference:url,www.microsoft.com/technet/security/bulletin/MS02-018.mspx; classtype:web-application-attack; sid:1802; rev:16;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-FRONTPAGE frontpage server extension long host string overflow attempt"; flow:to_server,established; content:"shtml.dll"; fast_pattern; http_uri; content:"Host|3A|"; http_header; pcre:"/^Host\x3A\s[^\r\n]{300,}/smiH"; reference:bugtraq,9008; reference:cve,2003-0824; reference:url,www.microsoft.com/technet/security/Bulletin/MS03-051.mspx; classtype:attempted-admin; sid:6409; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer malformed iframe buffer overflow attempt"; flow:to_client,established; file_data; content:"<IFRAME "; pcre:"/<IFRAME\s+[^>]*?src\s*=\s*(\x22|\x27|)[^\x22\x27\s>]{400}/smi"; metadata:policy security-ips drop; reference:bugtraq,11515; reference:cve,2004-1050; classtype:attempted-user; sid:15147; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI pgpmail.pl access"; flow:to_server,established; content:"/pgpmail.pl"; http_uri; reference:bugtraq,3605; reference:cve,2001-0937; reference:nessus,11070; classtype:web-application-activity; sid:2670; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HTML Inline Movie Control ActiveX function call access"; flow:established,to_client; file_data; content:"HTMLInlineVideoCtl.1"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22HTMLInlineVideoCtl.1\x22|\x27HTMLInlineVideoCtl.1\x27)\s*\x3b.*\w+\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)|\w+\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22HTMLInlineVideoCtl.1\x22|\x27HTMLInlineVideoCtl.1\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:cve,2007-0219; reference:url,www.microsoft.com/technet/security/bulletin/MS07-016.mspx; classtype:attempted-user; sid:10150; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 36 ActiveX clsid access"; flow:established,to_client; file_data; content:"C5702CCC-9B79-11D3-B654-00C04F79498E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q59>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C5702CCC-9B79-11D3-B654-00C04F79498E\s*}?\s*(?P=q59)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15646; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player or Explorer Malformed RIFF File DOS attempt"; flow:to_client,established; content:"MThd"; content:"|00 00 00 00 00 00|"; within:6; distance:4; metadata:policy security-ips drop; reference:bugtraq,21612; reference:cve,2006-6601; reference:url,www.milw0rm.com/exploits/3190; classtype:attempted-dos; sid:9801; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Talentsoft Web+ Source Code view access"; flow:to_server,established; content:"/webplus.exe?script=test.wml"; http_uri; reference:bugtraq,1722; reference:url,archives.neohapsis.com/archives/ntbugtraq/2000-q3/0168.html; classtype:web-application-attack; sid:1095; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Creative Software AutoUpdate Engine ActiveX clsid access"; flow:established,to_client; file_data; content:"0A5FD7C5-A45C-49FC-ADB5-9952547D5715"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0A5FD7C5-A45C-49FC-ADB5-9952547D5715\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(cachefolder)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0A5FD7C5-A45C-49FC-ADB5-9952547D5715\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(cachefolder))\s*=/siO"; metadata:policy security-ips drop; reference:bugtraq,29391; reference:cve,2008-0955; classtype:attempted-user; sid:17084; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI cgforum.cgi access"; flow:to_server,established; content:"/cgforum.cgi"; fast_pattern; http_uri; reference:bugtraq,1951; reference:cve,2000-1132; classtype:web-application-activity; sid:1713; rev:13;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 1220 (msg:"WEB-CGI streaming server parse_xml.cgi access"; flow:to_server,established; content:"/parse_xml.cgi"; fast_pattern:only; reference:bugtraq,6954; reference:bugtraq,6955; reference:bugtraq,6956; reference:bugtraq,6958; reference:cve,2003-0050; reference:cve,2003-0051; reference:cve,2003-0052; reference:cve,2003-0053; reference:cve,2003-0423; classtype:web-application-activity; sid:2086; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox JavaScript eval arbitrary code execution attempt"; flow:to_client,established; content:"arguments|2E|callee|2E|"; content:"|5F 5F|parent|5F 5F 2E|eval"; distance:0; fast_pattern; metadata:policy security-ips drop; reference:bugtraq,13645; reference:cve,2005-1532; reference:url,secunia.com/advisories/15528/; classtype:attempted-user; sid:17212; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT BitDefender Internet Security script code execution attempt"; flow:to_client,established; content:"|58 35 4F 21 50 25 40 41 50 5B 34 5C 50 5A 58 35|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0850; classtype:attempted-user; sid:17458; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Color Management Module buffer overflow attempt"; flow:to_client,established; content:"gXYZ"; content:"gXYZ"; within:4; distance:8; content:"bXYZ"; within:4; distance:8; byte_test:4,>,60,4,relative; metadata:policy security-ips drop; reference:bugtraq,14214; reference:cve,2005-1219; classtype:attempted-user; sid:17348; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"WEB-MISC TLSv1 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03 01|"; depth:3; content:"|01|"; depth:1; offset:5; flowbits:set,tlsv1.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:2661; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI tcsh access"; flow:to_server,established; content:"/tcsh"; fast_pattern; http_uri; reference:cve,1999-0509; reference:url,www.cert.org/advisories/CA-1996-11.html; classtype:attempted-recon; sid:872; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Trend Micro HouseCall ActiveX clsid access"; flow:established,to_client; file_data; content:"74D05D43-3236-11D4-BDCD-00C04F9A3B61"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q5>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*74D05D43-3236-11D4-BDCD-00C04F9A3B61\s*}?\s*(?P=q5)(\s|>).*(?P=id1)\s*\.\s*(notifyOnLoadNative)|<object\s*[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*74D05D43-3236-11D4-BDCD-00C04F9A3B61\s*}?\s*(?P=q6)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(notifyOnLoadNative))\s*\(/siO"; metadata:policy security-ips alert; reference:bugtraq,32950; reference:bugtraq,32965; reference:cve,2008-2434; reference:cve,2008-2435; classtype:attempted-user; sid:15177; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 33 ActiveX clsid access"; flow:established,to_client; file_data; content:"B64016F3-C9A2-4066-96F0-BD9563314726"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q53>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*B64016F3-C9A2-4066-96F0-BD9563314726\s*}?\s*(?P=q53)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15640; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer playlist file URL overflow attempt"; flow:to_client,established; flowbits:isset,realplayer.playlist; content:"file|3A|//"; pcre:"/^file\x3a\x2f\x2f[^\n]{400}/smi"; reference:bugtraq,13264; reference:bugtraq,9579; reference:cve,2004-0258; reference:cve,2005-0755; classtype:attempted-user; sid:2438; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXTFilter ActiveX clsid access"; flow:established,to_client; file_data; content:"385A91BC-1E8A-4E4A-A7A6-F4FC1E6CA1BD"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*385A91BC-1E8A-4E4A-A7A6-F4FC1E6CA1BD/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:7926; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Basic Charts ActiveX function call access "; flow:established,to_client; file_data; content:"MSChart20Lib.MSChart"; pcre:"/(?P<c>\w+)\s*=\s*(\x22MSChart20Lib\.MSChart(\.\d)?\x22|\x27MSChart20Lib\.MSChart(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*DoSetCursor\s*|.*(?P=v)\s*\.\s*DoSetCursor\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22MSChart20Lib\.MSChart(\.\d)?\x22|\x27MSChart20Lib\.MSChart(\.\d)?\x27)\s*\)(\s*\.\s*DoSetCursor\s*|.*(?P=n)\s*\.\s*DoSetCursor)\s*=/smiO"; metadata:policy security-ips drop; reference:cve,2008-4256; reference:url,support.microsoft.com/kb/960715; reference:url,www.microsoft.com/technet/security/bulletin/MS08-070.mspx; classtype:attempted-user; sid:15090; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Network Connections ActiveX object access"; flow:established,to_client; file_data; content:"7007ACC7-3202-11D1-AAD2-00805FC1270E"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*7007ACC7-3202-11D1-AAD2-00805FC1270E/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4227; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel oversized ib memory corruption attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|06 00|"; content:"9A|00|A|00|"; within:5; distance:24; metadata:policy security-ips drop; reference:cve,2009-3131; reference:url,www.microsoft.com/technet/security/bulletin/MS09-067.mspx; classtype:attempted-user; sid:16229; rev:5;)
alert tcp $HOME_NET 445 -> $HOME_NET any (msg:"NETBIOS Adobe Premier Pro ibfs32.dll dll-load exploit attempt"; flow:to_client,established; content:"i|00|b|00|f|00|s|00|3|00|2|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2010-3150; reference:url,osvdb.org/show/osvdb/67554; classtype:attempted-user; sid:18530; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 8000:8001 (msg:"WEB-MISC Quicktime User-Agent buffer overflow attempt"; flow:to_server,established; content:"User-Agent|3A|"; pcre:"/^User-Agent\x3a[^\n]{244,255}/smi"; reference:bugtraq,9735; reference:cve,2004-0169; classtype:web-application-attack; sid:2442; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX GraceNote CDDB ActiveX clsid access"; flow:established,to_client; file_data; content:"F4BAFF02-F907-11D2-8F8F-00C04F4C3B9F"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q11>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F4BAFF02-F907-11D2-8F8F-00C04F4C3B9F\s*}?\s*(?P=q11)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,18678; reference:bugtraq,23567; reference:cve,2006-3134; reference:cve,2007-0443; reference:url,www.gracenote.com/corporate/FAQs.html/faqset=update/page=0; reference:url,www.kb.cert.org/vuls/id/701121; classtype:attempted-user; sid:10986; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS ASP contents view"; flow:to_server,established; content:".htw?CiWebHitsFile"; fast_pattern; http_uri; reference:bugtraq,1861; reference:cve,2000-0942; reference:url,www.microsoft.com/technet/security/bulletin/MS00-006.mspx; classtype:web-application-attack; sid:979; rev:18;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbDatabase Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmdbCOM.VmdbDatabase"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmdbCOM\.VmdbDatabase\x22|\x27vmdbCOM\.VmdbDatabase\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmdbCOM\.VmdbDatabase\x22|\x27vmdbCOM\.VmdbDatabase\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14422; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AcerCtrls.APlunch ActiveX clsid access"; flow:established,to_client; file_data; content:"3895DD35-7573-11D2-8FED-00606730D3AA"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3895DD35-7573-11D2-8FED-00606730D3AA\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Run)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3895DD35-7573-11D2-8FED-00606730D3AA\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Run))\s*\(/siO"; metadata:policy security-ips drop; reference:cve,2009-2627; reference:url,www.kb.cert.org/vuls/id/485961; classtype:attempted-user; sid:15878; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft WebDAV MiniRedir remote code execution attempt"; flow:to_client,established; content:"<D|3A|href>"; fast_pattern; isdataat:520,relative; content:!"</D|3A|href>"; within:520; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0080; reference:url,www.microsoft.com/technet/security/bulletin/ms08-007.mspx; classtype:attempted-user; sid:13474; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC TRACE attempt"; flow:to_server,established; content:"TRACE"; depth:5; reference:bugtraq,9561; reference:cve,2003-1567; reference:cve,2004-2320; reference:cve,2010-0360; reference:nessus,11213; classtype:web-application-attack; sid:2056; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Orbit Downloader ActiveX function call access"; flow:established,to_client; file_data; content:"Orbitmxt.Orbit"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Orbitmxt\.Orbit\x22|\x27Orbitmxt\.Orbit\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*Download\s*|.*(?P=v)\s*\.\s*Download\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Orbitmxt\.Orbit\x22|\x27Orbitmxt\.Orbit\x27)\s*\)(\s*\.\s*Download\s*|.*(?P=n)\s*\.\s*Download\s*)\s*\(/smiO"; reference:cve,2008-1602; classtype:attempted-user; sid:14035; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Windows Start Menu ActiveX object access"; flow:established,to_client; file_data; content:"4622AD11-FF23-11D0-8D34-00A0C90F2719"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*4622AD11-FF23-11D0-8D34-00A0C90F2719/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4228; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI AnyForm2 access"; flow:to_server,established; content:"/AnyForm2"; fast_pattern; http_uri; reference:bugtraq,719; reference:cve,1999-0066; reference:nessus,10277; classtype:attempted-recon; sid:892; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX tsuserex.ADsTSUserEx.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"E2E9CAE6-1E7B-4B8E-BABD-E9BF6292AC29"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E2E9CAE6-1E7B-4B8E-BABD-E9BF6292AC29\s*}?\s*(?P=q1)(\s|>)/siO"; metadata:policy security-ips drop; reference:bugtraq,19570; reference:cve,2006-4219; reference:url,www.xsec.org/index.php?module=Releases&act=view&type=1&id=14; classtype:attempted-user; sid:7502; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI mrtg.cgi directory traversal attempt"; flow:to_server,established; content:"/mrtg.cgi"; http_uri; content:"cfg=/../"; reference:bugtraq,4017; reference:cve,2002-0232; reference:nessus,11001; classtype:web-application-attack; sid:1862; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAJoinStyle.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BEE-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BEE-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8816; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC webcart access"; flow:to_server,established; content:"/webcart/"; http_uri; reference:cve,1999-0610; reference:nessus,10298; classtype:attempted-recon; sid:1125; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Possible generic javascript heap spray attempt"; flow:to_client,established; content:"%u4141%u4141"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,35660; classtype:attempted-user; sid:18168; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Rediff Bol Downloader ActiveX function call access"; flow:established,to_client; file_data; content:"BOLDOWNLOADER.BolDownloaderCtrl.1"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22BOLDOWNLOADER.BolDownloaderCtrl.1\x22|\x27BOLDOWNLOADER.BolDownloaderCtrl.1\x27)\s*\x3b.*\w+\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)|\w+\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BOLDOWNLOADER.BolDownloaderCtrl.1\x22|\x27BOLDOWNLOADER.BolDownloaderCtrl.1\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,21831; reference:cve,2006-6838; classtype:attempted-user; sid:9826; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMT FormatConversion Prop Page ActiveX clsid access"; flow:established,to_client; file_data; content:"E188F7A3-A04E-413E-99D1-D79A45F70305"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*E188F7A3-A04E-413E-99D1-D79A45F70305/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7472; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word formatted disk pages table memory corruption attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|D0 CF 11 E0 A1 B1 1A E1|"; content:"|EC A5|"; within:2; distance:504; byte_test:4,>,65535,138,relative,little; metadata:policy security-ips drop; reference:bugtraq,21589; reference:cve,2006-6561; classtype:attempted-user; sid:17507; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Novell iPrint ActiveX clsid access"; flow:established,to_client; file_data; content:"36723f97-7aa0-11d4-8919-ff2d71d0d32c"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2008-0935; reference:cve,2008-2431; reference:cve,2008-2436; reference:cve,2008-2908; reference:cve,2009-1568; reference:cve,2009-1569; reference:cve,2010-1527; reference:cve,2010-3106; reference:cve,2010-4319; reference:cve,2010-4321; classtype:attempted-user; sid:13523; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Multiple vendor Antivirus magic byte detection evasion attempt"; flow:to_client,established; flowbits:isset,http.bat; content:"Content|2D|Type|3A 20|application|2F|bat"; http_header; file_data; pcre:"/(MZ|PK|BZh|BZ|GIF8|BM|IC|PI|CI|CP)/R"; metadata:policy security-ips drop; reference:cve,2005-3370; reference:cve,2005-3371; reference:cve,2005-3372; reference:cve,2005-3373; reference:cve,2005-3374; reference:cve,2005-3375; reference:cve,2005-3376; reference:cve,2005-3377; reference:cve,2005-3378; reference:cve,2005-3379; reference:cve,2005-3380; reference:cve,2005-3381; reference:cve,2005-3382; classtype:attempted-user; sid:17278; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime movie ftyp buffer underflow"; flow:to_client,established; flowbits:isset,http.quicktime; content:"|00 00 00 01|ftyp"; metadata:policy security-ips drop; reference:bugtraq,23652; reference:cve,2007-2296; classtype:attempted-user; sid:11180; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VixCOM.VixLib ActiveX clsid access"; flow:established,to_client; file_data; content:"6874E949-7186-4308-A1B9-D55A91F60728"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6874E949-7186-4308-A1B9-D55A91F60728\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14394; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Hypervisor DOS vfd download attempt"; flow:to_client,established; content:"|29 66 3A E1 58 4E 4F 20 4E 41 4D 45 20 20 20 20 46 41 54 31 32 20 20 20 6A 00|"; fast_pattern:only; reference:cve,2010-0026; reference:url,www.microsoft.com/technet/security/bulletin/MS10-010.mspx; classtype:attempted-admin; sid:18396; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE fpsrvadm.exe access"; flow:to_server,established; content:"/fpsrvadm.exe"; fast_pattern; http_uri; classtype:web-application-activity; sid:943; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file rcsL record exploit attempt"; flow:to_client,established; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00 00 00 05 0E|"; content:"|0A 08 19 1E 1C 1E 1F 1E 44 00 43 01 57 6E A1 9C|"; within:16; distance:512; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17188; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DivXBrowserPlugin ActiveX clsid access"; flow:established,to_client; file_data; content:"67DABFBF-D0AB-41fa-9C46-CC0F21721616"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*id\s*=((\x22|\x27)([^\2]*)\2)\s*classid\s*=\s*(\x22|\x27|)clsid\s*\x3a\s*{?\s*67DABFBF-D0AB-41fa-9C46-CC0F21721616\s*}?\4.*\3\.(Resize)\(|<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*67DABFBF-D0AB-41fa-9C46-CC0F21721616\s*}?\s*\6\s*id\s*=\s*((\x22|\x27)([^\8]*)\8).*\9\.(Resize)\(/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:10189; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Macromedia SiteSpring cross site scripting attempt"; flow:established,to_server; content:"/error/500error.jsp"; http_uri; content:"et="; http_uri; content:"<script"; http_uri; reference:bugtraq,5249; reference:cve,2002-1027; classtype:web-application-attack; sid:1835; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Cryptographic API COM 1 ActiveX clsid access"; flow:established,to_client; file_data; content:"17E3A1C3-EA8A-4970-AF29-7F54610B1D4C"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*17E3A1C3-EA8A-4970-AF29-7F54610B1D4C\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:cve,2007-0940; reference:url,www.microsoft.com/technet/security/bulletin/ms07-028.mspx; classtype:attempted-user; sid:11230; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office eps filters memory corruption attempt"; flow:to_client,established; flowbits:isset, http.eps.download; content:"|0A C5 D0 D3 C6|"; byte_test:2, >, 32767, 24, relative, little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3019; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-044.mspx; classtype:attempted-user; sid:13970; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI alienform.cgi directory traversal attempt"; flow:established,to_server; content:"/alienform.cgi"; http_uri; content:".|7C|./.|7C|."; reference:bugtraq,4983; reference:cve,2002-0934; reference:nessus,11027; classtype:web-application-attack; sid:1822; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT isComponentInstalled function buffer overflow"; flow:to_client,established; file_data; content:"isComponentInstalled"; isdataat:256,relative; pcre:"/isComponentInstalled\s*\([^,\)]{256}/smi"; metadata:policy security-ips drop; reference:bugtraq,16870; reference:cve,2006-1016; classtype:attempted-user; sid:7020; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC apache ?M=D directory list attempt"; flow:to_server,established; content:"/?M=D"; http_uri; reference:bugtraq,3009; reference:cve,2001-0731; reference:nessus,10704; classtype:web-application-activity; sid:1519; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer object management memory corruption attempt"; flow:to_client,established; content:".onpropertychange"; content:".childNode"; within:50; content:".onpropertychange"; distance:0; content:"null"; within:50; pcre:"/([A-Z\d_]+)\.onpropertychange\s*=\s*\1\.childNode.*?\1\.onpropertychange\s*=\s*null.*?\1\.onpropertychange/smi"; metadata:policy security-ips drop; reference:cve,2011-1345; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-018.mspx; classtype:attempted-user; sid:18671; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player ASF marker object parsing buffer overflow attempt"; flow:to_client,established; content:"|01 CD 87 F4|Q|A9 CF 11 8E E6 00 C0 0C| Se"; byte_test:4,>,134217727,24,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-4702; reference:cve,2009-2527; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-078.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-052.mspx; classtype:attempted-user; sid:9643; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Spanish_Modern Stemmer ActiveX clsid access"; flow:established,to_client; file_data; content:"B0516FF0-7F1C-11CE-BE57-00AA0051FE20"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*B0516FF0-7F1C-11CE-BE57-00AA0051FE20/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8035; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC RBS ISP /newuser  directory traversal attempt"; flow:to_server,established; content:"/newuser?Image=../.."; http_uri; reference:bugtraq,1704; reference:cve,2000-1036; reference:nessus,10521; classtype:web-application-attack; sid:1492; rev:14;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC post32.exe access"; flow:to_server,established; content:"/post32.exe"; http_uri; reference:bugtraq,1485; classtype:web-application-activity; sid:2071; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS cmd? access"; flow:to_server,established; content:".cmd?&"; fast_pattern:only; classtype:web-application-attack; sid:1003; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox Animated PNG Processing integer overflow"; flow:to_client,established; flowbits:isset,file.png; content:"IHDR"; byte_test:4,>,32767,0,relative; content:"|01|"; within:1; distance:12; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4064; classtype:attempted-user; sid:17379; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Help 2.0 Contents Control ActiveX clsid access"; flow:established,to_client; file_data; content:"314111b8-a502-11d2-bbca-00c04f8ec294"; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*314111b8-a502-11d2-bbca-00c04f8ec294\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-1086; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-023.mspx; classtype:attempted-user; sid:13668; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Webcam Upload ActiveX clsid unicode access"; flow:established,to_client; file_data; content:"D|00|C|00|E|00|2|00|F|00|8|00|B|00|1|00|-|00|A|00|5|00|2|00|0|00|-|00|1|00|1|00|D|00|4|00|-|00|8|00|F|00|D|00|0|00|-|00|0|00|0|00|D|00|0|00|B|00|7|00|7|00|3|00|0|00|2|00|7|00|7|00|"; fast_pattern:only; pcre:"/1([^>]\x00)*1(?P<q8>\x22\x00|\x27\x00|)1({\x00)?1(}\x00)?(?P=q8)(?=\s\x00|>\x00)/siO"; metadata:policy security-ips drop; reference:bugtraq,24341; reference:cve,2007-3147; classtype:attempted-user; sid:11823; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Basic Hierarchical FlexGrid ActiveX clsid access "; flow:established,to_client; file_data; content:"0ECD9B64-23AA-11D0-B351-00A0C9055D8E"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q22>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0ECD9B64-23AA-11D0-B351-00A0C9055D8E\s*}?\s*(?P=q22)(\s|>).*(?P=id1)\s*\.\s*(Rows)|<object\s*[^>]*\s*classid\s*=\s*(?P<q23>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0ECD9B64-23AA-11D0-B351-00A0C9055D8E\s*}?\s*(?P=q23)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\s*\.\s*(Rows))\s*=/siO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4254; reference:url,support.microsoft.com/kb/960715; reference:url,www.microsoft.com/technet/security/bulletin/MS08-070.mspx; classtype:attempted-user; sid:15100; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Domino events4.nsf access"; flow:to_server,established; content:"/events4.nsf"; http_uri; reference:nessus,10629; classtype:attempted-recon; sid:1580; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MksCompatCtl Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmappsdk.MksCompatCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmappsdk\.MksCompatCtl\x22|\x27vmappsdk\.MksCompatCtl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmappsdk\.MksCompatCtl\x22|\x27vmappsdk\.MksCompatCtl\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14458; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC .DS_Store access"; flow:to_server,established; content:"/.DS_Store"; http_uri; reference:url,www.macintouch.com/mosxreaderreports46.html; classtype:web-application-activity; sid:1769; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer oversize recordset object cache size exploit attempt"; flow:to_client,established; content:"recordset"; content:".CacheSize"; within:100; pcre:"/^\s*=\s*/R"; byte_test:10,>,0x3ffffffe,0,relative,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1117; reference:cve,2010-1118; reference:cve,2010-1259; reference:cve,2010-1262; reference:cve,2011-0027; reference:url,www.microsoft.com/technet/security/bulletin/MS10-035.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS11-002.mspx; classtype:attempted-user; sid:18280; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView NNM getnnmdata.exe CGI ICount parameter buffer overflow attempt"; flow:to_server,established; content:"/OvCgi/getnnmdata|2E|exe"; fast_pattern:only; http_uri; content:"ICount|3D|"; isdataat:300,relative; pcre:"/ICount\x3D\x2D[^\x26\x3F\x3B\x0D\x0A\s]{300}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1554; classtype:attempted-user; sid:19137; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Zenturi ProgramChecker SASATL ActiveX clsid access"; flow:established,to_client; file_data; content:"6754F588-E262-42D2-A6BC-3BB400ACFEED"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6754F588-E262-42D2-A6BC-3BB400ACFEED\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Scan)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6754F588-E262-42D2-A6BC-3BB400ACFEED\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Scan))\s*\(/si"; reference:bugtraq,25025; reference:cve,2007-3984; classtype:attempted-user; sid:12116; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI cvsview2.cgi access"; flow:to_server,established; content:"/cvsview2.cgi"; fast_pattern; http_uri; reference:bugtraq,4579; reference:bugtraq,5517; reference:cve,2003-0153; reference:nessus,11748; classtype:web-application-activity; sid:2197; rev:14;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Microsoft Office Visio invalid ho tag attempt"; flow:to_client,established; flowbits:isset,visio.request; content:"|00 02 0B|@|00 00 00 00 00 00 00 00 FE 00 FF 00 90 03 A7 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33660; reference:cve,2009-0096; reference:url,www.microsoft.com/technet/security/bulletin/MS09-005; classtype:attempted-user; sid:16318; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI register.cgi access"; flow:to_server,established; content:"/register.cgi"; fast_pattern; http_uri; reference:bugtraq,2157; reference:cve,2001-0076; classtype:web-application-activity; sid:1715; rev:13;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 3000 (msg:"WEB-CGI MDaemon form2raw.cgi overflow attempt"; flow:to_server,established; content:"/form2raw.cgi"; fast_pattern:only; pcre:"/\Wfrom=[^\x3b&\n]{100}/si"; reference:bugtraq,9317; reference:cve,2003-1200; reference:url,secunia.com/advisories/10512/; classtype:web-application-attack; sid:2433; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS /msadc/samples/ access"; flow:to_server,established; content:"/msadc/samples/"; fast_pattern; http_uri; reference:bugtraq,167; reference:cve,1999-0736; reference:nessus,1007; classtype:web-application-attack; sid:1401; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX vmappPropObj Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmappsdk.VmappPropObj"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmappsdk\.VmappPropObj\x22|\x27vmappsdk\.VmappPropObj\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmappsdk\.VmappPropObj\x22|\x27vmappsdk\.VmappPropObj\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14340; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC bsml.pl access"; flow:to_server,established; content:"/bsml.pl"; http_uri; reference:bugtraq,9311; reference:nessus,11973; classtype:web-application-activity; sid:2327; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP Intelligent Management Center database credentials information disclosure attempt - 3"; flow:to_server,established; content:"/imc/reportscript/oracle/deploypara.properties"; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40298; reference:url,secunia.com/advisories/39891; classtype:attempted-user; sid:17159; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint OfficeArt atom memory corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|"; depth:8; content:"P|00|o|00|w|00|e|00|r|00|P|00|o|00|i|00|n|00|t|00 20 00|D|00|o|00|c|00|u|00|m|00|e|00|n|00|t|00|"; content:"|00 00 00 00 0A 04 04 00 00 00|"; byte_extract:4,0,ref,little,relative; content:"|00 00 00 00 C1 0B|"; byte_test:4,>,4,0,little,relative; byte_test:4,=,ref,4,little,relative; metadata:policy security-ips drop; reference:cve,2011-0976; reference:url,www.microsoft.com/technet/security/bulletin/MS11-022.mspx; classtype:attempted-admin; sid:18637; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer malformed table remote code execution attempt"; flow:to_client,established; content:"position"; content:"absolute"; distance:0; content:"clip:"; pcre:"/table\s*\x7B[^\x7d]*position\x3a\s*absolute[^\x7d]*clip/smi"; reference:cve,2010-3962; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-090.mspx; classtype:attempted-user; sid:18221; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI emumail.cgi access"; flow:to_server,established; content:"/emumail.cgi"; fast_pattern; http_uri; reference:bugtraq,5824; reference:cve,2002-1526; classtype:web-application-activity; sid:1724; rev:13;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC architext_query.pl access"; flow:to_server,established; content:"/ews/architext_query.pl"; http_uri; reference:bugtraq,2248; reference:cve,1999-0279; reference:nessus,10064; reference:url,www2.fedcirc.gov/alerts/advisories/1998/txt/fedcirc.98.03.txt; classtype:attempted-recon; sid:1173; rev:14;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI csSearch.cgi access"; flow:to_server,established; content:"/csSearch.cgi"; http_uri; reference:bugtraq,4368; reference:cve,2002-0495; reference:nessus,10924; classtype:web-application-activity; sid:1548; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IBM Lotus Domino Web Access 6 ActiveX function call access"; flow:established,to_client; file_data; content:"iNotes6.iNotes6"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22iNotes6\.iNotes6\x22|\x27iNotes6\.iNotes6\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*InstallBrowserHelperDll\s*|.*(?P=v)\s*\.\s*InstallBrowserHelperDll\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22iNotes6\.iNotes6\x22|\x27iNotes6\.iNotes6\x27)\s*\)(\s*\.\s*InstallBrowserHelperDll\s*|.*(?P=n)\s*\.\s*InstallBrowserHelperDll\s*)\s*\(/Osmi"; metadata:policy security-ips alert; reference:bugtraq,26972; reference:cve,2007-4474; reference:cve,2010-0919; classtype:attempted-user; sid:13260; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS VP-ASP shopsearch.asp access"; flow:to_server,established; content:"/shopsearch.asp"; fast_pattern; http_uri; reference:bugtraq,9133; reference:bugtraq,9134; reference:nessus,11942; classtype:web-application-activity; sid:2324; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer document.insertBefore memory corruption attempt"; flow:to_client,established; content:"document.insertBefore(document"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-0036; reference:url,www.microsoft.com/technet/security/bulletin/MS11-003.mspx; classtype:attempted-admin; sid:18404; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Allaire JRUN DOS attempt"; flow:to_server,established; content:"servlet/......."; http_uri; reference:bugtraq,2337; reference:cve,2000-1049; classtype:web-application-attack; sid:1084; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Message System ActiveX clsid access"; flow:established,to_client; file_data; content:"B69003B3-C55E-4b48-836C-BC5946FC3B28"; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*B69003B3-C55E-4b48-836C-BC5946FC3B28\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips alert; reference:cve,2008-0082; reference:url,www.microsoft.com/technet/security/bulletin/MS08-050.mspx; classtype:attempted-user; sid:13965; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAFontStyle.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"25B0F91C-D23D-11D0-9B85-00C04FC2F51D"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*25B0F91C-D23D-11D0-9B85-00C04FC2F51D/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8741; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ISupportErrorInfo Interface ActiveX object access"; flow:established,to_client; file_data; content:"DF0B3D60-548F-101B-8E65-08002B2BD119"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*DF0B3D60-548F-101B-8E65-08002B2BD119/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4899; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC apache chunked encoding memory corruption exploit attempt"; flow:established,to_server; content:"|C0|PR|89 E1|PQRP|B8 3B 00 00 00 CD 80|"; reference:bugtraq,5033; reference:cve,2002-0392; classtype:web-application-activity; sid:1808; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX cfw Class ActiveX object access"; flow:established,to_client; file_data; content:"ECABAFC0-7F19-11D2-978E-0000F8757E2A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*ECABAFC0-7F19-11D2-978E-0000F8757E2A/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4891; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI view_broadcast.cgi access"; flow:to_server,established; content:"/view_broadcast.cgi"; fast_pattern; http_uri; reference:bugtraq,8257; reference:cve,2003-0422; classtype:web-application-activity; sid:2387; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION application.cfm access"; flow:to_server,established; content:"/application.cfm"; fast_pattern; http_uri; reference:arachnids,268; reference:bugtraq,550; reference:cve,1999-0760; reference:cve,2000-0189; classtype:attempted-recon; sid:932; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Ultra Crypto Component CryptoX.dll 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"FD22F3AE-1450-4BDC-ADBE-6AF210A78C2C"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*FD22F3AE-1450-4BDC-ADBE-6AF210A78C2C\s*}?\s*(?P=q6)(\s|>).*(?P=id1)\s*\.\s*(SaveToFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*FD22F3AE-1450-4BDC-ADBE-6AF210A78C2C\s*}?\s*(?P=q7)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\.(SaveToFile))\s*\(/si"; reference:bugtraq,25611; reference:url,www.ultrashareware.com/Ultra-Crypto-Component.htm; classtype:attempted-user; sid:12442; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AXIS Camera ActiveX initialization via script"; flow:established,to_client; file_data; content:"CamImage.CamImage"; pcre:"/(\x3d\s*new\s+ActiveXObject\s*\x28\s*(?P<q1>\x22|\x27)CamImage\.CamImage\.\d(?P=q1)\s*\x29|\x3d\s*CreateObject\s*\x28\s*(?P<q2>\x22|\x27)CamImage\.CamImage\.\d(?P=q2)\s*\x29)/siO"; metadata:policy security-ips drop; reference:bugtraq,33408; reference:cve,2008-5260; classtype:attempted-user; sid:17226; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF single packet heap overflow - ANIMEXTS1.0"; flow:to_client,established; content:"image/"; pcre:"/^Content-Type\s*\x3a(\s*|\s*\r?\n\s+)image\x2fgif/smi"; content:"GIF"; distance:0; content:"!|FF 0B|ANIMEXTS1.0"; distance:0; content:"|02|"; within:1; distance:1; byte_test:4,>,0x7f,3,relative; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:6502; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectX Transform Wrapper Property Page ActiveX clsid access"; flow:established,to_client; file_data; content:"1B544C24-FD0B-11CE-8C63-00AA0044B520"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*1B544C24-FD0B-11CE-8C63-00AA0044B520/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7433; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox Javascript array.splice memory corruption attempt"; flow:to_client,established; content:"a|5B|6|5D 20 3D 20 22|toto|22 3B|"; content:"a|2E|splice|28|6|2C 20|1|29 3B|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33990; reference:cve,2009-0773; classtype:attempted-user; sid:17399; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; content:".pkg"; http_uri; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Epkg/smi"; reference:cve,2007-0465; classtype:attempted-admin; sid:16002; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX reconfig.GuestInfo ActiveX clsid access"; flow:established,to_client; file_data; content:"C0A9F3A2-C933-42E5-8ED4-FC7E9A55686F"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C0A9F3A2-C933-42E5-8ED4-FC7E9A55686F\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14476; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Communications Control v6 ActiveX function call access"; flow:established,to_client; file_data; content:"MSCOMMLib.MSComm"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22MSCOMMLib\.MSComm(\.\d)?\x22|\x27MSCOMMLib\.MSComm(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22MSCOMMLib\.MSComm(\.\d)?\x22|\x27MSCOMMLib\.MSComm(\.\d)?\x27)\s*\)/smiO"; metadata:policy security-ips drop; reference:url,support.microsoft.com/kb/969898; classtype:attempted-user; sid:15545; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Unexpected method call remote code execution attempt"; flow:to_client,established; content:"clearAttributes"; pcre:"/(\w+)\.insertCell.*\1\.deleteCell.*\1\.clearAttributes/smi"; reference:cve,2009-1141; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:attempted-user; sid:15531; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX QuickTime Object ActiveX clsid access"; flow:established,to_client; file_data; content:"02BF25D5-8C17-4B23-BC80-D3488ABDDC6B"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*02BF25D5-8C17-4B23-BC80-D3488ABDDC6B/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:8375; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC handler access"; flow:to_server,established; content:"/handler"; http_uri; reference:arachnids,235; reference:bugtraq,380; reference:cve,1999-0148; reference:nessus,10100; classtype:web-application-activity; sid:1141; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 5 ActiveX clsid access"; flow:established,to_client; file_data; content:"4249304b-198d-4b81-8250-29445ed99c2f"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4249304b-198d-4b81-8250-29445ed99c2f\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14358; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Office 2000 and 2002 Web Components Record Navigation Control ActiveX object access"; flow:established,to_client; file_data; content:"0002E531-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*0002E531-0000-0000-C000-000000000046/si"; metadata:policy security-ips drop; reference:bugtraq,4449; reference:cve,2002-0727; reference:url,www.microsoft.com/technet/security/bulletin/MS02-044.mspx; classtype:attempted-user; sid:4178; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LeadTools JPEG 2000 COM Object ActiveX function call access"; flow:established,to_client; file_data; content:"LEADRasterVariant.LEADRasterVariant"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22LEADRasterVariant\.LEADRasterVariant\x22|\x27LEADRasterVariant\.LEADRasterVariant\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*BitmapDataPath\s*|.*(?P=v)\s*\.\s*BitmapDataPath\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22LEADRasterVariant\.LEADRasterVariant\x22|\x27LEADRasterVariant\.LEADRasterVariant\x27)\s*\)(\s*\.\s*BitmapDataPath\s*|.*(?P=n)\s*\.\s*BitmapDataPath)\s*=/smi"; reference:bugtraq,24040; reference:url,moaxb.blogspot.com/2007/05/moaxb-18-leadtools-jpeg-2000-com.html; classtype:attempted-user; sid:11628; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox JS Web Worker arbitrary code execution attempt"; flow:to_client,established; content:"postMessage"; fast_pattern; content:"data.concat"; within:50; content:"Worker"; pcre:"/\x2epostMessage\s*\x28\s*([^\s]+)\x2edata\x2econcat\s*\x28\1\x2edata\s*\x29/"; reference:cve,2009-3371; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=514554; classtype:attempted-user; sid:18332; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP eSupportDiagnostics 7 ActiveX clsid access"; flow:established,to_client; file_data; content:"6470DE80-1635-4B5D-93A3-3701CE148A79"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q39>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6470DE80-1635-4B5D-93A3-3701CE148A79\s*}?\s*(?P=q39)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28929; reference:cve,2008-0712; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13728; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC rcmd attempt"; flow:to_server,established; content:"rcmd.exe"; http_uri; classtype:web-application-activity; sid:1065; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS del attempt"; flow:to_server,established; content:"&del+/s+c|3A 5C|*.*"; fast_pattern:only; classtype:web-application-attack; sid:1008; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI WhatsUpGold configuration access"; flow:to_server,established; content:"/_maincfgret.cgi"; fast_pattern; http_uri; reference:bugtraq,11043; reference:bugtraq,11109; reference:cve,2004-0798; classtype:web-application-activity; sid:11817; rev:9;)
alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"WEB-MISC SSLv2 Server_Hello request from SSLv3 Client_Hello request"; flow:from_server,established; flowbits:isset,sslv3.client_hello.request; flowbits:isnotset,sslv3.server_hello.request; content:"|04|"; depth:1; offset:2; content:"|00 02|"; depth:2; offset:5; flowbits:set,sslv2.server_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:11671; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT hidden 1x1 div tag - potential malware obfuscation"; flow:to_client,established; content:"<div style=|22|overflow|3A|hidden|3B|width|3A|1px|3B|height|3A|1px|3B 22|>"; fast_pattern:only; metadata:policy security-ips drop; classtype:misc-activity; sid:19868; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Earth Resource Mapper NCSView ActiveX function call access"; flow:established,to_client; file_data; content:"NCSViewManager.NCSView"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22NCSViewManager\.NCSView\x22|\x27NCSViewManager\.NCSView\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22NCSViewManager\.NCSView\x22|\x27NCSViewManager\.NCSView\x27)\s*\)/smi"; reference:bugtraq,25584; reference:cve,2007-4470; classtype:attempted-user; sid:12415; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Basic 6 SearchHelper ActiveX clsid access"; flow:established,to_client; file_data; content:"8B217752-717D-11CE-AB5B-D41203C10000"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q5>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8B217752-717D-11CE-AB5B-D41203C10000\s*}?\s*(?P=q5)(\s|>)/Osi"; reference:cve,2007-2216; reference:url,www.microsoft.com/technet/security/bulletin/ms07-045.mspx; classtype:attempted-user; sid:12265; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX French_French Stemmer ActiveX clsid access"; flow:established,to_client; file_data; content:"2A6EB050-7F1C-11CE-BE57-00AA0051FE20"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*2A6EB050-7F1C-11CE-BE57-00AA0051FE20/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8013; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer innerHTML against incomplete element heap corruption attempt"; flow:to_client,established; content:"|3C|em id|3D 22|obj|22 3E|"; content:"obj|2E|outerHTML|2B 2B|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0490; reference:url,www.microsoft.com/technet/security/bulletin/MS10-018.mspx; classtype:attempted-user; sid:19147; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Rediff Bol Downloader ActiveX clsid access"; flow:established,to_client; file_data; content:"BADA82CB-BF48-4D76-9611-78E2C6F49F03"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BADA82CB-BF48-4D76-9611-78E2C6F49F03\s*}?\s*\1/si"; metadata:policy security-ips drop; reference:bugtraq,21831; reference:cve,2006-6838; classtype:attempted-user; sid:9824; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash cross-site request forgery attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|00|loadClip"; content:"|00|loadVariables"; content:"|00 8E 0F 00|loadUrl"; distance:0; metadata:policy security-ips drop; reference:cve,2011-2139; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19692; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Tumbleweed SecureTransport ActiveX clsid access"; flow:established,to_client; file_data; content:"38681fbd-d4cc-4a59-a527-b3136db711d3"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*38681fbd-d4cc-4a59-a527-b3136db711d3\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(TransferFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*38681fbd-d4cc-4a59-a527-b3136db711d3\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(TransferFile))\s*\(/siO"; metadata:policy security-ips drop; classtype:attempted-user; sid:16566; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint out of bounds value remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|C3 0B|"; byte_test:1,>,1,8,relative; byte_test:1,<,27,8,relative; byte_test:4,>,7,4,relative,little; content:!"|FF FF FF FF|"; within:4; distance:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0031; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:16411; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word document summary information null string overflow attempt"; flow:to_client,established; file_data; content:"|02 D5 CD D5 9C|.|1B 10 93 97 08 00|+,|F9 AE|"; content:"|1E 00 00 00 00 00 00 00|"; distance:0; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7200; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.MMSpecialEffect1Input ActiveX clsid access"; flow:established,to_client; file_data; content:"353359C1-39E1-491b-9951-464FD8AB071C"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*353359C1-39E1-491b-9951-464FD8AB071C/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-021.mspx; classtype:attempted-user; sid:6684; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Skype Extras Manager ActiveX clsid access"; flow:established,to_client; file_data; content:"42481700-CF3C-4D05-8EC6-F9A1C57E8DC0"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*42481700-CF3C-4D05-8EC6-F9A1C57E8DC0\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(RegisterWindow)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*42481700-CF3C-4D05-8EC6-F9A1C57E8DC0\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(RegisterWindow))\s*=/siO"; metadata:policy security-ips drop; reference:bugtraq,36459; reference:cve,2009-4741; classtype:attempted-user; sid:17674; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI RiSearch show.pl proxy attempt"; flow:to_server,established; content:"/show.pl"; fast_pattern; http_uri; content:"url="; reference:bugtraq,10812; classtype:web-application-activity; sid:3465; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer EMBED element memory corruption attempt"; flow:to_client,established; content:"function|20|open|5F|win|28 29|"; content:"document|2E|body|2E|innerHTML|20 3D|"; distance:0; content:"|22 3C|embed|20|type|3D 27|audio|2F|midi|27 3E|"; distance:0; content:"setInterval|28 27|open|5F|win|28 29 27 2C 20|1|29 3B|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34424; reference:cve,2009-0553; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-014.mspx; classtype:attempted-user; sid:17709; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Novell ZENworks Desktop Management ActiveX function call access"; flow:established,to_client; file_data; content:"AxNalServer.CAxNalWebInterface"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22AxNalServer\.CAxNalWebInterface\x22|\x27AxNalServer\.CAxNalWebInterface\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*CanUninstall\s*|.*(?P=v)\s*\.\s*CanUninstall\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22AxNalServer\.CAxNalWebInterface\x22|\x27AxNalServer\.CAxNalWebInterface\x27)\s*\)(\s*\.\s*CanUninstall\s*|.*(?P=n)\s*\.\s*CanUninstall\s*)\s*\(/Osmi"; metadata:policy security-ips alert; reference:bugtraq,31435; classtype:attempted-user; sid:14754; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Photoshop CS4 ABR file processing buffer overflow attempt - 2"; flow:to_client,established; content:"AnglUntF"; byte_test:4,>,1020,12,relative,big; content:"8BBR"; metadata:policy security-ips drop; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17144; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office thumbnail bitmap invalid biClrUsed attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|E0 85 9F F2 F9 4F 68 10 AB 91 08 00 2B 27 B3 D9 30 00 00 00|"; content:"|11 00 00 00|"; distance:0; content:"|47 00 00 00|"; distance:0; content:"|08 00 00 00 28 00 00 00|"; within:8; distance:8; pcre:"/^(?=.{10}[\x01\x04\x08\x16\x24\x32]\x00)(.{3}[\x55-\xFF]|.{31}[\x80-\xFF])/sR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3970; reference:url,www.microsoft.com/technet/security/bulletin/MS11-006.mspx; classtype:attempted-user; sid:18265; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC adminlogin access"; flow:to_server,established; content:"/adminlogin"; http_uri; reference:bugtraq,1164; reference:bugtraq,1175; reference:nessus,11748; classtype:attempted-recon; sid:1218; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WebViewFolderIcon.WebViewFolderIcon.1 ActiveX function call"; flow:established,to_client; file_data; content:"WebViewFolderIcon.WebViewFolderIcon.1"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,19030; reference:cve,2006-3730; reference:url,browserfun.blogspot.com/2006/07/mobb-18-webviewfoldericon-setslice.html; reference:url,www.microsoft.com/technet/security/bulletin/ms06-057.mspx; classtype:attempted-user; sid:8419; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 30 ActiveX clsid access"; flow:established,to_client; file_data; content:"8DBC7A04-B478-41D5-BE05-5545D565B59C"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q47>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8DBC7A04-B478-41D5-BE05-5545D565B59C\s*}?\s*(?P=q47)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14146; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FFmpeg 4xm processing memory corruption attempt"; flow:to_client,established; flowbits:isset,4xm.request; content:"strk|28 00 00 00|"; byte_test:4,>,0x7ffffffe,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33502; reference:cve,2009-0385; classtype:attempted-user; sid:15871; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC carbo.dll access"; flow:to_server,established; content:"/carbo.dll"; http_uri; content:"icatcommand="; metadata:policy security-ips drop; reference:bugtraq,2126; reference:cve,1999-1069; classtype:attempted-recon; sid:1001; rev:13;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Adobe Shockwave Flash Flex authoring tool XSS exploit attempt"; flow:to_server,established; content:"/EncDecUtils.swf|3F|"; fast_pattern; http_uri; content:"resourceModuleURLs="; http_uri; content:"http"; within:4; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2461; reference:url,www.adobe.com/support/security/bulletins/apsb11-25.html; classtype:attempted-admin; sid:20610; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java Web Start JNLP attribute buffer overflow attempt"; flow:to_client,established; content:"<j2se"; pcre:"/\x3cj2se[^\x3e]*(initial|max)-heap-size\s*\x3d\s*(\x22|\x27)[^\x22\x27]{50}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30148; reference:cve,2008-3111; classtype:attempted-user; sid:13950; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DASound.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BE4-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BE4-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8786; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime HREF Track Detected"; flow:to_client,established; flowbits:isset,http.quicktime; content:"> T<"; fast_pattern:only; pcre:"/A?<\s*([A-Za-z]{3,5}\x3A\x2F\x2F|javascript\x3a)[^>]+> T</sm"; metadata:policy security-ips drop; reference:cve,2007-0059; reference:url,projects.info-pull.com/moab/MOAB-03-01-2007.html; reference:url,www.apple.com/quicktime/tutorials/hreftracks.html; classtype:misc-activity; sid:9840; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC .htpasswd access"; flow:to_server,established; content:".htpasswd"; classtype:web-application-attack; sid:1071; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI faxsurvey access"; flow:to_server,established; content:"/faxsurvey"; fast_pattern; http_uri; reference:bugtraq,2056; reference:cve,1999-0262; reference:nessus,10067; classtype:web-application-activity; sid:857; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LexRefBilingualTextContext ActiveX function call access"; flow:established,to_client; file_data; content:"LR.LexRefBilingualTextContext.1.0.1"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22LR.LexRefBilingualTextContext.1.0.1\x22|\x27LR.LexRefBilingualTextContext.1.0.1\x27)\s*\x3b.*\w+\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)|\w+\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22LR.LexRefBilingualTextContext.1.0.1\x22|\x27LR.LexRefBilingualTextContext.1.0.1\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:cve,2007-0219; reference:url,www.microsoft.com/technet/security/bulletin/MS07-016.mspx; classtype:attempted-user; sid:10144; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave DIR file PAMI chunk code execution attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"XFIR"; depth:4; content:"pami"; distance:0; byte_test:4,>,0x7FFFFFFF,4,relative,little; metadata:policy security-ips drop; reference:cve,2010-1292; reference:url,secunia.com/advisories/38751/; reference:url,www.adobe.com/support/security/bulletins/apsb10-12.html; classtype:attempted-user; sid:16673; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Office Viewer ActiveX function call access"; flow:established,to_client; file_data; content:"OA.OActrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22OA\.OActrl(\.\d)?\x22|\x27OA\.OActrl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(DoOleCommand|FTPDownloadFile|FTPUploadFile|HttpUploadFile|Save|SaveWebFile|OpenWebFile)\s*|.*(?P=v)\s*\.\s*(DoOleCommand|FTPDownloadFile|FTPUploadFile|HttpUploadFile|Save|SaveWebFile|OpenWebFile)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22OA\.OActrl(\.\d)?\x22|\x27OA\.OActrl(\.\d)?\x27)\s*\)(\s*\.\s*(DoOleCommand|FTPDownloadFile|FTPUploadFile|HttpUploadFile|Save|SaveWebFile|OpenWebFile)\s*|.*(?P=n)\s*\.\s*(DoOleCommand|FTPDownloadFile|FTPUploadFile|HttpUploadFile|Save|SaveWebFile|OpenWebFile)\s*)\s*\(/smiO"; reference:bugtraq,23811; reference:bugtraq,33243; reference:bugtraq,33283; reference:url,moaxb.blogspot.com/2007/05/moaxb-04-office-viewer-oaocx-v-32.html; classtype:attempted-user; sid:11201; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer invalid object access memory corruption attempt"; flow:to_client,established; content:"createEventObject"; content:"innerHTML"; distance:0; pcre:"/createEventObject[^\x7D]+innerHTML\s*\x3D\s*\S+[^\x7D]+(setTimeout|setInterval)/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0249; reference:url,www.microsoft.com/technet/security/bulletin/MS10-002.mspx; classtype:attempted-user; sid:16367; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAFontStyle.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAFontStyle.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAFontStyle.1\x22|\x27DirectAnimation.DAFontStyle.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAFontStyle.1\x22|\x27DirectAnimation.DAFontStyle.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8743; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP eSupportDiagnostics 10 ActiveX clsid access"; flow:established,to_client; file_data; content:"93441C07-E57E-4086-B912-F323D741A9D8"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q4>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*93441C07-E57E-4086-B912-F323D741A9D8\s*}?\s*(?P=q4)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28929; reference:cve,2008-0712; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13734; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC server negative Content-Length attempt"; flow:to_client,established; content:"Content-Length"; pcre:"/^Content-Length\s*\x3a\s*-\d+/mi"; reference:bugtraq,10508; reference:cve,2004-0492; reference:url,www.guninski.com/modproxy1.html; classtype:attempted-admin; sid:2580; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI technote main.cgi file directory traversal attempt"; flow:to_server,established; content:"/technote/main.cgi"; fast_pattern; http_uri; content:"filename="; content:"../../"; reference:bugtraq,2156; reference:cve,2001-0075; reference:nessus,10584; classtype:web-application-attack; sid:1051; rev:18;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CurrentVMCtl Class ActiveX function call access"; flow:established,to_client; file_data; content:"Vmappsdk.CurrentVMCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Vmappsdk\.CurrentVMCtl\x22|\x27Vmappsdk\.CurrentVMCtl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Vmappsdk\.CurrentVMCtl\x22|\x27Vmappsdk\.CurrentVMCtl\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14588; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI mailman directory traversal attempt"; flow:to_server,established; content:"/mailman/"; http_uri; content:".../"; http_uri; reference:cve,2005-0202; classtype:web-application-attack; sid:3131; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE access.cnf access"; flow:to_server,established; content:"/_vti_pvt/access.cnf"; fast_pattern; http_uri; reference:bugtraq,4078; reference:cve,2002-1717; reference:nessus,10575; classtype:web-application-activity; sid:955; rev:18;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 19 ActiveX clsid access"; flow:established,to_client; file_data; content:"9BAFC7B3-F318-4BD4-BABB-6E403272615A"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q21>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*9BAFC7B3-F318-4BD4-BABB-6E403272615A\s*}?\s*(?P=q21)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14124; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 6/7 single line outerHTML invalid reference arbitrary code execution attempt"; flow:to_client,established; file_data; content:"document.getElementsByTagName|28|'STYLE'|29|[0].outerHTML"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,37085; reference:cve,2009-3672; reference:cve,2009-4054; reference:url,www.microsoft.com/technet/security/bulletin/MS09-072.mspx; classtype:attempted-user; sid:16311; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI cgimail access"; flow:to_server,established; content:"/cgimail"; fast_pattern; http_uri; reference:bugtraq,1623; reference:cve,2000-0726; reference:nessus,11721; classtype:web-application-activity; sid:1542; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 66 ActiveX clsid access"; flow:established,to_client; file_data; content:"9275A865-754B-4EDF-B828-FED0F8D344FC"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q125>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*9275A865-754B-4EDF-B828-FED0F8D344FC\s*}?\s*(?P=q125)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14218; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Messenger CYFT ActiveX function call access"; flow:established,to_client; file_data; content:"ft60.YFT"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ft60\.YFT\x22|\x27ft60\.YFT\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*GetFile\s*|.*(?P=v)\s*\.\s*GetFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ft60\.YFT\x22|\x27ft60\.YFT\x27)\s*\)(\s*\.\s*GetFile\s*|.*(?P=n)\s*\.\s*GetFile\s*)\s*\(/smi"; reference:bugtraq,25727; reference:cve,2007-5017; classtype:attempted-user; sid:12478; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Windows Media Transform Effects ActiveX clsid access"; flow:established,to_client; file_data; content:"B4DC8DD9-2CC1-4081-9B2B-20D7030234EF"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*B4DC8DD9-2CC1-4081-9B2B-20D7030234EF/si"; metadata:policy security-ips drop; reference:cve,2006-1303; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-021.mspx; classtype:attempted-user; sid:6681; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Zenturi ProgramChecker ActiveX function call access"; flow:established,to_client; file_data; content:"SafeAndSoundATL.NixonConfigMgrEx"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22SafeAndSoundATL\.NixonConfigMgrEx\x22|\x27SafeAndSoundATL\.NixonConfigMgrEx\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(Fill|DebugMsgLog|DownloadFile)\s*|.*(?P=v)\s*\.\s*(Fill|DebugMsgLog|DownloadFile)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22SafeAndSoundATL\.NixonConfigMgrEx\x22|\x27SafeAndSoundATL\.NixonConfigMgrEx\x27)\s*\)(\s*\.\s*(Fill|DebugMsgLog|DownloadFile)\s*|.*(?P=n)\s*\.\s*(Fill|DebugMsgLog|DownloadFile)\s*)\s*\(/siO"; reference:bugtraq,24217; reference:bugtraq,24274; reference:bugtraq,24848; reference:bugtraq,24883; reference:cve,2007-2987; reference:cve,2007-3703; classtype:attempted-user; sid:11675; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Windows MFC Library ActiveX clsid access"; flow:established,to_client; file_data; content:"F3F381A3-4795-41FF-8190-7AA2A8102F85"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F3F381A3-4795-41FF-8190-7AA2A8102F85\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(FindFile|ListFiles)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F3F381A3-4795-41FF-8190-7AA2A8102F85\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(FindFile|ListFiles))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,25697; reference:cve,2007-4916; classtype:attempted-user; sid:12612; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Domino collect4.nsf access"; flow:to_server,established; content:"/collect4.nsf"; http_uri; reference:nessus,10629; classtype:attempted-recon; sid:1582; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [8008,8028] (msg:"WEB-MISC Novell eDirectory management console Accept-Language buffer overflow attempt"; flow:to_server,established; content:"/nds"; content:"Accept-Language"; distance:0; content:"|3A|"; distance:0; pcre:"/^\s*Accept-Language\s*\x3a\s*([^\r\n]*?\x2c){20}/mi"; metadata:policy security-ips drop; reference:bugtraq,31553; reference:cve,2008-4479; reference:cve,2008-5094; reference:url,download.novell.com/Download?buildid=Cf15mVyA3GI~; classtype:attempted-admin; sid:15446; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI bb-replog.sh access"; flow:to_server,established; content:"/bb-replog.sh"; fast_pattern; http_uri; reference:bugtraq,142; reference:cve,1999-1462; classtype:attempted-recon; sid:1462; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ftp Asychronous Pluggable Protocol Handler ActiveX clsid access"; flow:established,to_client; file_data; content:"79EAC9E3-BAF9-11CE-8C82-00AA004BA90B"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q3>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*79EAC9E3-BAF9-11CE-8C82-00AA004BA90B\s*}?\s*(?P=q3)(\s|>)/si"; metadata:policy security-ips drop; reference:cve,2007-0218; reference:url,www.microsoft.com/technet/security/bulletin/MS07-033.mspx; classtype:attempted-user; sid:7934; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC /etc/passwd"; flow:to_server,established; content:"/etc/passwd"; http_uri; classtype:attempted-recon; sid:1122; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX NCTAudioInformation2 ActiveX function call access"; flow:established,to_client; file_data; content:"NCTAudioInformation2.AudioInformation2"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22NCTAudioInformation2\.AudioInformation2(\.\d)?\x22|\x27NCTAudioInformation2\.AudioInformation2(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(GetAudioInformation|SetAudioInformation)\s*|.*(?P=v)\s*\.\s*(GetAudioInformation|SetAudioInformation)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22NCTAudioInformation2\.AudioInformation2(\.\d)?\x22|\x27NCTAudioInformation2\.AudioInformation2(\.\d)?\x27)\s*\)(\s*\.\s*(GetAudioInformation|SetAudioInformation)\s*|.*(?P=n)\s*\.\s*(GetAudioInformation|SetAudioInformation)\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:cve,2008-0959; reference:url,www.kb.cert.org/vuls/id/669265; classtype:attempted-user; sid:15290; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView Performance Insight Server backdoor account code execution attempt"; flow:to_server,established; content:"/services"; http_uri; content:"aGNoOTA4djp6NnQwaiQraQ=="; fast_pattern:only; http_header; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,46079; reference:cve,2011-0276; classtype:attempted-admin; sid:18560; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMMsg Class ActiveX clsid access"; flow:established,to_client; file_data; content:"3d41639a-88cc-43d2-b6cb-2ce98a24509d"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3d41639a-88cc-43d2-b6cb-2ce98a24509d\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14344; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CGI Symantec IM Manager LoggedInUsers.lgx definition file multiple SQL injections attempt"; flow:to_server,established; content:"/IMManager/rdpageimlogic.aspx?"; fast_pattern:only; http_uri; pcre:"/\x2FIMManager\x2Frdpageimlogic\x2Easpx\x3F.*?(loginTimeStamp|dbo|dateDiffParam|whereClause)\x3D[^\x26]*?(\x3B|\x23|\x2D{2})/sU"; metadata:policy security-ips drop; reference:bugtraq,44299; reference:cve,2010-0112; classtype:web-application-attack; sid:18955; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAGeometry.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAGeometry.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAGeometry.1\x22|\x27DirectAnimation.DAGeometry.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAGeometry.1\x22|\x27DirectAnimation.DAGeometry.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8824; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI mmstdod.cgi access"; flow:to_server,established; content:"/mmstdod.cgi"; fast_pattern; http_uri; reference:bugtraq,2063; reference:cve,2001-0021; reference:nessus,10566; classtype:attempted-recon; sid:819; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel OBJ record stack buffer overflow attempt - with macro"; flow:to_client,established; flowbits:isset,http.xls; content:"|5D 00|"; content:"|15 00 12 00 14 00|"; within:6; distance:2; content:"|0C 00 14 00|"; within:4; distance:16; content:"|04 00|"; within:2; distance:20; byte_jump:2,0,relative,little; content:"|13 00|"; within:2; byte_test:2,>,0,0,relative,little; byte_jump:2,2,relative,little; byte_test:2,>,1024,14,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0822; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16639; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Multimedia File Property Sheet ActiveX object access"; flow:established,to_client; file_data; content:"00022613-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*00022613-0000-0000-C000-000000000046/si"; metadata:policy security-ips drop; reference:bugtraq,5094; classtype:attempted-user; sid:4159; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI FormHandler.cgi directory traversal attempt attempt"; flow:to_server,established; content:"/FormHandler.cgi"; http_uri; content:"reply_message_attach="; fast_pattern:only; content:"/../"; reference:bugtraq,798; reference:bugtraq,799; reference:cve,1999-1050; reference:nessus,10075; classtype:web-application-attack; sid:1628; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMClientHost Class ActiveX clsid access"; flow:established,to_client; file_data; content:"9663f7c7-44fb-4075-bc83-829b47db7936"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*9663f7c7-44fb-4075-bc83-829b47db7936\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14436; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Google Chrome and Apple Safari Ruby before and after memory corruption"; flow:to_client,established; file_data; content:"<ruby>"; fast_pattern:only; content:"ruby|3A|"; pcre:"/(before|after).*?((display\x3atable|counter-reset\x3a)|(counter-reset\x3a|display\x3atable)).*?ruby\s*{\s*float\x3a/siR"; reference:cve,2011-1440; classtype:attempted-user; sid:20579; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAPair.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BF4-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BF4-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8798; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Embedded Open Type Font malformed name table integer overflow attempt"; flow:to_client,established; flowbits:isset,eot.download; content:"|00 01 00 00|"; content:"|00 04|"; within:2; distance:2; byte_test:2,>,35752,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0232; reference:url,www.microsoft.com/technet/security/bulletin/MS09-029.mspx; classtype:attempted-user; sid:15694; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Windows MFC Library ActiveX function call access"; flow:established,to_client; file_data; content:"HpqUtil.System"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22HpqUtil\.System(\.\d)?\x22|\x27HpqUtil\.System(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(FindFile|ListFiles)\s*|.*(?P=v)\s*\.\s*(FindFile|ListFiles)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22HpqUtil\.System(\.\d)?\x22|\x27HpqUtil\.System(\.\d)?\x27)\s*\)(\s*\.\s*(FindFile|ListFiles)\s*|.*(?P=n)\s*\.\s*(FindFile|ListFiles)\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:bugtraq,25697; reference:cve,2007-4916; classtype:attempted-user; sid:12614; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealPlayer AutoStream.AutoStream.1 ActiveX function call access"; flow:established,to_client; file_data; content:"AutoStream.AutoStream.1"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22AutoStream.AutoStream.1\x22|\x27AutoStream.AutoStream.1\x27)\s*\x3b.*\w+\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)|\w+\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22AutoStream.AutoStream.1\x22|\x27AutoStream.AutoStream.1\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,21802; reference:cve,2006-6847; classtype:attempted-user; sid:9673; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Input Method Editor 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"DA56F851-D3C5-11D3-844C-00C04F7A06E5"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DA56F851-D3C5-11D3-844C-00C04F7A06E5\s*}?\s*\1/si"; metadata:policy security-ips drop; reference:cve,2006-4697; reference:url,www.microsoft.com/technet/security/bulletin/MS07-016.mspx; classtype:attempted-user; sid:10140; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Studio 6 VBTOVSI.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"7EEA39E3-41D1-11D2-AB3B-00AA00BDD685"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q4>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7EEA39E3-41D1-11D2-AB3B-00AA00BDD685\s*}?\s*(?P=q4)(\s|>)/si"; reference:bugtraq,25635; reference:cve,2007-4890; classtype:attempted-user; sid:12461; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Elevated.ElevMgr ActiveX function call access"; flow:established,to_client; file_data; content:"Elevated.ElevMgr"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Elevated\.ElevMgr\x22|\x27Elevated\.ElevMgr\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Elevated\.ElevMgr\x22|\x27Elevated\.ElevMgr\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14356; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS /iisadmpwd/aexp2.htr access"; flow:to_server,established; content:"/iisadmpwd/aexp2.htr"; fast_pattern; http_uri; reference:bugtraq,2110; reference:bugtraq,4236; reference:cve,1999-0407; reference:cve,2002-0421; reference:nessus,10371; classtype:web-application-activity; sid:1487; rev:18;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Free Download Manager .torrent parsing path overflow attempt"; flow:to_client,established; flowbits:isset,http.torrent; file_data; content:"4|3A|pathl"; byte_test:6,>,10000,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16520; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LeadTools Raster Dialog File Object ActiveX clsid access"; flow:established,to_client; file_data; content:"00140B79-B1BA-11CE-ABC6-F5B2E79D9E3F"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m5>\x22|\x27|)(?P<id1>.+?)(?P=m5)(\s|>)[^>]*\s*classid\s*=\s*(?P<q11>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*00140B79-B1BA-11CE-ABC6-F5B2E79D9E3F\s*}?\s*(?P=q11)(\s|>).*(?P=id1)\s*\.\s*(Directory)|<object\s*[^>]*\s*classid\s*=\s*(?P<q12>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*00140B79-B1BA-11CE-ABC6-F5B2E79D9E3F\s*}?\s*(?P=q12)(\s|>)[^>]*\s*id\s*=\s*(?P<m6>\x22|\x27|)(?P<id2>.+?)(?P=m6)(\s|>).*(?P=id2)\s*\.\s*(Directory))\s*=/si"; reference:bugtraq,24133; reference:url,moaxb.blogspot.com/2007/05/moaxb-24-leadtools-raster-dialog-file.html; classtype:attempted-user; sid:11630; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX McAfee ePolicy Orchestrator ActiveX clsid access"; flow:established,to_client; file_data; content:"4124FDF6-B540-44C5-96B4-A380CEE9826A"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*id\s*=((\x22|\x27)([^\2]*)\2)\s*classid\s*=\s*(\x22|\x27|)clsid\s*\x3a\s*{?\s*4124FDF6-B540-44C5-96B4-A380CEE9826A\s*}?\4.*\3\.(ExportSiteList|VerifyPackageCatalog)\(|<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4124FDF6-B540-44C5-96B4-A380CEE9826A\s*}?\s*\6\s*id\s*=\s*((\x22|\x27)([^\8]*)\8).*\9\.(ExportSiteList|VerifyPackageCatalog)\(/si"; metadata:policy security-ips drop; reference:bugtraq,22952; reference:url,knowledge.mcafee.com/SupportSite/search.do?cmd=displayKC&docType=kc&sliceId=SAL_Public&externalId=612496; classtype:attempted-user; sid:10387; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX TriEditDocument.TriEditDocument ActiveX clsid access"; flow:established,to_client; file_data; content:"438DA5E0-F171-11D0-984E-0000F80270F8"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*438DA5E0-F171-11D0-984E-0000F80270F8\s*}?\s*\1/si"; metadata:policy security-ips drop; reference:bugtraq,18946; reference:cve,2006-3591; reference:url,browserfun.blogspot.com/2006/07/mobb-12-trieditdocument-url.html; reference:url,osvdb.org/27056; classtype:attempted-user; sid:9821; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WebEx Meeting Manager atucfobj ActiveX function call access"; flow:established,to_client; file_data; content:"WebexUCFObject.WebexUCFObject"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22WebexUCFObject\.WebexUCFObject\x22|\x27WebexUCFObject\.WebexUCFObject\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*NewObject\s*|.*(?P=v)\s*\.\s*NewObject\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22WebexUCFObject\.WebexUCFObject\x22|\x27WebexUCFObject\.WebexUCFObject\x27)\s*\)(\s*\.\s*NewObject\s*|.*(?P=n)\s*\.\s*NewObject\s*)\s*\(/Osmi"; metadata:policy security-ips alert; reference:bugtraq,30578; reference:cve,2008-3558; reference:url,www.cisco.com/warp/public/707/cisco-sa-20080814-webex.shtml; classtype:attempted-user; sid:14015; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows javascript arguments keyword override rce attempt"; flow:to_client,established; content:"function arguments"; fast_pattern:only; pcre:"/function arguments\s*\x28[^\x29]*\x29\s*\x7b/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1920; reference:url,www.microsoft.com/technet/security/bulletin/MS09-045.mspx; classtype:attempted-user; sid:15913; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AOLFlash.AOLFlash ActiveX clsid access"; flow:established,to_client; file_data; content:"C1145550-A454-11D4-9020-00D0B7239081"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C1145550-A454-11D4-9020-00D0B7239081/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:7888; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer ani file processing - remote code execution attempt"; flow:to_client,established; file_data; content:"RIFF"; depth:4; fast_pattern; content:"ACON"; within:4; distance:4; content:"anih"; content:!"|18 00 00 00|"; within:4; metadata:policy security-ips drop, service http; reference:cve,2007-0038; reference:url,www.microsoft.com/technet/security/bulletin/ms07-017; classtype:attempted-user; sid:19886; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows WebDAV pathname buffer overflow attempt"; flow:to_client,established; content:"file|3A 2F 2F 5C 5C|"; pcre:"/file\x3A\x2F\x2F\x5C\x5C[^\s\x22\x27]{234}/smi"; reference:cve,2008-4259; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-073.mspx; classtype:attempted-user; sid:15115; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer invalid object access memory corruption attempt"; flow:to_client,established; file_data; content:".length|3B|i++"; content:"+= String.fromCharCode("; within:100; content:".charCodeAt(i)"; within:100; pcre:"/iframe\s+src\s*\x3D\s*(\x22|\x27)[^\1]+\x2Egif\1\s+onload\s*\x3D\s*(\x22|\x27)[^\2]+\x28event\x29\2/smi"; reference:cve,2010-0249; reference:url,www.microsoft.com/technet/security/bulletin/MS10-002.mspx; classtype:attempted-user; sid:19937; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI environ.pl access"; flow:to_server,established; content:"/environ.pl"; fast_pattern; http_uri; classtype:web-application-activity; sid:1651; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word .rtf file stylesheet buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.rtf; file_data; content:"|5C|stylesheet"; content:"|5C|stylesheet"; distance:0; content:"|5C|stylesheet"; distance:0; content:"|5C|stylesheet"; distance:0; content:"|5C|stylesheet"; distance:0; content:"|5C|stylesheet"; distance:0; metadata:policy security-ips drop; reference:cve,2008-4031; reference:url,www.microsoft.com/technet/security/bulletin/MS08-072.mspx; classtype:attempted-user; sid:15107; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX EasyMail IMAP4 ActiveX clsid access"; flow:established,to_client; file_data; content:"0CEA3FB1-7F88-4803-AA8E-AD021566955D"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0CEA3FB1-7F88-4803-AA8E-AD021566955D\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(LicenseKey)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0CEA3FB1-7F88-4803-AA8E-AD021566955D\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(LicenseKey))/siO"; metadata:policy security-ips drop; reference:bugtraq,25467; reference:cve,2007-4607; classtype:attempted-user; sid:16779; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealPlayer RMOC3260.DLL cdda URI overflow attempt"; flow:established,to_client; file_data; content:"CFCDAA03-8BE4-11CF-B84B-0020AFBBCCFA"; fast_pattern:only; content:"cdda|3A 2F 2F|"; isdataat:100,relative; pcre:"/cdda\x3A\x2F\x2F[^\s\x22\x27]{100}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,44144; reference:cve,2010-3747; classtype:attempted-user; sid:18578; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer VML source file memory corruption attempt"; flow:to_client,established; content:"vmlframe"; pcre:"/<(?P<t>[\w\x2D\x2E]+)\x3A[^>]+>.*?<(?P=t)\x3Avmlframe\s+[^>]*src\s*=\s*(?P<q>\x22|\x27)[\w\x25\x2D\x2E\x2F\x3A]+\x2E\w{2,4}(?P=q)/smi"; reference:bugtraq,25310; reference:cve,2007-1749; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-050.mspx; classtype:attempted-user; sid:12282; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Sun Java Web Start ActiveX clsid access"; flow:established,to_client; file_data; content:"5852F5ED-8BF4-11D4-A245-0080C6F74284"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5852F5ED-8BF4-11D4-A245-0080C6F74284\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(dnsResolve)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5852F5ED-8BF4-11D4-A245-0080C6F74284\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(dnsResolve))\s*\(/Osi"; metadata:policy security-ips drop; reference:bugtraq,25734; reference:cve,2007-5019; classtype:attempted-user; sid:12472; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Amaya web editor XML and HTML Parser Buffer overflow attempt"; flow:to_client,established; file_data; content:"<bdo"; pcre:"/^.*?dir\s*=\s*(\x22[^\x22]{500}|\x27[^\x27]{500}|[^\s\>]{500})/isR"; reference:bugtraq,33047; reference:cve,2009-0323; classtype:attempted-user; sid:16601; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT BitDefender Internet Security script code execution attempt"; flow:to_client,established; file_data; content:"PK|03 04 0A|"; within:5; content:"|3C 68 31 3E 20 69 64 3D 22 68 65 61 64 65 72 22 20 6F 6E 6D 6F 75 73 65 6D 6F 76 65 3D 22 61 6C 65 72 74 28 27 41 73 73 75 72 65 6E 74 20 53 65 63 75 72 65 20 54|"; within:54; distance:25; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0850; classtype:attempted-user; sid:17460; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAMatte.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BD2-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BD2-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8810; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT HP OpenView Network Node Manager ovlaunch host field overflow attempt"; flow:to_server,established; content:"ovlaunch.exe"; http_uri; content:"host|3A|"; isdataat:300,relative; pcre:"/^host\x3a\s*[^\r\n]{300}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33668; reference:cve,2008-4562; classtype:attempted-user; sid:16204; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.Redirect ActiveX function call access"; flow:established,to_client; file_data; content:"DXImageTransform.Microsoft.Redirect"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22DXImageTransform\.Microsoft\.Redirect\x22|\x27DXImageTransform\.Microsoft\.Redirect\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22DXImageTransform\.Microsoft\.Redirect\x22|\x27DXImageTransform\.Microsoft\.Redirect\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/bulletin/ms06-013.mspx; classtype:attempted-user; sid:11241; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS ASP.NET 2.0 cross-site scripting attempt"; flow:to_server,established; content:"__LASTFOCUS="; fast_pattern:only; pcre:"/__LASTFOCUS=(?!([_a-z]\w*|)([\x26\x3B]|$))/i"; reference:bugtraq,20337; reference:cve,2006-3436; reference:url,www.microsoft.com/technet/security/bulletin/MS06-056.mspx; classtype:attempted-user; sid:8700; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI formmail arbitrary command execution attempt"; flow:to_server,established; content:"/formmail"; fast_pattern; http_uri; content:"%0a"; reference:arachnids,226; reference:bugtraq,1187; reference:bugtraq,2079; reference:cve,1999-0172; reference:cve,2000-0411; reference:nessus,10076; reference:nessus,10782; classtype:web-application-attack; sid:1610; rev:18;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC b2 arbitrary command execution attempt"; flow:to_server,established; content:"/b2/b2-include/"; http_uri; content:"b2inc"; content:"http|3A|//"; reference:bugtraq,4673; reference:cve,2002-0734; reference:cve,2002-1466; reference:nessus,11667; classtype:web-application-attack; sid:1757; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Basic Charts ActiveX clsid access "; flow:established,to_client; file_data; content:"3A2B370C-BA0A-11D1-B137-0000F8753F5D"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m11>\x22|\x27|)(?P<id1>.+?)(?P=m11)(\s|>)[^>]*\s*classid\s*=\s*(?P<q42>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3A2B370C-BA0A-11D1-B137-0000F8753F5D\s*}?\s*(?P=q42)(\s|>).*(?P=id1)\s*\.\s*(DoSetCursor)|<object\s*[^>]*\s*classid\s*=\s*(?P<q43>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3A2B370C-BA0A-11D1-B137-0000F8753F5D\s*}?\s*(?P=q43)(\s|>)[^>]*\s*id\s*=\s*(?P<m12>\x22|\x27|)(?P<id2>.+?)(?P=m12)(\s|>).*(?P=id2)\s*\.\s*(DoSetCursor))\s*=/siO"; metadata:policy security-ips drop; reference:cve,2008-4256; reference:url,support.microsoft.com/kb/960715; reference:url,www.microsoft.com/technet/security/bulletin/MS08-070.mspx; classtype:attempted-user; sid:15088; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 24 ActiveX clsid access"; flow:established,to_client; file_data; content:"edaf3a1f-942e-4062-89b0-5276060dff93"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*edaf3a1f-942e-4062-89b0-5276060dff93\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14564; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 15 ActiveX clsid access"; flow:established,to_client; file_data; content:"b39924ac-b164-4f0a-b2d8-f07295df710d"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*b39924ac-b164-4f0a-b2d8-f07295df710d\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14466; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader and Acrobat TTF SING table parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/Subtype"; content:"/TrueType"; within:20; content:"name"; within:1024; byte_test:4,=,0,8,relative; content:"SING"; byte_test:4,!=,0,8,relative; metadata:policy security-ips drop; reference:bugtraq,43057; reference:cve,2010-2883; reference:url,www.adobe.com/support/security/advisories/apsa10-02.html; classtype:attempted-user; sid:18987; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS NewsPro administration authentication attempt"; flow:to_server,established; content:"logged,true"; reference:bugtraq,4672; reference:cve,2002-1734; classtype:web-application-activity; sid:1756; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAView.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"283807B5-2C60-11D0-A31D-00AA00B92C03"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*283807B5-2C60-11D0-A31D-00AA00B92C03/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8765; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HTML Help ActiveX object access"; flow:established,to_client; file_data; content:"41B23C28-488E-4e5C-ACE2-BB0BBABE99E8"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*41B23C28-488E-4e5C-ACE2-BB0BBABE99E8/si"; metadata:policy security-ips drop; reference:bugtraq,13953; reference:cve,2005-1208; reference:url,www.microsoft.com/technet/security/bulletin/MS05-026.mspx; classtype:attempted-user; sid:4183; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMEnumStrings Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmappsdk.VMEnumStrings"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmappsdk\.VMEnumStrings\x22|\x27vmappsdk\.VMEnumStrings\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmappsdk\.VMEnumStrings\x22|\x27vmappsdk\.VMEnumStrings\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14432; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VeralSoft HTTP File Uploader ActiveX clsid access"; flow:established,to_client; file_data; content:"28776DAD-5914-42A7-9139-8FD7C756BBDD"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m5>\x22|\x27|)(?P<id1>.+?)(?P=m5)(\s|>)[^>]*\s*classid\s*=\s*(?P<q11>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*28776DAD-5914-42A7-9139-8FD7C756BBDD\s*}?\s*(?P=q11)(\s|>).*(?P=id1)\s*\.\s*(AddFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q12>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*28776DAD-5914-42A7-9139-8FD7C756BBDD\s*}?\s*(?P=q12)(\s|>)[^>]*\s*id\s*=\s*(?P<m6>\x22|\x27|)(?P<id2>.+?)(?P=m6)(\s|>).*(?P=id2)\.(AddFile))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,23853; reference:url,moaxb.blogspot.com/2007/05/moaxb-07-versalsoft-http-file-uploader.html; classtype:attempted-user; sid:11214; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Messenger YMailAttach ActiveX function call access"; flow:established,to_client; file_data; content:"YMMAPI.YMailAttach"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22YMMAPI.YMailAttach\x22|\x27YMMAPI.YMailAttach\x27)\s*\x3b.*(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)(\s*\.\s*(TextETACalculating)\s*\(|.*\3\s*\.\s*(TextETACalculating)\s*\()|(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22YMMAPI.YMailAttach\x22|\x27YMMAPI.YMailAttach\x27)\s*\)(\s*\.\s*(TextETACalculating)\s*\(|.*\7\s*\.\s*(TextETACalculating)\s*\()/smi"; metadata:policy security-ips drop; reference:bugtraq,21607; reference:cve,2006-6603; reference:url,messenger.yahoo.com/security_update.php?id=120806; classtype:attempted-user; sid:9812; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Symantec Norton AntiVirus CcErrDisp ActiveX function call access"; flow:established,to_client; file_data; content:"CcErrDsp.ErrorDisplay"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22CcErrDsp\.ErrorDisplay(\.\d)?\x22|\x27CcErrDsp\.ErrorDisplay(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*DisplayError\s*|.*(?P=v)\s*\.\s*DisplayError\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22CcErrDsp\.ErrorDisplay(\.\d)?\x22|\x27CcErrDsp\.ErrorDisplay(\.\d)?\x27)\s*\)(\s*\.\s*DisplayError\s*|.*(?P=n)\s*\.\s*DisplayError\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,12175; classtype:attempted-user; sid:17582; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MsnPUpld ActiveX object access"; flow:established,to_client; file_data; content:"C3DFA998-A486-11d4-AA25-00C04F72DAEB"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C3DFA998-A486-11d4-AA25-00C04F72DAEB/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/bulletin/MS05-025.mspx; classtype:attempted-user; sid:4191; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC mkplog.exe access"; flow:to_server,established; content:"/mkplog.exe"; http_uri; classtype:web-application-activity; sid:1664; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Cisco IOS HTTP configuration attempt"; flow:to_server,established; content:"/level/"; http_uri; pcre:"/\x2flevel\x2f\d+\x2f(exec|configure)/iU"; reference:bugtraq,2936; reference:cve,2001-0537; reference:nessus,10700; classtype:web-application-attack; sid:1250; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 10 ActiveX clsid access"; flow:established,to_client; file_data; content:"F1F51698-7B63-4394-8743-1F4CF1853DE1"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q3>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F1F51698-7B63-4394-8743-1F4CF1853DE1\s*}?\s*(?P=q3)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14106; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Image Viewer CP Gold 6 ActiveX clsid access"; flow:established,to_client; file_data; content:"E589DA78-AD4C-4FC5-B6B9-9E47B110679E"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E589DA78-AD4C-4FC5-B6B9-9E47B110679E\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(TIFMergeMultiFiles|Image2PDF)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E589DA78-AD4C-4FC5-B6B9-9E47B110679E\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(TIFMergeMultiFiles|Image2PDF))/siO"; metadata:policy security-ips drop; reference:bugtraq,45155; classtype:attempted-user; sid:18325; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI eshop.pl arbitrary command execution attempt"; flow:to_server,established; content:"/eshop.pl?seite=|3B|"; fast_pattern; http_uri; reference:bugtraq,3340; reference:cve,2001-1014; classtype:web-application-attack; sid:1565; rev:16;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Microsoft Forefront UAG arbitrary embedded scripting attempt "; flow:to_server,established; content:"|2E|asp|3F|"; http_uri; content:"ONMOUSEOVER|3D 27|"; http_uri; metadata:policy security-ips drop; reference:cve,2010-2733; reference:url,www.microsoft.com/technet/security/bulletin/MS10-089.mspx; classtype:attempted-user; sid:18073; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AXIS Camera ActiveX clsid access"; flow:established,to_client; file_data; content:"917623D1-D8E5-11D2-BE8B-00104B06BDE3"; pcre:"/<object\s+[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*917623D1-D8E5-11D2-BE8B-00104B06BDE3\s*}?\s*(?P=q1)(\s|>)/i"; metadata:policy security-ips drop; reference:bugtraq,33408; reference:cve,2008-5260; classtype:attempted-user; sid:15243; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Terminal Services Advanced Client ActiveX object access"; flow:established,to_client; file_data; content:"1fb464c8-09bb-4017-a2f5-eb742f04392f"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*1fb464c8-09bb-4017-a2f5-eb742f04392f/si"; metadata:policy security-ips drop; reference:bugtraq,5554; reference:cve,2002-0726; reference:url,www.microsoft.com/technet/security/bulletin/MS02-046.mspx; classtype:attempted-user; sid:4185; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 67 ActiveX clsid access"; flow:established,to_client; file_data; content:"6C095616-6064-43ca-9180-CF1B6B6A0BE4"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q127>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6C095616-6064-43ca-9180-CF1B6B6A0BE4\s*}?\s*(?P=q127)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14220; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 5555 (msg:"WEB-MISC HP OpenView Storage Data Protector directory traversal attempt"; flow:to_server,established; content:"|2E 00 5C 00 2E 00 2E 00 5C 00|"; content:"|32 00 00 00|"; depth:4; offset:6; content:"1|00|7|00 00 00|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2011-1736; classtype:attempted-recon; sid:20531; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC HP OpenView Manager DOS"; flow:to_server,established; content:"/OvCgi/OpenView5.exe?Context=Snmp&Action=Snmp&Host=&Oid="; http_uri; reference:bugtraq,2845; reference:cve,2001-0552; classtype:misc-activity; sid:1258; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Windows Media Encoder 9 ActiveX clsid access"; flow:established,to_client; file_data; content:"A8D3AD02-7508-4004-B2E9-AD33F087F43C"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A8D3AD02-7508-4004-B2E9-AD33F087F43C\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(GetDetailsString)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A8D3AD02-7508-4004-B2E9-AD33F087F43C\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(GetDetailsString))\s*\(/siO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3008; reference:url,www.microsoft.com/technet/security/bulletin/MS08-053.mspx; classtype:attempted-user; sid:14255; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMR ImageSync 9 ActiveX object access"; flow:established,to_client; file_data; content:"E4979309-7A32-495E-8A92-7B014AAD4961"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*E4979309-7A32-495E-8A92-7B014AAD4961/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4903; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes AAC file handling integer overflow attempt"; flow:to_client,established; content:"mp4a"; content:"stsc"; distance:0; byte_jump:4,-8,relative,big; content:"stsz"; within:4; byte_test:4,<,257,-8,relative,big; byte_test:4,>,60,8,relative,big; metadata:policy security-ips drop; reference:bugtraq,18730; reference:cve,2006-1467; classtype:attempted-user; sid:16055; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC sadmind worm access"; flow:to_server,established; content:"GET x HTTP/1.0"; depth:15; reference:url,www.cert.org/advisories/CA-2001-11.html; classtype:attempted-recon; sid:1375; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.MMSpecialEffect2Inputs ActiveX function call access"; flow:established,to_client; file_data; content:"DXImageTransform.Microsoft.MMSpecialEffect2Inputs"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DXImageTransform.Microsoft.MMSpecialEffect2Inputs\x22|\x27DXImageTransform.Microsoft.MMSpecialEffect2Inputs\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DXImageTransform.Microsoft.MMSpecialEffect2Inputs\x22|\x27DXImageTransform.Microsoft.MMSpecialEffect2Inputs\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-021.mspx; classtype:attempted-user; sid:6682; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer VIDORV30 header length buffer overflow"; flow:to_client,established; content:".RMF"; content:"VIDORV30"; distance:0; byte_test:4,>,1000000,-16,relative; reference:bugtraq,11309; reference:cve,2004-1481; reference:url,www.eeye.com/html/research/advisories/AD20041001.html; classtype:attempted-admin; sid:3470; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC guestbook.pl access"; flow:to_server,established; content:"/guestbook.pl"; http_uri; reference:arachnids,228; reference:bugtraq,776; reference:cve,1999-0237; reference:cve,1999-1053; reference:nessus,10099; classtype:attempted-recon; sid:1140; rev:15;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI ikonboard.cgi access"; flow:to_server,established; content:"/ikonboard.cgi"; fast_pattern; http_uri; reference:bugtraq,7361; reference:nessus,11605; classtype:web-application-activity; sid:2127; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes Playlist Overflow Attempt"; flow:to_client,established; flowbits:isset,http.m3u.download; file_data; content:"|23|EXTM3U"; within:7; isdataat:1000; pcre:"/https?\x3a\x2f\x2f[^\n\r]{1000}/Ri"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2005-0043; classtype:attempted-user; sid:18484; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Reader plugin agm.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|agm.dll"; http_uri; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18440; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8889 (msg:"WEB-MISC Openwsman HTTP basic authentication buffer overflow attempt"; flow:to_server,established; content:"Authorization|3A|"; content:"Basic"; isdataat:256,relative; pcre:"/^Authorization\x3a\s*Basic[^\n]{256}/mi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30694; reference:cve,2008-2234; classtype:attempted-user; sid:14992; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Repository Interface Definition ActiveX object access"; flow:established,to_client; file_data; content:"6E227109-F799-11CF-9227-00AA00A1EB95"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*6E227109-F799-11CF-9227-00AA00A1EB95/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4906; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Oracle iSQL Plus cross site scripting attempt"; flow:to_server,established; content:"/isqlplus"; http_uri; content:"action="; http_uri; pcre:"/action(=|\x3f)[^(\n|&)]*\x3c[^(\n|&)]+\x3e/Ui"; reference:bugtraq,9484; reference:cve,2004-2115; classtype:web-application-attack; sid:11193; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ProShow Gold PSH file handling overflow attempt"; flow:to_client,established; file_data; content:"Photodex|28|R|29| ProShow|28|TM|29| Show File Version"; within:41; content:"cell[0].images[0].image="; distance:0; isdataat:512,relative; content:!"|0A|"; within:512; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3214; reference:url,osvdb.org/show/osvdb/57226; classtype:attempted-user; sid:16730; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer invalid object modification exploit attempt"; flow:to_client,established; content:"callback"; pcre:"/on((before|)(de|)activate|focus(in|out))\s*\x3d\s*function[^\x7d]*callback/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1530; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:attempted-user; sid:15536; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.NDFXArtEffects ActiveX function call access"; flow:established,to_client; file_data; content:"DXImageTransform.Microsoft.NDFXArtEffects.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DXImageTransform.Microsoft.NDFXArtEffects.1\x22|\x27DXImageTransform.Microsoft.NDFXArtEffects.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DXImageTransform.Microsoft.NDFXArtEffects.1\x22|\x27DXImageTransform.Microsoft.NDFXArtEffects.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,19340; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-042.mspx; classtype:attempted-user; sid:8425; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC sml3com access"; flow:to_server,established; content:"/graphics/sml3com"; http_uri; reference:bugtraq,2721; reference:cve,2001-0740; classtype:web-application-activity; sid:1291; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Works file converter file section length headers memory corruption attempt"; flow:to_client,established; flowbits:isset,works.download; content:"STSH"; byte_test:2,>,32768,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,27657; reference:cve,2007-0216; reference:url,www.microsoft.com/technet/security/bulletin/ms08-011.mspx; classtype:attempted-user; sid:13466; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Java Web Start ActiveX launch command by JavaScript CLSID"; flow:established,to_client; file_data; content:"CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA"; fast_pattern:only; content:"createElement"; content:"Launch"; pcre:"/(?P<obj>[A-Z\d_]+)\s*=\s*document\.createElement\((?P<q1>\x22|\x27|)OBJECT(?P=q1)\).*?(?P=obj)\.classid\s*=\s*(?P<q2>\x22|\x27|)clsid\x3ACAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA(?P=q2).*?(?P=obj)\.launch\(/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16548; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI test.cgi access"; flow:to_server,established; content:"/test.cgi"; fast_pattern; http_uri; classtype:web-application-activity; sid:1646; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Sample_showcode.html access"; flow:to_server,established; content:"/Sample_showcode.html"; http_uri; content:"fname"; reference:bugtraq,9555; classtype:web-application-activity; sid:2371; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_client,established; flowbits:isset,http.pct; file_data; content:"PICT"; depth:4; content:"|00 07|"; within:2; distance:594; byte_test:2,>,0x7fff,2,relative; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:19908; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX BlnSetUser Proxy ActiveX function call access"; flow:established,to_client; file_data; content:"BlnMgrPs.BlnSetUserPs.11"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22BlnMgrPs.BlnSetUserPs.11\x22|\x27BlnMgrPs.BlnSetUserPs.11\x27)\s*\x3b.*\w+\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)|\w+\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22BlnMgrPs.BlnSetUserPs.11\x22|\x27BlnMgrPs.BlnSetUserPs.11\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:cve,2007-0219; reference:url,www.microsoft.com/technet/security/bulletin/MS07-016.mspx; classtype:attempted-user; sid:10153; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS JET VBA access"; flow:to_server,established; content:"/scripts/samples/ctguestb.idc"; fast_pattern; http_uri; reference:bugtraq,307; reference:cve,1999-0874; reference:nessus,10116; classtype:web-application-activity; sid:984; rev:21;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Akamai DownloadManager ActiveX function call access"; flow:established,to_client; file_data; content:"MANAGER.DLMCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22MANAGER\.DLMCtrl(\.\d)?\x22|\x27MANAGER\.DLMCtrl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22MANAGER\.DLMCtrl(\.\d)?\x22|\x27MANAGER\.DLMCtrl(\.\d)?\x27)\s*\)/smiO"; metadata:policy security-ips drop; reference:url,support.microsoft.com/kb/960715; classtype:attempted-user; sid:15317; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Scriptlet.Typelib ActiveX clsid access"; flow:established,to_client; file_data; content:"06290BD5-48AA-11D2-8432-006008C3FBFC"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*06290BD5-48AA-11D2-8432-006008C3FBFC/si"; metadata:policy security-ips drop; reference:bugtraq,1754; reference:bugtraq,598; reference:cve,1999-0668; reference:cve,2000-1061; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;KB240308; reference:url,www.microsoft.com/technet/security/Bulletin/MS99-032.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS00-075.mspx; classtype:attempted-user; sid:8064; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Domino domlog.nsf access"; flow:to_server,established; content:"/domlog.nsf"; http_uri; reference:nessus,10629; classtype:attempted-recon; sid:1152; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI nsManager.cgi access"; flow:to_server,established; content:"/nsManager.cgi"; fast_pattern; http_uri; reference:bugtraq,1710; reference:bugtraq,4579; reference:cve,2000-1023; reference:nessus,11748; classtype:web-application-activity; sid:2215; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Comodo AntiVirus ActiveX clsid access"; flow:established,to_client; file_data; content:"309F674D-E4D3-46BD-B9E2-ED7DFD7FD176"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m9>\x22|\x27|)(?P<id1>.+?)(?P=m9)(\s|>)[^>]*\s*classid\s*=\s*(?P<q21>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*309F674D-E4D3-46BD-B9E2-ED7DFD7FD176\s*}?\s*(?P=q21)(\s|>).*(?P=id1)\s*\.\s*(ExecuteStr)|<object\s*[^>]*\s*classid\s*=\s*(?P<q22>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*309F674D-E4D3-46BD-B9E2-ED7DFD7FD176\s*}?\s*(?P=q22)(\s|>)[^>]*\s*id\s*=\s*(?P<m10>\x22|\x27|)(?P<id2>.+?)(?P=m10)(\s|>).*(?P=id2)\.(ExecuteStr))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,27424; classtype:attempted-user; sid:13337; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"271DC252-6FE1-4D59-9053-E4CF50AB99DE"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*271DC252-6FE1-4D59-9053-E4CF50AB99DE\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14320; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Intuit QuickBooks Online Edition 10 ActiveX clsid access"; flow:established,to_client; file_data; content:"40F8967E-34A6-474a-837A-CEC1E7DAC54C"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q4>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*40F8967E-34A6-474a-837A-CEC1E7DAC54C\s*}?\s*(?P=q4)(\s|>).*(?P=id1)\s*\.\s*(httpGETToFile|httpPOSTFromFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q5>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*40F8967E-34A6-474a-837A-CEC1E7DAC54C\s*}?\s*(?P=q5)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\.(httpGETToFile|httpPOSTFromFile))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,25544; reference:cve,2007-0322; reference:cve,2007-4471; reference:url,sc.accounting.quickbooks.com/Update/index.cfm?id=32; reference:url,www.kb.cert.org/vuls/id/907481; reference:url,www.kb.cert.org/vuls/id/979638; reference:url,www.microsoft.com/technet/security/bulletin/MS07-069.mspx; classtype:attempted-user; sid:12411; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer FTP command injection attempt"; flow:to_client,established; content:"ftp|3A 2F 2F|"; pcre:"/^[^\s]*\x250[ad]/iR"; reference:bugtraq,11826; reference:cve,2004-1166; classtype:attempted-user; sid:18300; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 7777 (msg:"WEB-CGI WhatsUpGold configuration access"; flow:to_server,established; content:"/_maincfgret.cgi"; fast_pattern; http_uri; reference:bugtraq,11043; reference:cve,2004-0798; classtype:web-application-activity; sid:12057; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Clever Database Comparer ActiveX function call access"; flow:established,to_client; file_data; content:"comparerax.IBDBExtract"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22comparerax\.IBDBExtract\x22|\x27comparerax\.IBDBExtract\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*ConnectToDatabase\s*|.*(?P=v)\s*\.\s*ConnectToDatabase\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22comparerax\.IBDBExtract\x22|\x27comparerax\.IBDBExtract\x27)\s*\)(\s*\.\s*ConnectToDatabase\s*|.*(?P=n)\s*\.\s*ConnectToDatabase\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,23969; reference:url,moaxb.blogspot.com/2007/05/moaxb-14-clever-database-comparer.html; classtype:attempted-user; sid:11299; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word document summary information string overflow attempt"; flow:to_client,established; file_data; content:"|02 D5 CD D5 9C|.|1B 10 93 97 08 00|+,|F9 AE|"; content:"|1E 00 00 00|"; distance:0; byte_test:4,>,2147483646,0,relative; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7202; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbQuery Class ActiveX clsid access"; flow:established,to_client; file_data; content:"477ca8b0-4c2a-40c9-a440-28acb95cfad8"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*477ca8b0-4c2a-40c9-a440-28acb95cfad8\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14366; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI /cgi-bin/ access"; flow:to_server,established; content:"/cgi-bin/"; http_uri; content:"/cgi-bin/ HTTP"; fast_pattern:only; classtype:web-application-attack; sid:1668; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Gnu gv buffer overflow attempt"; flow:to_client,established; content:"%%DocumentMedia|3A|"; isdataat:257,relative; content:!"|0A|"; within:257; metadata:policy security-ips drop; reference:bugtraq,20978; reference:cve,2006-5864; classtype:attempted-user; sid:9619; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC ServletManager access"; flow:to_server,established; content:"/servlet/ServletManager"; http_uri; reference:bugtraq,3697; reference:cve,2001-1195; reference:nessus,12122; classtype:web-application-activity; sid:2447; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI bb-hostscv.sh access"; flow:to_server,established; content:"/bb-hostsvc.sh"; fast_pattern; http_uri; reference:bugtraq,1455; reference:cve,2000-0638; reference:nessus,10460; classtype:web-application-activity; sid:1533; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Lotus Domino Web Access ActiveX Controls buffer overflow attempt"; flow:established,to_client; file_data; isdataat:1024; content:"ctrl.InstallBrowserHelperDll"; content:"General_ServerName"; content:!">"; within:1024; pcre:"/(3BFFE033-BF43-11d5-A271-00A024A51325|iNotes6\.iNotes6|E008A543-CEFB-4559-912F-C27C2B89F13B|dwa7\.dwa7|983A9C21-8207-4B58-BBB8-0EBC3D7C5505|dwa85?\.dwa85?|75AA409D-05F9-4f27-BD53-C7339D4B1D0A)/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,38457; reference:cve,2010-0919; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21421808; classtype:attempted-user; sid:17545; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 38292 (msg:"WEB-MISC Symantec Alert Management System modem string buffer overflow attempt"; flow:to_server,established; content:"|FF FF FF FF|"; depth:4; content:"PAGE"; depth:4; offset:30; content:"ModemString|00|"; distance:0; byte_test:2,>,32,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2010-0110; reference:url,www.symantec.com/business/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=2011&suid=20110126_00; classtype:attempted-user; sid:19209; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft.WebCapture ActiveX clsid access"; flow:established,to_client; file_data; content:"742D385A-D5BF-427D-9AF2-88258FB73EAF"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*742D385A-D5BF-427D-9AF2-88258FB73EAF/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:8399; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Web on Windows ActiveX clsid access"; flow:established,to_client; file_data; content:"441E9D47-9F52-11D6-9672-0080C88B3613"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m13>\x22|\x27|)(?P<id1>.+?)(?P=m13)(\s|>)[^>]*\s*classid\s*=\s*(?P<q27>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*441E9D47-9F52-11D6-9672-0080C88B3613\s*}?\s*(?P=q27)(\s|>).*(?P=id1)\s*\.\s*(WriteIniFileString|ShellExecute)|<object\s*[^>]*\s*classid\s*=\s*(?P<q28>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*441E9D47-9F52-11D6-9672-0080C88B3613\s*}?\s*(?P=q28)(\s|>)[^>]*\s*id\s*=\s*(?P<m14>\x22|\x27|)(?P<id2>.+?)(?P=m14)(\s|>).*(?P=id2)\.(WriteIniFileString|ShellExecute))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,33515; reference:cve,2009-0389; classtype:attempted-user; sid:15350; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Dynamic Casts ActiveX function call"; flow:established,to_client; file_data; content:"DirectAnimation.DATuple"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7436; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMT DeInterlace Prop Page ActiveX clsid access"; flow:established,to_client; file_data; content:"A2EDA89A-0966-4B91-9C18-AB69F098187F"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*A2EDA89A-0966-4B91-9C18-AB69F098187F/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7466; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Vie2Lib.Vie2LinuxVolume ActiveX function call access"; flow:established,to_client; file_data; content:"Vie2Lib.Vie2LinuxVolume"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Vie2Lib\.Vie2LinuxVolume\x22|\x27Vie2Lib\.Vie2LinuxVolume\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Vie2Lib\.Vie2LinuxVolume\x22|\x27Vie2Lib\.Vie2LinuxVolume\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14276; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Agent buffer overflow attempt"; flow:to_client,established; content:"|C2 AB CD AB|"; byte_test:4,<,500,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,21034; reference:cve,2006-3445; reference:url,www.microsoft.com/technet/security/bulletin/ms06-068.mspx; classtype:attempted-user; sid:9433; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS trace.axd access"; flow:to_server,established; content:"/trace.axd"; fast_pattern; http_uri; reference:nessus,10993; classtype:web-application-activity; sid:1660; rev:14;)
alert tcp $HTTP_SERVERS 443 -> $EXTERNAL_NET any (msg:"WEB-MISC SSLv2 Server_Hello request from TLSv1 Client_Hello request"; flow:from_server,established; flowbits:isset,tlsv1.client_hello.request; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,sslv3.server_hello.request; flowbits:isnotset,tlsv1.server_hello.request; content:"|04|"; depth:1; offset:2; content:"|00 02|"; depth:2; offset:5; flowbits:set,sslv2.server_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:11965; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAstatics ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAstatics"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22DirectAnimation\.DAstatics\x22|\x27DirectAnimation\.DAstatics\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22DirectAnimation\.DAstatics\x22|\x27DirectAnimation\.DAstatics\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/bulletin/ms06-013.mspx; classtype:attempted-user; sid:11245; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Reader plugin ace.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|ace.dll"; http_uri; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18439; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealPlayer RMOC3260.DLL ActiveX function call access"; flow:established,to_client; file_data; content:"rmocx.RealPlayer G2 Control"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22rmocx\.RealPlayer\s*G2\s*Control(\.\d)?\x22|\x27rmocx\.RealPlayer\s*G2\s*Control(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(ParseWallClock|GetSourceTransport|DoPlay)\s*|.*(?P=v)\s*\.\s*(ParseWallClock|GetSourceTransport|DoPlay)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22rmocx\.RealPlayer\s*G2\s*Control(\.\d)?\x22|\x27rmocx\.RealPlayer\s*G2\s*Control(\.\d)?\x27)\s*\)(\s*\.\s*(ParseWallClock|GetSourceTransport|DoPlay)\s*|.*(?P=n)\s*\.\s*(ParseWallClock|GetSourceTransport|DoPlay)\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,24658; reference:bugtraq,26660; reference:bugtraq,28157; reference:bugtraq,44144; reference:cve,2007-3410; reference:cve,2007-6224; reference:cve,2008-1309; reference:cve,2010-3747; reference:url,labs.idefense.com/intelligence/vulnerabilities/display.php?id=547; classtype:attempted-user; sid:12767; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer table layout access violation vulnerability"; flow:to_client,established; content:"|2E|getClientRects|28 29|"; content:"|2E|clearAttributes|28 29|"; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-2258; reference:url,www.microsoft.com/technet/security/bulletin/ms08-045.mspx; classtype:misc-attack; sid:13961; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla EnsureCachedAttrPraramArrays integer overflow attempt"; flow:to_client,established; file_data; content:"<applet"; isdataat:2000,relative; content:!"</applet"; within:2000; content:"<param"; within:2000; reference:bugtraq,41842; reference:cve,2010-1214; classtype:attempted-user; sid:18809; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Word Viewer ActiveX clsid access"; flow:established,to_client; file_data; content:"97AF4A45-49BE-4485-9F55-91AB40F22BF2"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m7>\x22|\x27|)(?P<id1>.+?)(?P=m7)(\s|>)[^>]*\s*classid\s*=\s*(?P<q14>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*97AF4A45-49BE-4485-9F55-91AB40F22BF2\s*}?\s*(?P=q14)(\s|>).*(?P=id1)\s*\.\s*(DoOleCommand|FTPDownloadFile|FTPUploadFile|HttpUploadFile|Save|SaveWebFile|OpenWebFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q15>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*97AF4A45-49BE-4485-9F55-91AB40F22BF2\s*}?\s*(?P=q15)(\s|>)[^>]*\s*id\s*=\s*(?P<m8>\x22|\x27|)(?P<id2>.+?)(?P=m8)(\s|>).*(?P=id2)\.(DoOleCommand|FTPDownloadFile|FTPUploadFile|HttpUploadFile|Save|SaveWebFile|OpenWebFile))\s*\(/siO"; metadata:policy balanced-ips drop, policy security-ips alert, service http; reference:bugtraq,23784; reference:bugtraq,33238; reference:bugtraq,33243; reference:url,moaxb.blogspot.com/2007/05/moaxb-03-wordviewerocx-32-multiple_03.html; classtype:attempted-user; sid:11187; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IE Address ActiveX clsid access"; flow:established,to_client; file_data; content:"de011590-0531-4804-9c9c-3fedc7e6e5c8"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*de011590-0531-4804-9c9c-3fedc7e6e5c8\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:url,download.microsoft.com/download/2/7/0/270e884a-9ba8-47e9-a732-15caee568f76/AdditionalInfo_KB905915.rtf; reference:url,support.microsoft.com/kb/905915; reference:url,www.microsoft.com/technet/security/bulletin/ms05-054.mspx; classtype:attempted-user; sid:11252; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft MciWndx ActiveX clsid access"; flow:established,to_client; file_data; content:"288F1523-FAC4-11CE-B16F-00AA0060D93D"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*288F1523-FAC4-11CE-B16F-00AA0060D93D\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Filename)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*288F1523-FAC4-11CE-B16F-00AA0060D93D\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(Filename))\s*=/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:11253; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file LsCM record exploit attempt"; flow:to_client,established; content:"LsCM|3A 00 00 00 00 00 00 0C 00 00 00 01 00 04 00 00 40 05 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2864; classtype:attempted-user; sid:17181; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Forms 2.0 ActiveX clsid access"; flow:established,to_client; file_data; content:"4C599241-6926-101B-9992-00000B65C6F9"; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4C599241-6926-101B-9992-00000B65C6F9\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0065; reference:url,www.microsoft.com/technet/security/bulletin/MS08-008.mspx; classtype:attempted-user; sid:13457; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Twiki viewfile rev command injection attempt"; flow:to_server,established; content:"/viewfile/"; http_uri; pcre:"/viewfile/[^\n]*rev[1|2]*=[^d\x20]+/smi"; reference:bugtraq,14834; reference:cve,2005-2877; classtype:attempted-admin; sid:4987; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Sun ONE Web Server JSP source code disclosure attempt"; flow:to_server,established; content:".jsp"; http_uri; content:"|3A 3A 24|DATA"; distance:0; metadata:policy security-ips drop; reference:cve,2009-2445; classtype:misc-attack; sid:16682; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmappPropFrame Class ActiveX function call access"; flow:established,to_client; file_data; content:"Vmappsdk.VmappPropFrame"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Vmappsdk\.VmappPropFrame\x22|\x27Vmappsdk\.VmappPropFrame\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Vmappsdk\.VmappPropFrame\x22|\x27Vmappsdk\.VmappPropFrame\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14482; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader malicious language.engtesselate.ln file download attempt"; flow:to_client,established; flowbits:isset,http.engtesselate; content:"2="; isdataat:255,relative; content:!"|0A|"; within:255; reference:cve,2011-2095; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19253; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IDAutomation Linear Bar Code ActiveX function call access"; flow:established,to_client; file_data; content:"IDAuto.BarCode"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22IDAuto\.BarCode\x22|\x27IDAuto\.BarCode\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SaveEnhWMF\s*|.*(?P=v)\s*\.\s*SaveEnhWMF\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22IDAuto\.BarCode\x22|\x27IDAuto\.BarCode\x27)\s*\)(\s*\.\s*SaveEnhWMF\s*|.*(?P=n)\s*\.\s*SaveEnhWMF\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,23954; reference:url,moaxb.blogspot.com/2007/05/moaxb-13-id-automation-linear-barcode.html; classtype:attempted-user; sid:11295; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX English_US Stemmer ActiveX clsid access"; flow:established,to_client; file_data; content:"EEED4C20-7F1B-11CE-BE57-00AA0051FE20"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*EEED4C20-7F1B-11CE-BE57-00AA0051FE20/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8011; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3443 (msg:"WEB-MISC HP Openview NNM cdpView.ovpl port 3443 Unix command execution attempt"; flow:to_server,established; content:"/cdpView.ovpl"; http_uri; content:"cdpnode="; http_uri; pcre:"/cdpView.ovpl[^\r\n]*cdpnode=[^\r\n]*%(\x2c|\x24|\x7c|\x3b|\x22|\x26|\x3c|\x3f)/Usmi"; reference:bugtraq,14662; reference:cve,2005-2773; classtype:web-application-attack; sid:8086; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbUpdates Class ActiveX clsid access"; flow:established,to_client; file_data; content:"dff44aec-2370-469d-8a22-df82448bff64"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*dff44aec-2370-469d-8a22-df82448bff64\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14530; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MetaProducts MetaTreeX ActiveX clsid access"; flow:established,to_client; file_data; content:"67E66985-F81A-11D6-BC0F-F7B40157DC26"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m7>\x22|\x27|)(?P<id1>.+?)(?P=m7)(\s|>)[^>]*\s*classid\s*=\s*(?P<q12>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*67E66985-F81A-11D6-BC0F-F7B40157DC26\s*}?\s*(?P=q12)(\s|>).*(?P=id1)\s*\.\s*(SaveToBMP)|<object\s*[^>]*\s*classid\s*=\s*(?P<q13>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*67E66985-F81A-11D6-BC0F-F7B40157DC26\s*}?\s*(?P=q13)(\s|>)[^>]*\s*id\s*=\s*(?P<m8>\x22|\x27|)(?P<id2>.+?)(?P=m8)(\s|>).*(?P=id2)\.(SaveToBMP))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,33318; classtype:attempted-user; sid:15251; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmappPoll Class ActiveX clsid access"; flow:established,to_client; file_data; content:"48e72e42-2d79-4d94-99f6-c859f3a46d42"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*48e72e42-2d79-4d94-99f6-c859f3a46d42\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14374; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI search.cgi access"; flow:to_server,established; content:"/search.cgi"; fast_pattern; http_uri; reference:bugtraq,921; reference:cve,2000-0054; classtype:web-application-activity; sid:1599; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Novell iPrint ActiveX function call access"; flow:established,to_client; file_data; content:"ienipp.Novell iPrint Control"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ienipp\.Novell\s*iPrint\s*Control(\.\d)?\x22|\x27ienipp\.Novell\s*iPrint\s*Control(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ienipp\.Novell\s*iPrint\s*Control(\.\d)?\x22|\x27ienipp\.Novell\s*iPrint\s*Control(\.\d)?\x27)\s*\)/smiO"; metadata:policy security-ips drop; reference:cve,2008-0935; reference:cve,2008-2431; reference:cve,2008-2436; reference:cve,2008-2908; reference:cve,2009-1568; reference:cve,2009-1569; reference:cve,2010-1527; reference:cve,2010-3106; reference:cve,2010-4319; reference:cve,2010-4321; classtype:attempted-user; sid:13525; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP Virtual Rooms ActiveX function call access"; flow:established,to_client; file_data; content:"WebHPVCInstall.HPVirtualRooms14"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22WebHPVCInstall\.HPVirtualRooms14\x22|\x27WebHPVCInstall\.HPVirtualRooms14\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(AuthenticationURL|PortalAPIURL|cabroot)\s*|.*(?P=v)\s*\.\s*(AuthenticationURL|PortalAPIURL|cabroot)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22WebHPVCInstall\.HPVirtualRooms14\x22|\x27WebHPVCInstall\.HPVirtualRooms14\x27)\s*\)(\s*\.\s*(AuthenticationURL|PortalAPIURL|cabroot)\s*|.*(?P=n)\s*\.\s*(AuthenticationURL|PortalAPIURL|cabroot))\s*=/smi"; metadata:policy security-ips drop; reference:bugtraq,27384; reference:cve,2008-0437; classtype:attempted-user; sid:13354; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CLSID_IMimeInternational ActiveX clsid access"; flow:established,to_client; file_data; content:"FD853CD9-7F86-11D0-8252-00C04FD85AB4"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*FD853CD9-7F86-11D0-8252-00C04FD85AB4/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:7916; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-MISC potential malware - download of server32.exe"; flow:established,to_server; content:"/server32.exe"; http_uri; metadata:policy security-ips drop; reference:url,en.wikipedia.org/wiki/Zeus_(trojan_horse); classtype:suspicious-filename-detect; sid:17810; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 5 ActiveX clsid access"; flow:established,to_client; file_data; content:"101D2283-EED9-4BA2-8F3F-23DB860946EB"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q89>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*101D2283-EED9-4BA2-8F3F-23DB860946EB\s*}?\s*(?P=q89)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14096; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC sharepoint cross site scripting attempt"; flow:to_server,established; content:"|22 29 3B|"; http_uri; metadata:policy security-ips drop; reference:bugtraq,23832; reference:cve,2007-2581; reference:url,www.microsoft.com/technet/security/bulletin/ms07-059.mspx; classtype:web-application-attack; sid:12629; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX BusinessObjects RptViewerAx ActiveX clsid access"; flow:established,to_client; file_data; content:"B20D9D6A-0DEC-4d76-9BEF-175896006B4A"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*B20D9D6A-0DEC-4d76-9BEF-175896006B4A\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips alert; reference:bugtraq,28292; reference:cve,2007-6254; classtype:attempted-user; sid:13657; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS perl-browse newline attempt"; flow:to_server,established; content:"|0A|.pl"; fast_pattern; http_uri; reference:bugtraq,6833; classtype:web-application-attack; sid:1026; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Trend Micro HouseCall ActiveX function call access"; flow:established,to_client; file_data; content:"XSCAN.XscanCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22XSCAN\.XscanCtrl(\.\d)?\x22|\x27XSCAN\.XscanCtrl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*notifyOnLoadNative\s*|.*(?P=v)\s*\.\s*notifyOnLoadNative\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22XSCAN\.XscanCtrl(\.\d)?\x22|\x27XSCAN\.XscanCtrl(\.\d)?\x27)\s*\)(\s*\.\s*notifyOnLoadNative\s*|.*(?P=n)\s*\.\s*notifyOnLoadNative\s*)\s*\(/smiO"; metadata:policy security-ips alert; reference:bugtraq,32950; reference:bugtraq,32965; reference:cve,2008-2434; reference:cve,2008-2435; classtype:attempted-user; sid:15179; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint TxMasterStyle10Atom atom numLevels buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|00 B2 0F|"; byte_test:2,>,5,4,relative,little; byte_test:1,<,0x90,-4,relative; byte_test:1,!&,0x01,-4,relative; byte_test:1,!&,0x02,-4,relative; byte_test:1,!&,0x04,-4,relative; byte_test:1,!&,0x08,-4,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-1455; reference:url,www.microsoft.com/technet/security/bulletin/ms08-051.mspx; classtype:attempted-user; sid:13971; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Multiple Vendor server file disclosure attempt"; flow:to_server,established; content:".jsp"; http_uri; pcre:"/^[^\x3b]*\x3b.*\x2ejsp/Ui"; reference:bugtraq,11245; reference:bugtraq,19106; reference:cve,2004-0928; reference:cve,2006-3853; classtype:web-application-attack; sid:15990; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ICQPhone.SipxPhoneManager ActiveX function call access"; flow:established,to_client; file_data; content:"ICQPhone.SipxPhoneManager"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ICQPhone.SipxPhoneManager(\.\d)?\x22|\x27ICQPhone.SipxPhoneManager(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(DownloadAgent)\s*\(|.*(?P=v)\s*\.\s*(DownloadAgent)\s*\()|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ICQPhone.SipxPhoneManager(\.\d)?\x22|\x27ICQPhone.SipxPhoneManager(\.\d)?\x27)\s*\)(\s*\.\s*(DownloadAgent)\s*\(|.*(?P=n)\s*\.\s*(DownloadAgent)\s*\()/siO"; metadata:policy security-ips drop; reference:bugtraq,20930; reference:cve,2006-5650; classtype:attempted-user; sid:9816; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Video Mixing Renderer 9 ActiveX object access"; flow:established,to_client; file_data; content:"51B4ABF3-748F-4E3B-A276-C828330E926A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*51B4ABF3-748F-4E3B-A276-C828330E926A/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4902; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Malicious Microsoft Agent Helper JAR download attempt"; flow:established,to_client; flowbits:isset,http.jar.agent_helper; file_data; content:"META-INF/MANIFEST.MF"; isdataat:128,relative; flowbits:unset,http.jar.agent_helper; content:!"META-INF/MICCORJA.SF"; content:!"META-INF/MICCORJA.RSA"; reference:cve,2011-1969; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-079.mspx; classtype:attempted-user; sid:20259; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft creator.dll 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"F849164D-9863-11D3-97C6-0060084856D4"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,19636; reference:cve,2006-4495; reference:url,www.xsec.org/index.php?module=Releases&act=view&type=1&id=16; classtype:attempted-user; sid:17595; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 9080 (msg:"WEB-MISC IBM Rational Quality Manager and Test Lab Manager policy bypass attempt"; flow:to_server,established; content:"/manager"; http_uri; content:"Authorization|3A 20|Basic|20|QURNSU46QURNSU4="; fast_pattern:only; http_header; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,44172; reference:cve,2010-4094; classtype:default-login-attempt; sid:19110; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC Media Player SMB module Win32AddConnection buffer overflow attempt"; flow:to_client,established; flowbits:isset,xspf_file.request; content:"smb|3A 2F 2F|"; pcre:"/smb\x3A\x2F\x2F[^\s\x0A\x0D\x3C]{251}/mi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35500; reference:cve,2009-2484; classtype:attempted-user; sid:16752; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX PSTypeLib ActiveX object access"; flow:established,to_client; file_data; content:"00020423-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*00020423-0000-0000-C000-000000000046/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4896; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft XML substringData integer overflow attempt"; flow:to_client,established; content:"substringData"; pcre:"/\w+\.substringData\([^\),]+,\s*(\d{4,}|25[7-9]|2[6-9][0-9]|[3-9][0-9]{2}|0x0*([1-9a-f][1-9a-f]{3,}|[2-9a-f][0-9a-f]{2}|1([0-9a-f][0-9a-f]|0[1-9a-f])))/smi"; metadata:policy security-ips drop; reference:cve,2007-2223; reference:cve,2007-2224; reference:cve,2008-1442; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-042.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-043.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-031.mspx; classtype:attempted-user; sid:12279; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer layout-grid-char value exploit attempt"; flow:to_client,established; content:"layout-grid-char|3A|"; pcre:"/^\s*[0-9]*[^0-9\s\x3b]/R"; metadata:policy security-ips drop; reference:cve,2011-1260; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-admin; sid:19243; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ActiveX Soft DVD Tools ActiveX function call access"; flow:established,to_client; file_data; content:"DVD_TOOLS.DVD_TOOLSCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22DVD_TOOLS\.DVD_TOOLSCtrl\x22|\x27DVD_TOOLS\.DVD_TOOLSCtrl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22DVD_TOOLS\.DVD_TOOLSCtrl\x22|\x27DVD_TOOLS\.DVD_TOOLSCtrl\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,22558; reference:url,moaxb.blogspot.com/2007/05/moaxb-04-bonus-actsoft-dvd-tools.html; classtype:attempted-user; sid:11197; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI nph-test-cgi access"; flow:to_server,established; content:"/nph-test-cgi"; fast_pattern; http_uri; reference:arachnids,224; reference:bugtraq,686; reference:cve,1999-0045; reference:nessus,10165; classtype:attempted-recon; sid:829; rev:18;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI htmlscript attempt"; flow:to_server,established; content:"/htmlscript?../.."; fast_pattern; http_uri; reference:bugtraq,2001; reference:cve,1999-0264; reference:nessus,10106; classtype:web-application-attack; sid:1608; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel OBJ record stack buffer overflow attempt - with linkFmla"; flow:to_client,established; flowbits:isset,http.xls; content:"|5D 00|"; content:"|15 00 12 00 14 00|"; within:6; distance:2; content:"|0C 00 14 00|"; within:4; distance:16; content:"|0E 00|"; within:2; distance:20; byte_jump:2,0,relative,little; content:"|13 00|"; within:2; byte_test:2,>,0,0,relative,little; byte_jump:2,2,relative,little; byte_test:2,>,1024,14,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0822; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16640; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI maillist.pl access"; flow:to_server,established; content:"/maillist.pl"; fast_pattern; http_uri; classtype:attempted-recon; sid:828; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Office Web Components Spreadsheet ActiveX clsid access"; flow:established,to_client; file_data; content:"0002E512-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0002E512-0000-0000-C000-000000000046\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(htmlurl)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0002E512-0000-0000-C000-000000000046\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(htmlurl))\s*=/siO"; reference:cve,2009-1534; reference:url,www.microsoft.com/technet/security/bulletin/MS09-043.mspx; classtype:attempted-user; sid:15858; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8004 (msg:"WEB-MISC Symantec admin interface client negative Content-Length attempt"; flow:to_server,established; content:"Content-Length|3A|"; pcre:"/^Content-Length\x3a(\s*|\s*\r?\n\s+)(-1|4294967295)/smi"; reference:bugtraq,15001; reference:cve,2005-2758; classtype:attempted-admin; sid:4681; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ClamAV antivirus CHM file handling DOS"; flow:to_client,established; content:"ITSF"; content:"|11 FD 01 7C AA 7B D0 11 9E 0C 00 A0 C9 22 E6 EC|"; within:16; distance:36; content:"ITSP"; distance:0; byte_test:4,<,8,12,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30994; reference:cve,2008-1389; reference:url,sourceforge.net/project/shownotes.php?group_id=86638&release_id=623661; classtype:attempted-dos; sid:17602; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Mmedia.AsyncMHandler.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"3DA2AA3E-3D96-11D2-9BD2-204C4F4F5020"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*3DA2AA3E-3D96-11D2-9BD2-204C4F4F5020/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7444; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Second Sight Software ActiveGS ActiveX function call access"; flow:established,to_client; file_data; content:"ACTIVEGS.ActiveGSCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ACTIVEGS\.ActiveGSCtrl\x22|\x27ACTIVEGS\.ActiveGSCtrl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ACTIVEGS\.ActiveGSCtrl\x22|\x27ACTIVEGS\.ActiveGSCtrl\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,23554; reference:cve,2007-1690; reference:url,www.kb.cert.org/vuls/id/118737; classtype:attempted-user; sid:10980; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows ShellExecute and IE7 url handling code execution attempt"; flow:to_client,established; content:"|22|.bat"; pcre:"/(mailto|telnet|news|nntp|snews)\x3A[^\n]*\x25[^\n]*\x22\x2Ebat/i"; metadata:policy security-ips alert; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-057.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-061.mspx; classtype:attempted-user; sid:12687; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"0149EEDF-D08F-4142-8D73-D23903D21E90"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q23>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0149EEDF-D08F-4142-8D73-D23903D21E90\s*}?\s*(?P=q23)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15610; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION CFNEWINTERNALADMINSECURITY access"; flow:to_server,established; content:"CFNEWINTERNALADMINSECURITY|28 29|"; fast_pattern:only; reference:bugtraq,550; reference:cve,1999-0760; classtype:attempted-user; sid:8485; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CGI Majordomo2 http directory traversal attempt"; flow:established,to_server; content:"mj_wwwusr"; fast_pattern; http_uri; content:"extra="; distance:0; http_uri; content:"../../.."; distance:0; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,46127; reference:cve,2011-0049; classtype:web-application-attack; sid:18761; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave Player Lnam chunk processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"manL"; content:"|00 00|"; within:2; distance:2; content:!"|00 00|"; within:2; distance:18; content:"|FF|"; within:1; distance:20; isdataat:256,relative; content:!"|00|"; within:256; metadata:policy security-ips drop; reference:bugtraq,44516; reference:cve,2010-3655; reference:url,www.adobe.com/support/security/bulletins/apsb10-25.html; classtype:attempted-user; sid:19012; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Google Chrome float rendering corruption attempt"; flow:to_client,established; content:"display: -webkit-inline-box"; fast_pattern:only; content:"removeChild|28|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1804; classtype:attempted-user; sid:19710; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI pals-cgi access"; flow:to_server,established; content:"/pals-cgi"; fast_pattern; http_uri; reference:bugtraq,2372; reference:cve,2001-0216; reference:cve,2001-0217; reference:nessus,10611; classtype:attempted-recon; sid:897; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Sopcast SopCore ActiveX function call access"; flow:established,to_client; file_data; content:"SOPCORE.SopCoreCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22SOPCORE\.SopCoreCtrl(\.\d)?\x22|\x27SOPCORE\.SopCoreCtrl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SetExternalPlayer\s*|.*(?P=v)\s*\.\s*SetExternalPlayer\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22SOPCORE\.SopCoreCtrl(\.\d)?\x22|\x27SOPCORE\.SopCoreCtrl(\.\d)?\x27)\s*\)(\s*\.\s*SetExternalPlayer\s*|.*(?P=n)\s*\.\s*SetExternalPlayer\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:bugtraq,33920; classtype:attempted-user; sid:15378; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP Intelligent Management Center information disclosure attempt"; flow:to_server,established; content:"/imc/report/DownloadReportSource"; http_uri; content:"fileName"; http_uri; pcre:"/fileName=.*?\x2E\x2E(\x2F|\x5C)/sI"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40298; reference:url,secunia.com/advisories/39891; classtype:misc-attack; sid:17137; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI math_sum.mscgi access"; flow:to_server,established; content:"/math_sum.mscgi"; http_uri; reference:bugtraq,10831; reference:nessus,14182; classtype:web-application-activity; sid:3468; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC iPlanet GETPROPERTIES attempt"; flow:to_server,established; content:"GETPROPERTIES"; depth:13; reference:bugtraq,2732; reference:cve,2001-0746; classtype:web-application-attack; sid:1050; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office RTF parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|5C|sp"; content:"|5C|sn"; within:100; content:"pFragments"; within:100; content:"|5C|sv"; within:100; pcre:"/\x5Csv\s+[^\x7D]*?\x3B[^\x7D]*?\x3B[^\x7B]{12}/smi"; byte_test:4,>,4,8,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3333; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087; classtype:attempted-user; sid:18067; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Outlook Web Access XSRF attempt"; flow:to_server,established; content:"POST"; http_method; content:"/owa/ev.owa"; http_uri; content:"ns=Rule"; http_uri; content:"ev=Save"; http_uri; content:"&#60params&#62&#60Id&#62&#60/Id&#62&#60Name&#62Test&#60/Name&#62&#60RecpA4&#62&#60item&#62&#60Rcp"; http_client_body; content:"AO=|22|3|22|&#62&#60/Rcp&#62&#60/item&#62&#60/RecpA4&#62&#60Actions&#62&#60item&#62&#60rca"; http_client_body; content:" t=|22|4|22|&#62&#60/rca&#62&#60/item&#62&#60/Actions&#62&#60/params&#62"; http_client_body; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3213; reference:url,www.microsoft.com/technet/security/advisory/2401593.mspx; classtype:attempted-user; sid:17296; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Chilkat HTTP 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"B973393F-27C7-4781-877D-8626AAEDF119"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m7>\x22|\x27|)(?P<id1>.+?)(?P=m7)(\s|>)[^>]*\s*classid\s*=\s*(?P<q14>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*B973393F-27C7-4781-877D-8626AAEDF119\s*}?\s*(?P=q14)(\s|>).*(?P=id1)\s*\.\s*(SaveLastError)|<object\s*[^>]*\s*classid\s*=\s*(?P<q15>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*B973393F-27C7-4781-877D-8626AAEDF119\s*}?\s*(?P=q15)(\s|>)[^>]*\s*id\s*=\s*(?P<m8>\x22|\x27|)(?P<id2>.+?)(?P=m8)(\s|>).*(?P=id2)\.(SaveLastError))\s*\(/si"; metadata:policy security-ips alert; reference:bugtraq,28546; reference:cve,2008-1647; classtype:attempted-user; sid:13689; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AOL.PicEditCtrl ActiveX clsid access"; flow:established,to_client; file_data; content:"E0CB08CE-AB3D-4779-9C77-62A439BFE6C3"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*E0CB08CE-AB3D-4779-9C77-62A439BFE6C3/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:7896; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC OpenView Network Node Manager cookie buffer overflow attempt"; flow:to_server,established; content:"/OVCgi/ovlaunchreg.exe"; fast_pattern:only; http_uri; pcre:"/(OvJavaScript|OvTitleFrame|OvHelpWindow|OvMap|OvSession|OvJavaLocale|OvOSLocale|OvLogin|OvDebug|OvDeveloper|OvTreeControl|OvJavaScript|OvProduct|OvPort|OvLocale|OvWebSession)\s*\x3D[^\x3B\x2C]{1024}/iC"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,42154; reference:cve,2010-2709; classtype:attempted-user; sid:18916; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AolCalSvr.ACDictionary ActiveX clsid access"; flow:established,to_client; file_data; content:"9F62797E-1249-4596-9FF7-AC6D851A542A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*9F62797E-1249-4596-9FF7-AC6D851A542A/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:7886; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Address Book smmscrpt.dll malicious DLL load"; flow:to_server,established; content:"smmscrpt.dll"; http_uri; metadata:policy security-ips drop; reference:cve,2010-3144; reference:url,www.microsoft.com/technet/security/bulletin/MS10-097.mspx; classtype:attempted-user; sid:18202; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Macrovision FLEXnet Connect ActiveX function call access"; flow:established,to_client; file_data; content:"MVSNClientDownloadManager61Lib.DownloadManager"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22MVSNClientDownloadManager61Lib\.DownloadManager\x22|\x27MVSNClientDownloadManager61Lib\.DownloadManager\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*AddFile\s*|.*(?P=v)\s*\.\s*AddFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22MVSNClientDownloadManager61Lib\.DownloadManager\x22|\x27MVSNClientDownloadManager61Lib\.DownloadManager\x27)\s*\)(\s*\.\s*AddFile\s*|.*(?P=n)\s*\.\s*AddFile\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,27279; classtype:attempted-user; sid:13327; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer arbitrary javascript command attempt"; flow:to_client,established; content:"application/smi"; fast_pattern; http_header; file_data; content:"file|3A|javascript|3A|"; pcre:"/<area\s+href=[\x22\x27]file\x3ajavascript\x3a/smi"; reference:bugtraq,8453; reference:bugtraq,9378; reference:cve,2003-0726; classtype:attempted-user; sid:2437; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.Light ActiveX clsid access"; flow:established,to_client; file_data; content:"F9EFBEC2-4302-11D2-952A-00C04FA34F05"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*F9EFBEC2-4302-11D2-952A-00C04FA34F05/si"; metadata:policy security-ips drop; reference:cve,2006-2383; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-021.mspx; classtype:attempted-user; sid:6517; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 53 ActiveX clsid access"; flow:established,to_client; file_data; content:"E6127E3B-8D17-4BEA-A039-8BB9D0D105A2"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q97>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E6127E3B-8D17-4BEA-A039-8BB9D0D105A2\s*}?\s*(?P=q97)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14192; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX sapi.dll alternate killbit ActiveX clsid access"; flow:established,to_client; file_data; content:"3bee4890-4fe9-4a37-8c1e-5e7e12791c1f"; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3bee4890-4fe9-4a37-8c1e-5e7e12791c1f\s*}?\s*(?P=q1)(\s|>)/si"; reference:cve,2007-0675; reference:url,www.microsoft.com/technet/security/bulletin/MS08-032.mspx; classtype:attempted-user; sid:13830; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari Webkit libxslt arbitrary file creation attempt"; flow:established,to_client; file_data; content:"xmlns:sx=|22|http://icl.com/saxon|22|"; fast_pattern:only; content:"sx:output"; pcre:"/\s*[^>]file=/iR"; reference:cve,2011-1774; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:20593; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer vidplin.dll avi header parsing execution attempt"; flow:to_client,established; flowbits:isset,http.avi; content:"strlstrh"; fast_pattern; byte_jump:4,0,relative,little; content:!"strf"; within:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,46047; reference:cve,2010-4393; classtype:attempted-user; sid:19169; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Flash Player nvapi.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|nvapi.dll"; http_uri; reference:cve,2011-0575; reference:url,www.adobe.com/support/security/bulletins/apsb11-02.html; classtype:attempted-user; sid:18445; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI /fcgi-bin/echo.exe access"; flow:to_server,established; content:"/fcgi-bin/echo.exe"; fast_pattern; http_uri; reference:nessus,10838; classtype:web-application-activity; sid:1592; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbUtil Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmdbCOM.VmdbUtil"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmdbCOM\.VmdbUtil\x22|\x27vmdbCOM\.VmdbUtil\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmdbCOM\.VmdbUtil\x22|\x27vmdbCOM\.VmdbUtil\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14496; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI webspirs.cgi access"; flow:to_server,established; content:"/webspirs.cgi"; fast_pattern; http_uri; reference:bugtraq,2362; reference:cve,2001-0211; reference:nessus,10616; classtype:attempted-recon; sid:901; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX GlobalLink ConnectAndEnterRoom ActiveX clsid access"; flow:established,to_client; file_data; content:"AE93C5DF-A990-11D1-AEBD-5254ABDD2B69"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*AE93C5DF-A990-11D1-AEBD-5254ABDD2B69\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(ConnectAndEnterRoom)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*AE93C5DF-A990-11D1-AEBD-5254ABDD2B69\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(ConnectAndEnterRoom))\s*\(/si"; reference:bugtraq,26244; reference:cve,2007-5722; classtype:attempted-user; sid:12689; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Computer Associates gui_cm_ctrls ActiveX clsid access"; flow:established,to_client; file_data; content:"E6239EB3-E0B0-46DA-A215-CFA9B3B740C5"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E6239EB3-E0B0-46DA-A215-CFA9B3B740C5\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SetColumnLabel)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E6239EB3-E0B0-46DA-A215-CFA9B3B740C5\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(SetColumnLabel))\s*\(/si"; metadata:policy security-ips drop; reference:cve,2008-1786; classtype:attempted-user; sid:14025; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP Power Manager formExportDataLogs directory traversal attempt"; flow:to_server, established; content:"|2F|goform|2F|formExportDataLogs"; http_uri; pcre:"/fileName\x3d[^\x26]*(\x2e\x2e\x5c|\x2e\x2e\x2f)/Ri"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37866; reference:cve,2009-4000; classtype:web-application-attack; sid:18802; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WebEx GPCContainer ActiveX clsid access"; flow:established,to_client; file_data; content:"E06E2E99-0AA1-11D4-ABA6-0060082AA75C"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E06E2E99-0AA1-11D4-ABA6-0060082AA75C\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(InitParam|SetParam)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E06E2E99-0AA1-11D4-ABA6-0060082AA75C\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(InitParam|SetParam))\s*\(/si"; reference:bugtraq,26430; reference:cve,2007-6005; classtype:attempted-user; sid:12714; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Safari-Internet Explorer SearchPath blended threat dll request"; flow:to_server,established; content:".dll"; http_uri; content:"Safari"; http_header; pcre:"/^User\x2dAgent\x3a\s*[^\n]*Safari[^\n]*\r\n/smi"; flowbits:set,safari.dll; flowbits:noalert; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-2540; reference:url,www.microsoft.com/technet/security/bulletin/MS09-015.mspx; classtype:attempted-user; sid:15468; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer htmlfile null attribute access"; flow:to_client,established; file_data; content:"25336920-03F9-11CF-8FD0-00AA00686F13"; content:".attributes["; pcre:"/<object[^>]+id\s*=\s*[\x22\x27]?([A-Z\d]+)[\x22\x27]?[^>]+classid\s*=\s*[\x22\x27]?clsid\x3A25336920-03F9-11CF-8FD0-00AA00686F13[\x22\x27]?.*?\1\.attributes.*?for\s*\x28[^\x29]+\1.attributes\x5B/smi"; reference:cve,2011-1995; reference:url,www.microsoft.com/technet/security/bulletin/MS11-081.mspx; classtype:attempted-user; sid:20263; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI commerce.cgi arbitrary file access attempt"; flow:to_server,established; content:"/commerce.cgi"; http_uri; content:"page="; content:"/../"; reference:bugtraq,2361; reference:cve,2001-0210; reference:nessus,10612; classtype:attempted-recon; sid:1572; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI ezman.cgi access"; flow:to_server,established; content:"/ezman.cgi"; fast_pattern; http_uri; reference:bugtraq,4068; reference:bugtraq,4579; reference:cve,2002-0263; reference:nessus,11748; classtype:web-application-activity; sid:2206; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft DT DDS Circular Auto Layout Logic 2 ActiveX object access"; flow:established,to_client; file_data; content:"B0406342-B0C5-11d0-89A9-00A0C9054129"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*B0406342-B0C5-11d0-89A9-00A0C9054129/si"; metadata:policy security-ips drop; reference:cve,2006-1186; reference:url,www.microsoft.com/technet/security/bulletin/MS06-013.mspx; classtype:attempted-user; sid:6004; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.RevealTrans ActiveX clsid access"; flow:established,to_client; file_data; content:"E31E87C4-86EA-4940-9B8A-5BD5D179A737"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*E31E87C4-86EA-4940-9B8A-5BD5D179A737/si"; metadata:policy security-ips drop; reference:url,browserfun.blogspot.com/2006/07/mobb-13-revealtrans-transition.html; reference:url,osvdb.org/27057; classtype:attempted-user; sid:7922; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX UUSee UUUpgrade ActiveX clsid access"; flow:established,to_client; file_data; content:"2CACD7BB-1C59-4BBB-8E81-6E83F82C813B"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2CACD7BB-1C59-4BBB-8E81-6E83F82C813B\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Update)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2CACD7BB-1C59-4BBB-8E81-6E83F82C813B\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Update))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,29963; classtype:attempted-user; sid:13883; rev:5;)
alert tcp $EXTERNAL_NET 1080 -> $HOME_NET any (msg:"WEB-CLIENT Firefox oversized SOCKS5 DNS reply memory corruption attempt"; flow:to_client,established; content:"|05 00 00 03|"; depth:4; isdataat:16,relative; reference:bugtraq,35925; reference:cve,2009-2470; classtype:attempted-user; sid:16612; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Office Visio mfc71 dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc71"; fast_pattern; http_uri; content:".dll"; within:7; http_uri; reference:cve,2010-3148; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-055.mspx; classtype:attempted-user; sid:19466; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Trend Micro OfficeScan Client ActiveX clsid access"; flow:established,to_client; file_data; content:"08D75BB0-D2B5-11D1-88FC-0080C859833B"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*08D75BB0-D2B5-11D1-88FC-0080C859833B\s*}?\s*\1/si"; metadata:policy security-ips drop; reference:bugtraq,22585; reference:cve,2007-0325; classtype:attempted-user; sid:10173; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC OpenView Network Node Manager cookie buffer overflow attempt"; flow:to_server,established; content:"/OVCgi/OpenView.exe"; fast_pattern:only; http_uri; pcre:"/(OvJavaScript|OvTitleFrame|OvHelpWindow|OvMap|OvSession|OvJavaLocale|OvOSLocale|OvLogin|OvDebug|OvDeveloper|OvTreeControl|OvJavaScript|OvProduct|OvPort|OvLocale|OvWebSession)\s*\x3D[^\x3B\x2C]{1024}/iC"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,42154; reference:cve,2010-2709; classtype:attempted-user; sid:18913; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS JET VBA access"; flow:to_server,established; content:"/scripts/samples/details.idc"; fast_pattern; http_uri; reference:bugtraq,286; reference:cve,1999-0874; classtype:web-application-activity; sid:985; rev:18;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LeadTools Thumbnail Browser Control ActiveX clsid access"; flow:established,to_client; file_data; content:"00140200-B1BA-11CE-ABC6-F5B2E79D9E3F"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m17>\x22|\x27|)(?P<id1>.+?)(?P=m17)(\s|>)[^>]*\s*classid\s*=\s*(?P<q41>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*00140200-B1BA-11CE-ABC6-F5B2E79D9E3F\s*}?\s*(?P=q41)(\s|>).*(?P=id1)\s*\.\s*(BrowseDir)|<object\s*[^>]*\s*classid\s*=\s*(?P<q42>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*00140200-B1BA-11CE-ABC6-F5B2E79D9E3F\s*}?\s*(?P=q42)(\s|>)[^>]*\s*id\s*=\s*(?P<m18>\x22|\x27|)(?P<id2>.+?)(?P=m18)(\s|>).*(?P=id2)\.(BrowseDir))\s*\(/si"; reference:bugtraq,24053; reference:url,moaxb.blogspot.com/2007/05/moaxb-19-leadtools-thumbnail-browser.html; classtype:attempted-user; sid:11654; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows malformed ASF voice codec memory corruption"; flow:to_client,established; content:"@|9E|i|F8|M[|CF 11 A8 FD 00 80|_|5C|D+"; isdataat:46,relative; pcre:"/^.{38}\x0a\x00..(?!(\x40\x1f|\x11\x2b|\x80\x3e|\x22\x56)\x00\x00)/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0555; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-051.mspx; classtype:attempted-user; sid:16157; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI day5datanotifier.cgi access"; flow:to_server,established; content:"/day5datanotifier.cgi"; fast_pattern; http_uri; reference:cve,1999-1232; classtype:attempted-recon; sid:864; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CEnroll.CEnroll.2 ActiveX function call access"; flow:established,to_client; file_data; content:"CEnroll.CEnroll.2"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22CEnroll.CEnroll.2\x22|\x27CEnroll.CEnroll.2\x27)\s*\x3b.*\w+\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)|\w+\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22CEnroll.CEnroll.2\x22|\x27CEnroll.CEnroll.2\x27)\s*\)/smi"; reference:url,browserfun.blogspot.com/2006/07/mobb-21-cenroll-stringtobinary.html; reference:url,osvdb.org/27230; classtype:attempted-user; sid:8423; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"WEB-CGI chetcpasswd access"; flow:to_server,established; content:"chetcpasswd.cgi"; fast_pattern; http_uri; reference:bugtraq,21102; reference:bugtraq,6472; reference:cve,2002-2220; reference:cve,2006-6679; classtype:web-application-activity; sid:10999; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI input.bat access"; flow:to_server,established; content:"/input.bat"; http_uri; reference:bugtraq,762; reference:cve,1999-0947; reference:nessus,10016; classtype:web-application-activity; sid:1513; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sophos Anti-Virus zip file handling DoS attempt"; flow:to_client,established; content:"PK|03 04|"; content:"|0C 00|"; within:2; distance:4; content:"-|00 00 00 F9 00 00 00 05 00 FF FF|"; within:12; distance:8; metadata:policy security-ips drop; reference:bugtraq,14270; reference:cve,2005-1530; classtype:attempted-dos; sid:15957; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT AIM GoChat URL access attempt"; flow:to_client,established; content:"aim|3A|GoChat?"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,22146; reference:cve,2007-0021; reference:url,projects.info-pull.com/moab/MOAB-20-01-2007.html; classtype:misc-attack; sid:10116; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX iPIX Media Send Class ActiveX clsid access"; flow:established,to_client; file_data; content:"d04a7099-0c25-4fc7-970f-6ec7d77886f3"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q4>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*d04a7099-0c25-4fc7-970f-6ec7d77886f3\s*}?\s*(?P=q4)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,23379; reference:cve,2007-1687; reference:url,www.kb.cert.org/vuls/id/958609; classtype:attempted-user; sid:10470; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft MSVTDGridCtrl7 ActiveX object access"; flow:established,to_client; file_data; content:"6F9F3481-84DD-4B14-B09C-6B4288ECCDE8"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*6F9F3481-84DD-4B14-B09C-6B4288ECCDE8/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4234; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI snorkerz.cmd access"; flow:to_server,established; content:"/snorkerz.cmd"; fast_pattern; http_uri; classtype:attempted-recon; sid:870; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Repository ActiveX object access"; flow:established,to_client; file_data; content:"6E227101-F799-11CF-9227-00AA00A1EB95"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*6E227101-F799-11CF-9227-00AA00A1EB95/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4225; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; content:"function attack|28 29 0A|"; content:"obj=document.getElementById|28 22|barID|22 29 3B|"; within:37; distance:14; content:"obj.className=|22|poc|22 3B|"; within:20; distance:10; metadata:policy security-ips alert; reference:cve,2009-0076; reference:url,www.microsoft.com/technet/security/bulletin/MS09-002.mspx; classtype:attempted-user; sid:16169; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"WEB-MISC SSLv2 Client_Hello Challenge Length overflow attempt"; flow:to_server,established; ssl_version:sslv2; ssl_state:client_hello; content:"|01 00 02|"; depth:3; offset:2; byte_test:1,>,127,0; byte_test:2,>,32,9; reference:bugtraq,11015; reference:cve,2004-0826; classtype:attempted-admin; sid:2656; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC uTorrent announce buffer overflow attempt"; flow:established,to_client; content:"d8|3A|announce"; pcre:"/^(\d{5,}|390[1-9]|39[1-9][0-9]|[4-9][0-9]{3})\x3A/R"; reference:bugtraq,22530; reference:cve,2007-0927; classtype:attempted-user; sid:10172; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC OpenView Network Node Manager cookie buffer overflow attempt"; flow:to_server,established; content:"/OVCgi/ovlogin.exe"; fast_pattern:only; http_uri; pcre:"/(OvJavaScript|OvTitleFrame|OvHelpWindow|OvMap|OvSession|OvJavaLocale|OvOSLocale|OvLogin|OvDebug|OvDeveloper|OvTreeControl|OvJavaScript|OvProduct|OvPort|OvLocale|OvWebSession)\s*\x3D[^\x3B\x2C]{1024}/iC"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,42154; reference:cve,2010-2709; classtype:attempted-user; sid:18917; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft HTML Window Security Proxy ActiveX clsid access"; flow:established,to_client; file_data; content:"3050F391-98B5-11CF-BB82-00AA00BDCE0B"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*3050F391-98B5-11CF-BB82-00AA00BDCE0B/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8025; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office OneNote iframe caller exploit attempt"; flow:to_client,established; content:"iframe"; content:"onenote|3A|"; distance:0; pcre:"/iframe[^\x3e]+onenote\x3a(\x2f|\x5c){2}[^\x3e]+(\x2fbackuppath|\x2fcachepath)/i"; reference:cve,2008-3007; reference:url,www.microsoft.com/technet/security/bulletin/MS08-055.mspx; classtype:web-application-attack; sid:14262; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Oracle Java Process Manager access"; flow:to_server,established; content:"/oprocmgr-status"; http_uri; reference:nessus,10851; classtype:web-application-activity; sid:1874; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI parse_xml.cgi access"; flow:to_server,established; content:"/parse_xml.cgi"; fast_pattern; http_uri; reference:bugtraq,6954; reference:bugtraq,6955; reference:bugtraq,6956; reference:bugtraq,6958; reference:cve,2003-0050; reference:cve,2003-0051; reference:cve,2003-0052; reference:cve,2003-0053; reference:cve,2003-0423; classtype:web-application-activity; sid:2085; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealNetworks RealGames InstallerDlg.dll ActiveX function call access"; flow:established,to_client; file_data; content:"StubbyUtil.ProcessMgr"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22StubbyUtil\.ProcessMgr(\.\d)?\x22|\x27StubbyUtil\.ProcessMgr(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(CreateVistaTaskLow|Exec|ExecLow|ShellExec)\s*|.*(?P=v)\s*\.\s*(CreateVistaTaskLow|Exec|ExecLow|ShellExec)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22StubbyUtil\.ProcessMgr(\.\d)?\x22|\x27StubbyUtil\.ProcessMgr(\.\d)?\x27)\s*\)(\s*\.\s*(CreateVistaTaskLow|Exec|ExecLow|ShellExec)\s*|.*(?P=n)\s*\.\s*(CreateVistaTaskLow|Exec|ExecLow|ShellExec)\s*)/smiO"; metadata:policy security-ips drop; reference:url,osvdb.org/71559; classtype:attempted-user; sid:19563; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"WEB-MISC SSLv3 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|01 03 00|"; depth:3; offset:2; flowbits:set,sslv3.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:10996; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI overflow.cgi access"; flow:to_server,established; content:"/overflow.cgi"; http_uri; reference:bugtraq,6326; reference:cve,2002-1361; reference:nessus,11190; reference:url,www.cert.org/advisories/CA-2002-35.html; classtype:web-application-activity; sid:2052; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Outlook Data Object ActiveX clsid access"; flow:established,to_client; file_data; content:"0006F033-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*0006F033-0000-0000-C000-000000000046/si"; metadata:policy security-ips drop; reference:url,metasploit.com/projects/Framework/modules/exploits/ie_createobject.pm; classtype:attempted-user; sid:8721; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 46 ActiveX clsid access"; flow:established,to_client; file_data; content:"66E07EF9-4E89-4284-9632-6D6904B77732"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q81>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*66E07EF9-4E89-4284-9632-6D6904B77732\s*}?\s*(?P=q81)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14178; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel Lbl record stack overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|18 00|"; byte_test:1,&,0x80,5,relative; byte_jump:2,0,relative,little; pcre:"/^([\x18\xDE\x19\xEB\xFC\xFF]\x00|[\x94\x99\x93\x13\x66]\x08|\xC1\x01)/R"; reference:cve,2010-1251; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16655; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP eSupportDiagnostics 5 ActiveX clsid access"; flow:established,to_client; file_data; content:"4774922A-8983-4ECC-94FD-7235F06F53A1"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q35>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4774922A-8983-4ECC-94FD-7235F06F53A1\s*}?\s*(?P=q35)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28929; reference:cve,2008-0712; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13724; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS msdac access"; flow:to_server,established; content:"/msdac/"; fast_pattern; http_uri; reference:nessus,11032; classtype:web-application-activity; sid:1285; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX East Wind Software ADVDAUDIO ActiveX function call access"; flow:established,to_client; file_data; content:"ADVDAUDIO.ADVDAUDIOCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ADVDAUDIO\.ADVDAUDIOCtrl\x22|\x27ADVDAUDIO\.ADVDAUDIOCtrl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*OpenDVD\s*|.*(?P=v)\s*\.\s*OpenDVD\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ADVDAUDIO\.ADVDAUDIOCtrl\x22|\x27ADVDAUDIO\.ADVDAUDIOCtrl\x27)\s*\)(\s*\.\s*OpenDVD\s*|.*(?P=n)\s*\.\s*OpenDVD\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,23833; reference:url,moaxb.blogspot.com/2007/05/moaxb-05-east-wind-software.html; classtype:attempted-user; sid:11208; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI alchemy http server PRN arbitrary command execution attempt"; flow:to_server,established; content:"/PRN/../../"; http_uri; reference:bugtraq,3599; reference:cve,2001-0871; reference:nessus,10818; classtype:web-application-activity; sid:1505; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Scriptlet Component ActiveX clsid access "; flow:established,to_client; file_data; content:"ae24fdae-03c6-11d1-8b76-0080c744f389"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2010-3331; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:17772; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LeadTools Raster ISIS Object ActiveX function call access"; flow:established,to_client; file_data; content:"LEADRasterISIS.LeadRasterISIS"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22LEADRasterISIS\.LeadRasterISIS\x22|\x27LEADRasterISIS\.LeadRasterISIS\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*DriverName\s*|.*(?P=v)\s*\.\s*DriverName\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22LEADRasterISIS\.LeadRasterISIS\x22|\x27LEADRasterISIS\.LeadRasterISIS\x27)\s*\)(\s*\.\s*DriverName\s*|.*(?P=n)\s*\.\s*DriverName)\s*=/smi"; reference:bugtraq,24193; reference:url,moaxb.blogspot.com/2007/05/moaxb-27-leadtools-raster-isis-object.html; classtype:attempted-user; sid:11644; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma Image Uploader 4 Property Overflows ActiveX function call access"; flow:established,to_client; file_data; content:"Aurigma.ImageUploader"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Aurigma\.ImageUploader\x22|\x27Aurigma\.ImageUploader\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(ExtractIptc|ExtractExif)\s*|.*(?P=v)\s*\.\s*(ExtractIptc|ExtractExif)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Aurigma\.ImageUploader\x22|\x27Aurigma\.ImageUploader\x27)\s*\)(\s*\.\s*(ExtractIptc|ExtractExif)\s*|.*(?P=n)\s*\.\s*(ExtractIptc|ExtractExif))\s*=/smi"; reference:bugtraq,26537; reference:bugtraq,27577; reference:url,blogs.aurigma.com/post/2007/11/Security-issue-in-Image-Uploader.aspx; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13436; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Apache SSI error page cross-site scripting"; flow:to_server,established; content:"host|3A|"; fast_pattern:only; pcre:"/^Host\x3a[a-z0-9\x20\-\.\x3A\t]*[^a-z0-9\x20\-\.\x3A\t\r\n]/msi"; reference:bugtraq,32476; reference:bugtraq,5847; reference:cve,2002-0840; reference:cve,2008-5278; classtype:web-application-attack; sid:11687; rev:13;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Groove GroovePerfmon.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|GroovePerfmon.dll"; http_uri; reference:cve,2010-3146; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-016.mspx; classtype:attempted-user; sid:19315; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Novell iManager ClassName handling overflow attempt"; flow:to_server,established; content:"/nps/servlet/webacc"; http_uri; content:"ClassName="; fast_pattern; http_client_body; pcre:"/^[^\x26]{512}/R"; metadata:policy security-ips drop; reference:bugtraq,40480; reference:cve,2010-1929; classtype:attempted-admin; sid:18796; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC search.dll directory listing attempt"; flow:to_server,established; content:"/search.dll"; http_uri; content:"query=%00"; reference:bugtraq,1684; reference:cve,2000-0835; reference:nessus,10514; classtype:web-application-attack; sid:1766; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Audio Conferencing ActiveX function call access"; flow:established,to_client; file_data; content:"Yahoo.AudioConf"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Yahoo\.AudioConf\x22|\x27Yahoo\.AudioConf\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*createAndJoinConference\s*|.*(?P=v)\s*\.\s*createAndJoinConference\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Yahoo\.AudioConf\x22|\x27Yahoo\.AudioConf\x27)\s*\)(\s*\.\s*createAndJoinConference\s*|.*(?P=n)\s*\.\s*createAndJoinConference\s*)\s*\(/Osmi"; metadata:policy security-ips drop; reference:bugtraq,23291; reference:cve,2007-1680; reference:url,messenger.yahoo.com/security_update.php?id=031207; classtype:attempted-user; sid:10425; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 13 ActiveX clsid access"; flow:established,to_client; file_data; content:"AE2B937E-EA7D-4A8D-888C-B68D7F72A3C4"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q9>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*AE2B937E-EA7D-4A8D-888C-B68D7F72A3C4\s*}?\s*(?P=q9)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14112; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MarkAny MaPrintModule_WORK ActiveX clsid access"; flow:established,to_client; file_data; content:"798B9483-B7A6-46C1-9F17-C9B9F02EA811"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*798B9483-B7A6-46C1-9F17-C9B9F02EA811\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(MaDecodeData)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*798B9483-B7A6-46C1-9F17-C9B9F02EA811\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(MaDecodeData))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,23420; classtype:attempted-user; sid:10476; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealNetworks RealGames InstallerDlg.dll ActiveX function call access"; flow:established,to_client; file_data; content:"StubbyUtil.ShellCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22StubbyUtil\.ShellCtl(\.\d)?\x22|\x27StubbyUtil\.ShellCtl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(CreateVistaTaskLow|Exec|ExecLow|ShellExec)\s*|.*(?P=v)\s*\.\s*(CreateVistaTaskLow|Exec|ExecLow|ShellExec)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22StubbyUtil\.ShellCtl(\.\d)?\x22|\x27StubbyUtil\.ShellCtl(\.\d)?\x27)\s*\)(\s*\.\s*(CreateVistaTaskLow|Exec|ExecLow|ShellExec)\s*|.*(?P=n)\s*\.\s*(CreateVistaTaskLow|Exec|ExecLow|ShellExec)\s*)/smiO"; metadata:policy security-ips drop; reference:url,osvdb.org/71559; classtype:attempted-user; sid:19565; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 68 ActiveX clsid access"; flow:established,to_client; file_data; content:"E1A26BBF-26C0-401d-B82B-5C4CC67457E0"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q129>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E1A26BBF-26C0-401d-B82B-5C4CC67457E0\s*}?\s*(?P=q129)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14222; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8090 (msg:"WEB-MISC TrackerCam ComGetLogFile.php3 log information disclosure"; flow:to_server,established; content:"/ComGetLogFile.php3"; pcre:"/fn=Eye\d{4}_\d{2}.log/Rmsi"; reference:bugtraq,12592; reference:cve,2005-0481; reference:nessus,17160; classtype:web-application-activity; sid:3545; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Domino ntsync4.nsf access"; flow:to_server,established; content:"/ntsync4.nsf"; http_uri; reference:nessus,10629; classtype:attempted-recon; sid:1581; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [7100,7101] (msg:"WEB-CGI Novell GroupWise agents HTTP request remote code execution attempt"; flow:to_server,established; content:"Host|3A|"; isdataat:500,relative; content:!"|0A|"; within:500; reference:bugtraq,44732; reference:cve,2010-4714; classtype:attempted-admin; sid:18960; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-MISC Real Player realtext long URI request"; flow:to_server,established; content:".rt"; http_uri; pcre:"/\S{190}.rt/Usmi"; flowbits:set,realtext.request; flowbits:noalert; classtype:protocol-command-decode; sid:3822; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Kaspersky AntiVirus KAV60Info ActiveX function call access"; flow:established,to_client; file_data; content:"AxKLProd60.KAV60Info"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22AxKLProd60\.KAV60Info\x22|\x27AxKLProd60\.KAV60Info\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*|.*(?P=v)\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22AxKLProd60\.KAV60Info\x22|\x27AxKLProd60\.KAV60Info\x27)\s*\)(\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*|.*(?P=n)\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,23345; reference:cve,2007-1112; reference:url,www.kaspersky.com/technews?id=203038693; classtype:attempted-user; sid:10433; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Office Web Components Datasource ActiveX clsid access"; flow:established,to_client; file_data; content:"0002E543-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0002E543-0000-0000-C000-000000000046\s*}?\s*(?P=q1)(\s|>)/siO"; metadata:policy security-ips drop; reference:cve,2009-0562; reference:url,www.microsoft.com/technet/security/bulletin/MS09-043.mspx; classtype:attempted-user; sid:15852; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Chilkat Crypt 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"3352B5B9-82E8-4FFD-9EB1-1A3E60056904"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m7>\x22|\x27|)(?P<id1>.+?)(?P=m7)(\s|>)[^>]*\s*classid\s*=\s*(?P<q14>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3352B5B9-82E8-4FFD-9EB1-1A3E60056904\s*}?\s*(?P=q14)(\s|>).*(?P=id1)\s*\.\s*(WriteFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q15>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3352B5B9-82E8-4FFD-9EB1-1A3E60056904\s*}?\s*(?P=q15)(\s|>)[^>]*\s*id\s*=\s*(?P<m8>\x22|\x27|)(?P<id2>.+?)(?P=m8)(\s|>).*(?P=id2)\.(WriteFile))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,32073; classtype:attempted-user; sid:15003; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMT Screen Capture Filter Task Page ActiveX clsid access"; flow:established,to_client; file_data; content:"679E132F-561B-42F8-846C-A70DBDC62999"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*679E132F-561B-42F8-846C-A70DBDC62999/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7486; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX COWON America JetAudio JetFlExt.dll ActiveX function call access"; flow:established,to_client; file_data; content:"JetAudio.Interface"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22JetAudio\.Interface\x22|\x27JetAudio\.Interface\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22JetAudio\.Interface\x22|\x27JetAudio\.Interface\x27)\s*\)/smi"; reference:bugtraq,25723; reference:cve,2007-4983; classtype:attempted-user; sid:12470; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows ISA Server cross-site scripting attempt"; flow:to_server,established; content:"CookieAuth.dll"; http_uri; content:"GetLogonRedir"; http_uri; content:"formdir"; http_uri; content:"reason=|22|"; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0237; reference:url,www.microsoft.com/technet/security/bulletin/MS09-016.mspx; classtype:attempted-user; sid:15475; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC OpenView Network Node Manager cookie buffer overflow attempt"; flow:to_server,established; content:"/OVCgi/ovalarm.exe"; fast_pattern:only; http_uri; pcre:"/(OvJavaScript|OvTitleFrame|OvHelpWindow|OvMap|OvSession|OvJavaLocale|OvOSLocale|OvLogin|OvDebug|OvDeveloper|OvTreeControl|OvJavaScript|OvProduct|OvPort|OvLocale|OvWebSession)\s*\x3D[^\x3B\x2C]{1024}/iC"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,42154; reference:cve,2010-2709; classtype:attempted-user; sid:18914; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AOL.PicDownloadCtrl ActiveX clsid access"; flow:established,to_client; file_data; content:"D670D0B3-05AB-4115-9F87-D983EF1AC747"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*D670D0B3-05AB-4115-9F87-D983EF1AC747/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:7894; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT CBO CBL CBM file transfer attempt"; flow:to_client,established; content:"text/plain"; http_header; content:"Interactive Training]"; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)text\x2fplain/smiH"; pcre:"/\[(Microsoft |Microsoft Press )?Interactive Training\]/"; reference:bugtraq,13944; reference:cve,2005-1212; reference:cve,2006-3448; reference:nessus,18492; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-005.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS05-031.mspx; classtype:attempted-user; sid:4196; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 3 ActiveX clsid access"; flow:established,to_client; file_data; content:"0369B4E5-45B6-11D3-B650-00C04F79498E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q45>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0369B4E5-45B6-11D3-B650-00C04F79498E\s*}?\s*(?P=q45)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15632; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Music JukeBox DataGrid ActiveX clsid access"; flow:established,to_client; file_data; content:"5F810AFC-BB5F-4416-BE63-E01DD117BD6C"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5F810AFC-BB5F-4416-BE63-E01DD117BD6C\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(AddImage|AddButton)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*5F810AFC-BB5F-4416-BE63-E01DD117BD6C\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(AddImage|AddButton))\s*\(/Osi"; metadata:policy security-ips alert; reference:bugtraq,27579; classtype:attempted-user; sid:13426; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp ID3v2 Tag Handling Buffer Overflow attempt"; flow:to_client,established; file_data; content:"ID3"; within:3; pcre:"/T(PE(1|2)|IT2)/iR"; byte_test:4,>,0x190,0,relative,big; metadata:policy security-ips drop; reference:bugtraq,14276; reference:cve,2005-2310; classtype:attempted-user; sid:17351; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer redirect to cdl protocol attempt"; flow:to_client,established; content:"302 Redirect"; content:"Location|3A 20|cdl|3A 2F 2F|"; distance:0; http_header; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1262; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-admin; sid:19245; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime RTSP URI overflow attempt"; flow:to_client,established; file_data; content:"rtsp|3A|//"; pcre:"/(=\s*([\x27|\x22]rtsp\x3A[^\x22\x27\s]{200}|rstp\x3A[^\s\x3E]{200})|\x3Csrc\x3Ertsp\x3A[^\x3C]{200})/smi"; metadata:policy security-ips drop; reference:bugtraq,21829; reference:cve,2007-0015; reference:url,applefun.blogspot.com/2007/01/moab-01-01-2007-apple-quicktime-rtsp.html; classtype:attempted-user; sid:9823; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI bizdbsearch attempt"; flow:to_server,established; content:"/bizdb1-search.cgi"; fast_pattern; http_uri; content:"mail"; reference:bugtraq,1104; reference:cve,2000-0287; reference:nessus,10383; classtype:web-application-attack; sid:1185; rev:19;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI eXtropia webstore access"; flow:to_server,established; content:"/web_store.cgi"; http_uri; reference:bugtraq,1774; reference:cve,2000-1005; reference:nessus,10532; classtype:web-application-activity; sid:1611; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE service.pwd"; flow:to_server,established; content:"/service.pwd"; fast_pattern; http_uri; reference:bugtraq,1205; classtype:web-application-activity; sid:959; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel file with embedded ActiveX control"; flow:to_client,established; flowbits:isset,http.xls; content:"|00|_|00|_|00|S|00|R|00|P|00|_|00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3477; reference:url,www.microsoft.com/technet/security/bulletin/MS08-057.mspx; classtype:attempted-user; sid:14642; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmappPropPath Class ActiveX function call access"; flow:established,to_client; file_data; content:"Vmappsdk.VmappPropPath"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Vmappsdk\.VmappPropPath\x22|\x27Vmappsdk\.VmappPropPath\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Vmappsdk\.VmappPropPath\x22|\x27Vmappsdk\.VmappPropPath\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14562; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iOS 4.3.3 jailbreak for iPod download attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|78 DA ED DD 07 3C 97 FB FF 3F 7E 23 0D 23 CA C8 28 69 90 64 13 21 44 85 B2 0A 91 68 C8 DE 5B 46|"; metadata:policy security-ips drop; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19419; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Intuit QuickBooks Online Edition 7 ActiveX clsid access"; flow:established,to_client; file_data; content:"0D3983A9-4E29-4f33-8313-DA22B29D3F87"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m15>\x22|\x27|)(?P<id1>.+?)(?P=m15)(\s|>)[^>]*\s*classid\s*=\s*(?P<q22>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0D3983A9-4E29-4f33-8313-DA22B29D3F87\s*}?\s*(?P=q22)(\s|>).*(?P=id1)\s*\.\s*(httpGETToFile|httpPOSTFromFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q23>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0D3983A9-4E29-4f33-8313-DA22B29D3F87\s*}?\s*(?P=q23)(\s|>)[^>]*\s*id\s*=\s*(?P<m16>\x22|\x27|)(?P<id2>.+?)(?P=m16)(\s|>).*(?P=id2)\.(httpGETToFile|httpPOSTFromFile))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,25544; reference:cve,2007-0322; reference:cve,2007-4471; reference:url,sc.accounting.quickbooks.com/Update/index.cfm?id=32; reference:url,www.kb.cert.org/vuls/id/907481; reference:url,www.kb.cert.org/vuls/id/979638; reference:url,www.microsoft.com/technet/security/bulletin/MS07-069.mspx; classtype:attempted-user; sid:12405; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Microsoft Sharepoint XSS attempt "; flow:to_server,established; content:"_layouts/help.aspx?cid0="; http_uri; pcre:"/\x5flayouts\x2fhelp\x2easpx\x3fcid0\x3d[A-Za-z\x5c\x2e0-9]*[^A-Za-z\x5c\x2f\x2e\x26\x3d0-9\s]/Usi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0817; reference:url,www.microsoft.com/technet/security/bulletin/MS10-039.mspx; classtype:attempted-user; sid:16560; rev:4;)
alert tcp $HOME_NET 445 -> $HOME_NET any (msg:"NETBIOS Adobe Premier Pro iacenc.dll dll-load exploit attempt"; flow:to_client,established; content:"i|00|a|00|c|00|e|00|n|00|c|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2010-3150; reference:url,osvdb.org/show/osvdb/67554; classtype:attempted-user; sid:18532; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MW6 Technologies DataMatrix ActiveX clsid access"; flow:established,to_client; file_data; content:"DE7DA0B5-7D7B-4CEA-8739-65CF600D511E"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m5>\x22|\x27|)(?P<id1>.+?)(?P=m5)(\s|>)[^>]*\s*classid\s*=\s*(?P<q11>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DE7DA0B5-7D7B-4CEA-8739-65CF600D511E\s*}?\s*(?P=q11)(\s|>).*(?P=id1)\s*\.\s*(SaveAsWMF|SaveAsBMP)|<object\s*[^>]*\s*classid\s*=\s*(?P<q12>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DE7DA0B5-7D7B-4CEA-8739-65CF600D511E\s*}?\s*(?P=q12)(\s|>)[^>]*\s*id\s*=\s*(?P<m6>\x22|\x27|)(?P<id2>.+?)(?P=m6)(\s|>).*(?P=id2)\.(SaveAsWMF|SaveAsBMP))\s*\(/siO"; metadata:policy security-ips drop; reference:cve,2008-4925; classtype:attempted-user; sid:15274; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX PostBootReminder object ActiveX clsid access"; flow:established,to_client; file_data; content:"7849596A-48EA-486E-8937-A2A3009F31A9"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*7849596A-48EA-486E-8937-A2A3009F31A9/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:7970; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE service.stp access"; flow:to_server,established; content:"/_vti_pvt/service.stp"; fast_pattern; http_uri; classtype:web-application-activity; sid:960; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Learn2 STRunner ActiveX clsid access"; flow:established,to_client; file_data; content:"0B72CCA4-5F11-11D0-9CB5-0000C0EC9FDB"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0B72CCA4-5F11-11D0-9CB5-0000C0EC9FDB\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28058; classtype:attempted-user; sid:13543; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 64 ActiveX clsid access"; flow:established,to_client; file_data; content:"038F6F55-C9F0-4601-8740-98EF1CA9DF9A"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q121>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*038F6F55-C9F0-4601-8740-98EF1CA9DF9A\s*}?\s*(?P=q121)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14214; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI directorypro.cgi attempt"; flow:to_server,established; content:"/directorypro.cgi"; http_uri; content:"show="; content:"../.."; distance:1; reference:bugtraq,2793; reference:cve,2001-0780; reference:nessus,10679; classtype:web-application-attack; sid:1574; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX EldoS SecureBlackbox PGPBBox ActiveX function call access"; flow:established,to_client; file_data; content:"pgpbbox.ElPGPJpegImageX"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22pgpbbox\.ElPGPJpegImageX\x22|\x27pgpbbox\.ElPGPJpegImageX\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SaveToFile\s*|.*(?P=v)\s*\.\s*SaveToFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22pgpbbox\.ElPGPJpegImageX\x22|\x27pgpbbox\.ElPGPJpegImageX\x27)\s*\)(\s*\.\s*SaveToFile\s*|.*(?P=n)\s*\.\s*SaveToFile\s*)\s*\(/smi"; reference:bugtraq,24882; reference:cve,2007-3785; classtype:attempted-user; sid:12093; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Generic HyperLink buffer overflow attempt"; flow:to_server,established; content:"GET /"; depth:5; isdataat:1450,relative; pcre:"/^GET \x2f[^\r\n]{1450}/i"; reference:bugtraq,13045; reference:bugtraq,14195; reference:bugtraq,36815; reference:bugtraq,37184; reference:cve,2005-0057; reference:cve,2005-0986; reference:cve,2007-0774; reference:cve,2009-0895; reference:cve,2011-1965; reference:url,www.microsoft.com/technet/security/bulletin/MS11-064.mspx; classtype:attempted-user; sid:17410; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PICT graphics converter memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pct; content:"|00 A1|"; content:"|49 43|"; within:2; distance:10; byte_test:2,>,4094,0,relative,big; metadata:policy security-ips drop; reference:cve,2010-3946; reference:url,www.microsoft.com/technet/security/bulletin/MS10-105.mspx; classtype:attempted-user; sid:18235; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer select element memory corruption attempt"; flow:to_client,established; content:"http-equiv="; content:"X-UA-Compatible"; distance:0; content:"content="; content:"IE=8"; distance:0; content:"createElement"; distance:0; content:"select"; distance:0; pcre:"/createElement\s*\x28\s*(?P<a>[\x22\x27])\s*select\s*(?P=a)\s*\x29/i"; reference:bugtraq,45260; reference:cve,2010-3345; classtype:attempted-user; sid:18217; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS showcode.asp access"; flow:to_server,established; content:"/showcode.asp"; fast_pattern; http_uri; reference:bugtraq,167; reference:cve,1999-0736; reference:nessus,10007; reference:url,www.microsoft.com/technet/security/bulletin/MS99-013.mspx; classtype:web-application-activity; sid:1037; rev:19;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC /*.shtml access"; flow:to_server,established; content:"/*.shtml"; http_uri; reference:bugtraq,1517; reference:cve,2000-0683; reference:nessus,11604; classtype:web-application-activity; sid:2139; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp MIDI file buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mid; file_data; content:"CTMF"; depth:4; byte_test:2,>,0x400,8,little; metadata:policy security-ips drop; reference:url,forums.winamp.com/showthread.php?t=332010; reference:url,osvdb.org/show/osvdb/76634; classtype:attempted-user; sid:20559; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 61 ActiveX clsid access"; flow:established,to_client; file_data; content:"974E1D88-BADF-4C80-8594-A59039C992EA"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q115>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*974E1D88-BADF-4C80-8594-A59039C992EA\s*}?\s*(?P=q115)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14208; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI whois_raw.cgi access"; flow:to_server,established; content:"/whois_raw.cgi"; http_uri; reference:arachnids,466; reference:bugtraq,304; reference:cve,1999-1063; reference:nessus,10306; classtype:attempted-recon; sid:810; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime Image Description Atom sign extension memory corruption attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"stsd"; content:"rpza"; distance:12; fast_pattern; content:"|00 00 00 00 00 00|"; within:6; byte_test:2,>,0x1FFC,18,relative,big; metadata:policy security-ips drop; reference:bugtraq,35166; reference:cve,2009-0955; reference:url,support.apple.com/kb/HT3591; classtype:attempted-user; sid:16360; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI printenv access"; flow:to_server,established; content:"/printenv"; http_uri; reference:bugtraq,1658; reference:cve,2000-0868; reference:nessus,10188; reference:nessus,10503; classtype:web-application-activity; sid:1877; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Embedded Open Type Font malformed name table overflow attempt"; flow:to_client,established; flowbits:isset,eot.download; content:"|00 01 00 01 00 00 00 01 FF FF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0231; reference:url,www.microsoft.com/technet/security/bulletin/MS09-029.mspx; classtype:attempted-user; sid:15693; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealPlayer Ierpplug.dll ActiveX function call access"; flow:established,to_client; file_data; content:"IERPCtl.IERPCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22IERPCtl\.IERPCtl(\.\d)?\x22|\x27IERPCtl\.IERPCtl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(GetComponentVersion|HandleAction|DoAutoUpdateRequest|Quoting|PlayerProperty|Import|RecordClip)\s*|.*(?P=v)\s*\.\s*(GetComponentVersion|HandleAction|DoAutoUpdateRequest|Quoting|PlayerProperty|Import|RecordClip)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22IERPCtl\.IERPCtl(\.\d)?\x22|\x27IERPCtl\.IERPCtl(\.\d)?\x27)\s*\)(\s*\.\s*(GetComponentVersion|HandleAction|DoAutoUpdateRequest|Quoting|PlayerProperty|Import|RecordClip)\s*|.*(?P=n)\s*\.\s*(GetComponentVersion|HandleAction|DoAutoUpdateRequest|Quoting|PlayerProperty|Import|RecordClip)\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,21802; reference:bugtraq,22811; reference:bugtraq,44443; reference:cve,2006-6847; reference:cve,2007-5601; reference:cve,2008-3066; reference:cve,2010-3749; classtype:attempted-user; sid:10193; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI commerce.cgi access"; flow:to_server,established; content:"/commerce.cgi"; fast_pattern; http_uri; reference:bugtraq,2361; reference:cve,2001-0210; reference:nessus,10612; classtype:attempted-recon; sid:898; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Clever Internet Suite ActiveX function call access"; flow:established,to_client; file_data; content:"clInetSuiteX6.clWebDav"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22clInetSuiteX6\.clWebDav\x22|\x27clInetSuiteX6\.clWebDav\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*GetToFile\s*|.*(?P=v)\s*\.\s*GetToFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22clInetSuiteX6\.clWebDav\x22|\x27clInetSuiteX6\.clWebDav\x27)\s*\)(\s*\.\s*GetToFile\s*|.*(?P=n)\s*\.\s*GetToFile\s*)\s*\(/smi"; reference:bugtraq,25063; reference:cve,2007-4067; classtype:attempted-user; sid:12191; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Tomcat SnoopServlet servlet access"; flow:established,to_server; content:"/examples/servlet/SnoopServlet"; http_uri; reference:bugtraq,4575; reference:nessus,11046; classtype:web-application-activity; sid:1830; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Oracle Secure Backup Administration preauth variable command injection attempt"; flow:to_server,established; content:"/index.php"; http_uri; content:"button=Remove"; http_uri; content:"op=Preauth"; http_uri; content:"preauth="; http_uri; pcre:"/preauth\x3d[\x26\x7c]/Ui"; reference:bugtraq,41597; reference:cve,2010-0906; classtype:attempted-admin; sid:19228; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows AVI Header insufficient data corruption attempt"; flow:to_client,established; flowbits:isset,http.avi; content:"RIFF"; fast_pattern; content:"AVI "; within:4; distance:4; content:"avih"; distance:0; byte_extract:4,0,chunk_size,little,relative; isdataat:!chunk_size,relative; metadata:policy security-ips drop, service http; reference:bugtraq,35967; reference:cve,2009-1545; reference:url,www.microsoft.com/technet/security/bulletin/ms09-038.mspx; classtype:attempted-user; sid:19320; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Trend Micro OfficeScan Server cgiRecvFile overflow attempt"; flow:to_server,established; content:"/cgi/cgiRecvFile.exe"; http_uri; content:"ComputerName"; pcre:"/ComputerName\s*\x3d\s*\x22[^\x22]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,31139; reference:cve,2008-2437; classtype:attempted-admin; sid:15510; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC iPlanet Search directory traversal attempt"; flow:established,to_server; content:"/search"; http_uri; content:"NS-query-pat="; content:"../../"; reference:bugtraq,5191; reference:cve,2002-1042; reference:nessus,11043; classtype:web-application-attack; sid:1828; rev:10;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 (msg:"WEB-MISC TLSv1 Client Change Cipher Spec message"; flow:established, to_server; ssl_version:tls1.0; content:"|14 03 01 00 01 01|"; depth:6; flowbits:set,tlsv1.client_change_cipher_spec; flowbits:noalert; classtype:protocol-command-decode; sid:18318; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint file LinkedSlide10Atom record parsing heap corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|00 00 E7|.|08 00 00 00|"; byte_jump:4,4,relative,multiplier 16,little; content:"|00 00 E6|.|08 00 00 00|"; within:8; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0030; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:16410; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX PhotoStockPlus ActiveX clsid access"; flow:established,to_client; file_data; content:"E48BB416-C578-4A62-84C9-5E3389ABE5FC"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q3>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E48BB416-C578-4A62-84C9-5E3389ABE5FC\s*}?\s*(?P=q3)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,29279; reference:cve,2008-0957; reference:url,support.microsoft.com/kb/956391; classtype:attempted-user; sid:14633; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel MSO.DLL malformed string parsing single byte buffer over attempt"; flow:to_client,established; file_data; content:"|00 00 00 00 00 00 1D 00 0F 00 03 00 00 00|"; isdataat:2,relative; content:!"|00|"; within:1; distance:2; metadata:policy security-ips drop; reference:bugtraq,17252; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7197; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP eSupportDiagnostics 2 ActiveX clsid access"; flow:established,to_client; file_data; content:"CDAF9CEC-F3EC-4B22-ABA3-9726713560F8"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q24>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CDAF9CEC-F3EC-4B22-ABA3-9726713560F8\s*}?\s*(?P=q24)(\s|>).*(?P=id1)\s*\.\s*(ReadTextFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q25>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CDAF9CEC-F3EC-4B22-ABA3-9726713560F8\s*}?\s*(?P=q25)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\.(ReadTextFile))\s*\(/si"; reference:bugtraq,26967; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13230; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Animation Control ActiveX function call access"; flow:established,to_client; file_data; content:"ComCtl2.Animation"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ComCtl2\.Animation(\.\d)?\x22|\x27ComCtl2\.Animation(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ComCtl2\.Animation(\.\d)?\x22|\x27ComCtl2\.Animation(\.\d)?\x27)\s*\)/smiO"; metadata:policy security-ips drop; reference:url,support.microsoft.com/kb/960715; classtype:attempted-user; sid:15309; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION eval.cfm access"; flow:to_server,established; content:"/cfdocs/expeval/eval.cfm"; fast_pattern; http_uri; reference:bugtraq,3154; reference:bugtraq,550; reference:cve,1999-0760; classtype:attempted-recon; sid:8491; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Logitech Video Call 1 ActiveX clsid access"; flow:established,to_client; file_data; content:"54da0fb5-483a-4c53-810b-f131d50a8eb6"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*54da0fb5-483a-4c53-810b-f131d50a8eb6\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Start)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*54da0fb5-483a-4c53-810b-f131d50a8eb6\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Start))/siO"; metadata:policy security-ips drop; reference:bugtraq,24254; reference:cve,2007-2918; classtype:attempted-user; sid:17063; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Intuit QuickBooks Online Import 5 ActiveX clsid access"; flow:established,to_client; file_data; content:"823AA622-D72B-42d4-905D-FDD9FC9600FC"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q9>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*823AA622-D72B-42d4-905D-FDD9FC9600FC\s*}?\s*(?P=q9)(\s|>)/si"; metadata:policy security-ips drop; reference:url,sc.accounting.quickbooks.com/Update/index.cfm?id=32; reference:url,www.microsoft.com/technet/security/bulletin/MS07-069.mspx; classtype:attempted-user; sid:12969; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI guestbook.cgi access"; flow:to_server,established; content:"/guestbook.cgi"; fast_pattern; http_uri; reference:cve,1999-0237; reference:nessus,10098; classtype:web-application-activity; sid:1597; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Oracle EasyMail ActiveX function call access"; flow:established,to_client; file_data; content:"EasyMail.SMTP"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22EasyMail\.SMTP(\.\d)?\x22|\x27EasyMail\.SMTP(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(ImportBodyText|ImportBodyTextEx|ImportBodyAlternative)\s*|.*(?P=v)\s*\.\s*(ImportBodyText|ImportBodyTextEx|ImportBodyAlternative)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22EasyMail\.SMTP(\.\d)?\x22|\x27EasyMail\.SMTP(\.\d)?\x27)\s*\)(\s*\.\s*(ImportBodyText|ImportBodyTextEx|ImportBodyAlternative)\s*|.*(?P=n)\s*\.\s*(ImportBodyText|ImportBodyTextEx|ImportBodyAlternative)\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,45849; reference:cve,2010-3595; classtype:attempted-user; sid:19305; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI mailnews.cgi access"; flow:to_server,established; content:"/mailnews.cgi"; fast_pattern; http_uri; reference:bugtraq,2391; reference:cve,2001-0271; reference:nessus,10641; classtype:attempted-recon; sid:1471; rev:15;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC OpenView Network Node Manager cookie buffer overflow attempt"; flow:to_server,established; content:"/OVCgi/nnmRptPresenter.exe"; fast_pattern:only; http_uri; pcre:"/(OvJavaScript|OvTitleFrame|OvHelpWindow|OvMap|OvSession|OvJavaLocale|OvOSLocale|OvLogin|OvDebug|OvDeveloper|OvTreeControl|OvJavaScript|OvProduct|OvPort|OvLocale|OvWebSession)\s*\x3D[^\x3B\x2C]{1024}/iC"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,42154; reference:cve,2010-2709; classtype:attempted-user; sid:18911; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS asp-dot attempt"; flow:to_server,established; content:".asp."; fast_pattern; http_uri; reference:bugtraq,1814; reference:nessus,10363; classtype:web-application-attack; sid:997; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX XML Schema Cache 6.0 ActiveX clsid access"; flow:established,to_client; file_data; content:"88D96A07-F192-11D4-A65F-0040963251E5"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*88D96A07-F192-11D4-A65F-0040963251E5/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:8403; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape Enterprise Server directory view"; flow:to_server,established; content:"?wp-cs-dump"; http_uri; reference:bugtraq,1063; reference:cve,2000-0236; reference:nessus,10352; classtype:attempted-recon; sid:1183; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC IE8 Javascript negative option index attack attempt"; flow:established,to_client; file_data; content:".options.add"; fast_pattern:only; content:"<script"; pcre:"/\w\x2eoptions\x2eadd\x28\s*\w\s*\x2c\s*\x2d/smi"; reference:cve,2011-1999; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-081.mspx; classtype:attempted-user; sid:20266; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.Light ActiveX function call access"; flow:established,to_client; file_data; content:"DXImageTransform.Microsoft.Light"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DXImageTransform.Microsoft.Light\x22|\x27DXImageTransform.Microsoft.Light\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DXImageTransform.Microsoft.Light\x22|\x27DXImageTransform.Microsoft.Light\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-2383; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-021.mspx; classtype:attempted-user; sid:6516; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 44 ActiveX clsid access"; flow:established,to_client; file_data; content:"F9769A06-7ACA-4E39-9CFB-97BB35F0E77E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q77>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F9769A06-7ACA-4E39-9CFB-97BB35F0E77E\s*}?\s*(?P=q77)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15664; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB-CGI Trend Micro OfficeScan CGI password decryption buffer overflow attempt"; flow:to_server,established; content:"/cgiablogon.exe"; fast_pattern:only; content:"CRYPT"; isdataat:512,relative; pcre:"/pwd=(\!|\%21)CRYPT(\!|\%21)[A-Z0-9]{512}/i"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,28020; reference:cve,2008-1365; reference:url,secunia.com/advisories/29124; classtype:web-application-attack; sid:13591; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION cfmlsyntaxcheck.cfm access"; flow:to_server,established; content:"/cfdocs/cfmlsyntaxcheck.cfm"; fast_pattern; http_uri; reference:bugtraq,550; reference:cve,1999-0760; classtype:attempted-recon; sid:931; rev:14;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI Web Shopper shopper.cgi attempt"; flow:to_server,established; content:"/shopper.cgi"; fast_pattern; http_uri; content:"newpage=../"; reference:bugtraq,1776; reference:cve,2000-0922; reference:nessus,10533; classtype:web-application-attack; sid:1468; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 16 ActiveX clsid access"; flow:established,to_client; file_data; content:"3604EC19-E009-4DCB-ABC5-BB95BF92FD8B"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q15>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3604EC19-E009-4DCB-ABC5-BB95BF92FD8B\s*}?\s*(?P=q15)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14118; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Blackberry Server PDF JBIG2 numnewsyms remote code execution attempt"; flow:to_client,established; content:"JBIG2Decode"; content:"stream"; distance:0; pcre:"/JBIG2Decode.*?stream(\x0d\x0a|\x0a|\x0d)/smi"; byte_test:1, !&, 63, 4, relative; byte_test:4, >, 2147483647, 17, relative; reference:bugtraq,35102; reference:cve,2009-2643; reference:url,www.blackberry.com/btsc/search.do?cmd=displayKC&docType=kc&externalId=KB18327; classtype:attempted-admin; sid:16336; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8014 (msg:"WEB-MISC CA ARCserve Axis2 default credential login attempt"; flow:to_server,established; content:"/WebServiceImpl/axis2-admin/login"; fast_pattern:only; http_uri; content:"userName=admin"; http_client_body; content:"password=axis2"; http_client_body; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,45625; reference:cve,2010-0219; classtype:default-login-attempt; sid:18985; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.Chroma ActiveX function call access"; flow:established,to_client; file_data; content:"DXImageTransform.Microsoft.Chroma"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22DXImageTransform\.Microsoft\.Chroma\x22|\x27DXImageTransform\.Microsoft\.Chroma\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22DXImageTransform\.Microsoft\.Chroma\x22|\x27DXImageTransform\.Microsoft\.Chroma\x27)\s*\)/smi"; reference:bugtraq,24188; reference:url,www.securityfocus.com/archive/1/443907; classtype:attempted-user; sid:11620; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Synactis ALL In-The-Box ActiveX function call access"; flow:established,to_client; file_data; content:"All_In_The_Box.AllBox"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22All_In_The_Box\.AllBox(\.\d)?\x22|\x27All_In_The_Box\.AllBox(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SaveDoc\s*|.*(?P=v)\s*\.\s*SaveDoc\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22All_In_The_Box\.AllBox(\.\d)?\x22|\x27All_In_The_Box\.AllBox(\.\d)?\x27)\s*\)(\s*\.\s*SaveDoc\s*|.*(?P=n)\s*\.\s*SaveDoc\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:bugtraq,33535; reference:cve,2009-0465; classtype:attempted-user; sid:15348; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected hIST overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"hIST"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6694; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC apache directory disclosure attempt"; flow:to_server,established; content:"////////"; reference:bugtraq,2503; classtype:attempted-dos; sid:1156; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3443 (msg:"WEB-MISC HP Openview NNM freeIPaddrs.ovpl port 3443 Unix command execution attempt"; flow:to_server,established; content:"/freeIPaddrs.ovpl"; http_uri; content:"netid="; http_uri; pcre:"/freeIPaddrs.ovpl[^\r\n]*netid=[^\r\n]*%(\x2c|\x24|\x7c|\x3b|\x22|\x26|\x3c|\x3f)/Usmi"; reference:bugtraq,14662; reference:cve,2005-2773; classtype:web-application-attack; sid:8087; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Widgets Engine ActiveX function call access"; flow:established,to_client; file_data; content:"YDPCTL.YDPControl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22YDPCTL\.YDPControl\x22|\x27YDPCTL\.YDPControl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*GetComponentVersion\s*|.*(?P=v)\s*\.\s*GetComponentVersion\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22YDPCTL\.YDPControl\x22|\x27YDPCTL\.YDPControl\x27)\s*\)(\s*\.\s*GetComponentVersion\s*|.*(?P=n)\s*\.\s*GetComponentVersion\s*)\s*\(/Osmi"; reference:bugtraq,25086; reference:cve,2007-4034; reference:url,help.yahoo.com/l/us/yahoo/widgets/security/security-08.html; classtype:attempted-user; sid:12195; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC ans.pl access"; flow:to_server,established; content:"/ans.pl"; http_uri; reference:bugtraq,4147; reference:bugtraq,4149; reference:cve,2002-0306; reference:cve,2002-0307; reference:nessus,10875; classtype:web-application-activity; sid:1523; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 42 ActiveX clsid access"; flow:established,to_client; file_data; content:"CAAFDD83-CEFC-4E3D-BA03-175F17A24F91"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q73>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CAAFDD83-CEFC-4E3D-BA03-175F17A24F91\s*}?\s*(?P=q73)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15660; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint 95 converter CString in ExEmbed container buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.ppt; file_data; content:"|CC 0F 00 00 FF FF 00 00|"; content:"|BA 0F 00 00|"; distance:0; byte_test:4,>,128,4,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1129; reference:url,www.microsoft.com/technet/security/bulletin/MS09-017.mspx; classtype:attempted-user; sid:15499; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Search Assistant UI ActiveX object access"; flow:established,to_client; file_data; content:"47C6C527-6204-4F91-849D-66E234DEE015"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*47C6C527-6204-4F91-849D-66E234DEE015/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4230; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAVector2.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BCA-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BCA-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8771; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks SMIL wallclock stack overflow attempt"; flow:to_client,established; content:"<smi"; content:"wallclock|28|"; pcre:"/^[^\x29]*\x2E[0-9]{11}/R"; metadata:policy balanced-ips drop, policy security-ips drop, service sunrpc; reference:bugtraq,24658; reference:cve,2007-3410; classtype:attempted-user; sid:12728; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAEvent.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"50B4791F-4731-11D0-8912-00C04FC2A0CA"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*50B4791F-4731-11D0-8912-00C04FC2A0CA/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8744; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX StreamAudio ProxyManager ActiveX function call access"; flow:established,to_client; file_data; content:"Ccpm.ProxyManager"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Ccpm\.ProxyManager\x22|\x27Ccpm\.ProxyManager\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*InternalTuneIn\s*|.*(?P=v)\s*\.\s*InternalTuneIn\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Ccpm\.ProxyManager\x22|\x27Ccpm\.ProxyManager\x27)\s*\)(\s*\.\s*InternalTuneIn\s*|.*(?P=n)\s*\.\s*InternalTuneIn\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,27247; reference:cve,2008-0248; classtype:attempted-user; sid:13314; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MW6 Technologies DataMatrix ActiveX function call access"; flow:established,to_client; file_data; content:"DATAMATRIX.MW6DataMatrix"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22DATAMATRIX\.MW6DataMatrix(\.\d)?\x22|\x27DATAMATRIX\.MW6DataMatrix(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(SaveAsWMF|SaveAsBMP)\s*|.*(?P=v)\s*\.\s*(SaveAsWMF|SaveAsBMP)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22DATAMATRIX\.MW6DataMatrix(\.\d)?\x22|\x27DATAMATRIX\.MW6DataMatrix(\.\d)?\x27)\s*\)(\s*\.\s*(SaveAsWMF|SaveAsBMP)\s*|.*(?P=n)\s*\.\s*(SaveAsWMF|SaveAsBMP)\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:cve,2008-4925; classtype:attempted-user; sid:15276; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Webcam Upload ActiveX function call unicode access"; flow:established,to_client; file_data; content:"Y|00|W|00|c|00|U|00|p|00|l|00|.|00|W|00|c|00|U|00|p|00|l|00|o|00|a|00|d|00|"; fast_pattern:only; pcre:"/(?P<c>\w+)(\s\x00)*=(\s\x00)*(?P<q9>\x22|\x27|)Y\x00W\x00c\x00U\x00p\x00l\x00.\x00W\x00c\x00U\x00p\x00l\x00o\x00a\x00d\x00(?P=q9)(\s|>)(\s\x00)*\x3b\x00.*(?P<v>(\w\x00)+)(\s\x00)*1\(\x00(\s\x00)*(?P=c)(\s\x00)*\)\x00|(?P<n>\w+)(\s\x00)*1\(\x00(\s\x00)*(?P<q10>\x22|\x27|)Y\x00W\x00c\x00U\x00p\x00l\x00.\x00W\x00c\x00U\x00p\x00l\x00o\x00a\x00d\x00(?P=q10)(\s|>)(\s\x00)*\)\x00/siO"; metadata:policy security-ips drop; reference:bugtraq,24341; reference:cve,2007-3147; classtype:attempted-user; sid:11825; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX EDraw Office Viewer Component ActiveX function call access"; flow:established,to_client; file_data; content:"EDraw.OfficeViewer"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22EDraw\.OfficeViewer\x22|\x27EDraw\.OfficeViewer\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(HttpDownloadFile|HttpDownloadFileToTempDir|FtpDownloadFile)\s*|.*(?P=v)\s*\.\s*(HttpDownloadFile|HttpDownloadFileToTempDir|FtpDownloadFile)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22EDraw\.OfficeViewer\x22|\x27EDraw\.OfficeViewer\x27)\s*\)(\s*\.\s*(HttpDownloadFile|HttpDownloadFileToTempDir|FtpDownloadFile)\s*|.*(?P=n)\s*\.\s*(HttpDownloadFile|HttpDownloadFileToTempDir|FtpDownloadFile)\s*)\s*\(/smi"; reference:bugtraq,25344; reference:bugtraq,25593; reference:bugtraq,25892; reference:cve,2007-3169; reference:cve,2007-4420; reference:cve,2007-4821; classtype:attempted-user; sid:12432; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CCRP FolderTreeView ActiveX clsid access"; flow:established,to_client; file_data; content:"19B7F2D6-1610-11D3-BF30-1AF820524153"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*19B7F2D6-1610-11D3-BF30-1AF820524153\s*}?\s*\1/si"; metadata:policy security-ips drop; reference:bugtraq,22092; reference:url,ccrp.mvps.org/index.html?controls/ccrpftv6.htm; classtype:attempted-user; sid:10013; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Kaspersky antivirus library heap buffer overflow - without optional fields"; flow:to_client,established; file_data; content:"MSCF"; byte_test:2,&,0x0003,26,relative,little; byte_test:2,!&,0x0004,26,relative,little; pcre:"/^.{32}([^\x00]*\x00)?[^\x00]{256}/sR"; metadata:policy security-ips drop; reference:bugtraq,14998; reference:cve,2005-3142; classtype:attempted-user; sid:16295; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI readmail.cgi access"; flow:to_server,established; content:"/readmail.cgi"; fast_pattern; http_uri; reference:bugtraq,3427; reference:bugtraq,4579; reference:cve,2001-1283; reference:nessus,11748; classtype:web-application-activity; sid:2216; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX QC.MessageMover.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"ECABB0BF-7F19-11D2-978E-0000F8757E2A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*ECABB0BF-7F19-11D2-978E-0000F8757E2A/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8033; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox ConstructFrame with floating first-letter memory corruption attempt"; flow:to_client,established; content:"first-letter"; content:"float: right"; distance:0; content:"parentNode.removeAttribute(|22|class|22|)"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,35765; reference:cve,2009-2462; classtype:attempted-user; sid:17642; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Voice Control ActiveX clsid access"; flow:established,to_client; file_data; content:"EEE78591-FE22-11D0-8BEF-0060081841DE"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*EEE78591-FE22-11D0-8BEF-0060081841DE\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Find)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*EEE78591-FE22-11D0-8BEF-0060081841DE\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Find))\s*\(/Osi"; reference:cve,2007-2222; reference:url,www.microsoft.com/technet/security/bulletin/ms07-034.mspx; classtype:attempted-user; sid:11826; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MS Agent File Provider ActiveX clsid access"; flow:established,to_client; file_data; content:"D45FD300-5C6E-11D1-9EC1-00C04FD7081F"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D45FD300-5C6E-11D1-9EC1-00C04FD7081F\s*}?\s*(?P=q6)(\s|>).*(?P=id1)\s*\.\s*(Characters.Load)|<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D45FD300-5C6E-11D1-9EC1-00C04FD7081F\s*}?\s*(?P=q7)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\.(Characters.Load))\s*\(/Osi"; reference:bugtraq,25566; reference:cve,2007-3040; reference:url,www.microsoft.com/technet/security/bulletin/ms07-051.mspx; classtype:attempted-user; sid:12452; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView NNM ovwebsnmpsrv.exe command line argument buffer overflow attempt"; flow:to_server,established; content:"/OvCgi/jovgraph.exe"; http_uri; content:"arg="; distance:0; isdataat:1024,relative; content:!"|0D|"; within:1024; reference:bugtraq,40873; reference:bugtraq,45762; reference:cve,2010-1964; reference:cve,2011-0261; classtype:attempted-user; sid:18998; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows 7 Home peerdist.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|peerdist.dll"; http_uri; reference:cve,2010-3966; reference:url,www.microsoft.com/technet/security/bulletin/MS10-095.mspx; classtype:attempted-user; sid:18208; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.MMSpecialEffect1Input ActiveX function call access"; flow:established,to_client; file_data; content:"DXImageTransform.Microsoft.MMSpecialEffect1Input"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DXImageTransform.Microsoft.MMSpecialEffect1Input\x22|\x27DXImageTransform.Microsoft.MMSpecialEffect1Input\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DXImageTransform.Microsoft.MMSpecialEffect1Input\x22|\x27DXImageTransform.Microsoft.MMSpecialEffect1Input\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-021.mspx; classtype:attempted-user; sid:6687; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI websendmail access"; flow:to_server,established; content:"/websendmail"; fast_pattern; http_uri; reference:arachnids,469; reference:bugtraq,2077; reference:cve,1999-0196; reference:nessus,10301; classtype:attempted-recon; sid:815; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMClientVMs Class ActiveX clsid access"; flow:established,to_client; file_data; content:"315cb05d-691f-4208-af14-0fa2fbb2cad6"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*315cb05d-691f-4208-af14-0fa2fbb2cad6\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14334; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FeedDemon OPML file handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|3C|opml"; content:"|3C|outline"; distance:0; pcre:"/[^\x3E]*?text\s*\x3D\s*(\x27[^\x27]{500}|\x22[^\x22]{500}|\S{500})/iR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33630; reference:cve,2009-0546; classtype:attempted-user; sid:17104; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI emumail.cgi NULL attempt"; flow:to_server,established; content:"/emumail.cgi"; http_uri; content:"type="; content:"%00"; reference:bugtraq,5824; reference:cve,2002-1526; classtype:web-application-activity; sid:1723; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8028 (msg:"WEB-MISC novell edirectory imonitor overflow attempt"; flow:to_server,established; content:"/nds"; http_uri; pcre:"/\x2fnds[^\r\n]{1000}/Usmi"; reference:bugtraq,18026; reference:cve,2006-2496; classtype:attempted-admin; sid:6507; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION sourcewindow.cfm access"; flow:to_server,established; content:"/cfdocs/exampleapp/docs/sourcewindow.cfm"; fast_pattern; http_uri; reference:bugtraq,3154; reference:bugtraq,550; reference:cve,1999-0760; reference:cve,1999-0922; classtype:attempted-recon; sid:8493; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Panda ActiveScan PAVPZ.SOS.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"DA2BD42B-07E8-413A-9FEA-BB3B2E825340"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*id\s*=((\x22|\x27)([^\2]*)\2)\s*classid\s*=\s*(\x22|\x27|)clsid\s*\x3a\s*{?\s*DA2BD42B-07E8-413A-9FEA-BB3B2E825340\s*}?\4.*\3\.(ObtenerTamano)\(|<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DA2BD42B-07E8-413A-9FEA-BB3B2E825340\s*}?\s*\6\s*id\s*=\s*((\x22|\x27)([^\8]*)\8).*\9\.(ObtenerTamano)\(/si"; metadata:policy security-ips drop; reference:bugtraq,21132; reference:cve,2006-5966; classtype:attempted-user; sid:9798; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Ecommerce import.txt access"; flow:to_server,established; content:"/config/import.txt"; http_uri; classtype:attempted-recon; sid:1146; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Move Networks Media Player ActiveX clsid access"; flow:established,to_client; file_data; content:"6054D082-355D-4B47-B77C-36A778899F48"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6054D082-355D-4B47-B77C-36A778899F48\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Upgrade)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6054D082-355D-4B47-B77C-36A778899F48\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Upgrade))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,27438; classtype:attempted-user; sid:13348; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealPlayer RMOC3260.DLL Vulnerble Property ActiveX function call access"; flow:established,to_client; file_data; content:"rmocx.RealPlayer G2 Control"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22rmocx\.RealPlayer\s*G2\s*Control\x22|\x27rmocx\.RealPlayer\s*G2\s*Control\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*Console\s*|.*(?P=v)\s*\.\s*Console\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22rmocx\.RealPlayer\s*G2\s*Control\x22|\x27rmocx\.RealPlayer\s*G2\s*Control\x27)\s*\)(\s*\.\s*Console\s*|.*(?P=n)\s*\.\s*Console)\s*=/smi"; metadata:policy security-ips alert; reference:bugtraq,28157; reference:cve,2008-1309; classtype:attempted-user; sid:13609; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare VMCtl Class ActiveX function call access"; flow:established,to_client; file_data; content:"VmCOM.VmCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22VmCOM\.VmCtl\x22|\x27VmCOM\.VmCtl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*GuestInfo\s*|.*(?P=v)\s*\.\s*GuestInfo\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22VmCOM\.VmCtl\x22|\x27VmCOM\.VmCtl\x27)\s*\)(\s*\.\s*GuestInfo\s*|.*(?P=n)\s*\.\s*GuestInfo\s*)\s*\(/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3892; classtype:attempted-user; sid:14613; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader CCITT stream compression filter invalid image size heap overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|2F|CCF"; content:"|2F|Columns"; within:500; byte_test:10,>,65535,0,relative,string; pcre:"/\x2FCCF[^\x3E]*\x2fColumns\s+\d{5}/i"; reference:cve,2011-0567; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18506; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Plugin for Non-IE browsers buffer overflow attempt"; flow:to_client,established; file_data; content:"<EMBED"; content:"src"; distance:0; pcre:"/<EMBED[^>]+?src\s*=\s*(\x22[^\x22]{1024}|\x27[^\x27]{1024}|[^\s]{1024})/i"; metadata:policy security-ips drop; reference:bugtraq,16644; reference:cve,2006-0005; reference:url,www.microsoft.com/technet/security/bulletin/ms06-006.mspx; classtype:attempted-user; sid:5710; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox SVG data processing memory corruption attempt"; flow:to_client,established; flowbits:isset,svg_file.request; content:"getElementsByTagName"; content:"pathSegList"; content:"createSVGPathSegMoveto"; fast_pattern; content:"appendItem"; distance:1; content:"replaceItem"; distance:1; pcre:"/(?P<N1>[a-zA-Z\x5f][a-zA-Z\x5f0-9]*\x2e)appendItem(?!.+?(?P=N1)appendItem).+?(?P=N1)replaceItem/s"; metadata:policy security-ips drop; reference:bugtraq,33990; reference:cve,2009-0771; reference:url,www.mozilla.org/security/announce/2009/mfsa2009-07.html; classtype:attempted-user; sid:15428; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI AHG search.cgi access"; flow:to_server,established; content:"/publisher/search.cgi"; fast_pattern; http_uri; content:"template="; reference:bugtraq,3985; classtype:web-application-activity; sid:1405; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java HsbParser.getSoundBank stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,java_class_file.request; file_data; content:"|01 00 2C 28|Ljava|2F|net|2F|URL|3B 29|Ljavax|2F|sound|2F|midi|2F|Soundbank"; content:"|01 00 0C|getSoundbank"; content:"file|3A 2F 2F|"; byte_test:2,>,312,-9,relative,big; content:"|01|"; within:1; distance:-10; pcre:"/^.{2}file|3A 2F 2F|[\x21-\x7E]{305}/R"; reference:bugtraq,36881; reference:cve,2009-3867; classtype:attempted-user; sid:17776; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP Data Protector GetPolicies SQL Injection attempt"; flow:to_server,established; content:"POST"; http_method; content:"/dpnepolicyservice/DPNECentral.asmx"; http_uri; content:"GetPolicies"; http_client_body; content:"clientVersion"; distance:0; http_client_body; content:"|3B|"; distance:0; http_client_body; content:"/clientVersion"; distance:0; http_client_body; reference:cve,2011-3157; reference:url,h20565.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03058866&ac.admitted=1321285525395.876444892.492883150; reference:url,osvdb.org/show/osvdb/76702; classtype:attempted-user; sid:20635; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash regular expression grouping depth buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"RegExp"; content:"|28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28|"; within:50; metadata:policy security-ips drop; reference:cve,2011-2134; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19685; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX eCentrex VOIP Client Module ActiveX clsid access"; flow:established,to_client; file_data; content:"BD80D375-5439-4D80-B128-DDA5FDC3AE6C"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BD80D375-5439-4D80-B128-DDA5FDC3AE6C\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(ReInit)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BD80D375-5439-4D80-B128-DDA5FDC3AE6C\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(ReInit))\s*\(/si"; reference:bugtraq,25383; reference:cve,2007-4489; reference:url,www.e800phone.com; classtype:attempted-user; sid:12301; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC webhits.exe access"; flow:to_server,established; content:"/scripts/samples/search/webhits.exe"; http_uri; reference:bugtraq,950; reference:cve,2000-0097; classtype:web-application-activity; sid:1073; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI rpc-nlog.pl access"; flow:to_server,established; content:"/rpc-nlog.pl"; http_uri; reference:cve,1999-1278; reference:url,marc.theaimsgroup.com/?l=bugtraq&m=91470326629357&w=2; reference:url,marc.theaimsgroup.com/?l=bugtraq&m=91471400632145&w=2; classtype:web-application-activity; sid:1931; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAUserData ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAUserData"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAUserData\x22|\x27DirectAnimation.DAUserData\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAUserData\x22|\x27DirectAnimation.DAUserData\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; classtype:attempted-user; sid:7008; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Vantage Linguistics 3 ActiveX clsid access"; flow:established,to_client; file_data; content:"66b4546f-c263-11d1-b1c9-444553540000"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q5>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*66b4546f-c263-11d1-b1c9-444553540000\s*}?\s*(?P=q5)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/bulletin/MS07-069.mspx; reference:url,www.vantagelinguistics.com/answerworks/release/; classtype:attempted-user; sid:12952; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC post32.exe arbitrary command attempt"; flow:to_server,established; content:"/post32.exe|7C|"; http_uri; reference:bugtraq,1485; classtype:web-application-attack; sid:2070; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP Openview OvWebHelp.exe buffer overflow"; flow:to_server, established; content:"Topic="; isdataat:500,relative; pcre:"/^[^&\x3b]{500}/Ri"; metadata:policy security-ips drop; reference:bugtraq,37261; reference:bugtraq,37340; reference:cve,2009-4178; reference:url,h2000.ww2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c01950877; classtype:attempted-admin; sid:18475; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime Movie link scripting security bypass attempt"; flow:to_client,established; content:"<?xml version"; content:"<?quicktime type=|22|application/x-quicktime-media-link"; distance:0; pcre:"/<embed[^>]*javascript/smi"; metadata:policy security-ips drop; reference:bugtraq,20138; reference:cve,2006-4965; classtype:attempted-user; sid:9429; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI imageFolio.cgi access"; flow:to_server,established; content:"/imageFolio.cgi"; fast_pattern; http_uri; reference:bugtraq,4579; reference:bugtraq,6265; reference:cve,2002-1334; reference:nessus,11748; classtype:web-application-activity; sid:2212; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file tSAC record exploit attempt"; flow:to_client,established; content:"tSAC|B7 00 00 00 00 00 00 01 00 00 00 8F|"; content:"|00 00 00 00 00 00 00 00 00 06 00 00 00 45 00 00|"; within:16; distance:28; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17184; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE register.txt access"; flow:to_server,established; content:"/_private/register.txt"; fast_pattern; http_uri; classtype:web-application-activity; sid:956; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Database Tools Query Designer v7.0 ActiveX object access"; flow:established,to_client; file_data; content:"2C10A98F-D64F-43B4-BED6-DD0E1BF2074C"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*2C10A98F-D64F-43B4-BED6-DD0E1BF2074C/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4233; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AXIS Camera ActiveX function call access"; flow:established,to_client; file_data; content:"CamImage.CamImage"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22CamImage\.CamImage(\.\d)?\x22|\x27CamImage\.CamImage(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*image_pan_tilt\s*|.*(?P=v)\s*\.\s*image_pan_tilt\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22CamImage\.CamImage(\.\d)?\x22|\x27CamImage\.CamImage(\.\d)?\x27)\s*\)(\s*\.\s*image_pan_tilt\s*|.*(?P=n)\s*\.\s*image_pan_tilt)\s*=/smiO"; metadata:policy security-ips drop; reference:bugtraq,33408; reference:cve,2008-5260; classtype:attempted-user; sid:15245; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime streaming debug error logging buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.smil; file_data; content:"<smil"; fast_pattern:only; content:"src"; distance:0; isdataat:449,relative; pcre:"/^\s*\=\s*(?![\x22\x27]?http(|s|1|s1)\x3a\x2f{2})(\x22[^\x22]{449}|\x27[^\x27]{449}|\S{449})/iR"; reference:bugtraq,41962; reference:cve,2010-1799; classtype:attempted-user; sid:18928; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS IISProtect globaladmin.asp access"; flow:to_server,established; content:"/iisprotect/admin/GlobalAdmin.asp"; fast_pattern; http_uri; reference:nessus,11661; classtype:web-application-activity; sid:2157; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Nwz Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmhwcfg.Nwz"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmhwcfg\.Nwz\x22|\x27vmhwcfg\.Nwz\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmhwcfg\.Nwz\x22|\x27vmhwcfg\.Nwz\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14550; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC basilix mysql.class access"; flow:to_server,established; content:"/class/mysql.class"; http_uri; reference:bugtraq,2198; reference:cve,2001-1044; reference:nessus,10601; classtype:web-application-activity; sid:1527; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer DXLUTBuilder ActiveX function call unicode access"; flow:to_client,established; content:"D|00|X|00|T|00|r|00|a|00|n|00|s|00|f|00|o|00|r|00|m|00|.|00|M|00|i|00|c|00|r|00|o|00|s|00|o|00|f|00|t|00|.|00|D|00|X|00|L|00|U|00|T|00|B|00|u|00|i|00|l|00|d|00|e|00|r|00|"; pcre:"/(?P<c>\w+)(\s\x00)*=(\s\x00)*(?P<q3>\x22|\x27|)D\x00X\x00T\x00r\x00a\x00n\x00s\x00f\x00o\x00r\x00m\x00.\x00M\x00i\x00c\x00r\x00o\x00s\x00o\x00f\x00t\x00.\x00D\x00X\x00L\x00U\x00T\x00B\x00u\x00i\x00l\x00d\x00e\x00r\x00(?P=q3)(\s|>)(\s\x00)*\x3b\x00.*(?P<v>(\w\x00)+)(\s\x00)*1\(\x00(\s\x00)*(?P=c)(\s\x00)*\)\x00|(?P<n>\w+)(\s\x00)*1\(\x00(\s\x00)*(?P<q4>\x22|\x27|)D\x00X\x00T\x00r\x00a\x00n\x00s\x00f\x00o\x00r\x00m\x00.\x00M\x00i\x00c\x00r\x00o\x00s\x00o\x00f\x00t\x00.\x00D\x00X\x00L\x00U\x00T\x00B\x00u\x00i\x00l\x00d\x00e\x00r\x00(?P=q4)(\s|>)(\s\x00)*\)\x00/smi"; reference:cve,2008-0078; reference:url,www.microsoft.com/technet/security/bulletin/MS08-010.mspx; classtype:attempted-user; sid:13456; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealPlayer RMP Download Handler ActiveX function call access"; flow:established,to_client; file_data; content:"rmocx.RealPlayer RMP Download Handler"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22rmocx\.RealPlayer\s*RMP\s*Download\s*Handler\x22|\x27rmocx\.RealPlayer\s*RMP\s*Download\s*Handler\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(Console|Controls)\s*|.*(?P=v)\s*\.\s*(Console|Controls)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22rmocx\.RealPlayer\s*RMP\s*Download\s*Handler\x22|\x27rmocx\.RealPlayer\s*RMP\s*Download\s*Handler\x27)\s*\)(\s*\.\s*(Console|Controls)\s*|.*(?P=n)\s*\.\s*(Console|Controls))\s*=/smi"; metadata:policy security-ips alert; reference:bugtraq,28157; reference:cve,2008-1309; reference:url,www.kb.cert.org/vuls/id/831457; classtype:attempted-user; sid:14046; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player JPG header record mismatch memory corruption attempt"; flow:to_client,established; flowbits:isset,http.avi; content:"|FF D8|"; content:"|FF C0|"; within:200; content:"|FF DA|"; within:500; pcre:"/\xFF\xD8.{0,198}\xFF\xC0.{7}(?P<cnt>.).{0,490}\xFF\xDA.{2}(?!(?P=cnt))/s"; metadata:policy security-ips drop; reference:bugtraq,40464; reference:cve,2010-1880; reference:url,www.microsoft.com/technet/security/bulletin/MS10-033.mspx; classtype:attempted-user; sid:19143; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Media Player ASX file ref href buffer overflow attempt"; flow:to_client,established; file_data; content:"<ref"; content:"href"; distance:0; pcre:"/<ref\s+href\s*=\s*\x22([^\x22]{2}|(\x25[0-9A-Z]{2}){1,2})\x3A\x2F[^\x22]{100}/smi"; metadata:policy security-ips drop; reference:bugtraq,21247; reference:cve,2006-6134; reference:url,www.microsoft.com/technet/security/bulletin/ms06-078.mspx; classtype:attempted-user; sid:9625; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX ADODB.Stream ActiveX function call access"; flow:established,to_client; file_data; content:"ADODB.Stream"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22ADODB.Stream\x22|\x27ADODB.Stream\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22ADODB.Stream\x22|\x27ADODB.Stream\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,10514; reference:cve,2004-0549; reference:url,support.microsoft.com/default.aspx?kbid=870669; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;KB870669; reference:url,www.microsoft.com/technet/security/bulletin/ms04-025.mspx; classtype:attempted-user; sid:8063; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX syncui.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"85BBD920-42A0-1069-A2E4-08002B30309D"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*85BBD920-42A0-1069-A2E4-08002B30309D/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8039; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3128 (msg:"WEB-MISC Squid authentication headers handling denial of service attempt"; flow:to_server,established; content:"Proxy-Authorization: NTLM"; flowbits:set,ntlm_authentication; flowbits:noalert; reference:bugtraq,14977; reference:cve,2005-2917; classtype:protocol-command-decode; sid:17370; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Learn2 STRunner ActiveX function call access"; flow:established,to_client; file_data; content:"STRunner.Popup1"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22STRunner\.Popup1\x22|\x27STRunner\.Popup1\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22STRunner\.Popup1\x22|\x27STRunner\.Popup1\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,28058; classtype:attempted-user; sid:13545; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Internet Explorer Blnmgrps.dll ActiveX object access"; flow:established,to_client; file_data; content:"BC5F1E51-5110-11D1-AFF5-006097C9A284"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*BC5F1E51-5110-11D1-AFF5-006097C9A284/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4198; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI shopping cart directory traversal"; flow:to_server,established; content:"/shop.cgi"; http_uri; content:"page=../"; reference:bugtraq,1777; reference:cve,2000-0921; classtype:web-application-attack; sid:1089; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; content:"<"; content:"onmousedown"; within:24; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^(\n|\s|>)]|\(|\))*\s*){21}/Rmi"; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17516; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Kingsoft Antivirus Online Update Module ActiveX function call access"; flow:established,to_client; file_data; content:"UpdateOcx2.KUpdateObj2"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22UpdateOcx2\.KUpdateObj2\x22|\x27UpdateOcx2\.KUpdateObj2\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SetUninstallName\s*|.*(?P=v)\s*\.\s*SetUninstallName\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22UpdateOcx2\.KUpdateObj2\x22|\x27UpdateOcx2\.KUpdateObj2\x27)\s*\)(\s*\.\s*SetUninstallName\s*|.*(?P=n)\s*\.\s*SetUninstallName\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,28172; reference:cve,2008-1307; classtype:attempted-user; sid:13601; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX vmappPropObj2 Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmappsdk.VmappPropObj2"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmappsdk\.VmappPropObj2\x22|\x27vmappsdk\.VmappPropObj2\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmappsdk\.VmappPropObj2\x22|\x27vmappsdk\.VmappPropObj2\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14372; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare VMCtl Class ActiveX clsid access"; flow:established,to_client; file_data; content:"38DB77F9-058D-4955-98AA-4A9F3B6A5B06"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*38DB77F9-058D-4955-98AA-4A9F3B6A5B06\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(GuestInfo)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|\x26\x23039\x3b|)\s*clsid\s*\x3a\s*{?\s*38DB77F9-058D-4955-98AA-4A9F3B6A5B06\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|\x26\x23039\x3b|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(GuestInfo))\s*\(/Osi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30934; reference:cve,2008-3892; classtype:attempted-user; sid:14611; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC mlog.phtml access"; flow:to_server,established; content:"/mlog.phtml"; http_uri; reference:bugtraq,713; reference:cve,1999-0068; reference:cve,1999-0346; classtype:attempted-recon; sid:1119; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX NCTAudioStudio2 NCT WavChunksEditor ActiveX clsid access"; flow:established,to_client; file_data; content:"A77849B6-6125-4466-88DC-4855C014A0C4"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A77849B6-6125-4466-88DC-4855C014A0C4\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(CreateFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A77849B6-6125-4466-88DC-4855C014A0C4\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(CreateFile))\s*\(/si"; reference:bugtraq,24656; reference:url,nctsoft.com/products/NCTAudioStudio2/; classtype:attempted-user; sid:12015; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java Runtime AWT setDiffICM stack buffer overflow attempt"; flow:to_client,established; file_data; content:"AppletX"; fast_pattern:only; pcre:"/\x3C\s*applet[^\x3E\n$]*code\s*=\s*[\x27\x22]AppletX[\x22\x27][^\x3E\n$]*archive\s*=\s*[\x22\x27][^\s\x3E\n$]{32}\x2Ejar[\x22\x27]/Ri"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36881; reference:cve,2009-3869; classtype:attempted-user; sid:19926; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Juniper Networks SSL-VPN Client JuniperSetup ActiveX control buffer overflow attempt"; flow:to_client,established; file_data; content:"E5F5D008-DD2C-4D32-977D-1A0ADF03058B"; content:"ProductName"; pcre:"/\<param\s*[^\>]*?name\s*=\s*(?P<q>\x22|\x27|)?ProductName(?P=q)[^\>]+?value\s*=\s*(\x22[^\x22]{500}|\x27[^\x27]{500}|[^\s\>]{500})/i"; metadata:policy security-ips drop; reference:bugtraq,17712; reference:cve,2006-2086; classtype:attempted-user; sid:16687; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MSN Heartbeat ActiveX clsid access"; flow:established,to_client; file_data; content:"E5D419D6-A846-4514-9FAD-97E826C84822"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E5D419D6-A846-4514-9FAD-97E826C84822\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy connectivity-ips drop, policy security-ips drop; reference:bugtraq,11367; reference:url,www.microsoft.com/technet/security/bulletin/MS04-038.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS07-069.mspx; classtype:attempted-user; sid:4167; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Kaspersky Online Scanner KAVWebScan.dll ActiveX function call access"; flow:established,to_client; file_data; content:"kavwebscan.CKAVWebScan"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22kavwebscan\.CKAVWebScan\x22|\x27kavwebscan\.CKAVWebScan\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22kavwebscan\.CKAVWebScan\x22|\x27kavwebscan\.CKAVWebScan\x27)\s*\)/smi"; reference:bugtraq,26004; reference:cve,2007-3675; classtype:attempted-user; sid:12639; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file LsCM overflow attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"LsCM"; byte_test:4,>,4211081214,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2864; classtype:attempted-user; sid:17200; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX GeoVision LiveX 7000 ActiveX function call access"; flow:established,to_client; file_data; content:"LiveX_v7000"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22LiveX_v7000(\.\d)?\x22|\x27LiveX_v7000(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SnapShotToFile\s*|.*(?P=v)\s*\.\s*SnapShotToFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22LiveX_v7000(\.\d)?\x22|\x27LiveX_v7000(\.\d)?\x27)\s*\)(\s*\.\s*SnapShotToFile\s*|.*(?P=n)\s*\.\s*SnapShotToFile\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:bugtraq,33782; classtype:attempted-user; sid:15336; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AOL.MemExpWz ActiveX clsid access"; flow:established,to_client; file_data; content:"18477169-4752-41DC-AB0F-C50EBA75641D"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*18477169-4752-41DC-AB0F-C50EBA75641D/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:7890; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS tag memory corruption attempt"; flow:to_client,established; content:"style"; content:"csstext"; distance:0; pcre:"/\x3c[^\x3e]*style\s*=[^\x3e]*?csstext\x3a/smi"; reference:bugtraq,24423; reference:cve,2007-1750; reference:url,www.microsoft.com/technet/security/bulletin/MS07-033.mspx; classtype:attempted-user; sid:11966; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI db4web_c directory traversal attempt"; flow:to_server,established; content:"/db4web_c"; fast_pattern; http_uri; pcre:"/db4web_c(\.exe)?\/.*(\.\.[\\|\/]|[a-z]\:)/smiU"; reference:bugtraq,5723; reference:cve,2002-1483; reference:nessus,11182; classtype:web-application-attack; sid:3674; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows URI External handler arbitrary command attempt"; flow:to_client,established; content:"%00%00"; pcre:"/(mailto|telnet|news|nntp|snews)\x3A%00%00/i"; reference:cve,2007-3896; reference:url,www.microsoft.com/technet/security/bulletin/ms07-061.mspx; classtype:attempted-user; sid:12643; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 4 ActiveX clsid access"; flow:established,to_client; file_data; content:"0369B4E6-45B6-11D3-B650-00C04F79498E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q67>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0369B4E6-45B6-11D3-B650-00C04F79498E\s*}?\s*(?P=q67)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15654; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation ActiveX object access"; flow:established,to_client; file_data; content:"283807B8-2C60-11D0-A31D-00AA00B92C03"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*283807B8-2C60-11D0-A31D-00AA00B92C03/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4202; rev:8;)
