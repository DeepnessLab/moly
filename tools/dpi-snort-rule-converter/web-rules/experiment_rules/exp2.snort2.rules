alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CStyleSheetRule array memory corruption attempt"; flow:to_client,established; content:"document.styleSheets"; fast_pattern; content:"removeRule"; within:200; metadata:policy security-ips drop; reference:bugtraq,43705; reference:cve,2010-3328; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:19436; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT GStreamer QuickTime file parsing multiple heap overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"stss"; content:"|00 00 00 00 00 00 00 03 00 00 00 01 00 FF FF FF|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33405; reference:cve,2009-0398; classtype:attempted-user; sid:17611; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI awstats.pl configdir command execution attempt"; flow:to_server,established; content:"/awstats.pl?"; fast_pattern; http_uri; content:"configdir="; http_uri; pcre:"/awstats.pl?[^\r\n]*configdir=\x7C/Ui"; reference:bugtraq,12298; reference:cve,2005-0116; reference:nessus,16189; classtype:attempted-user; sid:3813; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape PublishingXpert access"; flow:to_server,established; content:"/PSUser/PSCOErrPage.htm"; http_uri; reference:cve,2000-1196; reference:nessus,10364; classtype:web-application-activity; sid:1157; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RemoteBrowseDlg Class ActiveX clsid access"; flow:established,to_client; file_data; content:"6b681417-abe9-46ca-9615-8b96ec724d0c"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6b681417-abe9-46ca-9615-8b96ec724d0c\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14402; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS viewcode access"; flow:to_server,established; content:"/Sites/Knowledge/Membership/Inspiredtutorial/ViewCode.asp"; fast_pattern; http_uri; reference:cve,1999-0737; reference:nessus,10576; reference:url,www.microsoft.com/technet/security/bulletin/ms99-013.mspx; classtype:web-application-activity; sid:1033; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows DirectShow QuickTime file stsc atom parsing heap corruption attempt"; flow:to_client,established; content:"stbl"; content:"stsd"; within:4; distance:4; content:"ima4"; distance:8; content:"stsc"; distance:0; byte_jump:4,4,relative,multiplier 12,big; isdataat:7,relative; content:!"stsz"; within:4; distance:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1538; reference:url,www.microsoft.com/technet/security/bulletin/MS09-028.mspx; classtype:attempted-user; sid:15682; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS iisadmin access"; flow:to_server,established; content:"/iisadmin"; fast_pattern; http_uri; reference:bugtraq,189; reference:cve,1999-1538; reference:nessus,11032; classtype:web-application-attack; sid:993; rev:18;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat/Reader JpxDecode invalid crgn memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"jp2c|FF 4F|"; content:"|FF 5E 00|"; distance:0; pcre:"/\xff\x5e\x00(\x05[\x80-\xff]|\x06\x00[\x80-\xff]|\x06[^\x00])/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37757; reference:cve,2009-3955; classtype:attempted-user; sid:18801; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel object record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|5D 00|"; byte_test:2,>,8224,0,relative,little; content:"|15 00 12 00|"; within:4; distance:2; metadata:policy security-ips drop; reference:bugtraq,18886; reference:cve,2006-1306; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7048; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape Enterprise Server directory view"; flow:to_server,established; content:"?wp-uncheckout"; http_uri; reference:bugtraq,1063; reference:cve,2000-0236; classtype:attempted-recon; sid:1190; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime Movie link file URI security bypass attempt"; flow:to_client,established; content:"<?xml version"; content:"<?quicktime type=|22|application/x-quicktime-media-link"; distance:0; content:"qtnext=|22|"; distance:0; pcre:"/qtnext=\x22((-e\s+|-chrome\s+)?(file|javascript))/smi"; metadata:policy security-ips drop; reference:bugtraq,20138; reference:cve,2006-4965; classtype:attempted-user; sid:9430; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Windows Media Services DRM Storage ActiveX clsid access"; flow:established,to_client; file_data; content:"760C4B83-E211-11D2-BF3E-00805FBE84A6"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*760C4B83-E211-11D2-BF3E-00805FBE84A6/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:8401; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime FlashPix Movie file integer overflow attempt"; flow:to_client,established; content:"|00 01 00 54 C1 CE 11 85 53 00 AA 00 A1 F9 5B 01 00 00 00|"; byte_test:4,>,0x0FFFFFFF,12,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39020; reference:cve,2010-0519; classtype:attempted-user; sid:18510; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-MISC potential malware - download of svchost.exe"; flow:established,to_server; content:"/svchost.exe"; http_uri; metadata:policy security-ips drop; classtype:suspicious-filename-detect; sid:17811; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Possible generic javascript heap spray attempt"; flow:to_client,established; content:"%u9090%u9090"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,35660; classtype:attempted-user; sid:18167; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sophos Anti-Virus CAB file overflow attempt"; flow:to_client,established; file_data; content:"MSCF"; byte_test:2,>,8192,22,little,relative; metadata:policy security-ips drop; reference:bugtraq,17876; reference:cve,2006-0994; classtype:attempted-admin; sid:6504; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer MDAC remote code execution attempt"; flow:to_client,established; file_data; content:"eval|28 22|r|3D|o|22|"; content:"ect|28|n|2C 27 27 29|"; distance:0; pcre:"/bj\x22[\x0D\x0A\s\t]*\x2b[\x0D\x0A\s\t]*\x22ect\x28n\x2C\x27\x27\x29/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-014; classtype:attempted-user; sid:19872; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS sgdynamo.exe access"; flow:to_server,established; content:"/sgdynamo.exe"; fast_pattern; http_uri; reference:bugtraq,4720; reference:cve,2002-0375; reference:nessus,11955; classtype:web-application-activity; sid:2326; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel out-of-bounds structure read memory corruption attempt"; flow:to_client,established; content:"|C6 00 1A 00 02 00 00 00 01 00 21 00 AA 0A 03 00 00 00 02 00|"; reference:cve,2010-2562; reference:url,www.microsoft.com/technet/security/bulletin/ms10-057.mspx; classtype:attempted-user; sid:17134; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel sheet name memory corruption attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"Sheet1"; content:"|8C 00 04 00 56 00 56 00 C1 01 08 00 C1 01 00 00 80 38 01 00|"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24691; reference:cve,2007-3490; classtype:attempted-user; sid:17227; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 38 ActiveX clsid access"; flow:established,to_client; file_data; content:"C5702CCE-9B79-11D3-B654-00C04F79498E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q63>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C5702CCE-9B79-11D3-B654-00C04F79498E\s*}?\s*(?P=q63)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15650; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari invalid FRAME tag remote code execution attempt"; flow:to_client,established; file_data; content:"<frame"; content:"scrolling"; within:100; isdataat:10,relative; content:!"auto"; within:10; content:!"yes"; within:10; content:!"no"; within:10; pcre:"/\x3Cframe([^\x3E]+scrolling\s*\x3D(?!\s*(\x22|\x27)?\s*(yes|no|auto))){2}/i"; reference:bugtraq,17634; reference:cve,2006-1987; classtype:attempted-user; sid:17217; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Webcam Upload ActiveX clsid access"; flow:established,to_client; content:"DCE2F8B1-A520-11D4-8FD0-00D0B7730277"; fast_pattern:only; file_data; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DCE2F8B1-A520-11D4-8FD0-00D0B7730277\s*}?\s*(?P=q6)(\s|>).*(?P=id1)\s*\.\s*(server)|<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*DCE2F8B1-A520-11D4-8FD0-00D0B7730277\s*}?\s*(?P=q7)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\s*\.\s*(server))\s*=/siO"; metadata:policy security-ips drop; reference:bugtraq,24341; reference:cve,2007-3147; classtype:attempted-user; sid:11822; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave Flash memory corruption attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"|FF FF FF FF 01 1F 02|H|00 00 00|6|00 00 FF FF 01 1F 1F EE|"; content:!"|FF FF FF FF|"; within:4; distance:-24; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3463; classtype:attempted-user; sid:16293; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.Sequence ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.Sequence"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.Sequence\x22|\x27DirectAnimation.Sequence\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.Sequence\x22|\x27DirectAnimation.Sequence\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8764; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC intranet access"; flow:to_server,established; content:"/intranet/"; http_uri; reference:nessus,11626; classtype:attempted-recon; sid:1214; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Trident HTMLEditor ActiveX object access"; flow:established,to_client; file_data; content:"3050F4F5-98B5-11CF-BB82-00AA00BDCE0B"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*3050F4F5-98B5-11CF-BB82-00AA00BDCE0B/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4893; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI enter_bug.cgi access"; flow:to_server,established; content:"/enter_bug.cgi"; fast_pattern; http_uri; reference:bugtraq,3272; reference:cve,2002-0008; classtype:web-application-activity; sid:2055; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MSN Setup BBS 4.71.0.10 ActiveX object access"; flow:established,to_client; file_data; content:"8F0F5093-0A70-11D0-BCA9-00C04FD85AA6"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*8F0F5093-0A70-11D0-BCA9-00C04FD85AA6/si"; metadata:policy security-ips drop; reference:bugtraq,668; reference:cve,1999-1484; classtype:attempted-user; sid:4157; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MTSEvents Class ActiveX object access"; flow:established,to_client; file_data; content:"ECABB0AB-7F19-11D2-978E-0000F8757E2A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*ECABB0AB-7F19-11D2-978E-0000F8757E2A/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4892; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CLSID_ApprenticeICW ActiveX clsid access"; flow:established,to_client; file_data; content:"8EE42293-C315-11D0-8D6F-00A0C9A06E1F"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*8EE42293-C315-11D0-8D6F-00A0C9A06E1F/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:7997; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes playlist URL overflow attempt"; flow:to_client,established; file_data; content:"[playlist]"; pcre:"/^File[0-9]+=http\x3a\x2f\x2f[^\n]{150}/Rsmi"; metadata:policy security-ips drop; reference:bugtraq,12238; reference:cve,2005-0043; classtype:attempted-user; sid:3471; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI awstats access"; flow:to_server,established; content:"/awstats.pl"; fast_pattern; http_uri; reference:bugtraq,12572; reference:nessus,16456; classtype:web-application-activity; sid:3463; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ffdshow codec URL parsing buffer overflow attempt"; flow:to_client,established; content:"6BF52A52-394A-11d3-B153-00C04F79FAA6"; fast_pattern:only; content:"<param "; content:"URL"; distance:0; pcre:"/<param\s+name\s*=\s*(?P<q1>\x22|\x27|)URL(?P=q1)[^>]+?value\s*=\s*(\x22|\x27)[^\x22\x27]{500}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32438; reference:cve,2008-5381; classtype:attempted-user; sid:17573; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft XML core services cross-domain information disclosure attempt"; flow:to_client,established; file_data; content:"XMLHttpRequest"; pcre:"/setRequestHeader.*chunked/smiR"; content:"send"; distance:0; content:"0|5C|r|5C|n|5C|r|5C|n"; distance:0; metadata:policy security-ips drop; reference:cve,2008-4033; reference:url,www.microsoft.com/technet/security/bulletin/MS08-069.mspx; classtype:attempted-recon; sid:19818; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Cisco Catalyst command execution attempt"; flow:to_server,established; content:"/exec/show/config/cr"; http_uri; reference:bugtraq,1846; reference:cve,2000-0945; reference:nessus,10545; classtype:web-application-activity; sid:1544; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Content.mbcontent.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"52CA3BCF-3B9B-419E-A3D6-5D28C0B0B50C"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*52CA3BCF-3B9B-419E-A3D6-5D28C0B0B50C/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:8003; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION CFADMIN_REGISTRY_GET access"; flow:to_server,established; content:"CFADMIN_REGISTRY_GET|28 29|"; fast_pattern:only; reference:bugtraq,550; reference:cve,1999-0760; classtype:attempted-user; sid:8488; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF multipacket heap overflow - ANIMEXTS1.0"; flow:to_client,established; flowbits:isset,file.gif; content:"GIF"; content:"!|FF 0B|ANIMEXTS1.0"; distance:0; content:"|02|"; within:1; distance:1; byte_test:4,>,0x7f,3,relative; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:6503; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Music JukeBox MediaGrid ActiveX function call access"; flow:established,to_client; file_data; content:"YMG.YMGMediaGridAx"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22YMG\.YMGMediaGridAx\x22|\x27YMG\.YMGMediaGridAx\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*AddBitmap\s*|.*(?P=v)\s*\.\s*AddBitmap\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22YMG\.YMGMediaGridAx\x22|\x27YMG\.YMGMediaGridAx\x27)\s*\)(\s*\.\s*AddBitmap\s*|.*(?P=n)\s*\.\s*AddBitmap\s*)\s*\(/Osmi"; metadata:policy security-ips alert; reference:bugtraq,27578; classtype:attempted-user; sid:13432; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; content:"<"; content:"onmouseup"; within:22; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^(\n|\s|>)]|\(|\))*\s*){21}/Rmi"; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17514; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MS Access multiple control instantiation memory corruption attempt "; flow:established,to_client; file_data; content:"4D2F086C-6EA3-101B-A18A-00AA00446E07"; content:"53230327-172B-11D0-AD40-00A0C90DC8D9"; distance:0; content:"6BC0989F-0CE6-11D1-BAAE-00C04FC2E20D"; distance:0; metadata:policy security-ips drop; reference:cve,2010-0814; reference:url,www.microsoft.com/technet/security/bulletin/MS10-044.mspx; classtype:attempted-user; sid:17037; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected tRNS overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"tRNS"; byte_test:4,>,3000,-8,relative; reference:bugtraq,13941; reference:bugtraq,18385; reference:cve,2005-1211; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6695; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Exploerer blnmgr clsid attempt"; flow:to_client,established; content:"3F8A6C33-E0FD-11D0-8A8C-00A0C90C2BC5"; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*3F8A6C33-E0FD-11D0-8A8C-00A0C90C2BC5/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-user; sid:4134; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft creator.dll 1 ActiveX clsid access"; flow:established,to_client; file_data; content:"606EF130-9852-11D3-97C6-0060084856D4"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,19636; reference:cve,2006-4495; reference:url,www.xsec.org/index.php?module=Releases&act=view&type=1&id=16; classtype:attempted-user; sid:17594; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Folder GUID Code Execution attempt"; flow:to_client,established; content:".|7B|3050F4D8-98B5-11CF-BB82-00AA00BDCE0B|7D|"; fast_pattern:only; pcre:"/\x252e\x252e\x255c[^\s\x2e]*?\x2e\x7B3050F4D8-98B5-11CF-BB82-00AA00BDCE0B\x7d/smi"; metadata:policy security-ips drop; reference:bugtraq,19389; reference:cve,2006-3281; classtype:attempted-user; sid:17316; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX iseemedia LPViewer ActiveX function call access"; flow:established,to_client; file_data; content:"LPViewer.LPViewer"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22LPViewer\.LPViewer\x22|\x27LPViewer\.LPViewer\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(url|toolbar|enableZoomPastMax)\s*|.*(?P=v)\s*\.\s*(url|toolbar|enableZoomPastMax)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22LPViewer\.LPViewer\x22|\x27LPViewer\.LPViewer\x27)\s*\)(\s*\.\s*(url|toolbar|enableZoomPastMax)\s*|.*(?P=n)\s*\.\s*(url|toolbar|enableZoomPastMax))\s*=/Osmi"; metadata:policy security-ips drop; reference:bugtraq,31604; reference:cve,2008-4384; classtype:attempted-user; sid:14762; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Visio Malformed IconBitsComponent arbitrary code execution attempt"; flow:to_client,established; flowbits:isset,visio.request; content:"|00 00| |00| |FF 00 00 14 01 00 00 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0095; reference:url,www.microsoft.com/technet/security/bulletin/ms09-005.mspx; classtype:attempted-user; sid:15303; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS achg.htr access"; flow:to_server,established; content:"/iisadmpwd/achg.htr"; fast_pattern; http_uri; reference:bugtraq,2110; reference:cve,1999-0407; classtype:web-application-activity; sid:991; rev:16;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 749 (msg:"WEB-MISC MIT Kerberos V% KAdminD klog_vsyslog server overflow attempt"; flow:to_server,established; content:"|90|D|FA A0 B1|^C|07|m'|1C|m|08 02 D0 C7 C0|q|EE|q|E3|R|B3 1C|}K|DE D2 C1 F8 5C|{"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,23285; reference:cve,2007-0957; classtype:attempted-user; sid:16207; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows metafile SetPaletteEntries heap overflow attempt"; flow:to_client,established; flowbits:isset,wmf.download; content:"|00 09 00|"; content:"|FF FF FF|"; distance:12; content:"|00|"; within:1; distance:2; pcre:"/[\x00\x01]\x00\x09\x00.*?\xff\xff\xff[\xff\xf7][\x36\x37]\x00/smi"; reference:bugtraq,15356; reference:cve,2005-2124; reference:url,www.microsoft.com/technet/security/bulletin/ms05-053.mspx; classtype:attempted-user; sid:13807; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX CurrentVMCtl Class ActiveX clsid access"; flow:established,to_client; file_data; content:"fd99f74c-9d06-415e-8c60-a249d16f1d77"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*fd99f74c-9d06-415e-8c60-a249d16f1d77\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14586; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC client negative Content-Length attempt"; flow:to_server,established; content:"Content-Length|3A|"; byte_test:10,>,0x7FFFFFFF,1,relative,string,dec; metadata:policy security-ips drop; reference:bugtraq,16354; reference:bugtraq,17879; reference:bugtraq,9098; reference:bugtraq,9476; reference:bugtraq,9576; reference:cve,2004-0095; reference:cve,2005-3653; reference:cve,2006-2162; classtype:misc-attack; sid:2278; rev:21;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SuperBuddy Class ActiveX clsid access"; flow:established,to_client; file_data; content:"189504B8-50D1-4AA8-B4D6-95C8F58A6414"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*189504B8-50D1-4AA8-B4D6-95C8F58A6414/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:7983; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI store.cgi access"; flow:to_server,established; content:"/store.cgi"; fast_pattern; http_uri; reference:bugtraq,2385; reference:cve,2001-0305; reference:nessus,10639; classtype:web-application-activity; sid:1307; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Vmc2vmx.CoVPCDrive ActiveX clsid access"; flow:established,to_client; file_data; content:"D9902D56-1F2A-47D6-89AA-08F49A40AE8C"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D9902D56-1F2A-47D6-89AA-08F49A40AE8C\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14508; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Shell.Explorer 2 ActiveX clsid access "; flow:established,to_client; file_data; content:"8856F961-340A-11D0-A96B-00C04FD705A2"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8856F961-340A-11D0-A96B-00C04FD705A2\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Navigate|Navigate2)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8856F961-340A-11D0-A96B-00C04FD705A2\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Navigate|Navigate2))/siO"; metadata:policy security-ips drop; reference:bugtraq,11466; reference:cve,2005-0053; reference:cve,2008-4258; reference:url,www.microsoft.com/technet/security/Bulletin/MS05-014.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS04-038.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS08-073.mspx; classtype:attempted-user; sid:15122; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbTreeCtl Class ActiveX clsid access"; flow:established,to_client; file_data; content:"e669547d-ae52-459f-9c07-cc5f17b4b16f"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*e669547d-ae52-459f-9c07-cc5f17b4b16f\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14544; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI quickstore.cgi access"; flow:to_server,established; content:"/quickstore.cgi"; fast_pattern; http_uri; reference:bugtraq,9282; reference:nessus,11975; classtype:web-application-activity; sid:2323; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Kodak Image Editing ActiveX object access"; flow:established,to_client; file_data; content:"6D940285-9F11-11CE-83FD-02608C3EC08A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*6D940285-9F11-11CE-83FD-02608C3EC08A/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/bulletin/MS99-037.mspx; classtype:attempted-user; sid:4186; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE services.cnf access"; flow:to_server,established; content:"/_vti_pvt/services.cnf"; fast_pattern; http_uri; reference:bugtraq,4078; reference:cve,2002-1717; reference:nessus,10575; classtype:web-application-activity; sid:961; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IBM Access Support ActiveX function call access"; flow:established,to_client; file_data; content:"IbmEgath.IbmEgathCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22IbmEgath\.IbmEgathCtl(\.\d)?\x22|\x27IbmEgath\.IbmEgathCtl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*GetXMLValue\s*|.*(?P=v)\s*\.\s*GetXMLValue\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22IbmEgath\.IbmEgathCtl(\.\d)?\x22|\x27IbmEgath\.IbmEgathCtl(\.\d)?\x27)\s*\)(\s*\.\s*GetXMLValue\s*|.*(?P=n)\s*\.\s*GetXMLValue\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,34228; reference:cve,2009-0215; classtype:attempted-user; sid:16748; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Skype Extras Manager ActiveX function call access"; flow:established,to_client; file_data; content:"ezPMUtils.WindowGroup"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ezPMUtils\.WindowGroup(\.\d)?\x22|\x27ezPMUtils\.WindowGroup(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*RegisterWindow\s*|.*(?P=v)\s*\.\s*RegisterWindow\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ezPMUtils\.WindowGroup(\.\d)?\x22|\x27ezPMUtils\.WindowGroup(\.\d)?\x27)\s*\)(\s*\.\s*RegisterWindow\s*|.*(?P=n)\s*\.\s*RegisterWindow)\s*=/smiO"; metadata:policy security-ips drop; reference:bugtraq,36459; reference:cve,2009-4741; classtype:attempted-user; sid:17676; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI AlienForm af.cgi access"; flow:established,to_server; content:"/af.cgi"; http_uri; reference:bugtraq,4983; reference:cve,2002-0934; reference:nessus,11027; classtype:web-application-activity; sid:1825; rev:10;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Microsoft Windows CSRSS double free attempt"; flow:to_client,established; content:"|4A 10 33 C0 8B 4D FC 66 89 41 16 33 D2 8B 45 FC 66 89 50 12 8B 4D FC C7 41 0C 11 14 14 14 6A 1C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1284; reference:url,www.microsoft.com/technet/security/bulletin/MS11-056.mspx; classtype:attempted-user; sid:19463; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX OWC11.DataSourceControl.11 ActiveX function call access"; flow:established,to_client; file_data; content:"OWC11.DataSourceControl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22OWC11\.DataSourceControl(\.\d+)?\x22|\x27OWC11\.DataSourceControl(\.\d+)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22OWC11\.DataSourceControl(\.\d+)?\x22|\x27OWC11\.DataSourceControl(\.\d+)?\x27)\s*\)/smiO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,19069; reference:cve,2006-3729; reference:url,browserfun.blogspot.com/2006/07/mobb-19-datasourcecontrol.html; reference:url,osvdb.org/27111; classtype:attempted-user; sid:9820; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI environ.cgi access"; flow:to_server,established; content:"/environ.cgi"; fast_pattern; http_uri; classtype:attempted-recon; sid:856; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC DirBuster brute forcing tool detected"; flow:established,to_server; content:"User-Agent|3A| DirBuster"; fast_pattern:only; http_header; reference:url,sourceforge.net/projects/dirbuster/; classtype:web-application-attack; sid:19933; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC amazon 1-click cookie theft"; flow:to_server,established; content:"ref%3Cscript%20language%3D%22Javascript"; reference:bugtraq,1194; reference:cve,2000-0439; classtype:web-application-attack; sid:1082; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java Web Start arbitrary command execution attempt"; flow:to_client,established; content:"application/x-java-applet"; content:"-XXaltjvm"; fast_pattern:only; content:"launchjnlp"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16585; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox html tag attributes memory corruption"; flow:to_client,established; content:"var tags = new Array|28 22|audio|22|, |22|a|22|, |22|base|22 29|"; content:"var html = |22|<|22| + tags[i] + |22| |22| + atts[j]"; distance:0; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3765; classtype:attempted-user; sid:17804; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows win32k.sys kernel mode null pointer dereference attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|68 A2 01 00 00 68 FF FF 00 00 FF 15 30|"; fast_pattern; content:"|41 00|"; within:2; distance:1; reference:cve,2011-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS11-077.mspx; classtype:attempted-admin; sid:20261; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Excel Viewer ActiveX clsid access"; flow:established,to_client; file_data; content:"18A295DA-088E-42D1-BE31-5028D7F9B965"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*18A295DA-088E-42D1-BE31-5028D7F9B965\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(DoOleCommand|FTPDownloadFile|FTPUploadFile|HttpUploadFile|HttpDownloadFile|Save|SaveWebFile|OpenWebFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*18A295DA-088E-42D1-BE31-5028D7F9B965\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(DoOleCommand|FTPDownloadFile|FTPUploadFile|HttpUploadFile|HttpDownloadFile|Save|SaveWebFile|OpenWebFile))/siO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,23755; reference:bugtraq,33222; reference:bugtraq,33243; reference:url,moaxb.blogspot.com/2007/05/moaxb-02-excelviewerocx-v-31-multiple.html; classtype:attempted-user; sid:11181; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI NetScreen SA 5000 delhomepage.cgi access"; flow:to_server,established; content:"/delhomepage.cgi"; http_uri; reference:bugtraq,9791; reference:cve,2004-0347; classtype:web-application-activity; sid:3062; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer SWF frame handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|78 00 05 5F 00 00 0F A0 00 00 0C 01 00 43 02 FF FF FF BF 00 39|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30370; reference:cve,2007-5400; classtype:attempted-user; sid:17633; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 15 ActiveX clsid access"; flow:established,to_client; file_data; content:"37B03544-A4C8-11D2-B634-00C04F79498E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q13>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*37B03544-A4C8-11D2-B634-00C04F79498E\s*}?\s*(?P=q13)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15600; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SAP Crystal Reports PrintControl.dll ActiveX function call access"; flow:established,to_client; file_data; content:"CrystalReports12.CrystalPrintControl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22CrystalReports12\.CrystalPrintControl(\.\d)?\x22|\x27CrystalReports12\.CrystalPrintControl(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*ServerResourceVersion\s*|.*(?P=v)\s*\.\s*ServerResourceVersion\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22CrystalReports12\.CrystalPrintControl(\.\d)?\x22|\x27CrystalReports12\.CrystalPrintControl(\.\d)?\x27)\s*\)(\s*\.\s*ServerResourceVersion\s*|.*(?P=n)\s*\.\s*ServerResourceVersion)\s*=/smiO"; metadata:policy security-ips drop; reference:bugtraq,45387; reference:cve,2010-2590; classtype:attempted-user; sid:18975; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Wmm2ae.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"44C79591-D0DE-49C4-BA3C-A45AB7003356"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*44C79591-D0DE-49C4-BA3C-A45AB7003356/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7454; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS MDAC Content-Type overflow attempt"; flow:to_server,established; content:"/msadcs.dll"; http_uri; content:"Content-Type|3A|"; isdataat:50,relative; content:!"|0A|"; within:50; pcre:"/^POST\s/smi"; reference:bugtraq,6214; reference:cve,2002-1142; reference:nessus,11161; reference:url,www.foundstone.com/knowledge/randd-advisories-display.html?id=337; reference:url,www.microsoft.com/technet/security/bulletin/MS02-065.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS98-004.mspx; classtype:web-application-attack; sid:1970; rev:18;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 15 ActiveX clsid access"; flow:established,to_client; file_data; content:"FA8932FF-E064-4378-901C-69CB94E3A20A"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q13>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*FA8932FF-E064-4378-901C-69CB94E3A20A\s*}?\s*(?P=q13)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14116; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Dart Communications PowerTCP FTP ActiveX function call access"; flow:established,to_client; file_data; content:"Dart.Ftp"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Dart\.Ftp\x22|\x27Dart\.Ftp\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SecretKey\s*|.*(?P=v)\s*\.\s*SecretKey\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Dart\.Ftp\x22|\x27Dart\.Ftp\x27)\s*\)(\s*\.\s*SecretKey\s*|.*(?P=n)\s*\.\s*SecretKey)\s*=/Osmi"; metadata:policy security-ips drop; reference:bugtraq,31814; classtype:attempted-user; sid:14780; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI book.cgi arbitrary command execution attempt"; flow:to_server,established; content:"/book.cgi"; fast_pattern; http_uri; content:"current=|7C|"; reference:bugtraq,3178; reference:cve,2001-1114; reference:nessus,10721; classtype:web-application-attack; sid:1879; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Symantec CLIProxy.dll ActiveX function call access"; flow:established,to_client; file_data; content:"cliproxy.objects"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22cliproxy\.objects(\.\d)?\x22|\x27cliproxy\.objects(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SetRemoteComputerName\s*|.*(?P=v)\s*\.\s*SetRemoteComputerName\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22cliproxy\.objects(\.\d)?\x22|\x27cliproxy\.objects(\.\d)?\x27)\s*\)(\s*\.\s*SetRemoteComputerName\s*|.*(?P=n)\s*\.\s*SetRemoteComputerName\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,38222; reference:cve,2010-0108; reference:url,www.symantec.com/business/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=2010&suid=20100217_02; classtype:attempted-user; sid:19103; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX GeoVision LiveX 8120 ActiveX function call access"; flow:established,to_client; file_data; content:"LiveX_v8120"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22LiveX_v8120(\.\d)?\x22|\x27LiveX_v8120(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SnapShotToFile\s*|.*(?P=v)\s*\.\s*SnapShotToFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22LiveX_v8120(\.\d)?\x22|\x27LiveX_v8120(\.\d)?\x27)\s*\)(\s*\.\s*SnapShotToFile\s*|.*(?P=n)\s*\.\s*SnapShotToFile\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:bugtraq,33782; classtype:attempted-user; sid:15340; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC /~ftp access"; flow:to_server,established; content:"/~ftp"; http_uri; classtype:attempted-recon; sid:1662; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS users.xml access"; flow:to_server,established; content:"/users.xml"; fast_pattern; http_uri; classtype:web-application-activity; sid:1750; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java Web Start arbitrary command execution attempt - Internet Explorer"; flow:to_client,established; content:"8AD9C840-044E-11D1-B3E9-00805F499D93"; fast_pattern:only; content:"-XXaltjvm"; content:"launchjnlp"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16584; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AcroPDF.PDF ActiveX clsid access "; flow:established,to_client; file_data; content:"CA8A9780-280D-11CF-A24D-444553540000"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CA8A9780-280D-11CF-A24D-444553540000\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(execCommand)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CA8A9780-280D-11CF-A24D-444553540000\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(execCommand))\s*\(/siO"; reference:cve,2009-2987; classtype:attempted-user; sid:16386; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Eyeball MessengerSDK ActiveX clsid access"; flow:established,to_client; file_data; content:"CA06EE71-7348-44C4-9540-AAF0E6BD1515"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CA06EE71-7348-44C4-9540-AAF0E6BD1515\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(BgColor)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CA06EE71-7348-44C4-9540-AAF0E6BD1515\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(BgColor))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,30424; reference:cve,2008-3430; classtype:attempted-user; sid:14247; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX vmhwcfg.NwzCompleted ActiveX clsid access"; flow:established,to_client; file_data; content:"9F625D90-A74B-4dd8-9847-9CFD6F928FEF"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*9F625D90-A74B-4dd8-9847-9CFD6F928FEF\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14452; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC jigsaw dos attempt"; flow:established,to_server; content:"/servlet/con"; http_uri; pcre:"/\x2Fcon\b/Ui"; reference:bugtraq,5258; reference:cve,2002-1052; reference:nessus,11047; classtype:web-application-attack; sid:1831; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7510 (msg:"WEB-MISC HP OpenView Network Node Manager server name exploit attempt"; flow:to_server,established; content:"/topology/pathView"; http_uri; content:"|02 65 6E 74 00 00 73 71 00 7E 00 00 00 00 00 02|"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,45762; reference:cve,2011-0263; reference:url,h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c02670501; classtype:attempted-admin; sid:18993; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC OpenView Network Node Manager cookie buffer overflow attempt"; flow:to_server,established; content:"/OVCgi/nnmRptConfig.exe"; fast_pattern:only; http_uri; pcre:"/(OvJavaScript|OvTitleFrame|OvHelpWindow|OvMap|OvSession|OvJavaLocale|OvOSLocale|OvLogin|OvDebug|OvDeveloper|OvTreeControl|OvJavaScript|OvProduct|OvPort|OvLocale|OvWebSession)\s*\x3D[^\x3B\x2C]{1024}/iC"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,42154; reference:cve,2010-2709; classtype:attempted-user; sid:18910; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Visual Studio MFC applications mfc42.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc42.dll"; http_uri; reference:cve,2010-3190; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-025.mspx; classtype:attempted-user; sid:18620; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Agent Custom Proxy Class ActiveX clsid access"; flow:established,to_client; file_data; content:"4BAC124B-78C8-11D1-B9A8-00C04FD97575"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4BAC124B-78C8-11D1-B9A8-00C04FD97575\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:cve,2006-3445; reference:cve,2007-1205; reference:url,www.microsoft.com/technet/security/bulletin/MS06-068.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS07-020.mspx; classtype:attempted-user; sid:8850; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC IBM Lotus Domino Web Server Accept-Language header buffer overflow attempt"; flow:to_server,established; content:"Accept-Language|3A|"; isdataat:110,relative; pcre:"/^Accept-Language\x3A[^\n]{110}/smi"; content:".nsf?"; http_uri; reference:bugtraq,29310; reference:cve,2008-2240; classtype:attempted-admin; sid:13819; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT javascript uuencoded eval statement"; flow:to_client,established; content:"unescape"; content:"%u0065"; distance:0; content:"%u0076"; distance:0; content:"%u0061"; distance:0; content:"%u006c"; distance:0; pcre:"/unescape\s*\x28[\x22\x27]\s*\x25u0065\s*\x25u0076\s*\x25u0061\s*\x25u006c/i"; metadata:policy security-ips drop; classtype:misc-activity; sid:19075; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT UltraISO CUE file handling stack buffer overflow attempt"; flow:to_client,established; file_data; content:"FILE |22|"; within:6; isdataat:512,relative; content:!"|22|"; within:512; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24140; reference:cve,2007-2888; classtype:attempted-user; sid:16734; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Apache newline exploit attempt"; flow:to_server,established; content:"|0D 0A 0D 0A|"; pcre:"/(\x0d\x0a){100}/"; reference:bugtraq,7254; reference:cve,2003-0132; classtype:web-application-attack; sid:11272; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 389 (msg:" WEB-MISC OpenLDAP Modrdn utf-8 string code execution attempt"; flow:to_server, established; content:"|30|"; depth:1; content:"|6C|"; within:20; content:"cn="; pcre:"/cn=[^\x00]*\x23[^\x00]*\x01\x01\x00/i"; metadata:policy security-ips drop; reference:bugtraq,41770; reference:cve,2010-0211; classtype:attempted-admin; sid:18804; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [80,8000] (msg:"WEB-MISC IceCast header buffer overflow attempt"; flow:to_server,established; content:"HTTP/1."; pcre:"/HTTP\/1\.[01].*?\n([^\r\n]+?\r?\n){32}/i"; reference:bugtraq,11271; reference:cve,2004-1561; reference:url,archives.neohapsis.com/archives/bugtraq/2004-09/0366.html; classtype:attempted-admin; sid:8701; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Vista feed headlines cross-site scripting attack attempt"; flow:to_client,established; content:"<rss"; content:"<channel"; distance:0; content:"expression|28|"; distance:0; pcre:"/<title>[^>]*?(&lt|<).*?expression\x28.*?<\/title>/i"; metadata:policy security-ips drop; reference:bugtraq,25287; reference:cve,2007-3033; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-048.mspx; classtype:web-application-attack; sid:19174; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint out of bounds value remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; file_data; content:"|C3 0B 08|"; fast_pattern; byte_test:1,<,0x1,7,relative,little; content:"|C3 0B|"; distance:0; metadata:policy security-ips drop; reference:cve,2010-0032; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:19303; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SizerOne ActiveX function call access"; flow:established,to_client; file_data; content:"TabOne.TabOne"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22TabOne\.TabOne(\.\d)?\x22|\x27TabOne\.TabOne(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*AddTab\s*|.*(?P=v)\s*\.\s*AddTab\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22TabOne\.TabOne(\.\d)?\x22|\x27TabOne\.TabOne(\.\d)?\x27)\s*\)(\s*\.\s*AddTab\s*|.*(?P=n)\s*\.\s*AddTab\s*)\s*\(/smiO"; metadata:policy security-ips alert; reference:bugtraq,33148; reference:cve,2008-4827; classtype:attempted-user; sid:15194; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Kaspersky AntiVirus SysInfo ActiveX function call access"; flow:established,to_client; file_data; content:"KL.SysInfo"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22KL\.SysInfo\x22|\x27KL\.SysInfo\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*|.*(?P=v)\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22KL\.SysInfo\x22|\x27KL\.SysInfo\x27)\s*\)(\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*|.*(?P=n)\s*\.\s*(DeleteFile|StartBatchUploading|StartStrBatchUploading|StartUploading)\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,23325; reference:cve,2007-1112; reference:url,www.kaspersky.com/technews?id=203038693; reference:url,www.kaspersky.com/technews?id=203038694; classtype:attempted-user; sid:10429; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS MSProxy access"; flow:to_server,established; content:"/scripts/proxy/w3proxy.dll"; fast_pattern; http_uri; reference:url,support.microsoft.com/?kbid=331066; classtype:web-application-activity; sid:986; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AudioCDRipper ActiveX clsid access"; flow:established,to_client; file_data; content:"BE604333-B029-44E6-8367-1566B0AD7084"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q12>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*BE604333-B029-44E6-8367-1566B0AD7084\s*}?\s*(?P=q12)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,23900; classtype:attempted-user; sid:11284; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX gopher Asychronous Pluggable Protocol Handler ActiveX clsid access"; flow:established,to_client; file_data; content:"79EAC9E4-BAF9-11CE-8C82-00AA004BA90B"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q5>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*79EAC9E4-BAF9-11CE-8C82-00AA004BA90B\s*}?\s*(?P=q5)(\s|>)/si"; metadata:policy security-ips drop; reference:cve,2007-0218; reference:url,www.microsoft.com/technet/security/bulletin/MS07-033.mspx; classtype:attempted-user; sid:7938; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DADashStyle.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BF0-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BF0-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8825; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"WEB-MISC Tomcat UNIX platform directory traversal"; flow:established,to_server; content:"/%2E%2E"; fast_pattern:only; content:"/%2E%2E"; http_raw_uri; pcre:"/\/%2E%2E(\\|%5C)\//"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,22960; reference:cve,2007-0450; reference:url,tomcat.apache.org/tomcat-6.0-doc/changelog.html; classtype:web-application-attack; sid:17501; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Dart Communications PowerTCP FTP ActiveX clsid access"; flow:established,to_client; file_data; content:"39FDA070-61BA-11D2-AD84-00105A17B608"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*39FDA070-61BA-11D2-AD84-00105A17B608\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SecretKey)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*39FDA070-61BA-11D2-AD84-00105A17B608\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(SecretKey))\s*=/Osi"; metadata:policy security-ips drop; reference:bugtraq,31814; classtype:attempted-user; sid:14778; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Adodb.Stream ActiveX object access"; flow:established,to_client; file_data; content:"00000566-0000-0010-8000-00AA006D2EA4"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*00000566-0000-0010-8000-00AA006D2EA4/si"; metadata:policy security-ips drop; reference:bugtraq,10514; reference:cve,2004-0549; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;KB870669; reference:url,www.microsoft.com/technet/security/bulletin/ms04-025.mspx; classtype:attempted-user; sid:4982; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime PICT file overread buffer overflow attempt"; flow:to_client,established; content:"|00 11 02 FF 0C 00 FF|"; byte_jump:2,-17,relative,post_offset -4,big; isdataat:1,relative; content:!"|00 FF|"; within:2; metadata:policy security-ips drop; reference:bugtraq,28583; reference:cve,2008-1019; classtype:attempted-user; sid:18561; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC oracle web arbitrary command execution attempt"; flow:to_server,established; content:"/ows-bin/"; http_uri; content:"?&"; http_uri; reference:bugtraq,1053; reference:cve,2000-0169; reference:nessus,10348; classtype:web-application-attack; sid:1193; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer orphan DOM objects memory corruption attempt"; flow:to_client,established; content:"createElement"; content:"appendChild"; within:50; content:"innerHTML"; within:100; pcre:"/(?P<first>\S+)\x2EappendChild\x28\s*(?P<second>\S+)\s*\x29.*(?P=second)\x2E\S+\s*\x3D\s*(?P=first)\x2E\S+/is"; pcre:"/(\S+)\x2EappendChild[^\x7D]+\1\x2EinnerHTML\s*\x3D\s*\x27{2}/i"; reference:cve,2009-3674; reference:url,www.microsoft.com/technet/security/bulletin/MS09-072.mspx; classtype:attempted-user; sid:16330; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Free Download Manager .torrent parsing announce overflow attempt"; flow:to_client,established; flowbits:isset,http.torrent; file_data; content:"8|3A|announce"; byte_test:6,>,100000,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16518; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LM.LMBehaviorFactory.1 ActiveX function call access"; flow:established,to_client; file_data; content:"LM.LMBehaviorFactory.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22LM.LMBehaviorFactory.1\x22|\x27LM.LMBehaviorFactory.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22LM.LMBehaviorFactory.1\x22|\x27LM.LMBehaviorFactory.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8752; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 29 ActiveX clsid access"; flow:established,to_client; file_data; content:"68BBCA71-E1F6-47B2-87D3-369E1349D990"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q43>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*68BBCA71-E1F6-47B2-87D3-369E1349D990\s*}?\s*(?P=q43)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14144; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC ?PageServices access"; flow:to_server,established; content:"?PageServices"; http_uri; reference:bugtraq,1063; reference:bugtraq,7621; reference:cve,1999-0269; classtype:attempted-recon; sid:1123; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer playlist http URL overflow attempt"; flow:to_client,established; flowbits:isset,realplayer.playlist; content:"http|3A|//"; pcre:"/^http\x3a\x2f\x2f[^\n]{400}/smi"; reference:bugtraq,13264; reference:bugtraq,9579; reference:cve,2004-0258; reference:cve,2005-0755; classtype:attempted-user; sid:2439; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC malformed ipv6 uri overflow attempt"; flow:to_server,established; content:"|3A|/["; http_uri; pcre:"/\x3a\x2f\x5b\s*([\x2F\x3F\x23]*)|([\x2F\x3F\x23]+.+)|(\x3a[^\x3a^\x5d]*)$/U"; reference:bugtraq,11187; reference:cve,2004-0786; classtype:web-application-attack; sid:5715; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player ActionScript 3 integer overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|0A 5C 94 BF 42 D9 62 00 00 F3 45 3D D4 6E C2 7F 22 D1 11 DD B9 EC D8 84 72 2B DD 44 F2 BB 00 05 E6 8A 7B A8 DD 89 DE 4A 86 00 FF 09 10 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2416; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19682; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare IntraProcessLogging ActiveX clsid access"; flow:established,to_client; file_data; content:"AF13B07E-28A1-4CAC-9C9A-EC582E354A24"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*AF13B07E-28A1-4CAC-9C9A-EC582E354A24\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SetLogFileName)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*AF13B07E-28A1-4CAC-9C9A-EC582E354A24\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(SetLogFileName))\s*\(/si"; reference:bugtraq,25110; reference:cve,2007-4059; classtype:attempted-user; sid:12200; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS iisadmpwd attempt"; flow:to_server,established; content:"/iisadmpwd/aexp"; fast_pattern; http_uri; reference:bugtraq,2110; reference:cve,1999-0407; reference:nessus,10371; classtype:web-application-attack; sid:1018; rev:19;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI Poll-it access"; flow:to_server,established; content:"/pollit/Poll_It_SSI_v2.0.cgi"; fast_pattern; http_uri; reference:bugtraq,1431; reference:cve,2000-0590; reference:nessus,10459; classtype:web-application-activity; sid:1106; rev:18;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Trend Micro OfficeScan access"; flow:to_server,established; content:"/officescan/cgi/jdkRqNotify.exe"; http_uri; reference:bugtraq,1057; classtype:attempted-recon; sid:1192; rev:10;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI php.cgi access"; flow:to_server,established; content:"/php.cgi"; fast_pattern; http_uri; reference:arachnids,232; reference:bugtraq,2250; reference:bugtraq,712; reference:cve,1999-0058; reference:cve,1999-0238; reference:nessus,10178; classtype:attempted-recon; sid:824; rev:21;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX iDefense COMRaider ActiveX function call access"; flow:established,to_client; file_data; content:"vbDevKit.CVariantFileSystem"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vbDevKit\.CVariantFileSystem(\.\d)?\x22|\x27vbDevKit\.CVariantFileSystem(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*DeleteFile\s*|.*(?P=v)\s*\.\s*DeleteFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vbDevKit\.CVariantFileSystem(\.\d)?\x22|\x27vbDevKit\.CVariantFileSystem(\.\d)?\x27)\s*\)(\s*\.\s*DeleteFile\s*|.*(?P=n)\s*\.\s*DeleteFile\s*)\s*\(/smiO"; metadata:policy security-ips drop; reference:bugtraq,33867; classtype:attempted-user; sid:15374; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 17 ActiveX clsid access"; flow:established,to_client; file_data; content:"65FB3073-CA8E-42A1-9A9A-2F826D05A843"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q17>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*65FB3073-CA8E-42A1-9A9A-2F826D05A843\s*}?\s*(?P=q17)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14120; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Oracle Document Capture ActiveX clsid access"; flow:established,to_client; file_data; content:"D63891F1-E026-11D3-A6C3-005004055C6C"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D63891F1-E026-11D3-A6C3-005004055C6C\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(WriteJPG)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D63891F1-E026-11D3-A6C3-005004055C6C\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(WriteJPG))/siO"; metadata:policy security-ips drop; reference:bugtraq,45856; reference:cve,2010-3599; classtype:attempted-user; sid:19193; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC encoded cross site scripting attempt"; flow:to_server,established; content:"<SCRIPT"; http_uri; reference:cve,2009-1140; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:web-application-attack; sid:7070; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Xunlei Thunder PPLAYER.DLL ActiveX clsid access"; flow:established,to_client; file_data; content:"F3E70CEA-956E-49CC-B444-73AFE593AD7F"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F3E70CEA-956E-49CC-B444-73AFE593AD7F\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(FlvPlayerUrl)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*F3E70CEA-956E-49CC-B444-73AFE593AD7F\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(FlvPlayerUrl))\s*\(/si"; reference:bugtraq,26536; reference:cve,2007-6144; classtype:attempted-user; sid:12737; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Whale Client Components ActiveX clsid access"; flow:established,to_client; file_data; content:"8D9563A9-8D5F-459B-87F2-BA842255CB9A"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,34532; reference:cve,2007-2238; classtype:attempted-user; sid:18490; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer .hlp samba share download attempt"; flow:to_client,established; file_data; content:"vbscript"; content:".hlp"; content:"|5C|"; pcre:"/\\\\[^\x20\x0a\x0d]*\.hlp/smi"; metadata:policy security-ips drop; reference:cve,2010-0483; classtype:attempted-user; sid:16452; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader media.newPlayer memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/S/JavaScript"; content:"this.media.newPlayer"; pcre:"/^\x5C?\x28null\x5C?\x29/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37331; reference:cve,2009-4324; classtype:attempted-user; sid:16333; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint malformed data record code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|F2 03|"; content:"|AA AA AA 2F 00 C8 0F 0C 00 00 00 30 00 D2 0F 04 00|"; within:17; distance:1; metadata:policy security-ips drop; reference:bugtraq,20322; reference:cve,2006-3876; classtype:attempted-user; sid:17292; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java Virtual Machine malformed GIF buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.gif; content:"GIF"; byte_test:1,!&,128,7,relative; content:","; within:1; distance:10; content:"|00 00|"; within:2; distance:4; metadata:policy security-ips drop; reference:bugtraq,22085; reference:cve,2007-0243; classtype:attempted-user; sid:10062; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel BIFF5 ExternSheet record stack overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|16 00 02 00|"; content:"|17 00|"; within:2; distance:2; byte_test:1,>,250,2,relative; reference:cve,2010-1252; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16656; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX PPStream PPSMediaList ActiveX clsid access"; flow:established,to_client; file_data; content:"D22DE742-04CD-4B5C-A8A3-82AB3DAEC43D"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*D22DE742-04CD-4B5C-A8A3-82AB3DAEC43D\s*}?\s*(?P=q1)(\s|>)/siO"; metadata:policy security-ips drop; reference:bugtraq,36234; classtype:attempted-user; sid:15926; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player SWF scene and label data memory corruption attempt"; flow:to_client,established; content:"|BF 15 84 03 00 00|"; content:"|BF 14|D|02 00 00|"; within:6; distance:900; content:"?|13 1F 00 00 00|"; within:6; distance:640; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28695; reference:bugtraq,29386; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:13821; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Studio 6 PDWizard.ocx ActiveX clsid access"; flow:established,to_client; file_data; content:"0DDF3C0B-E692-11D1-AB06-00AA00BDD685"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0DDF3C0B-E692-11D1-AB06-00AA00BDD685\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(StartProcess)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0DDF3C0B-E692-11D1-AB06-00AA00BDD685\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(StartProcess))/siO"; metadata:policy security-ips drop; reference:bugtraq,25638; reference:cve,2007-4891; classtype:attempted-user; sid:12459; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT mozilla compareTo arbitrary code execution attempt"; flow:to_client,established; file_data; content:"InstallVersion"; content:"compareTo"; distance:0; pcre:"/InstallVersion\s*\x29?\s*\.\s*compareTo/smi"; metadata:policy security-ips drop; reference:bugtraq,14242; reference:cve,2005-2265; reference:url,www.mozilla.org/security/announce/2005/mfsa2005-50.html; classtype:attempted-user; sid:10131; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-FRONTPAGE frontpage server extension long host string overflow attempt"; flow:to_server,established; content:"fp30reg.dll"; fast_pattern; http_uri; content:"Host|3A|"; isdataat:300,relative; pcre:"/^Host\x3A\s[^\r\n]{300}/smi"; reference:bugtraq,9008; reference:cve,2003-0822; reference:cve,2003-0824; reference:url,www.microsoft.com/technet/security/Bulletin/MS03-051.mspx; classtype:attempted-admin; sid:6410; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE writeto.cnf access"; flow:to_server,established; content:"/_vti_pvt/writeto.cnf"; fast_pattern; http_uri; reference:bugtraq,4078; reference:cve,2002-1717; reference:nessus,10575; classtype:web-application-activity; sid:965; rev:17;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC RSA authentication agent for web redirect buffer overflow attempt"; flow:to_server,established; content:"IISWebAgent"; http_uri; content:"Redirect"; http_uri; content:"url|3D|"; http_uri; pcre:"/IISWebAgent[^\r\n]*\x2edll\x3F[^\r\n]*?url\x3d[^\r\n]{257}/Ui"; metadata:policy security-ips drop; reference:bugtraq,26424; reference:cve,2005-4734; classtype:attempted-user; sid:17440; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Multiple Products PNG large image width download attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32767,0,relative; metadata:policy security-ips drop; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:cve,2007-5503; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:3132; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX OWC11.DataSourceControl.11 ActiveX function call access"; flow:established,to_client; file_data; content:"OWC11.DataSourceControl.11"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22OWC11.DataSourceControl.11\x22|\x27OWC11.DataSourceControl.11\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22OWC11.DataSourceControl.11\x22|\x27OWC11.DataSourceControl.11\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; reference:url,browserfun.blogspot.com/2006/07/mobb-19-datasourcecontrol.html; reference:url,osvdb.org/27111; classtype:attempted-user; sid:8421; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Oracle Document Capture ActiveX function call access"; flow:established,to_client; file_data; content:"NCSECWLib.NCSRenderer"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22NCSECWLib\.NCSRenderer(\.\d)?\x22|\x27NCSECWLib\.NCSRenderer(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*WriteJPG\s*|.*(?P=v)\s*\.\s*WriteJPG\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22NCSECWLib\.NCSRenderer(\.\d)?\x22|\x27NCSECWLib\.NCSRenderer(\.\d)?\x27)\s*\)(\s*\.\s*WriteJPG\s*|.*(?P=n)\s*\.\s*WriteJPG\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,45856; reference:cve,2010-3599; classtype:attempted-user; sid:19194; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word malformed index code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|02 00 60 00 0C 14 FF 00 04 61 D5 00 B0 00 08 00 53 00 75 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,43766; reference:cve,2010-2750; classtype:attempted-user; sid:19153; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 2301 (msg:"WEB-MISC Compaq Insight directory traversal"; flow:to_server,established; content:"../"; reference:arachnids,244; reference:bugtraq,282; reference:cve,1999-0771; classtype:web-application-attack; sid:1199; rev:14;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI ttawebtop.cgi access"; flow:to_server,established; content:"/ttawebtop.cgi"; fast_pattern; http_uri; reference:bugtraq,2890; reference:cve,2001-0805; reference:nessus,10696; classtype:attempted-recon; sid:1480; rev:16;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC wwwboard.pl access"; flow:to_server,established; content:"/wwwboard.pl"; http_uri; reference:bugtraq,1795; reference:bugtraq,649; reference:cve,1999-0930; reference:cve,1999-0954; classtype:attempted-recon; sid:1175; rev:14;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP Universal CMDB server axis2 default credentials attempt"; flow:established,to_server; content:"/axis2/axis2-admin/login"; fast_pattern:only; http_uri; content:"POST"; http_method; content:"username=admin"; http_client_body; content:"password="; http_client_body; pcre:"/^(admin|axis2)/iR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,secunia.com/advisories/42763/; classtype:attempted-admin; sid:19157; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MW6 Technologies Barcode ActiveX clsid access"; flow:established,to_client; file_data; content:"14D09688-CFA7-11D5-995A-005004CE563B"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*14D09688-CFA7-11D5-995A-005004CE563B\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Supplement|SaveAsBMP|SaveAsWMF)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*14D09688-CFA7-11D5-995A-005004CE563B\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(Supplement|SaveAsBMP|SaveAsWMF))\s*=/siO"; metadata:policy security-ips drop; reference:bugtraq,33451; reference:cve,2008-4924; reference:cve,2009-0298; classtype:attempted-user; sid:15266; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Outlook Recipient Control ActiveX function call access"; flow:established,to_client; file_data; content:"RECIP.RecipCtl.1"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22RECIP.RecipCtl.1\x22|\x27RECIP.RecipCtl.1\x27)\s*\x3b.*\w+\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)|\w+\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22RECIP.RecipCtl.1\x22|\x27RECIP.RecipCtl.1\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,21649; classtype:attempted-user; sid:9670; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC webplus access"; flow:to_server,established; content:"/webplus?script"; http_uri; reference:bugtraq,1174; reference:bugtraq,1720; reference:bugtraq,1722; reference:bugtraq,1725; reference:cve,2000-1005; classtype:attempted-recon; sid:1159; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Generic javascript obfuscation attempt"; flow:to_client,established; file_data; content:"unescape"; pcre:"/var[^=]+=\s*unescape\s*\x3b/i"; metadata:policy security-ips drop; reference:bugtraq,35660; classtype:attempted-user; sid:15697; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI eXtropia webstore directory traversal"; flow:to_server,established; content:"/web_store.cgi"; http_uri; content:"page=../"; reference:bugtraq,1774; reference:cve,2000-1005; reference:nessus,10532; classtype:web-application-attack; sid:1088; rev:15;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Symantec Sygate Policy Manager SQL injection"; flow:established,to_server; content:"/servlet/Sygate.Servlet.login"; http_uri; pcre:"/[^\x26\x20\x0a]*insert[^\x26\x20\x0a]*Login[^\x26\x20\x0a]*Admin/smi"; reference:bugtraq,16452; reference:cve,2006-0522; classtype:attempted-admin; sid:11616; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LeadTools Raster Dialog File_D Object ActiveX clsid access"; flow:established,to_client; file_data; content:"00140BB5-B1BA-11CE-ABC6-F5B2E79D9E3F"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m7>\x22|\x27|)(?P<id1>.+?)(?P=m7)(\s|>)[^>]*\s*classid\s*=\s*(?P<q16>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*00140BB5-B1BA-11CE-ABC6-F5B2E79D9E3F\s*}?\s*(?P=q16)(\s|>).*(?P=id1)\s*\.\s*(DestinationPath)|<object\s*[^>]*\s*classid\s*=\s*(?P<q17>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*00140BB5-B1BA-11CE-ABC6-F5B2E79D9E3F\s*}?\s*(?P=q17)(\s|>)[^>]*\s*id\s*=\s*(?P<m8>\x22|\x27|)(?P<id2>.+?)(?P=m8)(\s|>).*(?P=id2)\s*\.\s*(DestinationPath))\s*=/si"; reference:bugtraq,24153; reference:url,moaxb.blogspot.com/2007/05/moaxb-25-leadtools-raster-dialog-filed.html; classtype:attempted-user; sid:11634; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Image Control 1.0 ActiveX object access"; flow:established,to_client; file_data; content:"D4A97620-8E8F-11CF-93CD-00AA00C08FDF"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*D4A97620-8E8F-11CF-93CD-00AA00C08FDF/si"; metadata:policy security-ips drop; reference:bugtraq,12477; reference:url,www.microsoft.com/technet/security/bulletin/MS05-014.mspx; classtype:attempted-user; sid:4165; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC telnet attempt"; flow:to_server,established; content:"telnet.exe"; classtype:web-application-activity; sid:1066; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Explorer invalid url file overflow attempt"; flow:to_client,established; file_data; content:"[InternetShortcut]"; within:100; content:"url="; distance:0; content:"file|3A|file|3A|file|3A|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,18838; reference:cve,2006-3351; classtype:denial-of-service; sid:7022; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX OutlookExpress.AddressBook ActiveX function call access"; flow:established,to_client; file_data; content:"OutlookExpress.AddressBook"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22OutlookExpress\.AddressBook\x22|\x27OutlookExpress\.AddressBook\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22OutlookExpress\.AddressBook\x22|\x27OutlookExpress\.AddressBook\x27)\s*\)/smi"; metadata:policy security-ips drop; classtype:attempted-user; sid:7005; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Photoshop CS4 ASL file processing buffer overflow attempt"; flow:to_client,established; content:"Stylenum"; byte_test:4,>,1020,8,relative,big; content:"8BSL"; metadata:policy security-ips drop; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17145; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel SST record remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|FC 00|"; byte_test:4,>,0x10000000,6,relative,little; byte_test:2,>,10,0,relative,little; byte_test:2,<,8225,0,relative,little; byte_jump:2,0,relative,little; pcre:"/^(\xFF|\x3C)\x00/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36042; reference:cve,2009-0561; reference:cve,2009-3037; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21396492; reference:url,www.microsoft.com/technet/security/bulletin/MS09-021.mspx; classtype:attempted-user; sid:15541; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VhdCvtCom.DiskLibHelper ActiveX function call access"; flow:established,to_client; file_data; content:"VhdCvtCom.DiskLibHelper"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22VhdCvtCom\.DiskLibHelper\x22|\x27VhdCvtCom\.DiskLibHelper\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22VhdCvtCom\.DiskLibHelper\x22|\x27VhdCvtCom\.DiskLibHelper\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14592; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Publisher 2007 pointer dereference attempt"; flow:to_client,established; flowbits:isset,http.pub; file_data; content:"|01 2C 01 2B 01 2A 01 2F 01 2E 01 2D 01 52 00 12 12 00 00 00|"; content:"|02 00 13 00|"; within:4; distance:11; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35599; reference:cve,2009-0566; reference:url,www.microsoft.com/technet/security/bulletin/MS09-030.mspx; classtype:attempted-user; sid:19932; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Intuit QuickBooks Online Edition 1 ActiveX clsid access"; flow:established,to_client; file_data; content:"CF9DEB90-8DE3-11D5-BAE4-00105AAAFF94"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CF9DEB90-8DE3-11D5-BAE4-00105AAAFF94\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(httpGETToFile|httpPOSTFromFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CF9DEB90-8DE3-11D5-BAE4-00105AAAFF94\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(httpGETToFile|httpPOSTFromFile))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,25544; reference:cve,2007-0322; reference:cve,2007-4471; reference:url,sc.accounting.quickbooks.com/Update/index.cfm?id=32; reference:url,www.kb.cert.org/vuls/id/907481; reference:url,www.kb.cert.org/vuls/id/979638; reference:url,www.microsoft.com/technet/security/bulletin/MS07-069.mspx; classtype:attempted-user; sid:12393; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint MCAtom remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|F8 0F 04 00 00 00|"; byte_test:4,>,2,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,20495; reference:cve,2006-5296; classtype:attempted-user; sid:17318; rev:4;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for addons.mozilla.org detected"; flow:to_client,established; ssl_state:server_hello; content:"addons.mozilla.org"; content:"|92 39 D5 34 8F 40 D1 69 5A 74 54 70 E1 F2 3F 43|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18571; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Novell ZENworks patch management SQL injection attempt"; flow:to_server, established; content:"/packages/default.asp?"; http_uri; pcre:"/sort\x3d[^\s]*\x3b+/Ui"; metadata:policy security-ips drop; reference:bugtraq,15220; reference:cve,2005-3315; classtype:web-application-attack; sid:17449; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Symantec Altiris Deployment Solution ActiveX function call access"; flow:established,to_client; file_data; content:"Altiris.AeXNSConsoleUtilities"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Altiris\.AeXNSConsoleUtilities(\.\d)?\x22|\x27Altiris\.AeXNSConsoleUtilities(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(BrowseAndSaveFile|RunCMD)\s*|.*(?P=v)\s*\.\s*(BrowseAndSaveFile|RunCMD)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Altiris\.AeXNSConsoleUtilities(\.\d)?\x22|\x27Altiris\.AeXNSConsoleUtilities(\.\d)?\x27)\s*\)(\s*\.\s*(BrowseAndSaveFile|RunCMD)\s*|.*(?P=n)\s*\.\s*(BrowseAndSaveFile|RunCMD)\s*)\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,36698; reference:bugtraq,37092; reference:cve,2009-3031; reference:cve,2009-3033; classtype:attempted-user; sid:16307; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-IIS IIS 5.1 alternate data stream authentication bypass attempt"; flow:established,to_server; content:"$i30:$INDEX_ALLOCATION"; http_uri; metadata:policy security-ips drop; reference:cve,2010-2731; reference:url,www.microsoft.com/technet/security/bulletin/MS10-065.mspx; classtype:web-application-attack; sid:17103; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX obfuscated instantiation of ActiveX object - likely malicious"; flow:established,to_client; file_data; content:"new ActiveXObject|28|"; content:"unescape|28|"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3558; classtype:attempted-user; sid:17571; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word rich text format invalid field size memory corruption attempt"; flow:to_client,established; content:"|5C|dpcallout"; content:"|5C|dppolycount"; within:50; byte_test:5,>,50,0,string,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1902; reference:url,www.microsoft.com/technet/security/bulletin/ms10-056.mspx; classtype:attempted-user; sid:17123; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI fileseek.cgi access"; flow:to_server,established; content:"/fileseek.cgi"; fast_pattern; http_uri; reference:bugtraq,4579; reference:bugtraq,6784; reference:cve,2002-0611; reference:nessus,11748; classtype:web-application-activity; sid:2207; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IBM Lotus SameTime STJNILoader ActiveX function call access"; flow:established,to_client; file_data; content:"JNILOADER.JNILoaderCtrl"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22JNILOADER\.JNILoaderCtrl\x22|\x27JNILOADER\.JNILoaderCtrl\x27)\s*\x3b.*(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)(\s*\.\s*(LoadLibrary)\s*\(|.*\3\s*\.\s*(LoadLibrary)\s*\()|(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22JNILOADER\.JNILoaderCtrl\x22|\x27JNILOADER\.JNILoaderCtrl\x27)\s*\)(\s*\.\s*(LoadLibrary)\s*\(|.*\7\s*\.\s*(LoadLibrary)\s*\()/smi"; metadata:policy security-ips drop; reference:bugtraq,23201; reference:url,www-1.ibm.com/support/docview.wss?uid=swg21257029; reference:url,www.securityfocus.com/archive/1/464185; classtype:attempted-user; sid:10417; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CGI Microsoft .NET Chart Control directory traversal attempt"; flow:to_server,established; content:"charImg.axd?"; content:"i=/"; distance:0; http_uri; content:".."; distance:0; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1977; reference:url,www.microsoft.com/technet/security/bulletin/MS11-066.mspx; classtype:attempted-recon; sid:19694; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Internet.PopupMenu.1 ActiveX function call access"; flow:established,to_client; file_data; content:"Internet.PopupMenu.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22Internet.PopupMenu.1\x22|\x27Internet.PopupMenu.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22Internet.PopupMenu.1\x22|\x27Internet.PopupMenu.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; classtype:attempted-user; sid:7012; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Oracle Java Web Start BasicServiceImpl security policy bypass attempt"; flow:to_server,established; content:"java.security.policy"; fast_pattern:only; http_uri; pcre:"/jnlp\x22\x09\x22-J-Djava\.security\.policy/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,43999; reference:cve,2010-3563; classtype:attempted-user; sid:20430; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Second Sight Software ActiveMod ActiveX function call access"; flow:established,to_client; file_data; content:"ACTIVEMOD.ActiveModCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22ACTIVEMOD\.ActiveModCtrl\x22|\x27ACTIVEMOD\.ActiveModCtrl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ACTIVEMOD\.ActiveModCtrl\x22|\x27ACTIVEMOD\.ActiveModCtrl\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,23554; reference:cve,2007-1691; reference:url,www.kb.cert.org/vuls/id/962305; classtype:attempted-user; sid:10984; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS strings parsing memory corruption attempt"; flow:to_client,established; content:"text-decoration"; pcre:"/\x2E[A-Z\d_]+\s*\x7b\s*text-decoration[^\x3A]*?\x7d/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0943; reference:url,www.microsoft.com/technet/security/bulletin/ms07-045.mspx; classtype:attempted-user; sid:17645; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI webdist.cgi arbitrary command attempt"; flow:to_server,established; content:"/webdist.cgi"; http_uri; content:"distloc=|3B|"; fast_pattern:only; reference:bugtraq,374; reference:cve,1999-0039; reference:nessus,10299; classtype:web-application-attack; sid:1865; rev:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView Network Node Manager OvOSLocale parameter buffer overflow attempt"; flow:to_server,established; content:"/OVCgi/Toolbar.exe"; http_uri; content:"OvOSLocale"; http_cookie; pcre:"/OvOSLocale\s*\x3d\s*[^\x3b\s]{249}/Cmi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34134; reference:cve,2008-0067; reference:cve,2009-0920; classtype:attempted-user; sid:15434; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Earth Resource Mapper NCSView ActiveX clsid access"; flow:established,to_client; file_data; content:"8EC18CE2-D7B4-11D2-88C8-006008A717FD"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8EC18CE2-D7B4-11D2-88C8-006008A717FD\s*}?\s*(?P=q1)(\s|>)/si"; reference:bugtraq,25584; reference:cve,2007-4470; classtype:attempted-user; sid:12413; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS Directory transversal attempt"; flow:to_server,established; content:"..|5C|.."; fast_pattern:only; reference:bugtraq,2218; reference:cve,1999-0229; classtype:web-application-attack; sid:974; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer use-after-free memory corruption attempt"; flow:to_client,established; content:"location.protocol"; fast_pattern:only; pcre:"/location.protocol\s*=[^=]/smi"; reference:cve,2010-2556; reference:url,www.microsoft.com/technet/security/bulletin/ms10-053.mspx; classtype:attempted-dos; sid:17129; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer javascript onload overflow attempt"; flow:to_client,established; content:"body"; content:"on"; within:20; content:"window"; within:20; pcre:"/<body\s+[^>]*on(Load|Blur)\s*=\s*[\x22\x27]?window\(\)/smi"; metadata:policy security-ips drop; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4647; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Microsoft IIS source code disclosure attempt"; flow:to_server,established; content:"http|3A 2F|localhost"; http_uri; metadata:policy security-ips drop; reference:cve,2005-2678; reference:url,secunia.com/advisories/16548; classtype:misc-attack; sid:17652; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 18 ActiveX clsid access"; flow:established,to_client; file_data; content:"577FAA18-4518-445E-8F70-1473F8CF4BA4"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q19>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*577FAA18-4518-445E-8F70-1473F8CF4BA4\s*}?\s*(?P=q19)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15606; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.Sequence ActiveX clsid access"; flow:established,to_client; file_data; content:"4F241DB1-EE9F-11D0-9824-006097C99E51"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*4F241DB1-EE9F-11D0-9824-006097C99E51/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8762; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Sony ImageStation ActiveX clsid access"; flow:established,to_client; file_data; content:"E9A7F56F-C40F-4928-8C6F-7A72F2A25222"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E9A7F56F-C40F-4928-8C6F-7A72F2A25222\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SetLogging)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E9A7F56F-C40F-4928-8C6F-7A72F2A25222\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(SetLogging))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,27715; reference:cve,2008-0748; classtype:attempted-user; sid:13547; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SonicWall Aventail EPInstaller ActiveX function call access"; flow:established,to_client; file_data; content:"Aventail.EPInstaller"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Aventail\.EPInstaller(\.\d)?\x22|\x27Aventail\.EPInstaller(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(InstallComponentMsi|Install3rdPartyComponent|InstallComponentVer|InstallComponent)\s*|.*(?P=v)\s*\.\s*(InstallComponentMsi|Install3rdPartyComponent|InstallComponentVer|InstallComponent)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Aventail\.EPInstaller(\.\d)?\x22|\x27Aventail\.EPInstaller(\.\d)?\x27)\s*\)(\s*\.\s*(InstallComponentMsi|Install3rdPartyComponent|InstallComponentVer|InstallComponent)\s*|.*(?P=n)\s*\.\s*(InstallComponentMsi|Install3rdPartyComponent|InstallComponentVer|InstallComponent)\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,44535; reference:cve,2010-2583; classtype:attempted-user; sid:18324; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI a1stats access"; flow:to_server,established; content:"/a1stats/"; http_uri; reference:bugtraq,2705; reference:cve,2001-0561; reference:nessus,10669; classtype:web-application-activity; sid:1731; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC mod-plsql administration access"; flow:to_server,established; content:"/admin_/"; http_uri; reference:bugtraq,3726; reference:bugtraq,3727; reference:cve,2001-1216; reference:cve,2001-1217; reference:nessus,10849; classtype:web-application-activity; sid:1385; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed named graph information ascii overflow"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|95 00|"; isdataat:133,relative; pcre:"/^(.{92}[^\x00]{41}|.{148}[^\x00]{41}|.{172}[^\x00]{41}|.{212}[^\x00]{41}|.{252}[^\x00]{22}|.{272}[^\x00]{22}|.{292}[^\x00]{22}|.{312}[^\x00]{22}|.{332}[^\x00]{22})/Rs"; metadata:policy security-ips drop; reference:cve,2007-0215; reference:url,www.microsoft.com/technet/security/bulletin/ms07-023.mspx; classtype:attempted-user; sid:11290; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape Enterprise DOS"; flow:to_server,established; content:"REVLOG / "; depth:9; reference:bugtraq,2294; reference:cve,2001-0251; classtype:web-application-attack; sid:1047; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Oracle Secure Backup Administration Server authentication bypass attempt via POST"; flow:to_server,established; content:"login.php"; http_uri; content:"attempt"; http_client_body; content:"uname="; http_client_body; pcre:"/uname\x3D[^\x26\x2D\s]*?\x2D/iP"; metadata:policy security-ips drop; reference:bugtraq,41596; reference:cve,2010-0907; classtype:attempted-admin; sid:17049; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI listrec.pl access"; flow:to_server,established; content:"/listrec.pl"; fast_pattern; http_uri; reference:bugtraq,3328; reference:cve,2001-0997; reference:nessus,10769; classtype:attempted-recon; sid:1470; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Agent Control ActiveX function call access"; flow:established,to_client; file_data; content:"Agent.Control"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Agent\.Control\.\d+\x22|\x27Agent\.Control\.\d+\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*Characters.Load\s*|.*(?P=v)\s*\.\s*Characters.Load\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Agent\.Control\.\d+\x22|\x27Agent\.Control\.\d+\x27)\s*\)(\s*\.\s*Characters.Load\s*|.*(?P=n)\s*\.\s*Characters.Load\s*)\s*\(/Osmi"; reference:bugtraq,25566; reference:cve,2007-3040; reference:url,www.microsoft.com/technet/security/bulletin/MS07-051.mspx; classtype:attempted-user; sid:12450; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Internet Explorer navcancl.htm url spoofing attempt"; flow:established,to_client; content:"about|3A|cancel|23|"; reference:bugtraq,22966; reference:cve,2007-1499; reference:url,www.microsoft.com/technet/security/bulletin/MS07-033.mspx; classtype:misc-attack; sid:12014; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Office Sharepoint Server elevation of privilege exploit attempt"; flow:to_server,established; content:!"/ssp/admin/_layouts"; http_uri; content:"mode=ssp"; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4032; reference:url,www.microsoft.com/technet/security/bulletin/MS08-077.mspx; classtype:attempted-admin; sid:15108; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows GDI VML gradient size heap overflow attempt"; flow:to_client,established; content:"v:fill"; content:"focussize"; pcre:"/focussize\s*\x3d\s*\x22[^\x2d\x2c\x22]*\x2d[^\x2d\x22]+\x2d/smi"; metadata:policy security-ips drop; reference:cve,2007-5348; reference:url,www.microsoft.com/technet/security/bulletin/MS08-052.mspx; classtype:attempted-user; sid:14261; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla multiple content-disposition headers malicious redirect attempt"; flow:to_client,established; content:"Content|2D|Disposition|3A|"; http_header; content:"|0A|Content|2D|Disposition|3A|"; distance:0; http_header; reference:cve,2011-3000; classtype:web-application-attack; sid:20586; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8888 (msg:"WEB-MISC answerbook2 admin attempt"; flow:to_server,established; content:"/cgi-bin/admin/admin"; reference:bugtraq,5383; reference:cve,2000-0696; classtype:web-application-activity; sid:1946; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC .wwwacl access"; flow:to_server,established; content:".www_acl"; http_uri; classtype:attempted-recon; sid:1131; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SAP GUI SAPBExCommonResources ActiveX clsid access"; flow:established,to_client; file_data; content:"A009C90D-814B-11D3-BA3E-080009D22344"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A009C90D-814B-11D3-BA3E-080009D22344\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Execute)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A009C90D-814B-11D3-BA3E-080009D22344\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Execute))/siO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,securitytracker.com/alerts/2010/Mar/1023760.html; classtype:attempted-user; sid:17614; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Logitech Video Call 3 ActiveX clsid access"; flow:established,to_client; file_data; content:"917b29f8-e72a-4761-8371-bf7fca27eb31"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*917b29f8-e72a-4761-8371-bf7fca27eb31\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Start)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*917b29f8-e72a-4761-8371-bf7fca27eb31\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(Start))/siO"; metadata:policy security-ips drop; reference:bugtraq,24254; reference:cve,2007-2918; classtype:attempted-user; sid:17067; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"WEB-MISC Novell iManager eDirectory plugin schema buffer overflow attempt - POST request"; flow:to_server,established; content:"POST"; http_method; content:"/nps/servlet/"; http_uri; content:"taskId=base.ExtendSchema"; http_uri; pcre:"/(((DestFile|encryptPass)\x3D[^\x26]{50})|((BaseDN|SearchFilter)\x3D[^\x26]{128}))/Pi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37672; reference:cve,2009-4486; classtype:attempted-admin; sid:16430; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX StreamAudio ProxyManager ActiveX clsid access"; flow:established,to_client; file_data; content:"2253F320-AB68-4A07-917D-4F12D8884A06"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2253F320-AB68-4A07-917D-4F12D8884A06\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(InternalTuneIn)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*2253F320-AB68-4A07-917D-4F12D8884A06\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(InternalTuneIn))\s*\(/si"; metadata:policy security-ips drop; reference:bugtraq,27247; reference:cve,2008-0248; classtype:attempted-user; sid:13312; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 8 toStaticHTML XSS attempt"; flow:to_client,established; content:"toStaticHTML("; fast_pattern; content:"expression("; within:100; pcre:"/toStaticHTML\x28.*?[\x26\x22].=expression\x28/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1252; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-user; sid:19239; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel ContinueFRT12 and MDXSet heap overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|87 08|"; byte_jump:2,0,relative,little; content:"|7F 08|"; within:2; metadata:policy security-ips drop; reference:cve,2010-0261; reference:url,www.microsoft.com/technet/security/bulletin/MS10-017.mspx; classtype:attempted-user; sid:16465; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMT DV Extract Filter ActiveX clsid access"; flow:established,to_client; file_data; content:"E476CBFF-E229-4524-B6B7-228A3129D1C7"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*E476CBFF-E229-4524-B6B7-228A3129D1C7/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7470; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC webadmin.dll access"; flow:to_server,established; content:"/webadmin.dll"; http_uri; reference:bugtraq,7438; reference:bugtraq,7439; reference:bugtraq,8024; reference:cve,2003-0471; reference:nessus,11771; classtype:web-application-activity; sid:2246; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Toshiba Surveillance Surveillix DVR ActiveX function call access"; flow:established,to_client; file_data; content:"RecordSend"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22RecordSend\x22|\x27RecordSend\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(SetPort|SetIPAddress)\s*|.*(?P=v)\s*\.\s*(SetPort|SetIPAddress)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22RecordSend\x22|\x27RecordSend\x27)\s*\)(\s*\.\s*(SetPort|SetIPAddress)\s*|.*(?P=n)\s*\.\s*(SetPort|SetIPAddress)\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,27360; reference:cve,2008-0399; classtype:attempted-user; sid:13331; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAEndStyle.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAEndStyle.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAEndStyle.1\x22|\x27DirectAnimation.DAEndStyle.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAEndStyle.1\x22|\x27DirectAnimation.DAEndStyle.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8749; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS ctss.idc access"; flow:to_server,established; content:"/ctss.idc"; fast_pattern; http_uri; reference:nessus,10359; classtype:web-application-activity; sid:1486; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RealPlayer AutoStream.AutoStream.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"405DE7C0-E7DD-11D2-92C5-00C0F01F77C1"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*405DE7C0-E7DD-11D2-92C5-00C0F01F77C1\s*}?\s*\1/si"; metadata:policy security-ips drop; reference:bugtraq,21802; reference:cve,2006-6847; classtype:attempted-user; sid:9671; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes PCAST protocol handler stack buffer overflow attempt"; flow:to_client,established; file_data; content:"pcast|3A|//"; pcre:"/(\x22|\x27)pcast\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15705; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML DOM invalid DHTML comment creation attempt"; flow:to_client,established; file_data; content:"document.location.href"; fast_pattern:only; content:"createComment"; pcre:"/(\w+)\s*=\s*\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)\s*\;.*?\w+\.(insertBefore|insertAfter|appendChild)\(\1\)\;|\w\.(insertBefore|insertAfter|appendChild)\(\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:policy security-ips drop; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:16300; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Kodak Image Editing ActiveX object access"; flow:established,to_client; file_data; content:"6D940280-9F11-11CE-83FD-02608C3EC08A"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*6D940280-9F11-11CE-83FD-02608C3EC08A/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/bulletin/MS99-037.mspx; classtype:attempted-user; sid:4193; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS pbserver access"; flow:to_server,established; content:"/pbserver/pbserver.dll"; fast_pattern; http_uri; reference:cve,2000-1089; reference:url,www.microsoft.com/technet/security/bulletin/ms00-094.mspx; classtype:web-application-activity; sid:1772; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX IBM Lotus SameTime STJNILoader ActiveX clsid access"; flow:established,to_client; file_data; content:"7261EE42-318E-490A-AE8F-77649DBA1ECA"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*id\s*=((\x22|\x27)([^\2]*)\2)\s*classid\s*=\s*(\x22|\x27|)clsid\s*\x3a\s*{?\s*7261EE42-318E-490A-AE8F-77649DBA1ECA\s*}?\4.*\3\.(LoadLibrary)\(|<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7261EE42-318E-490A-AE8F-77649DBA1ECA\s*}?\s*\6\s*id\s*=\s*((\x22|\x27)([^\8]*)\8).*\9\.(LoadLibrary)\(/si"; metadata:policy security-ips drop; reference:bugtraq,23201; reference:url,www-1.ibm.com/support/docview.wss?uid=swg21257029; reference:url,www.securityfocus.com/archive/1/464185; classtype:attempted-user; sid:10415; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI campas access"; flow:to_server,established; content:"/campas"; fast_pattern; http_uri; reference:bugtraq,1975; reference:cve,1999-0146; reference:nessus,10035; classtype:attempted-recon; sid:847; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Synactis ALL In-The-Box ActiveX clsid access"; flow:established,to_client; file_data; content:"B5576893-F948-4E0F-9BE1-A37CB56D66FF"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m11>\x22|\x27|)(?P<id1>.+?)(?P=m11)(\s|>)[^>]*\s*classid\s*=\s*(?P<q22>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*B5576893-F948-4E0F-9BE1-A37CB56D66FF\s*}?\s*(?P=q22)(\s|>).*(?P=id1)\s*\.\s*(SaveDoc)|<object\s*[^>]*\s*classid\s*=\s*(?P<q23>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*B5576893-F948-4E0F-9BE1-A37CB56D66FF\s*}?\s*(?P=q23)(\s|>)[^>]*\s*id\s*=\s*(?P<m12>\x22|\x27|)(?P<id2>.+?)(?P=m12)(\s|>).*(?P=id2)\.(SaveDoc))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,33535; reference:cve,2009-0465; classtype:attempted-user; sid:15346; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Object.Microsoft.DXTFilter ActiveX function call access"; flow:established,to_client; file_data; content:"Object.Microsoft.DXTFilter"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22Object.Microsoft.DXTFilter\x22|\x27Object.Microsoft.DXTFilter\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22Object.Microsoft.DXTFilter\x22|\x27Object.Microsoft.DXTFilter\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,18903; reference:cve,2006-3512; classtype:attempted-dos; sid:7016; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player codec code execution attempt"; flow:to_client,established; flowbits:isset,http.avi; content:"strh"; content:"auds"; within:4; distance:4; fast_pattern; byte_jump:4,-8,relative,little; isdataat:16,relative; content:"strf"; within:4; content:"U|00|"; within:2; distance:4; byte_test:4,!=,48000,2,relative,little; byte_test:4,!=,44100,2,relative,little; byte_test:4,!=,32000,2,relative,little; byte_test:4,!=,24000,2,relative,little; byte_test:4,!=,22050,2,relative,little; byte_test:4,!=,16000,2,relative,little; byte_test:4,!=,12000,2,relative,little; byte_test:4,!=,11025,2,relative,little; byte_test:4,!=,8000,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0480; reference:url,www.microsoft.com/technet/security/bulletin/MS10-026.mspx; classtype:attempted-user; sid:16543; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Cisco /%% DOS attempt"; flow:to_server,established; content:"/%%"; reference:bugtraq,1154; reference:cve,2000-0380; reference:nessus,10387; classtype:web-application-attack; sid:1546; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Najdi.si Toolbar ActiveX clsid access"; flow:established,to_client; file_data; content:"442599A9-EB41-4F1F-B999-737BC587F314"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*442599A9-EB41-4F1F-B999-737BC587F314\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(Location)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*442599A9-EB41-4F1F-B999-737BC587F314\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(Location))\s*=/si"; metadata:policy security-ips drop; reference:bugtraq,30922; classtype:attempted-user; sid:14243; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC BigBrother access"; flow:to_server,established; content:"/bb-hostsvc.sh?HOSTSVC"; http_uri; reference:bugtraq,1455; reference:cve,2000-0638; reference:nessus,10460; classtype:attempted-recon; sid:1105; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Internet.HHCtrl.1 ActiveX function call access"; flow:established,to_client; file_data; content:"Internet.HHCtrl.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22Internet.HHCtrl.1\x22|\x27Internet.HHCtrl.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22Internet.HHCtrl.1\x22|\x27Internet.HHCtrl.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:bugtraq,18769; reference:cve,2006-3357; reference:url,osvdb.org/26835; reference:url,www.microsoft.com/technet/security/bulletin/ms06-046.mspx; classtype:attempted-user; sid:7004; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 23 ActiveX clsid access"; flow:established,to_client; file_data; content:"8A674B4C-1F63-11D3-B64C-00C04F79498E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q31>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*8A674B4C-1F63-11D3-B64C-00C04F79498E\s*}?\s*(?P=q31)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15618; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel dval record arbitrary code excecution attempt"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|B2 01|"; byte_test:4,>,4294967293,12,relative,little; metadata:policy security-ips drop; reference:cve,2008-0111; reference:url,www.microsoft.com/technet/security/bulletin/MS08-014.mspx; classtype:attempted-user; sid:13571; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Windows Scripting Host Shell ActiveX function call access"; flow:established,to_client; file_data; content:"wscript.shell"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22wscript.shell\x22|\x27wscript.shell\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22wscript.shell\x22|\x27wscript.shell\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; classtype:attempted-user; sid:8068; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX GOM Player GomWeb ActiveX function call access"; flow:established,to_client; file_data; content:"GomWebCtrl.GomManager"; pcre:"/(?P<c>\w+)\s*=\s*(\x22GomWebCtrl\.GomManager(\.\d)?\x22|\x27GomWebCtrl\.GomManager(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*OpenURL\s*|.*(?P=v)\s*\.\s*OpenURL\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22GomWebCtrl\.GomManager(\.\d)?\x22|\x27GomWebCtrl\.GomManager(\.\d)?\x27)\s*\)(\s*\.\s*OpenURL\s*|.*(?P=n)\s*\.\s*OpenURL\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,26236; reference:cve,2007-5779; classtype:attempted-user; sid:17080; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC cybercop scan"; flow:to_server,established; content:"/cybercop"; http_uri; reference:arachnids,374; classtype:web-application-activity; sid:1099; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer setCapture heap corruption exploit attempt"; flow:to_client,established; content:"setCapture"; pcre:"/document\x2eall\x28.*?\x29\x2esetCapture\x28/s"; metadata:policy security-ips drop; reference:cve,2009-1529; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:attempted-user; sid:15535; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WIA FileSystem USD ActiveX clsid access"; flow:established,to_client; file_data; content:"D2923B86-15F1-46FF-A19A-DE825F919576"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*D2923B86-15F1-46FF-A19A-DE825F919576/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/ms05-038.mspx; classtype:attempted-user; sid:7989; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SignKorea SKCommAX ActiveX clsid access"; flow:established,to_client; file_data; content:"EC5D5118-9FDE-4A3E-84F3-C2B711740E70"; fast_pattern:only; pcre:"/<OBJECT\s*[^>]*\s*id\s*=((\x22|\x27)([^\2]*)\2)\s*classid\s*=\s*(\x22|\x27|)clsid\s*\x3a\s*{?\s*EC5D5118-9FDE-4A3E-84F3-C2B711740E70\s*}?\4.*\3\.(DownloadCertificateExt)\(|<OBJECT\s*[^>]*\s*classid\s*=\s*(\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*EC5D5118-9FDE-4A3E-84F3-C2B711740E70\s*}?\s*\6\s*id\s*=\s*((\x22|\x27)([^\8]*)\8).*\9\.(DownloadCertificateExt)\(/si"; metadata:policy security-ips drop; classtype:attempted-user; sid:10404; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI smartsearch.cgi access"; flow:to_server,established; content:"/smartsearch.cgi"; http_uri; reference:bugtraq,7133; classtype:web-application-activity; sid:2001; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC tftp attempt"; flow:to_server,established; content:"tftp.exe"; classtype:web-application-activity; sid:1068; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS fpcount access"; flow:to_server,established; content:"/fpcount.exe"; fast_pattern; http_uri; reference:bugtraq,2252; reference:cve,1999-1376; classtype:web-application-activity; sid:1013; rev:17;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows shell extensions deskpan.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|deskpan.dll"; http_uri; reference:cve,2011-1991; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-071.mspx; classtype:attempted-user; sid:20119; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 3 ActiveX clsid access"; flow:established,to_client; file_data; content:"76EE578D-314B-4755-8365-6E1722C001A2"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q45>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*76EE578D-314B-4755-8365-6E1722C001A2\s*}?\s*(?P=q45)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14092; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Vector Markup Language recolorinfo tag numfills parameter buffer overflow attempt"; flow:to_client,established; content:"recolorinfo"; content:"numfills"; pcre:"/recolorinfo[^>]*numfills\s*=\s*\x22/si"; byte_test:10,>,24403223,0,relative,string; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2007-0024; reference:url,www.microsoft.com/technet/security/bulletin/ms07-004.mspx; classtype:attempted-user; sid:9848; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI simplestmail.cgi access"; flow:to_server,established; content:"/simplestmail.cgi"; fast_pattern; http_uri; reference:bugtraq,2106; reference:bugtraq,4579; reference:cve,2001-0022; reference:nessus,11748; classtype:web-application-activity; sid:2220; rev:13;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC phpBook mail command execution attempt"; flow:established, to_server; content:"/lwc/index.php"; http_uri; pcre:"/index\.php\?.*mail=[^\r\n\x26]*\x3C\x3F/smiU"; metadata:policy security-ips drop; reference:bugtraq,16106; reference:cve,2006-0075; classtype:attempted-admin; sid:18334; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer object clone deletion memory corruption attempt"; flow:to_client,established; content:"cloneNode"; content:"clearAttributes"; distance:0; pcre:"/(?P<cl>\w+)\s*=\s*(?P<o>\w+)\.cloneNode.*?(?P=o)\.clearAttributes.*?(?P=o)\s*=\s*null\s*\x3B.*?(?P=cl)\.click\s*\x3B/Osmi"; metadata:policy balanced-ips alert, policy security-ips alert, service http; reference:cve,2009-0075; reference:url,www.microsoft.com/technet/security/bulletin/MS09-002.mspx; classtype:attempted-user; sid:15304; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAEvent.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DAEvent.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DAEvent.1\x22|\x27DirectAnimation.DAEvent.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DAEvent.1\x22|\x27DirectAnimation.DAEvent.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8746; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Lotus EditDoc attempt"; flow:to_server,established; content:"?EditDocument"; http_uri; reference:url,www.securiteam.com/exploits/5NP080A1RE.html; classtype:attempted-recon; sid:1117; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime SMIL File Handling Integer Overflow attempt"; flow:to_client,established; flowbits:isset,http.smil; content:"<smil>"; pcre:"/(author|copyright|information)/smiR"; content:"content|3D|"; distance:1; isdataat:1024,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24873; reference:cve,2007-2394; classtype:attempted-user; sid:17548; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI talkback.cgi directory traversal attempt"; flow:to_server,established; content:"/talkbalk.cgi"; http_uri; content:"article=../../"; fast_pattern:only; reference:bugtraq,2547; reference:cve,2001-0420; classtype:web-application-attack; sid:1719; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader U3D CLODMeshContinuation code execution attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"U3D|00|"; content:"1|FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,<,16777216,12,relative,little; content:"<|FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,>,16777215,12,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36665; reference:cve,2009-2990; reference:url,www.adobe.com/support/security/bulletins/apsb09-15.html; classtype:attempted-user; sid:16373; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.StructuredGraphicsControl ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.StructuredGraphicsControl"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.StructuredGraphicsControl\x22|\x27DirectAnimation.StructuredGraphicsControl\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.StructuredGraphicsControl\x22|\x27DirectAnimation.StructuredGraphicsControl\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:7009; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iOS 4.3.3 jailbreak for iPad download attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|28 69 90 CC 10 42 88 0A D9 21 25 52 F6 DE 23 23|"; fast_pattern:only; metadata:policy security-ips drop; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19417; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP eSupportDiagnostics 17 ActiveX clsid access"; flow:established,to_client; file_data; content:"C94188F6-0F9F-46B3-8B78-D71907BD8B77"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q18>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C94188F6-0F9F-46B3-8B78-D71907BD8B77\s*}?\s*(?P=q18)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28929; reference:cve,2008-0712; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13748; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI post-query access"; flow:to_server,established; content:"/post-query"; fast_pattern; http_uri; reference:bugtraq,6752; reference:cve,2001-0291; classtype:attempted-recon; sid:866; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAVector3.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BDA-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BDA-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8768; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX WMT DeInterlace Filter ActiveX clsid access"; flow:established,to_client; file_data; content:"C8F209F8-480E-454C-94A4-5392D88EBA0F"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C8F209F8-480E-454C-94A4-5392D88EBA0F/si"; metadata:policy security-ips drop; reference:cve,2006-3638; reference:url,www.microsoft.com/technet/security/bulletin/MS06-042.mspx; classtype:attempted-user; sid:7464; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer innerHTML against incomplete element heap corruption attempt"; flow:to_client,established; content:"innerHTML"; pcre:"/=\x22(\w+)\x22.*<script>.*\1\x2einnerHTML/smi"; reference:cve,2010-0490; reference:url,www.microsoft.com/technet/security/bulletin/MS10-018.mspx; classtype:attempted-user; sid:16506; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC server-status access"; flow:to_server,established; content:"/server-status"; http_uri; reference:url,httpd.apache.org/docs/mod/mod_info.html; classtype:web-application-activity; sid:1521; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 5/6 object type overflow attempt"; flow:to_client,established; file_data; content:"<OBJECT"; pcre:"/<OBJECT\s+[^>]*type\s*=[\x22\x27]\x2f{32}/smi"; reference:cve,2003-0344; reference:url,www.microsoft.com/technet/security/bulletin/MS03-020.mspx; classtype:attempted-user; sid:3149; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat and Adobe Acrobat Reader FlateDecode integer overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/DecodeParms"; content:"/Predictor"; distance:0; byte_test:8,>,1,0,relative,string,dec; pcre:"/\x2fDecodeParms\s*\x3c{2}\s*(?=[^\x3e]*\/Predictor\s+0*(1\d{1}|[2-9]))([^\x3e]*\x2fBitsPerComponent\s+\d{3}|[^\x3e]*\x2fColumns\s+(\d{5}|[6-9]\d{3})|[^\x3e]*\x2fColors\s+(\d{5}|[6-9]\d{3}))/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35294; reference:bugtraq,36600; reference:cve,2009-1856; reference:cve,2009-3459; classtype:attempted-user; sid:15709; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 6 ActiveX clsid access"; flow:established,to_client; file_data; content:"0955AC62-BF2E-4CBA-A2B9-A63F772D46CF"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,35558; reference:cve,2008-0015; reference:cve,2009-0901; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-037.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-060.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15670; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX EasyMail IMAP4 ActiveX function call access"; flow:established,to_client; file_data; content:"EasyMail.IMAP4"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22EasyMail\.IMAP4(\.\d)?\x22|\x27EasyMail\.IMAP4(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*LicenseKey\s*|.*(?P=v)\s*\.\s*LicenseKey\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22EasyMail\.IMAP4(\.\d)?\x22|\x27EasyMail\.IMAP4(\.\d)?\x27)\s*\)(\s*\.\s*LicenseKey\s*|.*(?P=n)\s*\.\s*LicenseKey\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,25467; reference:cve,2007-4607; classtype:attempted-user; sid:16781; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS style memory corruption attempt"; flow:to_client,established; file_data; content:"table"; content:"position"; content:"absolute"; distance:0; content:"clip"; pcre:"/table\s*(\/\*\*\/)?(\x7b|style)[^\x7d\x3e]*position\s*\x3a\s*absolute/i"; pcre:"/table\s*(\/\*\*\/)?(\x7b|style)[^\x7d\x3e]*clip\s*\x3a/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3962; reference:url,www.microsoft.com/technet/security/advisory/2458511.mspx; classtype:attempted-user; sid:19873; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8090 (msg:"WEB-MISC TrackerCam ComGetLogFile.php3 directory traversal attempt"; flow:to_server,established; content:"/ComGetLogFile.php3"; pcre:"/fn=\x2e\x2e(\x2f|\x5c)/Rmsi"; reference:bugtraq,12592; reference:cve,2005-0481; reference:nessus,17160; classtype:web-application-attack; sid:3544; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word Document remote code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|EC A5|"; byte_test:2,<,38,0,relative,little; byte_test:4,<,250,22,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3135; reference:url,www.microsoft.com/technet/security/bulletin/MS09-068.mspx; classtype:attempted-user; sid:16586; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint paragraph format array inner header overflow attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|1C 00 00 00 00 80 41 41 41 41 41 41 95 00 FF FF 64|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34833; reference:cve,2009-0220; classtype:attempted-user; sid:17695; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office malformed routing slip code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"Routing|3A 20|"; content:"|B9 00 9B 05 56 04 3F 05 00 00 41 41 41 41|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,17000; reference:cve,2006-0009; classtype:attempted-user; sid:17284; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI pfdispaly.cgi arbitrary command execution attempt"; flow:to_server,established; content:"/pfdispaly.cgi?'"; fast_pattern; http_uri; reference:cve,1999-0270; reference:nessus,10174; classtype:web-application-attack; sid:1655; rev:13;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-IIS multiple extension code execution attempt"; flow:established,to_server; content:".asp|3B|."; fast_pattern; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-4444; classtype:web-application-attack; sid:16356; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Ciansoft PDFBuilderX ActiveX clsid access"; flow:established,to_client; file_data; content:"00E7C7F8-71E2-498A-AB28-A3D72FC74485"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*00E7C7F8-71E2-498A-AB28-A3D72FC74485\s*}?\s*(?P=q6)(\s|>).*(?P=id1)\s*\.\s*(SaveToFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*00E7C7F8-71E2-498A-AB28-A3D72FC74485\s*}?\s*(?P=q7)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\.(SaveToFile))\s*\(/siO"; metadata:policy security-ips drop; reference:bugtraq,33233; classtype:attempted-user; sid:15228; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Samba SWAT Authorization overflow attempt"; flow:to_server,established; content:"Authorization|3A| Basic"; http_header; pcre:"/^Authorization\x3a(\s*|\s*\r?\n\s+)Basic\s+=/smiH"; reference:bugtraq,10780; reference:cve,2004-0600; classtype:web-application-attack; sid:2597; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC IBM Net.Commerce orderdspc.d2w access"; flow:established,to_server; content:"/ncommerce3/ExecMacro/orderdspc.d2w"; http_uri; reference:bugtraq,2350; reference:cve,2001-0319; reference:nessus,11020; classtype:web-application-activity; sid:1820; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media encryption sample ID header RCE attempt"; flow:to_client,established; flowbits:isset,http.asf; content:"|CB A5 E6 14 72 C6 32 43 83 99 A9 69 52 06 5B 5A|"; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,objectsize,relative,little; content:"N|B8 98|f|FA 0A|0C|AE B2 1C 0A 98 D7 A4|M"; distance:68; fast_pattern; byte_test:4,>,objectsize,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2498; reference:url,www.microsoft.com/technet/security/bulletin/ms09-047.mspx; classtype:attempted-user; sid:19449; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Symantec AppStream Client LaunchObj ActiveX clsid access"; flow:established,to_client; file_data; content:"3356DB7C-58A7-11D4-AA5C-006097314BF8"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3356DB7C-58A7-11D4-AA5C-006097314BF8\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(installAppMgr|installAppMgr2|upgradeAsNeeded|upgradeAsNeededEx)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3356DB7C-58A7-11D4-AA5C-006097314BF8\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(installAppMgr|installAppMgr2|upgradeAsNeeded|upgradeAsNeededEx))/siO"; metadata:policy security-ips drop; reference:bugtraq,33247; reference:cve,2008-4388; classtype:attempted-user; sid:17051; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Database Tools Query Designer V7.0 ActiveX function call access"; flow:established,to_client; file_data; content:"MSVDTQueryDesigne"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22MSVDTQueryDesigne\x22|\x27MSVDTQueryDesigne\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22MSVDTQueryDesigne\x22|\x27MSVDTQueryDesigne\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14328; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer http status response memory corruption vulnerability"; flow:to_client,established; content:"HTTP/1"; depth:6; content:"449"; within:10; fast_pattern; pcre:"/^http\/1\x2e[01][ \t]+449/i"; reference:cve,2008-2256; reference:url,www.microsoft.com/technet/security/bulletin/MS08-045.mspx; classtype:attempted-user; sid:13980; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS .cdx HTTP header buffer overflow attempt"; flow:to_server,established; content:"HTTP/"; content:".cdx"; fast_pattern; http_uri; content:"|3A|"; content:"|0A|"; content:"|00|"; reference:bugtraq,4476; reference:cve,2002-0150; reference:nessus,10936; reference:url,www.microsoft.com/technet/security/bulletin/MS02-018.mspx; classtype:web-application-attack; sid:1804; rev:17;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; content:".distz"; http_uri; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Edistz/smi"; reference:cve,2007-0465; classtype:attempted-admin; sid:16003; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Office PowerPoint improper filename remote code execution attempt"; flow:to_server,established; content:".ppt"; http_uri; pcre:"/[^\x5C\x2F\x3A\x2A\x3F\x22\x3C\x3E\x7C\x3D\s]{256}\x2Eppt($|\x3f)/Ui"; metadata:policy balanced-ips alert, policy security-ips alert, service http; reference:cve,2010-0029; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:16409; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT local resource redirection attempt"; flow:to_client,established; content:"Location|3A|"; http_header; pcre:"/^Location\x3a(\s*|\s*\r?\n\s+)*URL\s*\x3a/smiH"; reference:cve,2004-0549; reference:url,www.kb.cert.org/vuls/id/713878; classtype:attempted-user; sid:2577; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS malicious ASP file upload attempt"; flow:established,to_server; content:"Content-Disposition|3A| form-data"; http_header; content:"filename="; http_header; content:"<!--|23|include"; distance:0; fast_pattern; pcre:"/filename\x3d\x22[^\x22]*asp/smiH"; pcre:"/\x3c\x21\x2d\x2d\x23include\s+file\s*=\s*.{250,}-->/smi"; reference:bugtraq,18858; reference:cve,2006-0026; reference:url,www.microsoft.com/technet/security/bulletin/ms06-034.mspx; classtype:attempted-user; sid:12595; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel ExternName record stack buffer overflow attempt - 2"; flow:to_client,established; flowbits:isset,http.xls; content:"|AE 01|"; byte_jump:2,0,relative,little; content:"|23 00|"; within:2; byte_test:2,>,250,0,relative,little; byte_test:2,<,8225,0,relative,little; byte_test:1,!&,0x01,0,relative; byte_test:1,&,0x01,7,relative; byte_test:1,!&,0x08,7,relative; content:"|01 00|"; within:2; distance:10; reference:cve,2010-1249; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16651; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 443 (msg:"WEB-MISC SSLv2 Client_Hello with pad Challenge Length overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; byte_test:1,<,128,0; content:"|01|"; depth:1; offset:3; byte_test:2,<,768,4; flowbits:set,sslv2.client_hello.request; byte_test:2,>,32,10; classtype:attempted-admin; sid:2657; rev:13;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI Amaya templates sendtemp.pl directory traversal attempt"; flow:to_server,established; content:"/sendtemp.pl"; fast_pattern; http_uri; content:"templ="; reference:bugtraq,2504; reference:cve,2001-0272; reference:nessus,10614; classtype:web-application-attack; sid:899; rev:16;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS foxweb.exe access"; flow:to_server,established; content:"/foxweb.exe"; fast_pattern; http_uri; reference:nessus,11939; classtype:web-application-activity; sid:2321; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbContext Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmdbCOM.VmdbContext"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmdbCOM\.VmdbContext\x22|\x27vmdbCOM\.VmdbContext\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmdbCOM\.VmdbContext\x22|\x27vmdbCOM\.VmdbContext\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14332; rev:7;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Microsoft Windows CSRSS NULL Fontface pointer attempt"; flow:to_client,established; content:"|74 02 EB 19 68 00 00 01 00 0F B7 45 EC 50 68 D0 F0 42 00 E8 DA F3 FF FF 83 C4 0C EB A1 0F B7 45|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1282; reference:url,www.microsoft.com/technet/security/bulletin/MS11-056.mspx; classtype:attempted-user; sid:19461; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC Microsoft Windows GDIplus integer overflow attempt"; flow:to_client,established; content:"|01 00 00 00|"; content:"|20|EMF"; within:4; distance:36; content:"|45 4D 46 2B 08 40|"; pcre:"/\x45\x4d\x46\x2b\x08\x40.(\x06|\x86).{28}([\xf4-\xff]\xff\xff(\xff|\x7f)|[\x00-\x06]\x00\x00\x80)/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34250; reference:cve,2009-1217; classtype:misc-activity; sid:16679; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX EDraw Office Viewer ActiveX function call access"; flow:established,to_client; file_data; content:"EDrawOfficeViewer.EDrawOfficeViewerCtrl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22EDrawOfficeViewer\.EDrawOfficeViewerCtrl\x22|\x27EDrawOfficeViewer\.EDrawOfficeViewerCtrl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(DeleteLocalFile|HttpDownloadFile)\s*|.*(?P=v)\s*\.\s*(DeleteLocalFile|HttpDownloadFile)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22EDrawOfficeViewer\.EDrawOfficeViewerCtrl\x22|\x27EDrawOfficeViewer\.EDrawOfficeViewerCtrl\x27)\s*\)(\s*\.\s*(DeleteLocalFile|HttpDownloadFile)\s*|.*(?P=n)\s*\.\s*(DeleteLocalFile|HttpDownloadFile)\s*)\s*\(/smi"; reference:bugtraq,24229; reference:bugtraq,24230; reference:url,moaxb.blogspot.com/2007/05/moaxb-28-edraw-office-viewer-component.html; reference:url,moaxb.blogspot.com/2007/05/moaxb-29-edraw-office-viewer-component.html; classtype:attempted-user; sid:11662; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC cpshost.dll access"; flow:to_server,established; content:"/scripts/cpshost.dll"; http_uri; reference:bugtraq,1811; reference:bugtraq,4002; reference:cve,1999-0360; classtype:attempted-recon; sid:1128; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS CGImail.exe access"; flow:to_server,established; content:"/scripts/CGImail.exe"; fast_pattern; http_uri; reference:bugtraq,1623; reference:cve,2000-0726; reference:nessus,11721; classtype:web-application-activity; sid:980; rev:16;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC newsscript.pl admin attempt"; flow:to_server,established; content:"/newsscript.pl"; http_uri; content:"mode=admin"; reference:bugtraq,12761; reference:cve,2005-0735; reference:nessus,17309; classtype:web-application-attack; sid:3676; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI tst.bat access"; flow:to_server,established; content:"/tst.bat"; http_uri; reference:bugtraq,770; reference:cve,1999-0885; reference:nessus,10014; classtype:web-application-activity; sid:1650; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Vivotek RTSP MPEG4 SP Control ActiveX clsid access"; flow:established,to_client; file_data; content:"45830FF9-D9E6-4F41-86ED-B266933D8E90"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m5>\x22|\x27|)(?P<id1>.+?)(?P=m5)(\s|>)[^>]*\s*classid\s*=\s*(?P<q11>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*45830FF9-D9E6-4F41-86ED-B266933D8E90\s*}?\s*(?P=q11)(\s|>).*(?P=id1)\s*\.\s*(url)|<object\s*[^>]*\s*classid\s*=\s*(?P<q12>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*45830FF9-D9E6-4F41-86ED-B266933D8E90\s*}?\s*(?P=q12)(\s|>)[^>]*\s*id\s*=\s*(?P<m6>\x22|\x27|)(?P<id2>.+?)(?P=m6)(\s|>).*(?P=id2)\s*\.\s*(url))\s*=/si"; metadata:policy security-ips drop; reference:bugtraq,28010; classtype:attempted-user; sid:13535; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Movie Maker hhctrl.ocx dll-load exploit attempt"; flow:to_server,established; content:"|2F|hhctrl.ocx"; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3967; reference:url,www.microsoft.com/technet/security/bulletin/MS10-093.mspx; classtype:attempted-user; sid:18210; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VeryDOC PDF Viewer ActiveX clsid access"; flow:established,to_client; file_data; content:"433268D7-2CD4-43E6-AA24-2188672E7252"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*433268D7-2CD4-43E6-AA24-2188672E7252\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(OpenPDF)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*433268D7-2CD4-43E6-AA24-2188672E7252\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(OpenPDF))/siO"; metadata:policy security-ips drop; reference:bugtraq,32313; reference:cve,2008-5492; classtype:attempted-user; sid:17087; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Toolbar Helper Class ActiveX function call access"; flow:established,to_client; file_data; content:"yt.ythelper"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22yt\.ythelper\x22|\x27yt\.ythelper\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*c\s*|.*(?P=v)\s*\.\s*c\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22yt\.ythelper\x22|\x27yt\.ythelper\x27)\s*\)(\s*\.\s*c\s*|.*(?P=n)\s*\.\s*c\s*)\s*\(/smi"; metadata:policy security-ips alert; reference:bugtraq,26656; reference:cve,2007-6228; classtype:attempted-user; sid:12764; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Internet Explorer Install Engine ActiveX clsid access"; flow:established,to_client; file_data; content:"6E449683-C509-11CF-AAFA-00AA00B6015C"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6E449683-C509-11CF-AAFA-00AA00B6015C\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(BaseUrl|SetCifFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6E449683-C509-11CF-AAFA-00AA00B6015C\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(BaseUrl|SetCifFile))/siO"; metadata:policy security-ips drop; reference:bugtraq,11366; reference:cve,2004-0216; reference:url,www.microsoft.com/technet/security/Bulletin/MS04-038.mspx; classtype:attempted-user; sid:17588; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader icc mluc interger overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"mluc|00 00 00 00|"; byte_test:4,>,357913941,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,43729; reference:cve,2010-3622; classtype:attempted-user; sid:18308; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Art drawing invalid shape identifier attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|0A F0 08 00 00 00|"; fast_pattern; byte_test:1,=,0x2,-8,relative; byte_test:4,>,0x03FFD7FF,0,relative,little; metadata:policy security-ips drop; reference:cve,2010-3336; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:18069; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI calender_admin.pl access"; flow:to_server,established; content:"/calender_admin.pl"; fast_pattern; http_uri; reference:cve,2000-0432; reference:nessus,10506; classtype:attempted-recon; sid:1456; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows ATMFD font driver remote code execution attempt"; flow:to_client,established; flowbits:isset,http.otf; file_data; content:"|01 00 04 04 00 01 01 01 03 49 57 00 01 02 80 01 00 40 F8 0F|"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2010-3957; reference:url,www.microsoft.com/technet/security/bulletin/MS10-091.mspx; classtype:attempted-user; sid:18219; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX MSAuth ActiveX function call access"; flow:established,to_client; file_data; content:"NMSA.SessionDescription"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22NMSA\.SessionDescription\x22|\x27NMSA\.SessionDescription\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*SaveAs\s*|.*(?P=v)\s*\.\s*SaveAs\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22NMSA\.SessionDescription\x22|\x27NMSA\.SessionDescription\x27)\s*\)(\s*\.\s*SaveAs\s*|.*(?P=n)\s*\.\s*SaveAs\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:cve,2007-2221; reference:url,www.microsoft.com/technet/security/bulletin/ms07-027.mspx; classtype:attempted-user; sid:11226; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX McAfee NeoTrace ActiveX clsid access"; flow:established,to_client; file_data; content:"3E1DD897-F300-486C-BEAF-711183773554"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3E1DD897-F300-486C-BEAF-711183773554\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(TraceTarget)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3E1DD897-F300-486C-BEAF-711183773554\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(TraceTarget))\s*\(/siO"; reference:bugtraq,21697; reference:cve,2006-6707; classtype:attempted-user; sid:12087; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Direct Speech Recognition ActiveX clsid access"; flow:established,to_client; file_data; content:"4E3D9D1F-0C63-11D1-8BFB-0060081841DE"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m3>\x22|\x27|)(?P<id1>.+?)(?P=m3)(\s|>)[^>]*\s*classid\s*=\s*(?P<q6>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4E3D9D1F-0C63-11D1-8BFB-0060081841DE\s*}?\s*(?P=q6)(\s|>).*(?P=id1)\s*\.\s*(Find)|<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4E3D9D1F-0C63-11D1-8BFB-0060081841DE\s*}?\s*(?P=q7)(\s|>)[^>]*\s*id\s*=\s*(?P<m4>\x22|\x27|)(?P<id2>.+?)(?P=m4)(\s|>).*(?P=id2)\.(Find))\s*\(/Osi"; reference:cve,2007-2222; reference:url,www.microsoft.com/technet/security/bulletin/ms07-034.mspx; classtype:attempted-user; sid:11830; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Cisco Secure Access Control Server UCP Application CSuserCGI.exe buffer overflow attempt"; flow:to_server,established; content:"/CSuserCGI.exe?Logout"; http_uri; pcre:"/\x2FCSuserCGI\x2Eexe\x3FLogout.[^\s]{96}/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28222; reference:cve,2008-0532; reference:url,www.cisco.com/warp/public/707/cisco-sa-20080312-ucp.shtml; classtype:attempted-admin; sid:13656; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 81 (msg:"WEB-MISC McAfee header buffer overflow attempt"; flow:established,to_server; content:"AgentGuid="; pcre:"/^[^\x3e\x3f\x26]{63}/R"; content:"Source="; pcre:"/^[^\x3e\x3f\x26]{50}/R"; reference:bugtraq,20288; reference:cve,2006-5156; classtype:attempted-admin; sid:8441; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP Photo Creative ActiveX clsid access"; flow:established,to_client; file_data; content:"3EEEBC9A-580F-46EF-81D9-55510266413D"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3EEEBC9A-580F-46EF-81D9-55510266413D\s*}?\s*(?P=q1)(\s|>)/siO"; metadata:policy security-ips drop; reference:bugtraq,45631; classtype:attempted-user; sid:19214; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF multipacket heap overflow - NETSCAPE2.0"; flow:to_client,established; flowbits:isset,file.gif; content:"GIF"; content:"!|FF 0B|NETSCAPE2.0"; distance:0; content:"|02|"; within:1; distance:1; byte_test:4,>,0x7f,3,relative; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:3536; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat XML entity escape attempt"; flow:to_client,established; content:"<|21|ENTITY"; content:"SYSTEM"; within:50; content:"http|3A 2F 2F|"; within:50; content:"http|3A 2F 2F|"; within:500; pcre:"/<\x21ENTITY[^>]+SYSTEM[^>]+http\x3A\x2F\x2F[^>\s]+http\x3A\x2F\x2F/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-0604; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18456; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX https Asychronous Pluggable Protocol Handler ActiveX clsid access"; flow:established,to_client; file_data; content:"79EAC9E5-BAF9-11CE-8C82-00AA004BA90B"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q7>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*79EAC9E5-BAF9-11CE-8C82-00AA004BA90B\s*}?\s*(?P=q7)(\s|>)/si"; metadata:policy security-ips drop; reference:cve,2007-0218; reference:url,www.microsoft.com/technet/security/bulletin/MS07-033.mspx; classtype:attempted-user; sid:7944; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 (msg:"WEB-MISC SSLv2 OpenSSl KEY_ARG buffer overflow attempt"; flow:to_server,established; ssl_version:sslv2; ssl_state:client_keyx; content:"|02|"; depth:1; offset:2; byte_test:2,>,8,7,relative; reference:bugtraq,5362; reference:cve,2002-0656; classtype:misc-attack; sid:10997; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC cacti graph_image.php access"; flow:to_server,established; content:"/cacti/graph_image.php"; http_uri; reference:bugtraq,14042; classtype:web-application-activity; sid:4650; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT  QuickTime JPEG Huffman Table integer underflow attempt"; flow:to_client,established; flowbits:isset,file.jpeg; content:"|FF C4 02 11 00 FF FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; reference:bugtraq,12905; reference:cve,2005-0903; classtype:attempted-user; sid:10126; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS IISProtect access"; flow:to_server,established; content:"/iisprotect/admin/"; fast_pattern; http_uri; reference:nessus,11661; classtype:web-application-activity; sid:2131; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX LEADTOOLS Raster Twain LtocxTwainu.dll ActiveX clsid access"; flow:established,to_client; file_data; content:"00165752-B1BA-11CE-ABC6-F5B2E79D9E3F"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,42823; classtype:attempted-user; sid:19085; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Repository Property Definition ActiveX object access"; flow:established,to_client; file_data; content:"6E22710C-F799-11CF-9227-00AA00A1EB95"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*6E22710C-F799-11CF-9227-00AA00A1EB95/si"; metadata:policy security-ips drop; reference:cve,2005-2831; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4909; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [8004,8005] (msg:"WEB-MISC Symantec Scan Engine authentication bypass attempt"; flow:to_server,established; content:"<key mod=|22|784607708866"; content:"pub=|22|75429754206"; metadata:policy security-ips drop; reference:bugtraq,17637; reference:cve,2006-0230; classtype:attempted-recon; sid:16056; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media sample duration header RCE attempt"; flow:to_client,established; flowbits:isset,http.asf; content:"|CB A5 E6 14 72 C6 32 43 83 99 A9 69 52 06 5B 5A|"; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,objectsize,relative,little; content:"P|94 BD C6 7F 86 07|I|83 A3 C7|y!|B7|3|AD|"; distance:68; fast_pattern; byte_test:4,>,objectsize,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2498; reference:url,www.microsoft.com/technet/security/bulletin/ms09-047.mspx; classtype:attempted-user; sid:19444; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft MPEG-4 Video Decompressor Property Page ActiveX object access"; flow:established,to_client; file_data; content:"598EBA02-B49A-11D2-A1C1-00609778EA66"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*598EBA02-B49A-11D2-A1C1-00609778EA66/si"; metadata:policy security-ips drop; reference:cve,2005-2127; reference:url,www.microsoft.com/technet/security/bulletin/MS05-052.mspx; classtype:attempted-user; sid:4206; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX FlexLabel ActiveX clsid access"; flow:established,to_client; file_data; content:"584B432E-E0BD-4A78-BD77-665591DA84BB"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q8>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*584B432E-E0BD-4A78-BD77-665591DA84BB\s*}?\s*(?P=q8)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.securityfocus.com/archive/1/468070; classtype:attempted-user; sid:11280; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC ddicgi.exe access"; flow:to_server,established; content:"/ddicgi.exe"; http_uri; reference:bugtraq,1657; reference:cve,2000-0826; reference:nessus,11728; classtype:web-application-activity; sid:2242; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS register.asp access"; flow:to_server,established; content:"/register.asp"; fast_pattern; http_uri; reference:nessus,11621; classtype:web-application-activity; sid:2134; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT readme.eml autoload attempt"; flow:to_client,established; content:"window.open|28 22|readme.eml|22|"; reference:url,www.cert.org/advisories/CA-2001-26.html; classtype:attempted-user; sid:1290; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI cached_feed.cgi moreover shopping cart directory traversal"; flow:to_server,established; content:"/cached_feed.cgi"; http_uri; content:"../"; reference:bugtraq,1762; reference:cve,2000-0906; classtype:web-application-attack; sid:1093; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer JPEG Decoder Vulnerabilities attempt"; flow:to_client,established; file_data; content:"|FF D8 FF|"; content:"|FF DA|"; distance:0; content:"|03|"; within:1; distance:2; content:"|01 00 02 11 01|"; within:5; metadata:policy security-ips drop; reference:bugtraq,14282; reference:cve,2005-1998; reference:cve,2005-2308; classtype:attempted-user; sid:17355; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC VirusWall catinfo access"; flow:to_server,established; content:"/catinfo"; http_uri; reference:bugtraq,2579; reference:bugtraq,2808; reference:cve,2001-0432; reference:nessus,10650; classtype:attempted-recon; sid:1231; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Persits Software XUpload ActiveX function call access"; flow:established,to_client; file_data; content:"Persits.XUpload"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22Persits\.XUpload(\.\d)?\x22|\x27Persits\.XUpload(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*(AddFolder|AddFile|MakeHttpRequest)\s*|.*(?P=v)\s*\.\s*(AddFolder|AddFile|MakeHttpRequest)\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22Persits\.XUpload(\.\d)?\x22|\x27Persits\.XUpload(\.\d)?\x27)\s*\)(\s*\.\s*(AddFolder|AddFile|MakeHttpRequest)\s*|.*(?P=n)\s*\.\s*(AddFolder|AddFile|MakeHttpRequest)\s*)\s*\(/siO"; reference:bugtraq,27025; reference:bugtraq,27456; reference:bugtraq,36550; reference:cve,2007-6530; reference:cve,2008-0492; reference:cve,2009-3693; classtype:attempted-user; sid:13234; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Webtrends HTTP probe"; flow:to_server,established; content:"User-Agent|3A| Webtrends Security Analyzer|0D 0A|"; http_header; reference:arachnids,309; classtype:web-application-activity; sid:1101; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Yahoo Toolbar Helper Class ActiveX clsid access"; flow:established,to_client; file_data; content:"02478D38-C3F9-4EFB-9B51-7695ECA05670"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*02478D38-C3F9-4EFB-9B51-7695ECA05670\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(c)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*02478D38-C3F9-4EFB-9B51-7695ECA05670\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(c))\s*\(/si"; metadata:policy security-ips alert; reference:bugtraq,26656; reference:cve,2007-6228; classtype:attempted-user; sid:12762; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 40 ActiveX clsid access"; flow:established,to_client; file_data; content:"C5702CD0-9B79-11D3-B654-00C04F79498E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q69>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C5702CD0-9B79-11D3-B654-00C04F79498E\s*}?\s*(?P=q69)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15656; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC encoded cross site scripting HTML Image tag set to javascript attempt"; flow:to_server,established; content:"img src=javascript"; http_uri; reference:bugtraq,4858; reference:cve,2002-0902; classtype:web-application-attack; sid:7071; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI ezadmin.cgi access"; flow:to_server,established; content:"/ezadmin.cgi"; fast_pattern; http_uri; reference:bugtraq,4068; reference:bugtraq,4579; reference:cve,2002-0263; reference:nessus,11748; classtype:web-application-activity; sid:2204; rev:13;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP openview network node manager ovlogin.exe buffer overflow - password parameter"; flow:to_server,established; content:"/ovlogin.exe"; http_uri; content:"password="; http_client_body; pcre:"/password=[^\x26\r\n]{128}/Psmi"; metadata:policy security-ips drop; reference:bugtraq,37330; reference:cve,2009-4176; reference:url,h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c01950877; classtype:attempted-admin; sid:18481; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS UploadScript11.asp access"; flow:to_server,established; content:"/UploadScript11.asp"; fast_pattern; http_uri; reference:bugtraq,3608; reference:cve,2001-0938; reference:nessus,11746; classtype:web-application-activity; sid:2247; rev:12;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION fileexists.cfm access"; flow:to_server,established; content:"/cfdocs/snippets/fileexists.cfm"; fast_pattern; http_uri; reference:bugtraq,550; reference:cve,1999-0760; classtype:attempted-recon; sid:910; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX NCTsoft NCTAudioFile2 NCTWMAFile ActiveX clsid access"; flow:established,to_client; file_data; content:"6ED74AE3-8066-4385-AABA-243E033F75A3"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6ED74AE3-8066-4385-AABA-243E033F75A3\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(CreateFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6ED74AE3-8066-4385-AABA-243E033F75A3\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(CreateFile))\s*\(/si"; reference:bugtraq,24613; reference:url,nctsoft.com/products/NCTAudioEditor2/; classtype:attempted-user; sid:12019; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Vector Markup Language fill method overflow attempt"; flow:to_client,established; content:"|3A 00|f|00|i|00|l|00|l|00|"; content:"m|00|e|00|t|00|h|00|o|00|d|00|"; distance:0; pcre:"/<\x00(\w\x00)+\x3a\x00f\x00i\x00l\x00l\x00\s\x00([^>]\x00|>[^\x00])*m\x00e\x00t\x00h\x00o\x00d\x00(\s\x00)*=\x00(\s\x00)*(\x27\x00([^\x27]\x00|\x27[^\x00]){100}|\x22\x00([^\x22]\x00|\x22[^\x00]){100}|([^\s>]\x00|[\s>][^\x00]){100})/i"; metadata:policy security-ips drop; reference:bugtraq,20096; reference:cve,2006-4868; reference:url,www.microsoft.com/technet/security/bulletin/ms06-055.mspx; classtype:attempted-user; sid:18309; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel format record code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|1E 04|"; byte_test:2,>,392,2,relative,little; byte_test:2,>,4,0,relative,little; byte_jump:2,0,relative,little; pcre:"/^(\x1E\x04|\xE0\x00)/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3005; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-043.mspx; classtype:attempted-user; sid:19552; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 554 (msg:"WEB-MISC Real Server DESCRIBE buffer overflow attempt"; flow:to_server,established; content:"DESCRIBE"; content:"../"; distance:1; pcre:"/^DESCRIBE\s[^\n]{300}/smi"; reference:bugtraq,8476; reference:cve,2003-0725; reference:nessus,11642; reference:url,www.service.real.com/help/faq/security/rootexploit091103.html; classtype:web-application-attack; sid:2411; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DACamera.1 ActiveX function call access"; flow:established,to_client; file_data; content:"DirectAnimation.DACamera.1"; fast_pattern:only; pcre:"/new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*(\x22DirectAnimation.DACamera.1\x22|\x27DirectAnimation.DACamera.1\x27)[\r\n\s]*\)|(\w+)[\r\n\s]*=[\r\n\s]*(\x22DirectAnimation.DACamera.1\x22|\x27DirectAnimation.DACamera.1\x27)[\r\n\s]*\x3b.*new[\r\n\s]*ActiveXObject[\r\n\s]*\([\r\n\s]*\1[\r\n\s]*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8833; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Office Data Source Control 10.0 ActiveX clsid access"; flow:established,to_client; file_data; content:"0002E553-0000-0000-C000-000000000046"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0002E553-0000-0000-C000-000000000046\s*}?\s*(?P=q1)(\s|>)/siO"; metadata:policy security-ips drop; reference:bugtraq,35800; reference:bugtraq,35990; reference:cve,2002-0727; reference:cve,2002-0861; reference:cve,2009-0562; reference:url,www.microsoft.com/technet/security/Bulletin/MS02-044.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS09-043.mspx; classtype:attempted-user; sid:7876; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC WEB-INF access"; flow:established,to_server; content:"/WEB-INF"; http_uri; reference:bugtraq,1830; reference:bugtraq,5119; reference:cve,2000-1050; reference:cve,2001-0179; reference:nessus,11037; classtype:web-application-activity; sid:1826; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX AcroPDF.PDF ActiveX clsid access"; flow:established,to_client; file_data; content:"CA8A9780-280D-11CF-A24D-444553540000"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CA8A9780-280D-11CF-A24D-444553540000\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(execCommand|LoadFile|src|setLayoutMode|setNamedDest|setPageMode)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*CA8A9780-280D-11CF-A24D-444553540000\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(execCommand|LoadFile|src|setLayoutMode|setNamedDest|setPageMode))/siO"; metadata:policy security-ips drop; reference:bugtraq,21155; reference:cve,2005-0035; reference:cve,2006-6027; reference:cve,2006-6236; reference:url,www.adobe.com/support/security/advisories/apsa06-02.html; classtype:attempted-user; sid:9626; rev:10;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI admin.pl access"; flow:to_server,established; content:"/admin.pl"; fast_pattern; http_uri; reference:bugtraq,3839; reference:cve,2002-1748; reference:url,online.securityfocus.com/archive/1/249355; classtype:attempted-recon; sid:879; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla NNTP URL Handling Buffer Overflow attempt"; flow:to_client,established; content:"news|3A 2F 2F|"; pcre:"/news\x3a\x2f\x2f.*?\x2f?(profile|search).*?\x2f.*?\x5c[^\s\x22\x27]{0,1}/si"; metadata:policy security-ips drop; reference:bugtraq,12131; reference:cve,2004-1316; classtype:attempted-user; sid:17482; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP eSupportDiagnostics 12 ActiveX clsid access"; flow:established,to_client; file_data; content:"AB049B11-607B-46C8-BBF7-F4D6AF301046"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q8>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*AB049B11-607B-46C8-BBF7-F4D6AF301046\s*}?\s*(?P=q8)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28929; reference:cve,2008-0712; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13738; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAColor.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BC6-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BC6-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8828; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI ws_mail.cgi access"; flow:to_server,established; content:"/ws_mail.cgi"; fast_pattern; http_uri; reference:bugtraq,2861; reference:bugtraq,4579; reference:cve,2001-1343; reference:nessus,11748; classtype:web-application-activity; sid:2221; rev:13;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP Intelligent Management Center database credentials information disclosure attempt - 1"; flow:to_server,established; content:"/imc/reportscript/sqlserver/deploypara.properties"; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40298; reference:url,secunia.com/advisories/39891; classtype:attempted-user; sid:17157; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP eSupportDiagnostics 9 ActiveX clsid access"; flow:established,to_client; file_data; content:"910E7ADE-7F75-402D-A4A6-BB1A82362FCA"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q43>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*910E7ADE-7F75-402D-A4A6-BB1A82362FCA\s*}?\s*(?P=q43)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28929; reference:cve,2008-0712; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13732; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI zsh access"; flow:to_server,established; content:"/zsh"; fast_pattern; http_uri; reference:cve,1999-0509; reference:url,www.cert.org/advisories/CA-1996-11.html; classtype:attempted-recon; sid:1309; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX HP eSupportDiagnostics 16 ActiveX clsid access"; flow:established,to_client; file_data; content:"C70D0641-DDE1-4FD7-A4D4-DA187B80741D"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q16>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C70D0641-DDE1-4FD7-A4D4-DA187B80741D\s*}?\s*(?P=q16)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,28929; reference:cve,2008-0712; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:13746; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Eyeball MessengerSDK ActiveX function call access"; flow:established,to_client; file_data; content:"EyeballSdk.VideoWindowCtl"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22EyeballSdk\.VideoWindowCtl\x22|\x27EyeballSdk\.VideoWindowCtl\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*BgColor\s*|.*(?P=v)\s*\.\s*BgColor\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22EyeballSdk\.VideoWindowCtl\x22|\x27EyeballSdk\.VideoWindowCtl\x27)\s*\)(\s*\.\s*BgColor\s*|.*(?P=n)\s*\.\s*BgColor\s*)\s*\(/smi"; metadata:policy security-ips drop; reference:bugtraq,30424; reference:cve,2008-3430; classtype:attempted-user; sid:14249; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.Chroma ActiveX clsid access"; flow:established,to_client; file_data; content:"421516C1-3CF8-11D2-952A-00C04FA34F05"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*421516C1-3CF8-11D2-952A-00C04FA34F05\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy security-ips drop; reference:bugtraq,24188; reference:url,www.securityfocus.com/archive/1/443907; classtype:attempted-user; sid:7908; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DirectAnimation.DAPoint3.1 ActiveX clsid access"; flow:established,to_client; file_data; content:"C46C1BD8-3C52-11D0-9200-848C1D000000"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*C46C1BD8-3C52-11D0-9200-848C1D000000/si"; metadata:policy security-ips drop; reference:cve,2006-4446; reference:cve,2006-4777; reference:url,www.microsoft.com/technet/security/bulletin/MS06-067.mspx; classtype:attempted-user; sid:8789; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel MSO.DLL malformed string parsing multi byte buffer over attempt"; flow:to_client,established; file_data; content:"|00 00 00 00 00 00 1D 00 0F 00 03 00 00 00|"; content:"|00|"; within:1; distance:2; isdataat:6,relative; content:!"|00 00 00 00 00|"; within:5; distance:1; metadata:policy security-ips drop; reference:bugtraq,17252; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7198; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC Netscape Enterprise Server directory view"; flow:to_server,established; content:"?wp-html-rend"; http_uri; reference:bugtraq,1063; reference:cve,2000-0236; classtype:attempted-recon; sid:1191; rev:11;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-FRONTPAGE dvwssr.dll access"; flow:to_server,established; content:"/dvwssr.dll"; fast_pattern; http_uri; reference:arachnids,271; reference:bugtraq,1108; reference:bugtraq,1109; reference:cve,2000-0260; reference:nessus,10369; reference:url,www.microsoft.com/technet/security/bulletin/ms00-025.mspx; classtype:web-application-activity; sid:967; rev:19;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player recursive stack overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; file_data; content:"|42 1B EB 68 C4 A9 39 96 95 4B 0E 39 71 A9 9E E8 72 CE 38 A4 3B C4 92 4B|"; metadata:policy security-ips drop; reference:cve,2011-2426; reference:url,www.adobe.com/support/security/bulletins/apsb11-26.html; classtype:attempted-user; sid:20211; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash ActionStoreRegister instruction length invalidation attempt"; flow:to_client,established; flowbits:isset, http.swf; content:"|00 04 03 08 61 4E 12 12 9D 02 00 4D 02 96 06 00 04 03 08 61 05 01 4F 96 02 00 08 12 1C 96 02 00|"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2011-2414; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-admin; sid:19687; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC mall log order access"; flow:to_server,established; content:"/mall_log_files/order.log"; http_uri; reference:bugtraq,2266; reference:cve,1999-0606; classtype:attempted-recon; sid:1168; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Shockwave ActiveX Control ActiveX clsid access"; flow:established,to_client; file_data; content:"233C1507-6A77-46A4-9443-F871F945D258"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*233C1507-6A77-46A4-9443-F871F945D258\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(BGCOLOR|SRC|AutoStart|Sound|DrawLogo|DrawPress)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*233C1507-6A77-46A4-9443-F871F945D258\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(BGCOLOR|SRC|AutoStart|Sound|DrawLogo|DrawPress))/siO"; metadata:policy security-ips drop; reference:bugtraq,22067; reference:bugtraq,22842; reference:cve,2006-6885; classtype:attempted-user; sid:10214; rev:7;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for login.yahoo.com detected"; flow:to_client,established; ssl_state:server_hello; content:"login.yahoo.com"; content:"|39 2A 43 4F 0E 07 DF 1F 8A A3 05 DE 34 E0 C2 29|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18568; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer XSS mouseevent PII disclosure attempt"; flow:to_client,established; content:"Content-Type|3A| text/html"; content:"setcapture|28 29|"; distance:0; fast_pattern; content:"onclick="; content:"event"; content:"srcelement"; distance:0; pcre:"/(\w+)\x2esetcapture\x28\x29.*\1[^\x3e]*onclick\x3d/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3473; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-053.mspx; classtype:web-application-activity; sid:14656; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX RegVmsCtl Class ActiveX clsid access"; flow:established,to_client; file_data; content:"6bc34d15-ee92-46b3-8c6a-03de589ab727"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6bc34d15-ee92-46b3-8c6a-03de589ab727\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14406; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-MISC cookiejacking attempt"; flow:established,to_client; content:"<"; content:"file|3A 5C 5C|127.0.0.1"; distance:0; pcre:"/<\s*[A-Z]+\s+[^>]*file\x3A\x5C\x5C127\x2e0\x2e0\x2e1/smi"; reference:url,www.soom.cz/index.php?name=articles/show&aid=550; classtype:attempted-recon; sid:19176; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC VirusWall FtpSaveCVP access"; flow:to_server,established; content:"/FtpSaveCVP.dll"; http_uri; reference:bugtraq,2808; reference:cve,2001-0432; reference:nessus,10733; classtype:attempted-recon; sid:1235; rev:12;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3037 (msg:"WEB-MISC Novell File Reporter Agent XMLK parsing stack bugger overflow attempt"; flow:established,to_server; content:"|3C|NAME|3E|"; isdataat:41; pcre:"/^[^\x3c\2f]{41}/R"; reference:bugtraq,47144; reference:cve,2011-0994; classtype:attempted-admin; sid:19813; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes PLS file parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.pls; content:"[playlist]"; content:"File"; distance:0; pcre:"/^File\d+\s*\x3D\s*[^\x2E\r\n]+\x2E[^\r\n]{32}/mi"; metadata:policy security-ips drop; reference:bugtraq,36478; reference:cve,2009-2817; classtype:attempted-user; sid:19560; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView NNM ovlogin.exe CGI passwd parameter buffer overflow attempt"; flow:to_server,established; content:"/OvCgi/ovlogin|2E|exe"; fast_pattern:only; http_uri; content:"passwd|3D|"; http_client_body; isdataat:29,relative; pcre:"/passwd\x3D[^\x26\x3F\x3B\x0D\x0A]{29}/iP"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3846; reference:url,h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c01950877; classtype:attempted-user; sid:20180; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash MP4 ref_frame allocated buffer overflow attempt"; flow:to_client,established; content:"NetStream"; content:"|16 03 16 05 16 07 18 09 16 0B 16 10 17 05 05 00 05 00 08 17 16 18 16 19 16 1A 16 1B 16 1C|"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2011-2140; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-admin; sid:19693; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Visual Basic 6 TLIApplication ActiveX function call"; flow:established,to_client; file_data; content:"TLI.TLIApplication"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2007-2216; reference:url,www.microsoft.com/technet/security/bulletin/ms07-045.mspx; classtype:attempted-user; sid:12270; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 28 ActiveX clsid access"; flow:established,to_client; file_data; content:"A2E3074E-6C3D-11D3-B653-00C04F79498E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q41>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*A2E3074E-6C3D-11D3-B653-00C04F79498E\s*}?\s*(?P=q41)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15628; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Symantec NavComUI AxSysListView32 ActiveX clsid access"; flow:established,to_client; file_data; content:"0A398EE6-277C-480D-BD4F-3288EA3AB8E2"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0A398EE6-277C-480D-BD4F-3288EA3AB8E2\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(AnomalyList)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*0A398EE6-277C-480D-BD4F-3288EA3AB8E2\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(AnomalyList))\s*=/Osi"; reference:bugtraq,24983; reference:cve,2007-2955; reference:url,www.symantec.com/avcenter/security/Content/2007.08.09.html; classtype:attempted-user; sid:12246; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC renamed zip file handling code execution attempt - 2"; flow:to_client,established; flowbits:isset,http.mp3; file_data; content:"|50 4B 03 04|"; within:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40428; classtype:attempted-user; sid:17149; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Computer Associates gui_cm_ctrls ActiveX clsid access"; flow:established,to_client; file_data; content:"E6239EB3-E0B0-46DA-A215-CFA9B3B740C5"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E6239EB3-E0B0-46DA-A215-CFA9B3B740C5\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(SetColumnColor)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*E6239EB3-E0B0-46DA-A215-CFA9B3B740C5\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(SetColumnColor))\s*\(/si"; metadata:policy security-ips drop; reference:cve,2008-1786; classtype:attempted-user; sid:14029; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed FBI record"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"`|10|"; byte_test:2,>,32767,6,relative; metadata:policy security-ips drop; reference:bugtraq,23826; reference:cve,2007-1203; reference:cve,2007-1747; reference:url,www.microsoft.com/technet/security/bulletin/ms07-023.mspx; classtype:attempted-user; sid:12256; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI multidiff.cgi access"; flow:to_server,established; content:"/multidiff.cgi"; fast_pattern; http_uri; reference:bugtraq,4579; reference:bugtraq,5517; reference:cve,2003-0153; reference:nessus,11748; classtype:web-application-activity; sid:2199; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 39 ActiveX clsid access"; flow:established,to_client; file_data; content:"C5702CCF-9B79-11D3-B654-00C04F79498E"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q65>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*C5702CCF-9B79-11D3-B654-00C04F79498E\s*}?\s*(?P=q65)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15652; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sun Microsystems Java gif handling memory corruption attempt"; flow:to_client,established; content:"|F9 04 01 00 00 10 00|,|00 00 00 00 00 00 90 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,22085; reference:cve,2007-0243; classtype:attempted-user; sid:16000; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-COLDFUSION addcontent.cfm access"; flow:to_server,established; content:"/cfdocs/exampleapp/publish/admin/addcontent.cfm"; fast_pattern; http_uri; reference:cve,2001-0535; classtype:attempted-recon; sid:907; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer stylesheet dynamic access memory corruption attempt"; flow:to_client,established; content:"addBehavior|28|"; content:".onreadystatechange"; distance:0; content:".innerHTML"; distance:0; pcre:"/([A-Z\d_]+)\.addBehavior\x28.*?\.onreadystatechange\s*=\s*function[^\x7B]+\x7B[^\x7D]*\1\.innerHTML/smi"; reference:cve,2011-1964; reference:url,www.microsoft.com/technet/security/bulletin/MS11-057.mspx; classtype:attempted-user; sid:19672; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI /cgi-dos/ access"; flow:to_server,established; content:"/cgi-dos/"; http_uri; content:"/cgi-dos/ HTTP"; fast_pattern:only; classtype:web-application-attack; sid:1669; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java GIF LZW minimum code size overflow attempt"; flow:to_client,established; file_data; content:"|F3 E1 04 30 2E 7B 0A 25 A4 58 D1 E2 45 8C 19 35 6E E4 D8 D1 E3 47 90 21 45 8E 24 59 D2 E4 49 8F|"; fast_pattern:only; reference:bugtraq,34240; reference:cve,2009-1098; classtype:attempted-user; sid:20239; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC cgiWebupdate.exe access"; flow:to_server,established; content:"/cgiWebupdate.exe"; http_uri; reference:bugtraq,3216; reference:cve,2001-1150; reference:nessus,11722; classtype:web-application-activity; sid:2237; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Research In Motion AxLoader ActiveX function call access"; flow:established,to_client; file_data; content:"RIM.AxLoader"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22RIM\.AxLoader(\.\d)?\x22|\x27RIM\.AxLoader(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22RIM\.AxLoader(\.\d)?\x22|\x27RIM\.AxLoader(\.\d)?\x27)\s*\)/smiO"; metadata:policy security-ips drop; reference:bugtraq,33663; reference:cve,2009-0305; reference:url,support.microsoft.com/kb/960715; classtype:attempted-user; sid:15313; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX BigAnt Office Manager ActiveX function call access"; flow:established,to_client; file_data; content:"AntCore.AntConsole"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22AntCore\.AntConsole(\.\d)?\x22|\x27AntCore\.AntConsole(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*RegisterCom\s*|.*(?P=v)\s*\.\s*RegisterCom\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22AntCore\.AntConsole(\.\d)?\x22|\x27AntCore\.AntConsole(\.\d)?\x27)\s*\)(\s*\.\s*RegisterCom\s*|.*(?P=n)\s*\.\s*RegisterCom\s*)/smiO"; metadata:policy security-ips drop; reference:bugtraq,39721; classtype:attempted-user; sid:17672; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Registration Wizard ActiveX object access"; flow:established,to_client; file_data; content:"50E5E3D1-C07E-11D0-B9FD-00A0249F6B00"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*50E5E3D1-C07E-11D0-B9FD-00A0249F6B00/si"; metadata:policy security-ips drop; reference:bugtraq,671; reference:url,www.microsoft.com/technet/security/bulletin/MS99-037.mspx; classtype:attempted-user; sid:4171; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft product .dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|.dll"; http_uri; reference:cve,2011-0029; reference:cve,2011-0107; reference:cve,2011-1980; reference:url,www.microsoft.com/technet/security/bulletin/MS11-017.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS11-023.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS11-073.mspx; classtype:attempted-user; sid:18495; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC Trend Micro OfficeScan Console authentication buffer overflow attempt"; flow:to_server,established; content:"/officescan/console"; fast_pattern; http_uri; content:"session="; http_cookie; pcre:"/session=[^\s\x3b&]{520}/iC"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24641; reference:bugtraq,24935; reference:cve,2007-3454; reference:cve,2007-3455; classtype:attempted-admin; sid:17295; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe BMP image handler buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.bmp; content:"image/bmp"; fast_pattern:only; http_header; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; byte_test:4, >, 256, 36, relative, little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28874; reference:cve,2008-1765; classtype:attempted-user; sid:13865; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word Crafted Sprm memory corruption attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|01 49 66 01 00 00 00 08 D6 FD FF 05 D6 18 04 01 00 00 04 01|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32584; reference:cve,2008-4837; classtype:attempted-user; sid:17591; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft PicturePusher ActiveX clsid access"; flow:established,to_client; file_data; content:"507813C3-0B26-47AD-A8C0-D483C7A21FA7"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*507813C3-0B26-47AD-A8C0-D483C7A21FA7\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(AddString|Post)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*507813C3-0B26-47AD-A8C0-D483C7A21FA7\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(AddString|Post))\s*\(/Osi"; metadata:policy security-ips drop; reference:bugtraq,31632; reference:cve,2008-4493; classtype:attempted-user; sid:14637; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Visual Basic VBP file reference overflow attempt"; flow:to_client,established; content:"Reference"; pcre:"/^Reference\s*=\s*\*\x5CG\{[A-Z\d-]{36}\}\x23\d+\.\d+\x23\d+\x23[^\r\n]{474}/smi"; reference:bugtraq,25629; reference:cve,2007-4776; classtype:attempted-user; sid:12618; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 4 ActiveX clsid access"; flow:established,to_client; file_data; content:"3ddf644a-0e1a-4543-9595-4b917707a9a7"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*3ddf644a-0e1a-4543-9595-4b917707a9a7\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14348; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Input Method Editor ActiveX function call access"; flow:established,to_client; file_data; content:"IMESingleKanjiDict.8.1"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22IMESingleKanjiDict.8.1\x22|\x27IMESingleKanjiDict.8.1\x27)\s*\x3b.*\w+\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)|\w+\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22IMESingleKanjiDict.8.1\x22|\x27IMESingleKanjiDict.8.1\x27)\s*\)/smi"; metadata:policy security-ips drop; reference:cve,2006-4697; reference:url,www.microsoft.com/technet/security/bulletin/MS07-016.mspx; classtype:attempted-user; sid:10139; rev:5;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI SGI InfoSearch fname access"; flow:to_server,established; content:"/infosrch.cgi"; fast_pattern; http_uri; reference:arachnids,290; reference:bugtraq,1031; reference:cve,2000-0207; classtype:web-application-activity; sid:1727; rev:14;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS WebDAV file lock attempt"; flow:to_server,established; content:"LOCK "; depth:5; reference:bugtraq,2736; reference:nessus,10732; classtype:web-application-activity; sid:969; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX McAfee ePolicy Orchestrator ActiveX function call access"; flow:established,to_client; file_data; content:"SiteManager.SiteMgr.1"; fast_pattern:only; pcre:"/(\w+)\s*=\s*(\x22SiteManager\.SiteMgr\.1\x22|\x27SiteManager\.SiteMgr\.1\x27)\s*\x3b.*(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*\1\s*\)(\s*\.\s*(ExportSiteList|VerifyPackageCatalog)\s*\(|.*\3\s*\.\s*(ExportSiteList|VerifyPackageCatalog)\s*\()|(\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22SiteManager\.SiteMgr\.1\x22|\x27SiteManager\.SiteMgr\.1\x27)\s*\)(\s*\.\s*(ExportSiteList|VerifyPackageCatalog)\s*\(|.*\7\s*\.\s*(ExportSiteList|VerifyPackageCatalog)\s*\()/smi"; metadata:policy security-ips drop; reference:bugtraq,22952; reference:url,knowledge.mcafee.com/SupportSite/search.do?cmd=displayKC&docType=kc&sliceId=SAL_Public&externalId=612496; classtype:attempted-user; sid:10389; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari/Google Chrome Webkit memory corruption attempt"; flow:to_client,established; content:"|3C|dialog|20|style|3D 27|position|3A|relative|27 3E|"; fast_pattern:only; content:"|3C|h|20|style|3D 27|outline|2D|style|3A|auto|27 3E|"; metadata:policy security-ips drop; reference:bugtraq,43078; reference:cve,2010-1813; classtype:attempted-user; sid:19005; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC WebLogic ConsoleHelp view source attempt"; flow:to_server,established; content:"/ConsoleHelp/"; http_uri; content:".jsp"; http_uri; reference:bugtraq,1518; reference:cve,2000-0682; reference:nessus,11724; classtype:web-application-attack; sid:2238; rev:9;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC robot.txt access"; flow:to_server,established; content:"/robot.txt"; http_uri; reference:nessus,10302; classtype:web-application-activity; sid:1857; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI echo.bat access"; flow:to_server,established; content:"/echo.bat"; http_uri; reference:bugtraq,1002; reference:cve,2000-0213; reference:nessus,10246; classtype:web-application-activity; sid:1706; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VmdbSchema Class ActiveX function call access"; flow:established,to_client; file_data; content:"vmdbCOM.VmdbSchema"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22vmdbCOM\.VmdbSchema\x22|\x27vmdbCOM\.VmdbSchema\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22vmdbCOM\.VmdbSchema\x22|\x27vmdbCOM\.VmdbSchema\x27)\s*\)/Osmi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14388; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-MISC potential malware - download of iprinp.dll"; flow:established,to_server; content:"/iprinp.dll"; http_uri; metadata:policy security-ips drop; classtype:suspicious-filename-detect; sid:17813; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI agora.cgi attempt"; flow:to_server,established; content:"/store/agora.cgi?cart_id=<SCRIPT>"; fast_pattern; http_uri; reference:bugtraq,3702; reference:bugtraq,3976; reference:cve,2001-1199; reference:cve,2002-0215; reference:nessus,10836; classtype:web-application-attack; sid:1534; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX DXImageTransform.Microsoft.Glow ActiveX clsid access"; flow:established,to_client; file_data; content:"9F8E6421-3D9B-11D2-952A-00C04FA34F05"; fast_pattern:only; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*9F8E6421-3D9B-11D2-952A-00C04FA34F05/si"; metadata:policy security-ips drop; reference:url,www.securityfocus.com/archive/1/443907; classtype:attempted-user; sid:7936; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC Media Player XSPF memory corruption attempt TEST"; flow:to_client,established; flowbits:isset,xspf_file.request; file_data; content:"|3C|identifier|3E|"; pcre:"/\x3cidentifier\x3E[^\x3c]*\x2d\d/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4558; classtype:attempted-user; sid:15157; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file rcsL record exploit attempt"; flow:to_client,established; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00|"; content:"|01 17 00 C0 FF FF 00 00 00 C1 00 00 01 84 00 00|"; within:16; distance:84; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17186; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Help Workshop HPJ OPTIONS section buffer overflow attempt"; flow:to_client,established; content:"HLP"; pcre:"/^\s*HLP\s*\x3d\s*[^\n]{257}/smi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,22135; reference:cve,2007-0427; classtype:attempted-user; sid:17366; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed chart arbitrary code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"A|10 12 00|"; byte_test:2,>,1,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3004; reference:url,www.microsoft.com/technet/security/bulletin/MS08-043.mspx; classtype:attempted-user; sid:13981; rev:8;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI csPassword password.cgi.tmp access"; flow:to_server,established; content:"/password.cgi.tmp"; http_uri; reference:bugtraq,4889; reference:cve,2002-0920; classtype:web-application-activity; sid:1788; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX EDraw Office Viewer Component ActiveX clsid access"; flow:established,to_client; file_data; content:"6BA21C22-53A5-463F-BBE8-5CF7FFA0132B"; fast_pattern:only; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6BA21C22-53A5-463F-BBE8-5CF7FFA0132B\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(HttpDownloadFile|HttpDownloadFileToTempDir|FtpDownloadFile)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6BA21C22-53A5-463F-BBE8-5CF7FFA0132B\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(HttpDownloadFile|HttpDownloadFileToTempDir|FtpDownloadFile))\s*\(/si"; reference:bugtraq,25344; reference:bugtraq,25593; reference:bugtraq,25892; reference:cve,2007-3169; reference:cve,2007-4420; reference:cve,2007-4821; classtype:attempted-user; sid:12430; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX VMWare unspecified 7 ActiveX clsid access"; flow:established,to_client; file_data; content:"75869575-07ba-4c7e-8f8f-980dfbc12abd"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*75869575-07ba-4c7e-8f8f-980dfbc12abd\s*}?\s*(?P=q1)(\s|>)/Osi"; metadata:policy security-ips drop; reference:bugtraq,30934; reference:cve,2008-3691; reference:cve,2008-3692; reference:cve,2008-3693; reference:cve,2008-3694; reference:cve,2008-3695; reference:cve,2008-3696; reference:url,www.vmware.com/security/advisories/VMSA-2008-0014.html; classtype:attempted-user; sid:14414; rev:7;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI technote print.cgi directory traversal attempt"; flow:to_server,established; content:"/technote/print.cgi"; fast_pattern; http_uri; content:"board="; content:"../../"; content:"%00"; reference:bugtraq,2156; reference:cve,2001-0075; reference:nessus,10584; classtype:web-application-attack; sid:1052; rev:17;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows GDI+ interlaced PNG file parsing heap overflow attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; byte_test:4,>,59000,0,relative,big; byte_test:4,>,32000,4,relative,big; byte_test:1,>,7,8,relative; content:"|06|"; within:1; distance:9; content:"|01|"; within:1; distance:2; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3126; reference:url,www.microsoft.com/technet/security/bulletin/MS09-062.mspx; classtype:attempted-user; sid:16186; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI rwwwshell.pl access"; flow:to_server,established; content:"/rwwwshell.pl"; fast_pattern; http_uri; reference:url,www.itsecurity.com/papers/p37.htm; classtype:attempted-recon; sid:834; rev:14;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Apple Safari-Internet Explorer SearchPath blended threat attempt"; flow:to_client,established; flowbits:isset,safari.dll; content:"MZ|90 00|"; byte_jump:4,56,relative,little; content:"PE|00 00|"; within:4; distance:-64; metadata:policy security-ips drop; reference:bugtraq,29445; reference:cve,2008-2540; reference:url,www.microsoft.com/technet/security/bulletin/MS09-015.mspx; classtype:attempted-user; sid:16319; rev:4;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-CGI perl.exe access"; flow:to_server,established; content:"/perl.exe"; fast_pattern; http_uri; reference:arachnids,219; reference:cve,1999-0509; reference:nessus,10173; reference:url,www.cert.org/advisories/CA-1996-11.html; classtype:attempted-recon; sid:832; rev:18;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-IIS cmd32.exe access"; flow:to_server,established; content:"cmd32.exe"; fast_pattern; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; classtype:web-application-attack; sid:1661; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC renamed zip file handling code execution attempt - 3"; flow:to_client,established; flowbits:isset,http.mp4; file_data; content:"|50 4B 03 04|"; within:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40428; classtype:attempted-user; sid:17150; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Foxit Reader title overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"/Title"; fast_pattern; pcre:"/^\s*[\x3C\x28][^\x29]{538}/Rs"; metadata:policy security-ips drop; reference:bugtraq,43785; classtype:attempted-user; sid:20445; rev:3;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC search.dll access"; flow:to_server,established; content:"/search.dll"; http_uri; reference:bugtraq,1684; reference:cve,2000-0835; reference:nessus,10514; classtype:web-application-activity; sid:1767; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Microsoft Video 17 ActiveX clsid access"; flow:established,to_client; file_data; content:"4A5869CF-929D-4040-AE03-FCAFC5B9CD42"; fast_pattern:only; pcre:"/classid\s*=\s*(?P<q17>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4A5869CF-929D-4040-AE03-FCAFC5B9CD42\s*}?\s*(?P=q17)/siO"; metadata:policy security-ips drop; reference:cve,2008-0015; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-032.mspx; reference:url,www.microsoft.com/technet/security/advisory/972890.mspx; classtype:attempted-user; sid:15604; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Visual Studio MFC applications mfc100.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc100.dll"; http_uri; reference:cve,2010-3190; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-025.mspx; classtype:attempted-user; sid:18623; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX NCTAudioStudio2 NCT WavChunksEditor ActiveX function call access"; flow:established,to_client; file_data; content:"NCTWavChunksEditor2.WavChunksEditor2"; fast_pattern:only; pcre:"/(?P<c>\w+)\s*=\s*(\x22NCTWavChunksEditor2\.WavChunksEditor2\x22|\x27NCTWavChunksEditor2\.WavChunksEditor2\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*CreateFile\s*|.*(?P=v)\s*\.\s*CreateFile\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22NCTWavChunksEditor2\.WavChunksEditor2\x22|\x27NCTWavChunksEditor2\.WavChunksEditor2\x27)\s*\)(\s*\.\s*CreateFile\s*|.*(?P=n)\s*\.\s*CreateFile\s*)\s*\(/smi"; reference:bugtraq,24656; reference:url,nctsoft.com/products/NCTAudioStudio2/; classtype:attempted-user; sid:12017; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint MCAtom remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|F9 0F 04 00 00 00|"; byte_test:4,>,2147483646,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,20495; reference:cve,2006-5296; classtype:attempted-user; sid:17320; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX Aurigma unspecified 55 ActiveX clsid access"; flow:established,to_client; file_data; content:"73BCFD0F-0DAA-4B21-B709-2A8D9D9C692A"; fast_pattern:only; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q101>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*73BCFD0F-0DAA-4B21-B709-2A8D9D9C692A\s*}?\s*(?P=q101)(\s|>)/si"; metadata:policy security-ips drop; reference:url,www.microsoft.com/technet/security/advisory/953839.mspx; classtype:attempted-user; sid:14196; rev:6;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-MISC util.pl access"; flow:to_server,established; content:"/util.pl"; http_uri; reference:bugtraq,9748; classtype:web-application-activity; sid:2407; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer XML HttpRequest race condition exploit attempt"; flow:to_client,established; content:"ActiveXObject"; content:"Microsoft.XMLHTTP"; within:30; content:"setInterval"; distance:0; pcre:"/function\s+([a-z0-9_]+)\s*\x28.*?ActiveXObject\s*\x28\s*\x22Microsoft.XMLHTTP\x22\s*\x29.*setInterval\s*\x28\s*\x22\1/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1528; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:attempted-user; sid:15534; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-ACTIVEX SonicWALL SSL-VPN NeLaunchCtrl ActiveX clsid access"; flow:established,to_client; file_data; content:"6EEFD7B1-B26C-440D-B55A-1EC677189F30"; pcre:"/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6EEFD7B1-B26C-440D-B55A-1EC677189F30\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(AddRouteEntry)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*6EEFD7B1-B26C-440D-B55A-1EC677189F30\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\.(AddRouteEntry))/siO"; metadata:policy security-ips drop; reference:bugtraq,26288; reference:cve,2007-5603; classtype:attempted-user; sid:17082; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint MCAtom remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|FA 0F 04 00 00 00|"; byte_test:4,>,2147483646,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,20495; reference:cve,2006-5296; classtype:attempted-user; sid:17319; rev:4;)
