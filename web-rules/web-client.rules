alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint OfficeArt atom memory corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|"; depth:8; content:"P|00|o|00|w|00|e|00|r|00|P|00|o|00|i|00|n|00|t|00 20 00|D|00|o|00|c|00|u|00|m|00|e|00|n|00|t|00|"; nocase; content:"|00 00 00 00 0A 04 04 00 00 00|"; byte_extract:4,0,ref,little,relative; content:"|00 00 00 00 C1 0B|"; byte_test:4,>,4,0,little,relative; byte_test:4,=,ref,4,little,relative; metadata:policy security-ips drop; reference:cve,2011-0976; reference:url,www.microsoft.com/technet/security/bulletin/MS11-022.mspx; classtype:attempted-admin; sid:18637; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows DirectX SAMI file CRawParser buffer overflow attempt"; flow:to_client,established; content:"<SAMI>"; fast_pattern:only; pcre:"/\x3C\S+\s+[^\x3E]*?(\x22[^\x22]{500}|\x27[^\x27]{500}|[^\x3E\x20\x09]{500})/OR"; reference:cve,2007-3901; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-064.mspx; classtype:attempted-user; sid:12983; rev:6;)
# Copyright 2001-2005 Sourcefire, Inc. All Rights Reserved
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2005 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2005 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#
# $Id: web-client.rules,v 1.276.2.16 2011-12-07 19:55:41 vrtbuild Exp $
#---------------
# WEB-CLIENT RULES
#---------------
#
# These signatures look for two things:
# * bad things coming from our users
# * attacks against our web users

alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT XMLHttpRequest attempt"; flow:to_client,established; content:"new XMLHttpRequest|28|"; content:"file|3A|//"; nocase; reference:bugtraq,4628; reference:cve,2002-0354; classtype:web-application-attack; sid:1735; rev:9;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT readme.eml download attempt"; flow:to_server,established; content:"/readme.eml"; nocase; http_uri; reference:url,www.cert.org/advisories/CA-2001-26.html; classtype:attempted-user; sid:1284; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT readme.eml autoload attempt"; flow:to_client,established; content:"window.open|28 22|readme.eml|22|"; nocase; reference:url,www.cert.org/advisories/CA-2001-26.html; classtype:attempted-user; sid:1290; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Javascript document.domain attempt"; flow:to_client,established; content:"document.domain|28|"; nocase; reference:bugtraq,5346; reference:cve,2002-0815; classtype:attempted-user; sid:1840; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Javascript URL host spoofing attempt"; flow:to_client,established; content:"javascript|3A|//"; nocase; reference:bugtraq,5293; classtype:attempted-user; sid:1841; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer playlist file URL overflow attempt"; flow:to_client,established; flowbits:isset,realplayer.playlist; content:"file|3A|//"; nocase; pcre:"/^file\x3a\x2f\x2f[^\n]{400}/smi"; reference:bugtraq,13264; reference:bugtraq,9579; reference:cve,2004-0258; reference:cve,2005-0755; classtype:attempted-user; sid:2438; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer playlist http URL overflow attempt"; flow:to_client,established; flowbits:isset,realplayer.playlist; content:"http|3A|//"; nocase; pcre:"/^http\x3a\x2f\x2f[^\n]{400}/smi"; reference:bugtraq,13264; reference:bugtraq,9579; reference:cve,2004-0258; reference:cve,2005-0755; classtype:attempted-user; sid:2439; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer playlist rtsp URL overflow attempt"; flow:to_client,established; flowbits:isset,realplayer.playlist; content:"rtsp|3A|//"; nocase; pcre:"/^http\x3a\x2f\x2f[^\n]{400}/smi"; reference:bugtraq,13264; reference:bugtraq,9579; reference:cve,2004-0258; reference:cve,2005-0755; classtype:attempted-user; sid:2440; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Norton antivirus sysmspam.dll load attempt"; flow:to_client,established; content:"clsid|3A|"; nocase; content:"0534CF61-83C5-4765-B19B-45F7A4E135D0"; nocase; reference:bugtraq,9916; reference:cve,2004-0363; classtype:attempted-admin; sid:2485; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT local resource redirection attempt"; flow:to_client,established; content:"Location|3A|"; nocase; http_header; pcre:"/^Location\x3a(\s*|\s*\r?\n\s+)*URL\s*\x3a/smiH"; reference:cve,2004-0549; reference:url,www.kb.cert.org/vuls/id/713878; classtype:attempted-user; sid:2577; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Content-Disposition CLSID command attempt"; flow:to_client,established; content:"Content-Disposition|3A|"; nocase; http_header; pcre:"/^Content-Disposition\x3a(\s*|\s*\r?\n\s+)[^\r\n]*?\{[\da-fA-F]{8}(-[\da-fA-F]{4}){3}-[\da-fA-F]{12}\}/smiH"; reference:bugtraq,9510; reference:cve,2004-0420; reference:url,www.microsoft.com/technet/security/bulletin/ms04-024.mspx; classtype:attempted-user; sid:2589; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer bitmap BitmapOffset integer overflow attempt"; flow:to_client,established; content:"image/bmp"; nocase; http_header; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)image\x2fbmp/smiH"; content:"BM"; file_data; byte_test:4,>,2147480000,8,relative,little; reference:bugtraq,9663; reference:cve,2004-0566; reference:url,www.microsoft.com/technet/security/bulletin/ms04-025.mspx; classtype:attempted-user; sid:2671; rev:12;)

alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT libpng tRNS overflow attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:4; distance:4; content:"tRNS"; distance:0; byte_test:4,>,256,-8,relative,big; pcre:"/IHDR(?!.*?PLTE).*?tRNS/s"; reference:bugtraq,10872; reference:cve,2004-0597; classtype:attempted-user; sid:2673; rev:6;)

alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Multiple Products JPEG parser heap overflow attempt"; flow:to_client,established; content:"Content-Type"; nocase; http_header; content:"image/"; nocase; http_header; pcre:"/^Content-Type\x3A\s*image\x2F/smiH"; file_data; content:"|FF D8|"; within:2; fast_pattern; pcre:"/^.*\xFF[\xE1\xE2\xED\xFE]\x00[\x00\x01]/sR"; metadata:policy security-ips drop; reference:bugtraq,11173; reference:cve,2004-0200; reference:url,www.microsoft.com/security/bulletins/200409_jpeg.mspx; classtype:attempted-user; sid:2705; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT JPEG parser multipacket heap overflow"; flow:to_client,established; flowbits:isset,file.jpeg; content:"|FF|"; pcre:"/\xFF[\xE1\xE2\xED\xFE]\x00[\x00\x01]/"; metadata:policy security-ips drop; reference:bugtraq,11173; reference:cve,2004-0200; reference:url,www.microsoft.com/security/bulletins/200409_jpeg.mspx; classtype:attempted-admin; sid:2707; rev:5;)

alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows ANI file parsing overflow"; flow:to_client,established; content:"RIFF"; nocase; content:"anih"; nocase; byte_test:4,>,36,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2004-1049; reference:cve,2007-0038; reference:cve,2007-1765; reference:url,www.microsoft.com/technet/security/bulletin/MS05-002.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS07-017.mspx; classtype:attempted-user; sid:3079; rev:10;)

alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT winamp .cda file name overflow attempt"; flow:to_client,established; content:".cda"; nocase; pcre:"/(\x5c[^\x5c]{16,}|\x2f[^\x2f]{16,})\.cda$/smi"; reference:bugtraq,11730; reference:cve,2004-1119; reference:nessus,15817; classtype:attempted-user; sid:3088; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Multiple Products PNG large image width download attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32767,0,relative; metadata:policy security-ips drop; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:cve,2007-5503; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:3132; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft PNG large colour depth download attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:1,>,16,8,relative; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:3134; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Multiple Products PNG large image height download attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32767,4,relative; metadata:policy security-ips drop; reference:bugtraq,11481; reference:bugtraq,11523; reference:cve,2004-0599; reference:cve,2004-0990; reference:cve,2004-1244; reference:cve,2007-5503; reference:url,www.microsoft.com/technet/security/bulletin/MS05-009.mspx; classtype:attempted-user; sid:3133; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 5/6 object type overflow attempt"; flow:to_client,established; file_data; content:"<OBJECT"; nocase; pcre:"/<OBJECT\s+[^>]*type\s*=[\x22\x27]\x2f{32}/smi"; reference:cve,2003-0344; reference:url,www.microsoft.com/technet/security/bulletin/MS03-020.mspx; classtype:attempted-user; sid:3149; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player directory traversal via Content-Disposition attempt"; flow:to_client,established; content:".wmz"; fast_pattern; nocase; http_header; content:"Content-Disposition|3A|"; nocase; http_header; content:"filename="; nocase; http_header; pcre:"/filename=[^\x3b\x3a\r\n]*(\x25\x2e\x25\x2e\x25\x5c|\x25\x32\x65\x25\x35\x63|\x2e\x2e\x5c)[^\x3b\x3a\r\n]*\x2ewmz/smiH"; reference:bugtraq,7517; reference:cve,2003-0228; reference:nessus,11595; reference:url,www.microsoft.com/technet/security/bulletin/MS03-017.mspx; classtype:attempted-user; sid:3192; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows winhelp clsid attempt"; flow:to_client,established; content:"adb880a6-d8ff-11cf-9377-00aa003b7a11"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*adb880a6-d8ff-11cf-9377-00aa003b7a11/si"; metadata:policy security-ips drop; reference:bugtraq,11467; reference:bugtraq,4857; reference:bugtraq,5874; reference:cve,2002-0693; reference:cve,2002-0823; reference:cve,2004-1043; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;KB828750; reference:url,support.microsoft.com/default.aspx?scid=kb\;en-us\;Q293338; reference:url,www.microsoft.com/technet/security/bulletin/MS02-055.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS05-001.mspx; reference:url,www.ngssoftware.com/advisories/ms-winhlp.txt; classtype:attempted-user; sid:3148; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer VIDORV30 header length buffer overflow"; flow:to_client,established; content:".RMF"; nocase; content:"VIDORV30"; distance:0; byte_test:4,>,1000000,-16,relative; reference:bugtraq,11309; reference:cve,2004-1481; reference:url,www.eeye.com/html/research/advisories/AD20041001.html; classtype:attempted-admin; sid:3470; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes playlist URL overflow attempt"; flow:to_client,established; file_data; content:"[playlist]"; pcre:"/^File[0-9]+=http\x3a\x2f\x2f[^\n]{150}/Rsmi"; metadata:policy security-ips drop; reference:bugtraq,12238; reference:cve,2005-0043; classtype:attempted-user; sid:3471; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer SMIL file overflow attempt"; flow:to_client,established; file_data; content:"<smil>"; nocase; content:"system-screen-size=|22|"; distance:0; nocase; isdataat:256,relative; content:!"|22|"; within:256; metadata:policy security-ips drop; reference:bugtraq,12698; reference:cve,2005-0455; classtype:attempted-user; sid:3473; rev:15;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF multipacket heap overflow - NETSCAPE2.0"; flow:to_client,established; flowbits:isset,file.gif; content:"GIF"; content:"!|FF 0B|NETSCAPE2.0"; distance:0; nocase; content:"|02|"; within:1; distance:1; byte_test:4,>,0x7f,3,relative; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:3536; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF single packet heap overflow - NETSCAPE2.0"; flow:to_client,established; content:"image/"; http_header; pcre:"/^Content-Type\s*\x3a(\s*|\s*\r?\n\s+)image\x2fgif/smiH"; content:"GIF"; content:"!|FF 0B|NETSCAPE2.0"; distance:0; nocase; content:"|02|"; within:1; distance:1; byte_test:4,>,0x7f,3,relative; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:3534; rev:14;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT HTML http/https scheme hostname overflow attempt"; flow:to_client,established; content:"http"; nocase; content:"|3A|//"; within:4; pcre:"/=\s*\x22\s*http(s)?\x3a\x2f\x2f[^\x3a\x2f@\s\x22\x3F\x26]{255}|=\s*\x27\s*http(s)?\x3a\x2f\x2f[^\x3a\x2f@\s\x27\x3F\x26]{255}|=\s*http(s)?\x3a\x2f\x2f[^\x3a\x2f@\s\x3F\x26]{255}/i"; reference:bugtraq,33894; reference:cve,2005-0554; reference:cve,2009-0187; classtype:attempted-user; sid:3550; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Bitmap width integer overflow multipacket attempt"; flow:to_client,established; flowbits:isset,http.bmp; content:"BM"; byte_test:4,>,83386080,16,relative,little; metadata:policy security-ips drop; reference:bugtraq,11171; reference:cve,2004-0904; reference:cve,2008-3015; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=255067; reference:url,www.microsoft.com/technet/security/bulletin/MS08-052.mspx; classtype:attempted-admin; sid:3634; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Bitmap width integer overflow attempt"; flow:to_client,established; content:"image/bmp"; nocase; http_header; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)image\x2fbmp/smiH"; file_data; content:"BM"; distance:0; byte_test:4,>,83386080,16,relative,little; metadata:policy security-ips drop; reference:bugtraq,11171; reference:cve,2004-0904; reference:cve,2008-3015; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=255067; reference:url,www.microsoft.com/technet/security/bulletin/MS08-052.mspx; classtype:attempted-admin; sid:3632; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Web-client IFRAME src javascript code execution"; flow:to_client,established; content:"IFRAME"; nocase; pcre:"/\x3c\s*IFRAME\s*[^\x3e]*src=\x22javascript\x3a/smi"; reference:bugtraq,13544; reference:bugtraq,30560; reference:cve,2005-1476; reference:cve,2008-2939; reference:nessus,18243; classtype:attempted-user; sid:3679; rev:7;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer spoofed MIME-Type auto-execution attempt"; flow:to_client,established; content:"Content-Type|3A|"; nocase; http_header; content:"audio/"; fast_pattern; nocase; http_header; pcre:"/Content-Type\x3A\s+audio\/(x-wav|mpeg|x-midi)/iH"; content:"filename="; nocase; http_header; pcre:"/filename=[\x22\x27]?.{1,221}\.(vbs|exe|scr|pif|bat)/Hi"; metadata:policy security-ips drop; reference:bugtraq,2524; reference:cve,2001-0154; reference:url,www.microsoft.com/technet/security/bulletin/MS01-020.mspx; classtype:attempted-admin; sid:3683; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer bitmap BitmapOffset multipacket integer overflow attempt"; flow:to_client,established; flowbits:isset,http.bmp; content:"BM"; pcre:"/^BM/sm"; byte_test:4,>,2147480000,8,relative,little; reference:bugtraq,9663; reference:cve,2004-0566; reference:url,www.microsoft.com/technet/security/bulletin/ms04-025.mspx; classtype:attempted-user; sid:3685; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer tRNS overflow attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:4; distance:4; content:"tRNS"; distance:0; byte_test:4,>,256,-8,relative,big; reference:bugtraq,13941; reference:cve,2005-1211; reference:nessus,18490; reference:url,www.microsoft.com/technet/security/bulletin/MS05-025.mspx; classtype:attempted-user; sid:3689; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer javaprxy.dll COM access"; flow:to_client,established; content:"03D9F3F2-B0E3-11D2-B081-006008039BF0"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*03D9F3F2-B0E3-11D2-B081-006008039BF0/si"; metadata:policy security-ips drop; reference:bugtraq,14087; reference:cve,2005-2087; reference:url,www.microsoft.com/technet/security/bulletin/ms05-037.mspx; reference:url,www.osvdb.org/displayvuln.php?osvdb_id=17680; classtype:attempted-user; sid:3814; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows CHM file transfer attempt"; flow:to_client,established; flowbits:isset,http.chm; file_data; content:"ITSF"; within:4; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,13953; reference:cve,2005-1208; reference:nessus,18482; reference:url,www.microsoft.com/technet/security/bulletin/ms05-026.mspx; classtype:attempted-user; sid:3820; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer msdds clsid attempt"; flow:to_client,established; content:"EC444CB6-3E7E-4865-B1C3-0DE72EF39B3F"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*EC444CB6-3E7E-4865-B1C3-0DE72EF39B3F/si"; metadata:policy security-ips drop; reference:bugtraq,14594; reference:cve,2005-1990; reference:cve,2005-2127; reference:url,www.frsirt.com/english/advisories/2005/1450; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-user; sid:4132; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer devenum clsid attempt"; flow:to_client,established; content:"083863F1-70DE-11d0-BD40-00A0C911CE86"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*083863F1-70DE-11d0-BD40-00A0C911CE86/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-user; sid:4133; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer JPEG heap overflow single packet attempt"; flow:to_client,established; content:"image/"; nocase; http_header; pcre:"/^Content-Type\s*\x3a(\s*|\s*\r?\n\s+)image\x2fp?jpe?g/smiH"; file_data; content:"|FF D8|"; within:2; content:"|FF C0|"; content:"|FF DA|"; distance:0; pcre:"/\xFF\xC0[^\xFF]{8}(([^\xFF])[^\xFF]{2})(([^\xFF])[^\xFF]{2})?(([^\xFF])[^\xFF]{2})?(([^\xFF])[^\xFF]{2})?\xFF.*\xFF\xDA[^\xFF]{2}[\x01-\x04](?(?=\2)[^\xFF]{2}(?(4)(?(?=\4)[^\xFF]{2}(?(6)(?(?=\6)[^\xFF]{2}(?(8)(?(?=\8)(?!))|(?!)))|(?!)))|(?!)))/s"; reference:bugtraq,14282; reference:bugtraq,14284; reference:cve,2005-1988; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-dos; sid:4135; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Exploerer blnmgr clsid attempt"; flow:to_client,established; content:"3F8A6C33-E0FD-11D0-8A8C-00A0C90C2BC5"; nocase; pcre:"/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*3F8A6C33-E0FD-11D0-8A8C-00A0C90C2BC5/si"; metadata:policy security-ips drop; reference:bugtraq,14511; reference:cve,2005-1990; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-user; sid:4134; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer JPEG heap overflow multipacket attempt"; flow:to_client,established; flowbits:isset,file.jpeg; content:"|FF C0|"; content:"|FF DA|"; distance:0; pcre:"/\xFF\xC0[^\xFF]{8}(([^\xFF])[^\xFF]{2})(([^\xFF])[^\xFF]{2})?(([^\xFF])[^\xFF]{2})?(([^\xFF])[^\xFF]{2})?\xFF.*\xFF\xDA[^\xFF]{2}[\x01-\x04](?(?=\2)[^\xFF]{2}(?(4)(?(?=\4)[^\xFF]{2}(?(6)(?(?=\6)[^\xFF]{2}(?(8)(?(?=\8)(?!))|(?!)))|(?!)))|(?!)))/s"; reference:bugtraq,14282; reference:bugtraq,14284; reference:cve,2005-1988; reference:url,www.microsoft.com/technet/security/bulletin/MS05-038.mspx; classtype:attempted-dos; sid:4136; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT multipacket CBO CBL CBM file transfer attempt"; flow:to_client,established; flowbits:isset,bookmark_link_content_type; content:"Interactive Training]"; pcre:"/\[(Microsoft |Microsoft Press )?Interactive Training\]/"; metadata:policy security-ips drop; reference:bugtraq,13944; reference:cve,2005-1212; reference:cve,2006-3448; reference:nessus,18492; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-005.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS05-031.mspx; classtype:attempted-user; sid:4195; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT CBO CBL CBM file transfer attempt"; flow:to_client,established; content:"text/plain"; nocase; http_header; content:"Interactive Training]"; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)text\x2fplain/smiH"; pcre:"/\[(Microsoft |Microsoft Press )?Interactive Training\]/"; reference:bugtraq,13944; reference:cve,2005-1212; reference:cve,2006-3448; reference:nessus,18492; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-005.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS05-031.mspx; classtype:attempted-user; sid:4196; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT multipacket CBO CBL CBM file transfer start"; flow:to_client,established; content:"text/plain"; nocase; http_header; pcre:"/^Content-type\x3a(\s*|\s*\r?\n\s+)text\x2fplain/smiH"; flowbits:set,bookmark_link_content_type; flowbits:noalert; classtype:protocol-command-decode; sid:4194; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows malformed shortcut file with comment buffer overflow attempt"; flow:to_client,established; content:"L|00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00|F"; byte_test:1,&,4,0,relative,little; byte_jump:2,56,relative,little; byte_jump:2,0,relative,little; byte_jump:2,-2,relative,multiplier 2,little; byte_jump:2,0,relative,multiplier 2,little; byte_jump:2,0,relative,multiplier 2,little; byte_jump:2,0,relative,little; content:"|CC 00 00 00|"; within:4; distance:-2; isdataat:72,relative; content:!"|00 00|"; within:32; distance:40; metadata:policy security-ips drop; reference:bugtraq,15069; reference:bugtraq,15070; reference:cve,2005-2118; reference:cve,2005-2122; reference:url,www.microsoft.com/technet/security/bulletin/MS05-049.mspx; classtype:attempted-user; sid:4644; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows malformed shortcut file buffer overflow attempt"; flow:to_client,established; content:"L|00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00|F"; byte_test:1,!&,4,0,relative,little; byte_jump:2,56,relative,little; byte_jump:2,0,relative,little; byte_jump:2,-2,relative,multiplier 2,little; byte_jump:2,0,relative,multiplier 2,little; byte_jump:2,0,relative,little; content:"|CC 00 00 00|"; within:4; distance:-2; isdataat:72,relative; content:!"|00 00|"; within:32; distance:40; metadata:policy security-ips drop; reference:bugtraq,15069; reference:bugtraq,15070; reference:cve,2005-2118; reference:cve,2005-2122; reference:url,www.microsoft.com/technet/security/bulletin/MS05-049.mspx; classtype:attempted-user; sid:4643; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash DOACTION tag overflow attempt"; flow:to_client,established; content:"FWS"; content:"|03|"; distance:19; content:!"|00|"; within:1; byte_test:1,<,128,0,relative; content:"|9B|"; within:1; distance:1; content:!"|00|"; within:1; distance:-2; reference:url,www.macromedia.com/devnet/security/security_zone/mpsb05-07.html; classtype:attempted-user; sid:4675; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer javascript onload overflow attempt"; flow:to_client,established; content:"body"; nocase; content:"on"; within:20; nocase; content:"window"; within:20; nocase; pcre:"/<body\s+[^>]*on(Load|Blur)\s*=\s*[\x22\x27]?window\(\)/smi"; metadata:policy security-ips drop; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4647; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime movie file component name integer overflow multipacket attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"hdlr"; nocase; byte_test:1,>,250,24,relative; metadata:policy security-ips drop; reference:bugtraq,15308; reference:cve,2005-2754; reference:url,docs.info.apple.com/article.html?artnum=302772; classtype:attempted-user; sid:4679; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime movie file component name integer overflow attempt"; flow:to_client,established; content:"video/quicktime"; nocase; http_header; pcre:"/^Content-Type\x3A\s*video\x2Fquicktime/smiH"; content:"hdlr"; nocase; byte_test:1,>,250,24,relative; reference:bugtraq,15308; reference:cve,2005-2754; reference:url,docs.info.apple.com/article.html?artnum=302772; classtype:attempted-user; sid:4680; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer javascript onload document.write obfuscation overflow attempt"; flow:to_client,established; content:"document.write"; nocase; pcre:"/document\.write\(([^\x22\x27\x29\x3B]*([\x22\x27]))((?(?=\2)\2(?1)))\x3C(?3)b(?3)o(?3)d(?3)y(?3)\s*(?3)o(?3)n(?3)l(?3)o(?3)a(?3)d(?3)\s*(?3)=(?3)\s*(?3)w(?3)i(?3)n(?3)d(?3)o(?3)w(?3)\x28(?3)\x29/smi"; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4916; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer javascript onload prompt obfuscation overflow attempt"; flow:to_client,established; content:"prompt"; nocase; content:"fillmem"; distance:0; nocase; content:"body"; nocase; content:"onLoad"; distance:0; nocase; content:"setTimeout"; distance:0; nocase; pcre:"/prompt\(fillmem[^\)]*\).*?<body\s+[^>]*onLoad\s*=\s*[\x22\x27]?setTimeout\(/smi"; metadata:policy security-ips drop; reference:bugtraq,13799; reference:cve,2005-1790; reference:url,computerterrorism.com/research/ie/ct21-11-2005; reference:url,www.microsoft.com/technet/security/bulletin/MS05-054.mspx; classtype:attempted-user; sid:4917; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Metasploit Windows picture and fax viewer wmf arbitrary code execution attempt"; flow:to_client,established; content:"|01 00 09 00 00 03|R|1F 00 00 06 00|=|00 00 00 00 00|"; content:"&|06 09 00 16 00|"; metadata:policy security-ips drop; reference:bugtraq,16074; reference:cve,2005-4560; reference:url,www.microsoft.com/technet/security/bulletin/ms06-001.mspx; classtype:web-application-attack; sid:5319; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows wmf file arbitrary code execution attempt"; flow:to_client,established; flowbits:isset,wmf.download; file_data; content:"&"; content:"|09 00|"; within:2; distance:1; reference:bugtraq,16074; reference:cve,2005-4560; reference:cve,2007-3034; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-046.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms06-001.mspx; classtype:web-application-attack; sid:5318; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Plugin for Non-IE browsers buffer overflow attempt"; flow:to_client,established; file_data; content:"<EMBED"; nocase; content:"src"; distance:0; nocase; pcre:"/<EMBED[^>]+?src\s*=\s*(\x22[^\x22]{1024}|\x27[^\x27]{1024}|[^\s]{1024})/i"; metadata:policy security-ips drop; reference:bugtraq,16644; reference:cve,2006-0005; reference:url,www.microsoft.com/technet/security/bulletin/ms06-006.mspx; classtype:attempted-user; sid:5710; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player zero length bitmap heap overflow attempt"; flow:to_client,established; flowbits:isset,http.bmp; file_data; content:"BM|00 00 00 00|"; depth:6; pcre:"/^BM\x00\x00\x00\x00/sm"; metadata:policy security-ips drop; reference:bugtraq,16633; reference:cve,2006-0006; reference:url,www.eeye.com/html/research/advisories/AD20060214.html; reference:url,www.microsoft.com/technet/security/bulletin/ms06-005.mspx; classtype:attempted-admin; sid:5711; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Metafile invalid header size integer overflow"; flow:to_client,established; content:"|D7 CD C6 9A|"; byte_test:2,<,8,25,relative,little; metadata:policy security-ips drop; reference:bugtraq,16516; reference:cve,2006-0020; reference:url,www.microsoft.com/technet/security/bulletin/ms06-004.mspx; classtype:attempted-admin; sid:5713; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB CLIENT Microsoft Windows Media Player invalid data offset bitmap heap overflow attempt"; flow:to_client,established; file_data; content:"BM"; within:2; byte_test:4,<,14,8,little,relative; metadata:policy security-ips drop; reference:bugtraq,16633; reference:cve,2006-0006; reference:url,www.eeye.com/html/research/advisories/AD2006021.html; reference:url,www.microsoft.com/technet/security/bulletin/ms06-005.mspx; classtype:attempted-admin; sid:5712; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft HTML help workshop buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.hhp.download; file_data; content:"["; depth:1; content:"]"; within:12; content:"file"; distance:0; nocase; content:"="; distance:0; pcre:"/\x5B(OPTIONS|WINDOWS|MERGE FILES|MAP|ALIAS|TEXT\x20POPUPS|INFOTYPES|SUBSETS)\x5D.*?(Contents|Index|Compiled|Sample List|Full text search stop list)\x20file\s*\x3D[^\r\n]{200}/smi"; metadata:policy security-ips drop; reference:cve,2006-0564; reference:cve,2009-0133; reference:url,users.pandora.be/bratax/advisories/b008.html; reference:url,www.frsirt.com/english/advisories/2006/0446; classtype:attempted-user; sid:5741; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF single packet heap overflow - ANIMEXTS1.0"; flow:to_client,established; content:"image/"; pcre:"/^Content-Type\s*\x3a(\s*|\s*\r?\n\s+)image\x2fgif/smi"; content:"GIF"; distance:0; content:"!|FF 0B|ANIMEXTS1.0"; distance:0; nocase; content:"|02|"; within:1; distance:1; byte_test:4,>,0x7f,3,relative; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:6502; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer mhtml uri shortcut buffer overflow attempt"; flow:to_client,established; content:"URL"; nocase; content:"mhtml|3A|//"; distance:0; nocase; pcre:"/^\s*URL\s*=\s*mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\r\n]{1253}/smi"; metadata:policy security-ips drop; reference:bugtraq,18198; reference:cve,2006-2766; reference:url,www.microsoft.com/technet/security/bulletin/ms06-043.mspx; classtype:attempted-user; sid:6510; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime udta atom overflow attempt"; flow:to_client,established; content:"udta"; byte_test:4,>,4294967291,-8,relative; metadata:policy security-ips drop; reference:bugtraq,17953; reference:cve,2006-1460; classtype:attempted-user; sid:6506; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla GIF multipacket heap overflow - ANIMEXTS1.0"; flow:to_client,established; flowbits:isset,file.gif; content:"GIF"; content:"!|FF 0B|ANIMEXTS1.0"; distance:0; nocase; content:"|02|"; within:1; distance:1; byte_test:4,>,0x7f,3,relative; reference:bugtraq,12881; reference:cve,2005-0399; reference:nessus,17605; classtype:attempted-user; sid:6503; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sophos Anti-Virus CAB file overflow attempt"; flow:to_client,established; file_data; content:"MSCF"; byte_test:2,>,8192,22,little,relative; metadata:policy security-ips drop; reference:bugtraq,17876; reference:cve,2006-0994; classtype:attempted-admin; sid:6504; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime fpx file SectNumMiniFAT overflow attempt"; flow:to_client,established; content:"|D0 CF 11 E0 A1 B1 1A E1|"; depth:8; byte_test:4,>,8388606,56,little,relative; metadata:policy security-ips drop; reference:bugtraq,17074; reference:cve,2006-1249; classtype:attempted-user; sid:6505; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer mhtml uri href buffer overflow attempt"; flow:to_client,established; content:"mhtml|3A|//"; nocase; pcre:"/href\s*=\s*(\x22mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\x22]{1253}|\x27mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\x27]{1253}|mhtml\x3A\x2F\x2F[A-Z\x2D]{2,31}\x3A[^\x09\r\n\x20]{1253})/smi"; metadata:policy security-ips drop; reference:bugtraq,18198; reference:cve,2006-2766; reference:url,www.microsoft.com/technet/security/bulletin/ms06-043.mspx; classtype:attempted-user; sid:6509; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected hIST overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"hIST"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6694; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected tRNS overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"tRNS"; byte_test:4,>,3000,-8,relative; reference:bugtraq,13941; reference:bugtraq,18385; reference:cve,2005-1211; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6695; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected pHYs overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"pHYs"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6696; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected sPLT overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"sPLT"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6697; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected sBIT overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"sBIT"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6691; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected bKGD overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"bkGD"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6693; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected tIME overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"tIME"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6698; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected zTXt overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"zTXt"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6701; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected iTXt overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"iTXt"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6699; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected cHRM overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"cHRM"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6689; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Multiple Products malformed PNG detected tEXt overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"tEXt"; byte_test:4,>,3000,-8,relative; metadata:policy security-ips drop; reference:bugtraq,18385; reference:cve,2006-0025; reference:cve,2009-2501; reference:url,www.microsoft.com/technet/security/bulletin/MS09-062.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6700; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected sRGB overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"sRGB"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6692; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player Malformed PNG detected iCCP overflow attempt"; flow:to_client,established; flowbits:isset,file.png; content:"iCCP"; byte_test:4,>,3000,-8,relative; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,www.microsoft.com/technet/security/bulletin/ms06-024.mspx; classtype:attempted-user; sid:6690; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel url unicode overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|E0 C9 EA|y|F9 BA CE 11 8C 82 00 AA 00|K|A9 0B|"; byte_test:4,>,3628,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,18422; reference:bugtraq,18500; reference:cve,2006-3059; reference:cve,2006-3086; reference:cve,2011-0104; reference:url,www.microsoft.com/technet/security/bulletin/MS11-021.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7002; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Explorer invalid url file overflow attempt"; flow:to_client,established; file_data; content:"[InternetShortcut]"; within:100; nocase; content:"url="; distance:0; nocase; content:"file|3A|file|3A|file|3A|"; distance:0; nocase; metadata:policy security-ips drop; reference:bugtraq,18838; reference:cve,2006-3351; classtype:denial-of-service; sid:7022; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel object record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|5D 00|"; byte_test:2,>,8224,0,relative,little; content:"|15 00 12 00|"; within:4; distance:2; metadata:policy security-ips drop; reference:bugtraq,18886; reference:cve,2006-1306; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7048; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT isComponentInstalled function buffer overflow"; flow:to_client,established; file_data; content:"isComponentInstalled"; nocase; isdataat:256,relative; pcre:"/isComponentInstalled\s*\([^,\)]{256}/smi"; metadata:policy security-ips drop; reference:bugtraq,16870; reference:cve,2006-1016; classtype:attempted-user; sid:7020; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel url unicode overflow attempt"; flow:to_client,established; content:"n|DB 7C D2|m|AE CF 11 96 B8|DEST|00 00|"; content:"FWS"; within:3; distance:8; content:"javascript|3A|"; distance:0; nocase; metadata:policy security-ips drop; reference:bugtraq,18583; reference:cve,2006-3014; reference:url,www.microsoft.com/technet/security/bulletin/ms06-069.mspx; classtype:attempted-user; sid:7025; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel style handling overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|E0 00|"; byte_jump:2,0,relative,little; content:"|93 02|"; within:2; byte_test:2,>,733,4,relative,little; byte_test:1,!&,0x80,3,relative; reference:bugtraq,18872; reference:cve,2006-3431; reference:url,www.microsoft.com/technet/security/bulletin/ms06-059.mspx; classtype:attempted-user; sid:7024; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word document summary information string overflow attempt"; flow:to_client,established; file_data; content:"|02 D5 CD D5 9C|.|1B 10 93 97 08 00|+,|F9 AE|"; content:"|1E 00 00 00|"; distance:0; byte_test:4,>,2147483646,0,relative; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7202; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word document summary information null string overflow attempt"; flow:to_client,established; file_data; content:"|02 D5 CD D5 9C|.|1B 10 93 97 08 00|+,|F9 AE|"; content:"|1E 00 00 00 00 00 00 00|"; distance:0; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7200; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word summary information null string overflow attempt"; flow:to_client,established; file_data; content:"|E0 85 9F F2 F9|Oh|10 AB 91 08 00|+'|B3 D9|"; content:"|1E 00 00 00 00 00 00 00|"; distance:0; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7201; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel object ftCmo overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|5D 00|"; content:"|15 00 12 00|"; within:4; distance:2; byte_test:2,>,0x1E,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,18886; reference:cve,2006-1306; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7204; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel FngGroupCount record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|9C 00 02 00|"; byte_test:2,>,14,0,relative,little; byte_test:2,!=,16,0,relative,little; reference:bugtraq,18890; reference:cve,2006-1308; reference:cve,2008-0320; classtype:attempted-user; sid:7205; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel MSO.DLL malformed string parsing multi byte buffer over attempt"; flow:to_client,established; file_data; content:"|00 00 00 00 00 00 1D 00 0F 00 03 00 00 00|"; content:"|00|"; within:1; distance:2; isdataat:6,relative; content:!"|00 00 00 00 00|"; within:5; distance:1; metadata:policy security-ips drop; reference:bugtraq,17252; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7198; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel label record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|02 04|"; byte_test:2,>,35071,2,relative; metadata:policy security-ips drop; reference:bugtraq,28166; reference:cve,2006-1309; reference:cve,2008-0114; reference:url,www.microsoft.com/technet/security/bulletin/ms06-037.mspx; classtype:attempted-user; sid:7199; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel MSO.DLL malformed string parsing single byte buffer over attempt"; flow:to_client,established; file_data; content:"|00 00 00 00 00 00 1D 00 0F 00 03 00 00 00|"; isdataat:2,relative; content:!"|00|"; within:1; distance:2; metadata:policy security-ips drop; reference:bugtraq,17252; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7197; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word information string overflow attempt"; flow:to_client,established; file_data; content:"|E0 85 9F F2 F9|Oh|10 AB 91 08 00|+'|B3 D9|"; content:"|1E 00 00 00|"; distance:0; byte_test:4,>,2147483646,0,relative; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:7203; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla javascript navigator object access"; flow:to_client,established; file_data; content:"window.navigator"; nocase; content:"="; within:2; content:"java."; distance:0; nocase; metadata:policy security-ips drop; reference:bugtraq,19181; reference:cve,2006-3677; reference:url,www.mozilla.org/security/announce/2006/mfsa2006-45.html; classtype:attempted-user; sid:8058; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer error message format string vulnerability attempt"; flow:to_client,established; content:"<imfl>"; nocase; pcre:"/<[^>]*?\x25/ROsmi"; metadata:policy security-ips drop; reference:bugtraq,14945; reference:cve,2005-2710; classtype:attempted-user; sid:8091; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT HCP URI uplddrvinfo access"; flow:to_client,established; content:"hcp|3A|"; nocase; content:"uplddrvinfo.htm?"; distance:0; nocase; content:"file|3A|"; distance:0; nocase; pcre:"/hcp\x3A[^\r\n]+uplddrvinfo\x2Ehtm\x3F[^\r\n]*file\x3A/smi"; reference:bugtraq,5478; reference:cve,2002-0974; reference:url,www.microsoft.com/technet/security/bulletin/ms02-060.mspx; classtype:misc-activity; sid:8413; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office GIF image descriptor memory corruption attempt"; flow:to_client,established; file_data; content:"GIF8"; within:4; content:"a"; within:1; distance:1; byte_test:1,&,0x80,4,relative; pcre:"/^(.{13}|.{19}|.{31}|.{55}|.{103}|.{199}|.{391}|.{775})\x2C.{5}([\xE0-\xFF]|.{2}[\xE0-\xFF])/sR"; reference:bugtraq,18915; reference:bugtraq,22630; reference:cve,2006-0007; reference:cve,2007-1071; reference:url,www.microsoft.com/technet/security/bulletin/ms06-039.mspx; classtype:attempted-user; sid:8414; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Vector Markup Language fill method overflow attempt"; flow:to_client,established; content:"|3A|fill"; nocase; content:"method"; distance:0; nocase; pcre:"/<\w+\x3afill\s[^>]*method\s*=\s*(\x27[^\x27]{32}|\x22[^\x22]{32}|[^\s>]{32})/smi"; metadata:policy security-ips drop; reference:bugtraq,20096; reference:cve,2006-4868; reference:url,www.microsoft.com/technet/security/bulletin/ms06-055.mspx; classtype:attempted-user; sid:8416; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows RTF file with embedded object package download attempt"; flow:to_client,established; content:"{|5C|rtf"; nocase; content:"{|5C|object|5C|objemb{|5C|*|5C|objclass Package}"; distance:0; nocase; metadata:policy security-ips drop; reference:cve,2006-4692; reference:url,www.microsoft.com/technet/security/bulletin/ms06-065.mspx; classtype:misc-activity; sid:8445; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel colinfo XF record overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"}|00 0C 00 00 00|"; content:!"|00|"; within:1; distance:1; metadata:policy security-ips drop; reference:cve,2006-3875; reference:url,www.microsoft.com/technet/security/bulletin/ms06-059.mspx; classtype:attempted-user; sid:8448; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Agent buffer overflow attempt"; flow:to_client,established; content:"|C4 AB CD AB|"; byte_test:4,<,500,0,relative,little; reference:bugtraq,21034; reference:cve,2006-3445; reference:url,www.microsoft.com/technet/security/bulletin/ms06-068.mspx; classtype:attempted-user; sid:9432; rev:4;)
alert tcp $EXTERNAL_NET [80,5190,8090] -> $HOME_NET any (msg:"WEB-CLIENT Ultravox-Max-Msg header integer overflow attempt"; flow:to_client,established; content:"Ultravox-Max-Msg|3A|"; nocase; byte_test:10,>,65535,0,relative,string; metadata:policy security-ips drop; reference:bugtraq,20744; reference:cve,2006-5567; reference:url,www.winamp.com/player/version_history.php; classtype:attempted-user; sid:9434; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime Movie link file URI security bypass attempt"; flow:to_client,established; content:"<?xml version"; nocase; content:"<?quicktime type=|22|application/x-quicktime-media-link"; distance:0; nocase; content:"qtnext=|22|"; distance:0; nocase; pcre:"/qtnext=\x22((-e\s+|-chrome\s+)?(file|javascript))/smi"; metadata:policy security-ips drop; reference:bugtraq,20138; reference:cve,2006-4965; classtype:attempted-user; sid:9430; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime Movie link scripting security bypass attempt"; flow:to_client,established; content:"<?xml version"; nocase; content:"<?quicktime type=|22|application/x-quicktime-media-link"; distance:0; nocase; pcre:"/<embed[^>]*javascript/smi"; metadata:policy security-ips drop; reference:bugtraq,20138; reference:cve,2006-4965; classtype:attempted-user; sid:9429; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Agent buffer overflow attempt"; flow:to_client,established; content:"|C2 AB CD AB|"; byte_test:4,<,500,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,21034; reference:cve,2006-3445; reference:url,www.microsoft.com/technet/security/bulletin/ms06-068.mspx; classtype:attempted-user; sid:9433; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Gnu gv buffer overflow attempt"; flow:to_client,established; content:"%%DocumentMedia|3A|"; nocase; isdataat:257,relative; content:!"|0A|"; within:257; metadata:policy security-ips drop; reference:bugtraq,20978; reference:cve,2006-5864; classtype:attempted-user; sid:9619; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Download Manger dm.ini stack overflow attempt"; flow:to_client,established; content:"<?aom"; nocase; content:"<url>"; isdataat:271; content:!"</url>"; within:271; nocase; metadata:policy security-ips drop; reference:bugtraq,21453; reference:cve,2006-5856; classtype:attempted-user; sid:9637; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Windows Media Player ASX file ref href buffer overflow attempt"; flow:to_client,established; file_data; content:"<ref"; nocase; content:"href"; distance:0; nocase; pcre:"/<ref\s+href\s*=\s*\x22([^\x22]{2}|(\x25[0-9A-Z]{2}){1,2})\x3A\x2F[^\x22]{100}/smi"; metadata:policy security-ips drop; reference:bugtraq,21247; reference:cve,2006-6134; reference:url,www.microsoft.com/technet/security/bulletin/ms06-078.mspx; classtype:attempted-user; sid:9625; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player ASF simple index object parsing buffer overflow attempt"; flow:to_client,established; content:"|90 08 00|3|B1 E5 CF 11 89 F4 00 A0 C9 03|I|CB|"; byte_test:4,>,715827882,36,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-4702; reference:cve,2009-2527; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-078.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-052.mspx; classtype:attempted-user; sid:9641; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player ASF codec list object parsing buffer overflow attempt"; flow:to_client,established; content:"@R|D1 86 1D|1|D0 11 A3 A4 00 A0 C9 03|H|F6|"; byte_test:4,>,134217727,24,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-4702; reference:cve,2009-2527; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-078.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-052.mspx; classtype:attempted-user; sid:9642; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player ASF marker object parsing buffer overflow attempt"; flow:to_client,established; content:"|01 CD 87 F4|Q|A9 CF 11 8E E6 00 C0 0C| Se"; byte_test:4,>,134217727,24,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-4702; reference:cve,2009-2527; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-078.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-052.mspx; classtype:attempted-user; sid:9643; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player or Explorer Malformed RIFF File DOS attempt"; flow:to_client,established; content:"MThd"; content:"|00 00 00 00 00 00|"; within:6; distance:4; metadata:policy security-ips drop; reference:bugtraq,21612; reference:cve,2006-6601; reference:url,www.milw0rm.com/exploits/3190; classtype:attempted-dos; sid:9801; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime RTSP URI overflow attempt"; flow:to_client,established; file_data; content:"rtsp|3A|//"; nocase; pcre:"/(=\s*([\x27|\x22]rtsp\x3A[^\x22\x27\s]{200}|rstp\x3A[^\s\x3E]{200})|\x3Csrc\x3Ertsp\x3A[^\x3C]{200})/smi"; metadata:policy security-ips drop; reference:bugtraq,21829; reference:cve,2007-0015; reference:url,applefun.blogspot.com/2007/01/moab-01-01-2007-apple-quicktime-rtsp.html; classtype:attempted-user; sid:9823; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime HREF Track Detected"; flow:to_client,established; flowbits:isset,http.quicktime; content:"> T<"; fast_pattern:only; pcre:"/A?<\s*([A-Za-z]{3,5}\x3A\x2F\x2F|javascript\x3a)[^>]+> T</sm"; metadata:policy security-ips drop; reference:cve,2007-0059; reference:url,projects.info-pull.com/moab/MOAB-03-01-2007.html; reference:url,www.apple.com/quicktime/tutorials/hreftracks.html; classtype:misc-activity; sid:9840; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Plugin Universal cross-site scripting attempt"; flow:to_client,established; content:".pdf|23|"; nocase; pcre:"/\x2Epdf\x23[^\r\n]+\x3Djavascript\x3A/smi"; reference:cve,2007-0045; reference:url,isc.sans.org/diary.php?storyid=1999; classtype:misc-attack; sid:9842; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Plugin JavaScript parameter double free attempt"; flow:to_client,established; content:".pdf|23|"; nocase; content:"document."; distance:0; nocase; pcre:"/\x2Epdf\x23[^\r\n]+\x3Djavascript\x3A[^\r\n]*document\x2E\w+/smi"; metadata:policy security-ips drop; reference:cve,2007-0046; reference:url,www.adobe.com/support/security/advisories/apsa07-01.html; classtype:attempted-user; sid:9843; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Vector Markup Language recolorinfo tag numfills parameter buffer overflow attempt"; flow:to_client,established; content:"recolorinfo"; content:"numfills"; pcre:"/recolorinfo[^>]*numfills\s*=\s*\x22/si"; byte_test:10,>,24403223,0,relative,string; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2007-0024; reference:url,www.microsoft.com/technet/security/bulletin/ms07-004.mspx; classtype:attempted-user; sid:9848; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Outlook Saved Search download attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"S|00|a|00|v|00|e|00|d|00|S|00|e|00|a|00|r|00|c|00|h|00|"; metadata:policy security-ips drop; reference:cve,2007-0034; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-003.mspx; classtype:attempted-user; sid:9847; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VLC Media Player udp URI format string attempt"; flow:to_client,established; flowbits:isset,http.m3u.download; file_data; content:"|23|EXTM3U"; content:"udp|3A|//"; distance:0; nocase; content:"%"; distance:0; pcre:"/\x23EXTM3U.*?udp\x3A\x2F\x2F[^\r\n]*%/smi"; metadata:policy security-ips drop; reference:bugtraq,21852; reference:cve,2007-0017; reference:url,projects.info-pull.com/moab/MOAB-02-01-2007.html; classtype:attempted-user; sid:9844; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Vector Markup Language recolorinfo tag numcolors parameter buffer overflow attempt"; flow:to_client,established; content:"recolorinfo"; content:"numcolors"; pcre:"/recolorinfo[^>]*numcolors\s*=\s*\x22/si"; byte_test:10,>,24403223,0,relative,string; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2007-0024; reference:url,www.microsoft.com/technet/security/bulletin/ms07-004.mspx; classtype:attempted-user; sid:9849; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java Virtual Machine malformed GIF buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.gif; content:"GIF"; byte_test:1,!&,128,7,relative; content:","; within:1; distance:10; content:"|00 00|"; within:2; distance:4; metadata:policy security-ips drop; reference:bugtraq,22085; reference:cve,2007-0243; classtype:attempted-user; sid:10062; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Firefox query interface suspicious function call access attempt"; flow:to_client,established; file_data; content:"location.QueryInterface"; nocase; content:"Components.interfaces.nsIClassInfo"; nocase; metadata:policy security-ips drop; reference:bugtraq,16476; reference:cve,2006-0295; reference:url,www.mozilla.org/security/announce/2006/mfsa2006-04.html; classtype:attempted-user; sid:10063; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT AIM GoChat URL access attempt"; flow:to_client,established; content:"aim|3A|GoChat?"; nocase; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,22146; reference:cve,2007-0021; reference:url,projects.info-pull.com/moab/MOAB-20-01-2007.html; classtype:misc-attack; sid:10116; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows WMF DOS attempt"; flow:to_client,established; flowbits:isset,wmf.download; content:"|FC 02|"; pcre:"/\xFC\x02[\x08\x06]\x00.{4}(?!\x00\x00)/s"; metadata:policy security-ips drop; reference:bugtraq,21992; reference:cve,2006-4071; classtype:web-application-attack; sid:10115; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT mozilla compareTo arbitrary code execution attempt"; flow:to_client,established; file_data; content:"InstallVersion"; nocase; content:"compareTo"; distance:0; nocase; pcre:"/InstallVersion\s*\x29?\s*\.\s*compareTo/smi"; metadata:policy security-ips drop; reference:bugtraq,14242; reference:cve,2005-2265; reference:url,www.mozilla.org/security/announce/2005/mfsa2005-50.html; classtype:attempted-user; sid:10131; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel Malformed Named Graph Information unicode overflow"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|95 00|"; isdataat:55,relative; pcre:"/^.{3}(\x00[^\x00]|[^\x00]\x00|[^\x00][^\x00]){25}/Rs"; metadata:policy security-ips drop; reference:cve,2007-0215; reference:url,www.microsoft.com/technet/security/bulletin/ms07-023.mspx; classtype:attempted-user; sid:11258; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime movie ftyp buffer underflow"; flow:to_client,established; flowbits:isset,http.quicktime; content:"|00 00 00 01|ftyp"; metadata:policy security-ips drop; reference:bugtraq,23652; reference:cve,2007-2296; classtype:attempted-user; sid:11180; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer colgroup tag uninitialized memory corruption vulnerability"; flow:to_client,established; content:"<colgroup"; nocase; content:"delete"; distance:0; nocase; pcre:"/<colgroup\s+[^>]*id\s*=\s*(?P<q1>\x22|\x27|)(?P<q2>\w+)(?P=q1)[^>]*>.*\s+(?P=q2)\.delete/smi"; metadata:policy security-ips drop; reference:bugtraq,23771; reference:cve,2007-0944; reference:url,www.microsoft.com/technet/security/bulletin/ms07-027.mspx; classtype:attempted-user; sid:11257; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Photoshop PNG file handling stack buffer overflow attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A|"; content:"PLTE"; byte_test:4,>,768,-8,relative,big; metadata:policy security-ips drop; reference:bugtraq,23698; reference:cve,2007-2365; classtype:attempted-user; sid:11267; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed named graph information ascii overflow"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|95 00|"; isdataat:133,relative; pcre:"/^(.{92}[^\x00]{41}|.{148}[^\x00]{41}|.{172}[^\x00]{41}|.{212}[^\x00]{41}|.{252}[^\x00]{22}|.{272}[^\x00]{22}|.{292}[^\x00]{22}|.{312}[^\x00]{22}|.{332}[^\x00]{22})/Rs"; metadata:policy security-ips drop; reference:cve,2007-0215; reference:url,www.microsoft.com/technet/security/bulletin/ms07-023.mspx; classtype:attempted-user; sid:11290; rev:6;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows schannel security package"; flow:to_client,established; ssl_state:server_hello; content:"|16 03 00|"; content:"|0C|"; within:1; distance:2; byte_jump:2,3,relative,big; byte_jump:2,0,relative,big; content:"|00 00|"; within:2; reference:cve,2007-2218; reference:url,www.microsoft.com/technet/security/bulletin/MS07-031.mspx; classtype:attempted-user; sid:11947; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS tag memory corruption attempt"; flow:to_client,established; content:"style"; nocase; content:"csstext"; distance:0; nocase; pcre:"/\x3c[^\x3e]*style\s*=[^\x3e]*?csstext\x3a/smi"; reference:bugtraq,24423; reference:cve,2007-1750; reference:url,www.microsoft.com/technet/security/bulletin/MS07-033.mspx; classtype:attempted-user; sid:11966; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer SMIL wallclock parsing buffer overflow"; flow:to_client,established; content:"smil "; nocase; content:"wallclock|28|"; distance:0; nocase; pcre:"/wallclock\x28((\d{2}\x3A){2}\d{2}\.[^\x2b\x2d\x5a]{11}|\d{4}-\d{2}-\d{2}T(\d{2}\x3A){2}\d{2}\.[^\x2b\x2d\x5a]{11})/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24658; reference:cve,2007-3410; reference:url,labs.idefense.com/intelligence/vulnerabilities/display.php?id=547; classtype:attempted-user; sid:12219; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer VML source file memory corruption attempt"; flow:to_client,established; content:"stroke"; nocase; pcre:"/<(?P<t>[\w\x2D\x2E]+)\x3A[^>]+>.*?<(?P=t)\x3Astroke\s+[^>]*src\s*=\s*(?P<q>\x22|\x27)[\w\x25\x2D\x2E\x2F\x3A]+\x2E\w{2,4}(?P=q)/smi"; reference:bugtraq,25310; reference:cve,2007-1749; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-050.mspx; classtype:attempted-user; sid:12281; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed FBI record"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"`|10|"; byte_test:2,>,32767,6,relative; metadata:policy security-ips drop; reference:bugtraq,23826; reference:cve,2007-1203; reference:cve,2007-1747; reference:url,www.microsoft.com/technet/security/bulletin/ms07-023.mspx; classtype:attempted-user; sid:12256; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer VML source file memory corruption attempt"; flow:to_client,established; content:"imagedata"; nocase; pcre:"/<(?P<t>[\w\x2D\x2E]+)\x3A[^>]+>.*?<(?P=t)\x3Aimagedata\s+[^>]*src\s*=\s*(?P<q>\x22|\x27)[\w\x25\x2D\x2E\x2F\x3A]+\x2E\w{2,4}(?P=q)/smi"; reference:bugtraq,25310; reference:cve,2007-1749; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-050.mspx; classtype:attempted-user; sid:12280; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft XML substringData integer overflow attempt"; flow:to_client,established; content:"substringData"; nocase; pcre:"/\w+\.substringData\([^\),]+,\s*(\d{4,}|25[7-9]|2[6-9][0-9]|[3-9][0-9]{2}|0x0*([1-9a-f][1-9a-f]{3,}|[2-9a-f][0-9a-f]{2}|1([0-9a-f][0-9a-f]|0[1-9a-f])))/smi"; metadata:policy security-ips drop; reference:cve,2007-2223; reference:cve,2007-2224; reference:cve,2008-1442; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-042.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-043.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-031.mspx; classtype:attempted-user; sid:12279; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer VML source file memory corruption attempt"; flow:to_client,established; content:"vmlframe"; nocase; pcre:"/<(?P<t>[\w\x2D\x2E]+)\x3A[^>]+>.*?<(?P=t)\x3Avmlframe\s+[^>]*src\s*=\s*(?P<q>\x22|\x27)[\w\x25\x2D\x2E\x2F\x3A]+\x2E\w{2,4}(?P=q)/smi"; reference:bugtraq,25310; reference:cve,2007-1749; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-050.mspx; classtype:attempted-user; sid:12282; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel rtWnDesk record memory corruption exploit attempt"; flow:to_client,established; content:"8|00 04 00|"; byte_test:2,>,32767,0,relative,little; flowbits:isset,http.xlw; reference:cve,2007-3890; reference:url,www.microsoft.com/technet/security/Bulletin/ms07-044.mspx; classtype:attempted-user; sid:12284; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT PCRE character class double free overflow attempt"; flow:to_client,established; content:"RegExp("; nocase; content:"[["; distance:0; content:"]]"; within:6; distance:1; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,25002; reference:cve,2007-3944; reference:url,docs.info.apple.com/article.html?artnum=306174; classtype:attempted-user; sid:12286; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Visual Basic VBP file reference overflow attempt"; flow:to_client,established; content:"Reference"; nocase; pcre:"/^Reference\s*=\s*\*\x5CG\{[A-Z\d-]{36}\}\x23\d+\.\d+\x23\d+\x23[^\r\n]{474}/smi"; reference:bugtraq,25629; reference:cve,2007-4776; classtype:attempted-user; sid:12618; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows URI External handler arbitrary command attempt"; flow:to_client,established; content:"%00%00"; pcre:"/(mailto|telnet|news|nntp|snews)\x3A%00%00/i"; reference:cve,2007-3896; reference:url,www.microsoft.com/technet/security/bulletin/ms07-061.mspx; classtype:attempted-user; sid:12643; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows ShellExecute and IE7 url handling code execution attempt"; flow:to_client,established; content:"|22|.cmd"; nocase; pcre:"/(mailto|telnet|news|nntp|snews)\x3A[^\n]*\x25[^\n]*\x22\x2Ecmd/i"; metadata:policy security-ips alert; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-057.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-061.mspx; classtype:attempted-user; sid:12688; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows ShellExecute and IE7 url handling code execution attempt"; flow:to_client,established; content:"|22|.bat"; nocase; pcre:"/(mailto|telnet|news|nntp|snews)\x3A[^\n]*\x25[^\n]*\x22\x2Ebat/i"; metadata:policy security-ips alert; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-057.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-061.mspx; classtype:attempted-user; sid:12687; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer lyrics heap overflow attempt"; flow:to_client,established; content:"LYRICSBEGIN"; nocase; pcre:"/(EAL|EAR|ETT)\s*-0{0,4}1/i"; reference:bugtraq,26214; reference:cve,2007-5080; classtype:attempted-user; sid:12707; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks SMIL wallclock stack overflow attempt"; flow:to_client,established; content:"<smi"; nocase; content:"wallclock|28|"; pcre:"/^[^\x29]*\x2E[0-9]{11}/R"; metadata:policy balanced-ips drop, policy security-ips drop, service sunrpc; reference:bugtraq,24658; reference:cve,2007-3410; classtype:attempted-user; sid:12728; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FLAC libFLAC picture description metadata buffer overflow attempt"; flow:to_client,established; content:"fLaC"; content:"|06|"; byte_jump:4,7,relative; content:"|FF FF FF FF|"; within:4; metadata:policy security-ips drop; reference:bugtraq,26042; reference:cve,2007-4619; classtype:attempted-user; sid:12743; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime uncompressed PICT stack overflow attempt"; flow:to_client,established; content:"|00 00 00 00 00 00 00 00 00 00|"; content:"|00 11 02 FF|"; distance:0; fast_pattern; content:"|82 01|"; distance:0; byte_test:4,<,50,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26344; reference:cve,2007-4672; classtype:attempted-user; sid:12757; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FLAC libFLAC picture metadata buffer overflow attempt"; flow:to_client,established; content:"fLaC"; content:"|06|"; content:"|FF FF FF FF|"; within:4; distance:7; metadata:policy security-ips drop; reference:bugtraq,26042; reference:cve,2007-4619; classtype:attempted-user; sid:12745; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FLAC libFLAC VORBIS string buffer overflow attempt"; flow:to_client,established; content:"fLaC"; content:"|04|"; content:"|FF FF FF FF|"; within:4; distance:3; metadata:policy security-ips drop; reference:bugtraq,26042; reference:cve,2007-4619; classtype:attempted-user; sid:12744; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Media Player .asf markers detected"; flow:to_client,established; content:"|01 CD 87 F4|Q|A9 CF 11 8E E6 00 C0 0C| Se"; content:" |DB FE|L|F6|u|CF 11 9C 0F 00 A0 C9 03|I|CB|"; within:16; distance:8; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0064; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-068.mspx; classtype:attempted-user; sid:12972; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB_CLIENT Microsoft Media Player asf streaming format audio error masking integer overflow attempt"; flow:to_client,established; content:"49F1A440-4ECE-11d0-A3AC-00A0C90348F6"; byte_jump:4, 8, relative; byte_test:2, >, 65527, 14, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0064; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-068.mspx; classtype:attempted-user; sid:13159; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Media Player asf streaming audio spread error correction data length integer overflow attempt"; flow:to_client,established; content:"BFC3CD50-618F-11CF-8BB2-00AA00B4E220"; byte_test:4, >, 65522, 12, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0064; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-068.mspx; classtype:attempted-user; sid:13160; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB_CLIENT Microsoft Media Player asf streaming format interchange data integer overflow attempt"; flow:to_client,established; content:"35907DE0-E415-11CF-A917-00805F5C442B"; byte_test:2, >, 65476, 52, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0064; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-068.mspx; classtype:attempted-user; sid:13158; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime panorama atoms buffer overflow attempt"; flow:to_client,established; content:"video/quicktime"; nocase; content:"pdat"; byte_test:2,=,0,6,relative; byte_test:4,>,104,-8,relative; metadata:policy security-ips drop; reference:bugtraq,26342; reference:cve,2007-4675; reference:url,docs.info.apple.com/article.html?artnum=306896; classtype:attempted-user; sid:13293; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing des buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mp4; content:"|A9|des"; byte_test:4, >, 512, 0, relative; metadata:policy security-ips drop; reference:bugtraq,19976; reference:bugtraq,26773; reference:cve,2006-4386; reference:cve,2007-6401; classtype:attempted-user; sid:13319; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing ART buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mp4; content:"|A9|ART"; byte_test:4, >, 512, 0, relative; metadata:policy security-ips drop; reference:bugtraq,19976; reference:bugtraq,26773; reference:cve,2006-4386; reference:cve,2007-6401; classtype:attempted-user; sid:13316; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing cmt buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mp4; content:"|A9|cmt"; byte_test:4, >, 512, 0, relative; metadata:policy security-ips drop; reference:bugtraq,19976; reference:bugtraq,26773; reference:cve,2006-4386; reference:cve,2007-6401; classtype:attempted-user; sid:13318; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apache mod_imagemap cross site scripting attempt"; flow:to_server,established; content:".map/"; nocase; http_uri; content:"script"; nocase; pcre:"/.map/[^\n]*script[^\n]*script/i"; reference:bugtraq,26838; reference:cve,2007-5000; classtype:web-application-attack; sid:13302; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing cpy buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mp4; content:"|A9|cpy"; byte_test:4, >, 512, 0, relative; metadata:policy security-ips drop; reference:bugtraq,19976; reference:bugtraq,26773; reference:cve,2006-4386; reference:cve,2007-6401; classtype:attempted-user; sid:13320; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT 3ivx MP4 file parsing nam buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mp4; content:"|A9|nam"; byte_test:4, >, 512, 0, relative; metadata:policy security-ips drop; reference:bugtraq,19976; reference:bugtraq,26773; reference:cve,2006-4386; reference:cve,2007-6401; classtype:attempted-user; sid:13317; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player embedded JPG image height overflow attempt"; flow:to_client,established; content:"FWS"; content:"|FF D8|"; distance:0; content:"JFIF"; distance:0; content:"|FF C0|"; distance:0; byte_test:2, >, 32767, 3, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26951; reference:cve,2007-6242; classtype:attempted-admin; sid:13300; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player embedded JPG image width overflow attempt"; flow:to_client,established; content:"FWS"; content:"|FF D8|"; distance:0; content:"JFIF"; distance:0; content:"|FF C0|"; distance:0; byte_test:2, >, 32767, 5, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26951; reference:cve,2007-6242; classtype:attempted-admin; sid:13301; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Quicktime user agent"; flow:to_server,established; content:"User-Agent|3A| QuickTime"; http_header; flowbits:set,quicktime_agent; flowbits:noalert; classtype:misc-activity; sid:13515; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime HTTP error response buffer overflow"; flow:to_client,established; flowbits:isset, quicktime_agent; content:"HTTP/1.1 404"; isdataat:256,relative; content:!"|0A|"; within:256; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,27225; reference:cve,2008-0234; classtype:attempted-user; sid:13516; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Zango adware installation request"; flow:to_server,established; content:"Zango/Setup.exe"; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:url,www.ftc.gov/os/caselist/0523130/index.shtm; classtype:policy-violation; sid:13632; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows metafile SetPaletteEntries heap overflow attempt"; flow:to_client,established; flowbits:isset,wmf.download; content:"|00 09 00|"; content:"|FF FF FF|"; distance:12; content:"|00|"; within:1; distance:2; pcre:"/[\x00\x01]\x00\x09\x00.*?\xff\xff\xff[\xff\xf7][\x36\x37]\x00/smi"; reference:bugtraq,15356; reference:cve,2005-2124; reference:url,www.microsoft.com/technet/security/bulletin/ms05-053.mspx; classtype:attempted-user; sid:13807; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player SWF scene and label data memory corruption attempt"; flow:to_client,established; content:"|BF 15 84 03 00 00|"; content:"|BF 14|D|02 00 00|"; within:6; distance:900; content:"?|13 1F 00 00 00|"; within:6; distance:640; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28695; reference:bugtraq,29386; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:13821; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player SWF scene and label data memory corruption attempt"; flow:to_client,established; content:"|A8 15|"; content:"|8C 15|"; within:2; distance:40; content:"|BF 14 7F 01 00 00|"; within:6; distance:12; content:"|19 13|"; within:2; distance:383; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28695; reference:bugtraq,29386; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:13822; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player SWF scene and label data memory corruption attempt"; flow:to_client,established; content:"|A8 15|"; content:"|BF 15 0C 00 00 00|"; within:6; distance:45; content:"|BF 14 7F 01 00 00|"; within:6; distance:12; content:"?|13 19 00 00 00|"; within:6; distance:383; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28695; reference:bugtraq,29386; reference:cve,2007-0071; reference:url,www.adobe.com/support/security/bulletins/apsb08-11.html; classtype:attempted-user; sid:13820; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox IFRAME style change handling code execution"; flow:to_client,established; content:"iframe"; nocase; content:"iframe.contentDocument.designMode"; nocase; content:"addEventListener"; nocase; pcre:"/addEventListener\s*\(\s*(?P<q>\x22|\x27|)(mouse(move|down)|keydown)(?P=q)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28448; reference:cve,2008-1236; reference:url,secunia.com/advisories/29526; reference:url,www.mozilla.org/security/announce/2008/mfsa2008-15.html; classtype:attempted-user; sid:13838; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe BMP image handler buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.bmp; content:"image/bmp"; fast_pattern:only; http_header; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; byte_test:4, >, 256, 36, relative, little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28874; reference:cve,2008-1765; classtype:attempted-user; sid:13865; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime MOV file string handling integer overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"hdlr"; byte_test:1,>=,251,24,relative; metadata:policy security-ips drop; reference:bugtraq,15306; reference:cve,2005-2753; classtype:attempted-user; sid:13917; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime MOV file string handling integer overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"text"; byte_test:1,>=,251,49,relative; reference:bugtraq,15306; reference:cve,2005-2753; classtype:attempted-user; sid:13919; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime MOV file string handling integer overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"tmci"; byte_test:1,>=,251,24,relative; metadata:policy security-ips drop; reference:bugtraq,15306; reference:cve,2005-2753; classtype:attempted-user; sid:13918; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime Obji Atom parsing stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"obji"; nocase; byte_test:4,<,20,-8,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28583; reference:cve,2008-1022; classtype:attempted-user; sid:13920; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java Web Start JNLP attribute buffer overflow attempt"; flow:to_client,established; content:"<j2se"; nocase; pcre:"/\x3cj2se[^\x3e]*(initial|max)-heap-size\s*\x3d\s*(\x22|\x27)[^\x22\x27]{50}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30148; reference:cve,2008-3111; classtype:attempted-user; sid:13950; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT CyberLink PowerDVD playlist file handling stack overflow attempt"; flow:to_client,established; flowbits:isset,http.m3u.download; content:"Content-Length"; nocase; http_header; pcre:"/Content-Length\x3a\s*(\d{7}|[5-9]\d{5})/iH"; reference:bugtraq,30341; classtype:attempted-user; sid:14019; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT CyberLink PowerDVD playlist file handling stack overflow attempt"; flow:to_client,established; flowbits:isset,http.pls; content:"Content-Length"; nocase; http_header; pcre:"/Content-Length\x3a\s*(\d{7}|[5-9]\d{5})/iH"; reference:bugtraq,30341; classtype:attempted-user; sid:14020; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader and Acrobat util.printf buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"util.printf"; pcre:"/\x28\s*\x22\s*\x25([2-9][6-9][5-9]|[1-9][0-9]{3,})f/mi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2008-2992; classtype:attempted-user; sid:15014; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java Web Start xml encoding buffer overflow attempt"; flow:to_client,established; content:"<?xml"; nocase; content:"encoding"; distance:0; nocase; pcre:"/^<\x3Fxml[^>]+?encoding\s*=\s*(\x22[^\x22]{28}|\x27[^\x27]{28})/smi"; metadata:policy security-ips drop; reference:bugtraq,28083; reference:cve,2008-1188; reference:url,sunsolve.sun.com/search/document.do?assetkey=1-66-233323-1; classtype:attempted-admin; sid:15081; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer nested tag memory corruption attempt"; flow:to_client,established; file_data; content:"datasrc"; distance:0; nocase; content:"datafld"; nocase; pcre:"/<(?P<t1>button|div|input[^>]+?type\s*=\s*(\x22|\x27)button(\x22|\x27)|label|legend|marquee|param|span)\s+[^>]*(datasrc\s*=\s*(?P<q1>\x22|\x27|)(?P<d1>\S+)(?P=q1)\s+[^>]*datafld\s*=\s*(?P<q2>\x22|\x27|)(?P<d2>\S+)(?P=q2)|datafld\s*=\s*(?P<q3>\x22|\x27|)(?P<d3>\S+)(?P=q3)\s+[^>]*datasrc\s*=\s*(?P<q4>\x22|\x27|)(?P<d4>\S+)(?P=q4))[^>]*>(?!.*?<\/\s*(?P=t1)\s*>.*?<(?P=t1)).*?<(?P=t1)\s+[^>]*(datasrc\s*=\s*(?P<q5>\x22|\x27|)((?P=d1)|(?P=d3))(?P=q5)\s+datafld\s*=\s*(?P<q6>\x22|\x27|)((?P=d2)|(?P=d4))(?P=q6)|(datafld\s*=\s*(?P<q7>\x22|\x27|)(?P=d1)(?P=q7)\s+datasrc\s*=\s*(?P<q8>\x22|\x27|)(?P=d2)(?P=q8)))/Osi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32721; reference:cve,2008-4844; reference:url,www.microsoft.com/technet/security/bulletin/ms08-078.mspx; classtype:attempted-user; sid:15126; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC Media Player XSPF memory corruption attempt TEST"; flow:to_client,established; flowbits:isset,xspf_file.request; file_data; content:"|3C|identifier|3E|"; pcre:"/\x3cidentifier\x3E[^\x3c]*\x2d\d/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4558; classtype:attempted-user; sid:15157; rev:3;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC Media Player RealText buffer overflow attempt"; flow:to_client,established; flowbits:isset,realplayer.playlist; content:"<time "; nocase; pcre:"/\x3ctime\x20[^\x3e]*(begin|end)\x3d\x22[^\x22]{13}/Osmi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-5036; classtype:attempted-user; sid:15166; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ACD Systems ACDSee XPM file format overflow attempt"; flow:to_client,established; content:"/* XPM */"; pcre:"/^\s*\x22[^\x22\n]{300}/mi"; metadata:policy security-ips drop; reference:bugtraq,23620; reference:cve,2007-2193; classtype:attempted-user; sid:15236; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe PDF JBIG2 remote code execution attempt"; flow:to_client,established; content:"JBIG2Decode"; nocase; content:"stream"; distance:0; nocase; pcre:"/JBIG2Decode.*?stream(\x0d\x0a|\x0a|\x0d)/si"; byte_test:1,&,0x40,4,relative; byte_test:1,=,0,5,relative; byte_test:4,>,0x1000,6,relative,big; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:15357; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT obfuscated javascript excessive fromCharCode - potential attack"; flow:to_client,established; content:"String.fromCharCode|28|"; nocase; content:"String.fromCharCode|28|"; within:100; nocase; content:"String.fromCharCode|28|"; within:100; nocase; content:"String.fromCharCode|28|"; within:100; nocase; content:"String.fromCharCode|28|"; within:100; nocase; metadata:policy security-ips drop; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.cs.ucsb.edu/~marco/blog/2008/10/dom-based-obfuscation-in-malicious-javascript.html; classtype:misc-activity; sid:15362; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Potential obfuscated javascript eval unescape attack attempt"; flow:to_client,established; content:"eval|28|"; nocase; content:"unescape|28|"; within:15; nocase; content:!"|29|"; within:250; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,cansecwest.com/slides07/csw07-nazario.pdf; reference:url,www.cs.ucsb.edu/~marco/blog/2008/10/dom-based-obfuscation-in-malicious-javascript.html; classtype:misc-activity; sid:15363; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime pict image poly structure memory corruption attempt"; flow:to_client,established; content:"|00 11 02 FF 0C 00|"; pcre:"/\x00[\x70-\x74]\x00[\x00-\x09]/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26345; reference:bugtraq,34938; reference:cve,2007-4676; reference:cve,2009-0010; classtype:attempted-user; sid:15384; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows OLE32 MSHTA masquerade attempt"; flow:to_client,established; flowbits:isnotset,http.hta; content:"R|00|o|00|o|00|t|00| |00|E|00|n|00|t|00|r|00|y|00|"; nocase; content:"|D8 F4|P0|B5 98 CF 11 BB 82 00 AA 00 BD CE 0B|"; within:16; distance:60; metadata:policy security-ips drop; reference:bugtraq,13132; reference:cve,2005-0063; reference:url,www.microsoft.com/technet/security/bulletin/ms05-016.mspx; classtype:attempted-user; sid:3552; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML DOM null DHTML element insertion attempt"; flow:to_client,established; file_data; content:"NULL"; pcre:"/(insertBefore|insertAfter|appendChild)\(\s*NULL\s*\)/sm"; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:3553; rev:13;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Content Advisor memory corruption attempt"; flow:to_client,established; flowbits:isset,http.rat; file_data; content:"name"; nocase; pcre:"/rating\x2Dservice.{0,300}\x28\s*name\s*\x22[^\x22]{261}/smi"; metadata:policy security-ips drop; reference:cve,2005-0555; reference:url,www.microsoft.com/technet/security/Bulletin/MS05-020.mspx; classtype:attempted-user; sid:3686; rev:12;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft EMF+ GpFont.SetData buffer overflow attempt"; flow:to_client,established; content:"|01 00 00 00|"; content:" EMF"; within:4; distance:36; byte_jump:4,-40,relative,little; content:"F|00 00 00|,|00 00 00| |00 00 00|"; within:12; distance:-8; content:"F|00 00 00|"; distance:0; content:"|08|@|00 06|"; within:4; distance:12; byte_test:4,>,4261412864,28,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34250; reference:cve,2009-1217; classtype:attempted-user; sid:15430; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox SVG data processing memory corruption attempt"; flow:to_client,established; flowbits:isset,svg_file.request; content:"getElementsByTagName"; content:"pathSegList"; content:"createSVGPathSegMoveto"; fast_pattern; nocase; content:"appendItem"; distance:1; content:"replaceItem"; distance:1; pcre:"/(?P<N1>[a-zA-Z\x5f][a-zA-Z\x5f0-9]*\x2e)appendItem(?!.+?(?P=N1)appendItem).+?(?P=N1)replaceItem/s"; metadata:policy security-ips drop; reference:bugtraq,33990; reference:cve,2009-0771; reference:url,www.mozilla.org/security/announce/2009/mfsa2009-07.html; classtype:attempted-user; sid:15428; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Multiple MP3 player PLS buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.pls; file_data; content:"[playlist]"; fast_pattern; nocase; content:"File"; distance:0; nocase; content:"="; within:5; distance:1; isdataat:500,relative; content:!"|0A|"; within:500; metadata:policy security-ips drop; reference:bugtraq,16410; reference:bugtraq,33589; reference:cve,2006-0476; reference:cve,2009-0476; classtype:attempted-user; sid:15472; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT asp file upload"; flow:to_server,established; content:".asp"; nocase; flowbits:set,asp.upload; flowbits:noalert; classtype:protocol-command-decode; sid:15471; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Multiple media players M3U playlist file handling buffer overflow attempt"; flow:to_client,established; content:"|23|EXTM3U"; nocase; pcre:"/^[^\x0a]{501}/m"; reference:bugtraq,16410; reference:bugtraq,16623; reference:bugtraq,21206; reference:cve,2006-0476; reference:cve,2006-0708; reference:cve,2006-6063; classtype:attempted-user; sid:15473; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Trend Micro OfficeScan Server cgiRecvFile overflow attempt"; flow:to_server,established; content:"/cgi/cgiRecvFile.exe"; http_uri; content:"ComputerName"; pcre:"/ComputerName\s*\x3d\s*\x22[^\x22]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,31139; reference:cve,2008-2437; classtype:attempted-admin; sid:15510; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime Movie File Clipping Region handling heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"crgn"; byte_jump:2,-6,relative,big; content:!"|7F FF 7F FF|"; within:4; distance:-8; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35167; reference:cve,2009-0954; reference:url,support.apple.com/kb/HT3591; classtype:attempted-user; sid:15559; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader JPX malformed code-block width attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"jP  "; content:"|FF|O|FF|Q"; distance:0; byte_jump:2,36,relative,multiplier 3,big; content:"|FF|R"; within:2; byte_test:1,>,16,7,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1859; classtype:attempted-user; sid:15562; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT F-Secure AntiVirus library heap overflow attempt"; flow:to_client,established; flowbits:isset,arj_file.request; content:"|0A|`|EA|"; pcre:"/\x0a\x0d?\x0a\x60\xea(.{36}[^\x00]{256}|.+\x60\xea.{32}[^\x00]{256})/s"; metadata:policy security-ips drop; reference:bugtraq,12515; reference:cve,2005-0350; classtype:attempted-user; sid:15583; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Possible generic javascript heap spray attempt"; flow:to_client,established; content:"%u0c0c%u0c0c"; fast_pattern:only; nocase; metadata:policy security-ips drop; reference:bugtraq,35660; classtype:attempted-user; sid:15698; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Generic javascript obfuscation attempt"; flow:to_client,established; file_data; content:"unescape"; nocase; pcre:"/var[^=]+=\s*unescape\s*\x3b/i"; metadata:policy security-ips drop; reference:bugtraq,35660; classtype:attempted-user; sid:15697; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes PCAST protocol handler stack buffer overflow attempt"; flow:to_client,established; file_data; content:"pcast|3A|//"; nocase; pcre:"/(\x22|\x27)pcast\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15705; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes ITMS protocol handler stack buffer overflow attempt"; flow:to_client,established; file_data; content:"itms|3A|//"; nocase; isdataat:256,relative; pcre:"/(\x22|\x27)itms\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15703; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat and Adobe Acrobat Reader FlateDecode integer overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/DecodeParms"; content:"/Predictor"; distance:0; byte_test:8,>,1,0,relative,string,dec; pcre:"/\x2fDecodeParms\s*\x3c{2}\s*(?=[^\x3e]*\/Predictor\s+0*(1\d{1}|[2-9]))([^\x3e]*\x2fBitsPerComponent\s+\d{3}|[^\x3e]*\x2fColumns\s+(\d{5}|[6-9]\d{3})|[^\x3e]*\x2fColors\s+(\d{5}|[6-9]\d{3}))/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35294; reference:bugtraq,36600; reference:cve,2009-1856; reference:cve,2009-3459; classtype:attempted-user; sid:15709; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes ITPC protocol handler stack buffer overflow attempt"; flow:to_client,established; file_data; content:"itpc|3A|//"; nocase; isdataat:256,relative; pcre:"/(\x22|\x27)itpc\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15707; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes DAAP protocol handler stack buffer overflow attempt"; flow:to_client,established; file_data; content:"daap|3A|//"; nocase; isdataat:256,relative; pcre:"/(\x22|\x27)daap\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15706; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes ITMSS protocol handler stack buffer overflow attempt"; flow:to_client,established; file_data; content:"itmss|3A|//"; nocase; isdataat:256,relative; pcre:"/(\x22|\x27)itmss\x3a\x2f\x2f[^\x22\x27]*\x3a[^\x22\x27\x2f]{256}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35157; reference:cve,2009-0950; classtype:attempted-user; sid:15704; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Firefox defineSetter function pointer memory corruption attempt"; flow:to_client,established; content:".watch|28|"; nocase; content:"__defineSetter__|28|"; nocase; pcre:"/(?P<obj>\w+)\.watch\((?P<q1>\x22|\x27|)(?P<prop>[A-Z0-9\x2d\x5f]+)(?P=q1).*(?P=obj)\.__defineSetter__\((?P<q2>\x22|\x27|)(?P=prop)(?P=q2)/smi"; metadata:policy security-ips drop; reference:bugtraq,35758; reference:cve,2009-2469; classtype:attempted-user; sid:15872; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat PDF font processing memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"obj<<"; content:"/BaseFont"; distance:0; content:"endobj"; distance:0; pcre:"/obj\x3c\x3c.*?\x2fBaseFont\x2f[^\x80-\xff\x2f]*[\x80-\xff].*?endobj/s"; metadata:policy security-ips drop; reference:bugtraq,32100; reference:cve,2008-4813; reference:url,vallejo.cc/proyectos/adobereader812.html; classtype:attempted-user; sid:15867; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT libxml2 file processing long entity overflow attempt"; flow:to_client,established; flowbits:isset,xml.download; content:"<!ENTITY"; fast_pattern; isdataat:200,relative; pcre:"/^\s+([^\x22\x20\x3E]{200}|[^\s]*\s+\x22[^\x22\x20\x3E]{200})/smR"; metadata:policy security-ips drop, service http; reference:bugtraq,31126; reference:cve,2008-3529; classtype:attempted-user; sid:15866; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FFmpeg 4xm processing memory corruption attempt"; flow:to_client,established; flowbits:isset,4xm.request; content:"strk|28 00 00 00|"; byte_test:4,>,0x7ffffffe,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33502; reference:cve,2009-0385; classtype:attempted-user; sid:15871; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Firefox location spoofing via invalid window.open characters"; flow:to_client,established; content:"window.open|28|"; nocase; pcre:"/window\x2Eopen\x28(\x22[^\x22]+(\x25[^0-9a-f]|\x2C)|\x27[^\x27]+(\x25[^0-9a-f]|\x2C))/smi"; metadata:policy security-ips alert; reference:bugtraq,35803; reference:cve,2009-2654; classtype:misc-attack; sid:15873; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player ASnative command execution attempet"; flow:to_client,established; content:"|00|airappinstaller|00|ASnative|00|"; pcre:"/\x00[\x3b\x7c\x26\x60][^\x00]+\x00airappinstaller\x00ASnative\x00/smi"; content:"|99 08|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32896; reference:cve,2008-5499; classtype:attempted-user; sid:15869; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT fCreateShellLink function use - potential attack"; flow:to_client,established; content:"fCreateShellLink|28|"; nocase; reference:bugtraq,29792; reference:cve,2008-2959; classtype:misc-activity; sid:15893; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime VR Track Header Atom heap corruption attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"trak"; content:"tkhd"; within:4; distance:4; fast_pattern; pcre:"/trak.{4}tkhd.{40}(?=.{20})(?!\x00\x01\x00\x00.{12}\x00\x01\x00\x00)/s"; metadata:policy security-ips drop; reference:bugtraq,33384; reference:cve,2009-0002; reference:url,support.apple.com/kb/HT3403; classtype:attempted-user; sid:15909; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer URL canonicalization address bar spoofing attempt"; flow:to_client,established; content:"%01@"; pcre:"/http\x3A\x2f\x2f[^\r\n]+\x2501\x40/smi"; reference:cve,2003-1025; reference:url,www.microsoft.com/technet/security/bulletin/ms04-004.mspx; classtype:misc-activity; sid:15933; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sophos Anti-Virus zip file handling DoS attempt"; flow:to_client,established; content:"PK|03 04|"; content:"|0C 00|"; within:2; distance:4; content:"-|00 00 00 F9 00 00 00 05 00 FF FF|"; within:12; distance:8; metadata:policy security-ips drop; reference:bugtraq,14270; reference:cve,2005-1530; classtype:attempted-dos; sid:15957; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Vista Feed Headlines Gagdet code execution attempt"; flow:to_client,established; flowbits:isset,rss.download; content:"&lt|3B|"; fast_pattern; nocase; content:"<title>"; nocase; pcre:"/\x3ctitle\x3e[^\x3c]*\x26lt\x3b[^\x3c]*(>|\x26gt\x3b)/i"; metadata:policy security-ips drop; reference:bugtraq,25287; reference:cve,2007-3033; classtype:attempted-user; sid:15946; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla regular expression heap corruption attempt"; flow:to_client,established; content:"new RegExp|28|"; nocase; pcre:"/^(?=[^\x29]*\x5c{2}[\x22\x27])[^\x29]*\x5b[^\x5d]*\x5c{2}[\x22\x27]/R"; metadata:policy security-ips drop; reference:bugtraq,20042; reference:cve,2006-4566; classtype:attempted-user; sid:8443; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Sun Microsystems Java gif handling memory corruption attempt"; flow:to_client,established; content:"|F9 04 01 00 00 10 00|,|00 00 00 00 00 00 90 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,22085; reference:cve,2007-0243; classtype:attempted-user; sid:16000; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML Decoding memory corruption attempt"; flow:to_client,established; content:"charset=UTF-8"; nocase; file_data; content:"|F8|AAA|F8|AA|C8|"; within:8; metadata:policy security-ips drop; reference:bugtraq,18309; reference:cve,2006-2382; classtype:attempted-user; sid:16032; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; content:".distz"; nocase; http_uri; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Edistz/smi"; reference:cve,2007-0465; classtype:attempted-admin; sid:16003; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT winamp midi file header overflow attempt"; flow:to_client,established; content:"MThd|00 00 00 06 00 00 00 01 00|`MTrk"; byte_test:4,>,2147483648,8,relative; metadata:policy security-ips drop; reference:bugtraq,18507; reference:cve,2006-3228; classtype:attempted-user; sid:16027; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; content:".pkg"; nocase; http_uri; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Epkg/smi"; reference:cve,2007-0465; classtype:attempted-admin; sid:16002; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer nested object tag memory corruption attempt"; flow:to_client,established; content:"<STYLE></STYLE>|0A|<OBJECT"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,17658; reference:cve,2006-1992; classtype:attempted-user; sid:16031; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Mac OS X installer package filename format string vulnerability"; flow:to_server,established; content:".mpkg"; nocase; http_uri; pcre:"/GET\s+[^\x0D\x0A]*\x25[^\x0D\x0A]*\x2Empkg/smi"; reference:cve,2007-0465; classtype:attempted-admin; sid:16004; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer html tag memory corruption attempt"; flow:to_client,established; content:"|09 09|pre {|0A 09 09 09|white-space|3A|normal|3B 0A|"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,17468; reference:cve,2006-1188; classtype:attempted-dos; sid:16043; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT GNU tar PAX extended headers handling overflow attempt"; flow:to_client,established; content:"GNU.sparse.numblocks="; nocase; pcre:"/GNU\x2esparse\x2enumblocks\s*\x3d\s*(0|[6-9]\d{4})/smi"; metadata:policy security-ips drop; reference:bugtraq,16764; reference:cve,2006-0300; classtype:attempted-dos; sid:16053; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox tag order memory corruption attempt"; flow:to_client,established; content:"BGCOLOR=|22|http|3A 22|-|9D 22 22| DP=-|B3| UNITS=|22 E2 E2 E2 E2|"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,17516; reference:cve,2006-0749; classtype:attempted-user; sid:16050; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox CSS Letter-Spacing overflow attempt"; flow:to_client,established; content:"style=|22|letter-spacing|3A| -2147483648"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,17516; reference:cve,2006-1730; classtype:attempted-user; sid:16044; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime bitmap multiple header overflow"; flow:to_client,established; flowbits:isset,http.bmp; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; byte_test:4,>,65535,4,relative,little; byte_test:4,>,3,12,relative,little; metadata:policy security-ips drop; reference:bugtraq,17953; reference:cve,2006-2238; classtype:attempted-user; sid:16054; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer isindex buffer overflow attempt"; flow:to_client,established; content:"<style>"; nocase; content:"<isindex>"; distance:0; fast_pattern; nocase; content:"<style>"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,27668; reference:cve,2008-0076; reference:url,www.microsoft.com/technet/security/bulletin/ms08-010.mspx; classtype:attempted-user; sid:16063; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft ASP.NET application folder info disclosure attempt"; flow:to_server,established; content:"app|5F|code"; nocase; http_uri; pcre:"/^\w+\s+[^\s]*app\x5fcode(\x255c|\x5c)/i"; metadata:policy security-ips drop; reference:bugtraq,18920; reference:cve,2006-1300; classtype:attempted-recon; sid:16048; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft SQL Server Distributed Management Objects overflow attempt"; flow:to_client,established; content:"<object classid='clsid|3A|10020200-E260-11CF-AE68-00AA004A34D5' id='SQLServer'"; nocase; content:"SQLDMO.SQLServer"; nocase; pcre:"/progid\s*\x3d\s*[\x22\x27]SQLDMO\x2eSQLServer[\x22\x27]/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,25594; reference:cve,2007-4814; classtype:attempted-user; sid:16208; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT HP OpenView Network Node Manager ovlaunch host field overflow attempt"; flow:to_server,established; content:"ovlaunch.exe"; nocase; http_uri; content:"host|3A|"; nocase; isdataat:300,relative; pcre:"/^host\x3a\s*[^\r\n]{300}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33668; reference:cve,2008-4562; classtype:attempted-user; sid:16204; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Kaspersky antivirus library heap buffer overflow - without optional fields"; flow:to_client,established; file_data; content:"MSCF"; byte_test:2,&,0x0003,26,relative,little; byte_test:2,!&,0x0004,26,relative,little; pcre:"/^.{32}([^\x00]*\x00)?[^\x00]{256}/sR"; metadata:policy security-ips drop; reference:bugtraq,14998; reference:cve,2005-3142; classtype:attempted-user; sid:16295; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML DOM invalid DHTML textnode creation attempt"; flow:to_client,established; file_data; content:"document.location.href"; fast_pattern:only; content:"createTextNode"; pcre:"/(\w+)\s*=\s*\w+\.createTextNode\(((\x22\x22|\x27\x27)|([A-z]\w*))\)\s*\;.*?\w+\.(insertBefore|insertAfter|appendChild)\(\1\)\;|\w\.(insertBefore|insertAfter|appendChild)\(\w+\.createTextNode\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:policy security-ips drop; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:16301; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Kaspersky antivirus library heap buffer overflow - with optional fields"; flow:to_client,established; content:"|0D 0A 0D 0A|MSCF"; byte_test:2,&,0x0003,26,relative,little; byte_test:2,&,0x0004,26,relative,little; byte_jump:2,32,relative,little; pcre:"/^.{2}([^\x00]*\x00)?[^\x00]{256}/sR"; metadata:policy security-ips drop; reference:bugtraq,14998; reference:cve,2005-3142; classtype:attempted-user; sid:16296; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave Flash memory corruption attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"|FF FF FF FF 01 1F 02|H|00 00 00|6|00 00 FF FF 01 1F 1F EE|"; content:!"|FF FF FF FF|"; within:4; distance:-24; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3463; classtype:attempted-user; sid:16293; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML DOM invalid DHTML comment creation attempt"; flow:to_client,established; file_data; content:"document.location.href"; fast_pattern:only; content:"createComment"; pcre:"/(\w+)\s*=\s*\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)\s*\;.*?\w+\.(insertBefore|insertAfter|appendChild)\(\1\)\;|\w\.(insertBefore|insertAfter|appendChild)\(\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:policy security-ips drop; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:16300; rev:4;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Network Security Services regexp heap overflow attempt"; flow:to_client,established; content:"|16|"; content:"|0B|"; within:1; distance:4; byte_test:3,>,0,3,relative,big; content:"|06 03|U|04 03|"; distance:0; pcre:"/^[\x0c\x13]([\x00-\x7f]|\x81.|\x82.{2})\x28(?=[^\x29]*\x7e)[^\x29]*\x7c/sR"; metadata:policy security-ips drop; reference:bugtraq,35891; reference:cve,2009-2404; classtype:attempted-user; sid:16291; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 6/7 outerHTML invalid reference arbitrary code execution attempt"; flow:to_client,established; file_data; content:"getElement"; nocase; content:"outerHTML"; nocase; content:"overflow"; fast_pattern; nocase; pcre:"/([^\s]+)\s*=\s*document\.getElement\w+\s*\x28\s*([\x22\x27])STYLE\2.*\1\.outerHTML/si"; pcre:"/\x7b[^\x7d]*(overflow[^\x7d]*margin\s*\x3a\s*0\s*\x3b|margin\s*\x3a\s*0\s*\x3b[^\x7d]*overflow)/si"; metadata:policy security-ips drop; reference:bugtraq,37085; reference:cve,2009-3672; reference:cve,2009-4054; reference:url,www.microsoft.com/technet/security/bulletin/MS09-072.mspx; classtype:attempted-user; sid:16310; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 6/7 single line outerHTML invalid reference arbitrary code execution attempt"; flow:to_client,established; file_data; content:"document.getElementsByTagName|28|'STYLE'|29|[0].outerHTML"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,37085; reference:cve,2009-3672; reference:cve,2009-4054; reference:url,www.microsoft.com/technet/security/bulletin/MS09-072.mspx; classtype:attempted-user; sid:16311; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader media.newPlayer memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/S/JavaScript"; content:"this.media.newPlayer"; pcre:"/^\x5C?\x28null\x5C?\x29/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37331; reference:cve,2009-4324; classtype:attempted-user; sid:16333; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Blackberry Server PDF JBIG2 numnewsyms remote code execution attempt"; flow:to_client,established; content:"JBIG2Decode"; nocase; content:"stream"; distance:0; pcre:"/JBIG2Decode.*?stream(\x0d\x0a|\x0a|\x0d)/smi"; byte_test:1, !&, 63, 4, relative; byte_test:4, >, 2147483647, 17, relative; reference:bugtraq,35102; reference:cve,2009-2643; reference:url,www.blackberry.com/btsc/search.do?cmd=displayKC&docType=kc&externalId=KB18327; classtype:attempted-admin; sid:16336; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT xpdf ObjectStream integer overflow"; flow:to_client,established; content:"Type/ObjStm"; nocase; pcre:"/Type\x2FObjStm[^>]*?\x2FN\s+\d{7}/smi"; metadata:policy security-ips drop; reference:bugtraq,36703; reference:bugtraq,37167; reference:cve,2009-3608; classtype:attempted-user; sid:16335; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Xpdf Splash DrawImage integer overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/Subtype"; content:"/Image"; within:20; content:"/FlateDecode"; pcre:"/\x3C{2}(?=[^\x3E]*\x2F(Height|Width)\s*\d{6})(?=[^\x3E]*\x2FFlateDecode)[^\x3E]*\x2FSubtype\s*\x2FImage/"; metadata:policy security-ips drop; reference:bugtraq,36703; reference:cve,2009-3604; classtype:attempted-user; sid:16355; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FFmpeg OGV file format memory corruption attempt"; flow:to_client,established; content:"OggS"; content:"|82|theora"; distance:0; byte_test:1,!&,0xE0,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36465; reference:url,secunia.com/advisories/36805; classtype:attempted-user; sid:16353; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IBM Informix Client SDK NFX file InformixServerList processing stack buffer overflow attempt"; flow:to_client,established; content:"[Setnet32]"; fast_pattern; nocase; content:"ServerSize="; distance:0; byte_test:4,>,293,0,relative,dec,string; pcre:"/InformixServerList=([^\r\n\x3B]{,293}\x3B)*[^\r\n\x3B]{294}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36588; reference:cve,2009-3691; classtype:attempted-user; sid:16346; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IBM Informix Client SDK NFX file HostList processing stack buffer overflow attempt"; flow:to_client,established; content:"[Setnet32]"; fast_pattern; nocase; content:"HostSize="; distance:0; byte_test:4,>,296,0,relative,dec,string; pcre:"/HostList=([^\r\n\x3B]{,296}\x3B)*[^\r\n\x3B]{297}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36588; reference:cve,2009-3691; classtype:attempted-user; sid:16345; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Illustrator DSC comment overflow attempt"; flow:to_client,established; file_data; content:"%!PS-Adobe-"; nocase; content:"EPSF-"; within:10; pcre:"/%[^\x0d\x0a]{1000}/smiR"; metadata:policy security-ips drop; reference:bugtraq,37192; reference:cve,2009-4195; classtype:attempted-user; sid:16359; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office BMP header biClrUsed integer overflow attempt"; flow:to_client,established; flowbits:isset,http.bmp; content:"BM"; fast_pattern; content:"|00 00 00 00|"; within:4; distance:4; byte_test:4,>,536870911,36,relative,little; metadata:policy security-ips drop; reference:bugtraq,36651; reference:cve,2009-2518; classtype:attempted-admin; sid:16361; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime Image Description Atom sign extension memory corruption attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"stsd"; content:"rpza"; distance:12; fast_pattern; content:"|00 00 00 00 00 00|"; within:6; byte_test:2,>,0x1FFC,18,relative,big; metadata:policy security-ips drop; reference:bugtraq,35166; reference:cve,2009-0955; reference:url,support.apple.com/kb/HT3591; classtype:attempted-user; sid:16360; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML+TIME animatemotion property memory corruption attempt"; flow:to_client,established; content:"ANIMATEMOTION"; nocase; pcre:"/<[A-Z_]+\s*\x3A\s*ANIMATEMOTION[^>]+?id=(?P<q>\x22|\x27|)(?P<n>[A-Z][A-Z\d\x2D\x2E\x3A\x5F]*)(?P=q).*?(?P=n)\./Osmi"; reference:bugtraq,27666; reference:cve,2008-0077; reference:url,www.microsoft.com/technet/security/bulletin/ms08-010.mspx; classtype:attempted-user; sid:16382; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer .hlp samba share download attempt"; flow:to_client,established; file_data; content:"vbscript"; nocase; content:".hlp"; nocase; content:"|5C|"; pcre:"/\\\\[^\x20\x0a\x0d]*\.hlp/smi"; metadata:policy security-ips drop; reference:cve,2010-0483; classtype:attempted-user; sid:16452; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Opera Content-Length header integer overflow attempt"; flow:to_client,established; content:"Content-Length"; nocase; http_header; pcre:"/^Content-Length\s*\x3A\s*[^\n]{20}/miH"; reference:bugtraq,38519; reference:url,www.hack0wn.com/view.php?xroot=672.0&cat=exploits; classtype:attempted-user; sid:16481; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari inline text box use after free attempt"; flow:to_client,established; content:".innerHTML"; nocase; content:"rtl"; nocase; content:"<NOBR"; fast_pattern; nocase; pcre:"/<(body|html)[^>]+dir\s*=\s*(?P<q1>\x22|\x27|)rtl(?P=q1)/smi"; pcre:"/(?P<obj>[A-Z\d_]+)\s*=\s*document\.getElementsByTagName\((?P<q2>\x22|\x27|)NOBR(?P=q2)\).*?(?P=obj)\.innerHTML\s*=\s*(\x22\x22|\x27\x27)/smi"; metadata:policy security-ips drop; reference:cve,2010-0049; classtype:attempted-user; sid:16492; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox WOFF font processing integer overflow attempt - TrueType"; flow:to_client,established; content:"wOFF|00 01 00 00|"; content:"|00 00|"; within:2; distance:6; pcre:"/^.{28}([0-9A-Z\x20\x2F]{4}.{8}[^\xFF].{7})*([0-9A-Z\x20\x2F]{4}.{8}\xFF{3})/isR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,38298; reference:cve,2010-1028; reference:url,www.kb.cert.org/vuls/id/964549; classtype:attempted-user; sid:16501; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox WOFF font processing integer overflow attempt - CFF-based"; flow:to_client,established; content:"wOFFOTTO"; content:"|00 00|"; within:2; distance:6; pcre:"/^.{28}([0-9A-Z\x20\x2F]{4}.{8}[^\xFF].{7})*([0-9A-Z\x20\x2F]{4}.{8}\xFF{3})/isR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,38298; reference:cve,2010-1028; reference:url,www.kb.cert.org/vuls/id/964549; classtype:attempted-user; sid:16502; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Free Download Manager .torrent parsing path overflow attempt"; flow:to_client,established; flowbits:isset,http.torrent; file_data; content:"4|3A|pathl"; nocase; byte_test:6,>,10000,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16520; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Free Download Manager .torrent parsing name overflow attempt"; flow:to_client,established; flowbits:isset,http.torrent; file_data; content:"4|3A|name"; nocase; byte_test:6,>,10000,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16519; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Novell QuickFinder server cross-site-scripting attempt"; flow:to_server, established; content:"AdminServlet"; nocase; http_uri; pcre:"/AdminServlet.*(userid|adminurl)[^\x26\x20\x0a]*<script/smiU"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0611; classtype:web-application-attack; sid:16522; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Free Download Manager .torrent parsing comment overflow attempt"; flow:to_client,established; flowbits:isset,http.torrent; file_data; content:"7|3A|comment"; nocase; byte_test:6,>,100000,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16517; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat javascript getIcon method buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"|25|PDF-"; depth:5; content:"Collab.getIcon"; distance:0; fast_pattern; nocase; pcre:!"/Collab\.getIcon[^\x28]*?\x28\s*([\x22\x27])[^\x]{1,256}\1\s*\x29/smi"; metadata:policy security-ips drop; reference:bugtraq,34169; reference:cve,2009-0927; classtype:attempted-user; sid:16554; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Free Download Manager .torrent parsing announce overflow attempt"; flow:to_client,established; flowbits:isset,http.torrent; file_data; content:"8|3A|announce"; nocase; byte_test:6,>,100000,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16518; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle JRE Java Platform SE and Java Deployment Toolkit plugins code execution attempt - npruntime-scriptable-plugin"; flow:to_client,established; content:"application/npruntime-scriptable-plugin|3B|deploymenttoolkit"; nocase; content:"-J-jar"; pcre:"/http\x3A\s+-J-jar\s+-J[^\s]+\x2Ejar/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16549; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle JRE Java Platform SE and Java Deployment Toolkit plugins code execution attempt - java-deployment-toolkit"; flow:to_client,established; content:"application/java-deployment-toolkit"; nocase; content:"-J-jar"; pcre:"/http\x3A\s+-J-jar\s+-J[^\s]+\x2Ejar/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16550; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3128 (msg:"WEB-CLIENT Squid Proxy http version number overflow attempt"; flow:to_server,established; content:" http/"; nocase; pcre:"/^[^\s]+\s+[^\s]+\s+http\x2f(\d+\x2e)?\d{10}/i"; metadata:policy security-ips drop; reference:bugtraq,33604; reference:cve,2009-0478; classtype:attempted-user; sid:16521; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java Web Start arbitrary command execution attempt"; flow:to_client,established; content:"application/x-java-applet"; nocase; content:"-XXaltjvm"; fast_pattern:only; content:"launchjnlp"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16585; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Un4seen Developments XMPlay crafted ASX file buffer overflow attempt"; flow:to_client,established; file_data; content:"<ASX VERSION=|22|3|22|>"; nocase; content:"<Entry>"; distance:0; nocase; content:"<ref href=|22|file|3A|//"; distance:0; nocase; pcre:"/^\S{501}/R"; metadata:policy security-ips drop; reference:bugtraq,21206; reference:cve,2006-6063; classtype:attempted-user; sid:16582; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java Web Start arbitrary command execution attempt - Internet Explorer"; flow:to_client,established; content:"8AD9C840-044E-11D1-B3E9-00805F499D93"; fast_pattern:only; nocase; content:"-XXaltjvm"; content:"launchjnlp"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:16584; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari information disclosure and remote code execution attempt"; flow:to_client,established; content:"parent"; content:".prompt"; distance:0; pcre:"/var\s+(\w+)\s*\x3D\s*parent\s*\x3b.*\1\x2Eprompt.*\1\x2Eclose/smi"; reference:cve,2010-1939; reference:url,secunia.com/advisories/39670; classtype:attempted-user; sid:16596; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader Linux malformed U3D mesh deceleration block exploit attempt"; flow:to_client,established; flowbits:isset, http.pdf; content:"stream|0A|U3D"; fast_pattern:only; pcre:"/stream\nU3D[^<]*\x31\xff\xff\xff/si"; byte_jump:2, 8, relative, little; byte_test:4, >, 97612893, 32, relative, little; metadata:policy security-ips drop; reference:cve,2010-0196; classtype:attempted-user; sid:16603; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Amaya web editor XML and HTML Parser Buffer overflow attempt"; flow:to_client,established; file_data; content:"<bdo"; nocase; pcre:"/^.*?dir\s*=\s*(\x22[^\x22]{500}|\x27[^\x27]{500}|[^\s\>]{500})/isR"; reference:bugtraq,33047; reference:cve,2009-0323; classtype:attempted-user; sid:16601; rev:3;)
alert tcp $EXTERNAL_NET 1080 -> $HOME_NET any (msg:"WEB-CLIENT Firefox oversized SOCKS5 DNS reply memory corruption attempt"; flow:to_client,established; content:"|05 00 00 03|"; depth:4; isdataat:16,relative; reference:bugtraq,35925; reference:cve,2009-2470; classtype:attempted-user; sid:16612; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Help Centre escape sequence XSS attempt"; flow:to_client,established; file_data; content:"hcp|3A 2F 2F|"; nocase; content:"script"; distance:0; nocase; content:"defer"; distance:0; nocase; pcre:"/hcp\x3a\x2f\x2f[^\n]*(\x3c|\x253c)script(\s|\x2520|\x2f)+defer/iO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40725; reference:cve,2010-1885; reference:url,osvdb.org/show/osvdb/65264; reference:url,www.microsoft.com/technet/security/bulletin/MS10-042.mspx; classtype:attempted-user; sid:16665; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave DIR file PAMI chunk code execution attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"XFIR"; depth:4; content:"pami"; distance:0; byte_test:4,>,0x7FFFFFFF,4,relative,little; metadata:policy security-ips drop; reference:cve,2010-1292; reference:url,secunia.com/advisories/38751/; reference:url,www.adobe.com/support/security/bulletins/apsb10-12.html; classtype:attempted-user; sid:16673; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Palo Alto Networks Firewall editUser.esp XSS attempt"; flow:to_server,established; content:"/esp/editUser.esp"; fast_pattern; nocase; http_uri; content:"role="; nocase; http_uri; pcre:"/[\x3f\x26]role=[^\x26]*?[^\x26a-z0-9\x5b\x5d\x2d]/Usmi"; metadata:policy security-ips drop; reference:cve,2010-0475; reference:url,osvdb.org/show/osvdb/64717; classtype:web-application-attack; sid:16689; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT BlazeVideo BlazeDVD PLF playlist file name buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.plf; content:"Content-Type: application/octet-stream"; http_header; file_data; pcre:"/^[^\s]{256}/R"; reference:bugtraq,21337; reference:cve,2006-6199; classtype:attempted-user; sid:16692; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Astonsoft Deepburner dbr file name buffer overflow attempt"; flow:to_client,established; file_data; content:"|3C|DeepBurner_record"; nocase; content:"|3C|data_cd"; distance:0; nocase; content:"|3C|file"; distance:0; nocase; pcre:"/^\s*[^\x3E]*path\s*=\s*(\x22[^\x22]{272}|\x27[^\x27]{272}|[^\s\x3E]{272})/iR"; metadata:policy security-ips drop; reference:bugtraq,21657; reference:cve,2006-6665; reference:url,osvdb.org/show/osvdb/32356; classtype:attempted-user; sid:16696; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader malformed FlateDecode colors declaration"; flow:to_client,established; content:"FlateDecode"; content:"DecodeParms"; pcre:"/DecodeParms\s*\[[^\]]*Colors\s*\d\d\d\d/smi"; metadata:policy security-ips drop; reference:bugtraq,36600; reference:cve,2009-3459; classtype:attempted-user; sid:16677; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 9060 (msg:"WEB-CLIENT IBM WebSphere application server cross site scripting attempt"; flow:to_server, established; content:"/ibm/console/"; content:"script"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34001; reference:cve,2009-0855; classtype:misc-attack; sid:16686; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java Web Start Splashscreen PNG processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; within:16; pcre:"/^([^\x00]|\x00[^\x00]|.{4}[^\x00]|.{4}\x00[^\x00]|.{8}[\x11-\xff])/Rs"; metadata:policy security-ips drop; reference:bugtraq,34240; reference:cve,2009-1097; classtype:attempted-user; sid:16716; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT gAlan malformed file stack overflow attempt"; flow:to_client,established; file_data; content:"Mjik"; within:4; pcre:"/^[^\s\x00]{512}/R"; metadata:policy security-ips drop; reference:url,osvdb.org/60897; classtype:attempted-user; sid:16726; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT UltraISO CCD file handling overflow attempt"; flow:to_client,established; file_data; content:"[CloneCD]"; within:9; content:"INDEX 1="; distance:0; isdataat:256,relative; content:!"|0A|"; within:256; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1260; reference:url,osvdb.org/show/osvdb/53275; classtype:attempted-user; sid:16733; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT CA multiple product AV engine CAB header parsing stack overflow attempt"; flow:to_client,established; file_data; content:"MSCF"; within:4; byte_test:2,=,1,24,relative,little; byte_jump:4,12,relative,post_offset -20,little; pcre:"/^.{16}[^\x00]{256}/sR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24330; reference:cve,2007-2864; classtype:attempted-user; sid:16719; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Orbital Viewer .orb stack buffer overflow attempt"; flow:to_client,established; file_data; content:"OrbitalFileV1.0|0D 0A|"; fast_pattern; nocase; pcre:"/^[^\x00]{512}/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,38436; reference:cve,2010-0688; classtype:attempted-user; sid:16721; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT IDEAL Administration IPJ file handling stack overflow attempt"; flow:to_client,established; file_data; content:"|0D 0A|[Group,Export,Yes]|0D 0A|"; within:22; content:"Computer="; distance:0; pcre:"/^[^\s\x00]{512}/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-4265; reference:url,osvdb.org/show/osvdb/60681; classtype:attempted-user; sid:16727; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT SafeNet SoftRemote multiple policy file local overflow attempt"; flow:to_client,established; file_data; content:"|5B|HKEY_LOCAL_MACHINE|5C|SOFTWARE|5C|IRE|5C|SafeNet|2F|Soft-PK|5C|ACL|5C|GROUPDEFS|5C|_SafeNet_Default_Group|5D|"; content:"|22|GROUPNAME|22 3D 22|"; distance:0; isdataat:256,relative; content:!"|22|"; within:256; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3861; reference:url,osvdb.org/show/osvdb/59724; classtype:attempted-user; sid:16732; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT UltraISO CUE file handling stack buffer overflow attempt"; flow:to_client,established; file_data; content:"FILE |22|"; within:6; isdataat:512,relative; content:!"|22|"; within:512; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24140; reference:cve,2007-2888; classtype:attempted-user; sid:16734; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VariCAD multiple products DWB file handling overflow attempt"; flow:to_client,established; file_data; content:"|34 87 01 00 00 00 00 00 25 5C 1F 85|"; within:12; pcre:"/^[^\x0a\x3d]{512}/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,38815; reference:url,osvdb.org/show/osvdb/63067; classtype:attempted-user; sid:16736; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ProShow Gold PSH file handling overflow attempt"; flow:to_client,established; file_data; content:"Photodex|28|R|29| ProShow|28|TM|29| Show File Version"; within:41; content:"cell[0].images[0].image="; distance:0; isdataat:512,relative; content:!"|0A|"; within:512; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3214; reference:url,osvdb.org/show/osvdb/57226; classtype:attempted-user; sid:16730; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC Media Player TY processing buffer overflow attempt"; flow:to_client,established; file_data; content:"|F5 46 7A BD 00 00 00 02 00 02 00 00|"; within:12; byte_test:4,>,32,8,relative,big; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,31813; reference:cve,2008-4654; classtype:attempted-user; sid:16720; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC Media Player SMB module Win32AddConnection buffer overflow attempt"; flow:to_client,established; flowbits:isset, http.m3u.download; content:"smb|3A 2F 2F|"; pcre:"/smb\x3A\x2F\x2F[^\s\x0D\x0A\x3C]{251}/mi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35500; reference:cve,2009-2484; classtype:attempted-user; sid:16751; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Cain & Abel Remote Desktop Protocol file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.rdp; file_data; pcre:"/^[a-z0-9]{500}/iR"; reference:bugtraq,32543; reference:cve,2008-5405; classtype:attempted-user; sid:16743; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC Media Player SMB module Win32AddConnection buffer overflow attempt"; flow:to_client,established; flowbits:isset,xspf_file.request; content:"smb|3A 2F 2F|"; pcre:"/smb\x3A\x2F\x2F[^\s\x0A\x0D\x3C]{251}/mi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35500; reference:cve,2009-2484; classtype:attempted-user; sid:16752; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT MultiMedia Jukebox multiple playlist file handling overflow attempt"; flow:to_client,established; flowbits:isset,http.m3u.download; file_data; content:"http|3A 2F 2F|"; within:7; pcre:"/^[^\s]{256}/R"; reference:cve,2009-2650; reference:url,osvdb.org/show/osvdb/55924; classtype:attempted-user; sid:16739; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 8080 (msg:"WEB-CLIENT VideoLAN VLC Media Player SMB module Win32AddConnection buffer overflow attempt"; flow:to_server,established; content:"GET"; nocase; http_method; content:"|2F|requests|2F|status.xml"; nocase; http_uri; content:"smb"; http_uri; pcre:"/^GET\s+.*\x2Frequests\x2Fstatus.xml\x3F.*smb\x3A\x2F\x2F[^\s\x0A\x0D]{251}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35500; reference:cve,2009-2484; classtype:attempted-user; sid:16753; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT DX Studio Player plug-in command injection attempt"; flow:to_client,established; content:"<dxstudio"; fast_pattern:only; nocase; content:"<?xml"; content:"shell.execute"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35273; reference:cve,2009-2011; classtype:attempted-user; sid:16744; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft LNK shortcut download attempt"; flow:to_client,established; file_data; content:"|4C 00 00 00|"; content:"|20 20 EC 21 EA 3A 69 10 A2 DD 08 00 2B 30 30 9D|"; fast_pattern; pcre:"/\x2E\x00?d\x00?l\x00?l\x00?/Ri"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2568; reference:url,www.microsoft.com/technet/security/bulletin/ms10-046.mspx; classtype:attempted-user; sid:17042; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FeedDemon OPML file handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|3C|opml"; nocase; content:"|3C|outline"; distance:0; nocase; pcre:"/[^\x3E]*?text\s*\x3D\s*(\x27[^\x27]{500}|\x22[^\x22]{500}|\S{500})/iR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33630; reference:cve,2009-0546; classtype:attempted-user; sid:17104; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT FeedDemon unicode OPML file handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|3C 00|o|00|p|00|m|00|l|00|"; nocase; content:"|3C 00|o|00|u|00|t|00|l|00|i|00|n|00|e|00|"; distance:0; nocase; pcre:"/[^\x3E]*?t\x00e\x00x\x00t\x00(\s\x00)*\x3D\x00(\s\x00)*(\x27\x00(?!(..){0,500}\x27\x00)|\x22\x00(?!(..){0,500}\x22\x00)|(?!(..){0,500}\s\x00))/isOR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33630; reference:cve,2009-0546; classtype:attempted-user; sid:17105; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Photoshop CS4 ASL file processing buffer overflow attempt"; flow:to_client,established; content:"Stylenum"; nocase; byte_test:4,>,1020,8,relative,big; content:"8BSL"; metadata:policy security-ips drop; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17145; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla multiple products JavaScript string replace buffer overflow attempt"; flow:to_client,established; file_data; content:".replace|28|"; pcre:"/(?P<var>\w+)\x2Ereplace\x28\s*(?P=var)\s*\x2C\s*(?P=var)\s*\x29/"; metadata:policy security-ips drop; reference:bugtraq,36343; reference:cve,2009-3075; classtype:attempted-user; sid:17166; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC renamed zip file handling code execution attempt - 3"; flow:to_client,established; flowbits:isset,http.mp4; file_data; content:"|50 4B 03 04|"; within:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40428; classtype:attempted-user; sid:17150; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Photoshop CS4 ABR file processing buffer overflow attempt - 1"; flow:to_client,established; content:"AnglUntF"; nocase; byte_test:4,>,1020,12,relative,big; content:"8BIM"; metadata:policy security-ips drop; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17143; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Photoshop CS4 ABR file processing buffer overflow attempt - 2"; flow:to_client,established; content:"AnglUntF"; nocase; byte_test:4,>,1020,12,relative,big; content:"8BBR"; metadata:policy security-ips drop; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17144; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox plugin parameter array dangling pointer exploit attempt - 1"; flow:to_client,established; content:"<object"; nocase; content:"|22 22|"; within:200; fast_pattern; pcre:"/\x3Cobject(?![^\x3E]+?src)[^\x3E]+?data\s*\x3D\s*\x22\x22/i"; reference:bugtraq,41933; reference:cve,2010-2755; classtype:attempted-user; sid:17153; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC renamed zip file handling code execution attempt - 2"; flow:to_client,established; flowbits:isset,http.mp3; file_data; content:"|50 4B 03 04|"; within:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40428; classtype:attempted-user; sid:17149; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Opera browser document writing uninitialized memory access attempt"; flow:to_client,established; file_data; content:"document.write"; content:"setInterval"; fast_pattern:only; nocase; pcre:"/function\s+(?P<func>[a-z\x5F]+).+?\x7B[^\x7D]+?document\x2Ewrite[^\x7D]+?setInterval\x28(?P=func)/is"; metadata:policy security-ips drop; reference:bugtraq,39855; reference:cve,2010-1728; classtype:attempted-user; sid:17165; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC renamed zip file handling code execution attempt - 1"; flow:to_client,established; flowbits:isset,http.avi; file_data; content:"|50 4B 03 04|"; within:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,40428; classtype:attempted-user; sid:17148; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Photoshop CS4 GRD file processing buffer overflow attempt"; flow:to_client,established; content:"|00|G|00|r|00|a|00|d|00|i|00|e|00|n|00|t"; nocase; byte_test:4,>,1020,13,relative,big; content:"8BGR"; metadata:policy security-ips drop; reference:bugtraq,40389; reference:cve,2010-1296; classtype:attempted-user; sid:17146; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox plugin parameter array dangling pointer exploit attempt - 2"; flow:to_client,established; content:"<object"; nocase; content:"|27 27|"; within:200; fast_pattern; pcre:"/\x3Cobject(?![^\x3E]+?src)[^\x3E]+?data\s*\x3D\s*\x27\x27/i"; reference:bugtraq,41933; reference:cve,2010-2755; classtype:attempted-user; sid:17154; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT  QuickTime JPEG Huffman Table integer underflow attempt"; flow:to_client,established; flowbits:isset,file.jpeg; content:"|FF C4 02 11 00 FF FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; reference:bugtraq,12905; reference:cve,2005-0903; classtype:attempted-user; sid:10126; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox JavaScript eval arbitrary code execution attempt"; flow:to_client,established; content:"arguments|2E|callee|2E|"; nocase; content:"|5F 5F|parent|5F 5F 2E|eval"; distance:0; fast_pattern; nocase; metadata:policy security-ips drop; reference:bugtraq,13645; reference:cve,2005-1532; reference:url,secunia.com/advisories/15528/; classtype:attempted-user; sid:17212; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari invalid FRAME tag remote code execution attempt"; flow:to_client,established; file_data; content:"<frame"; nocase; content:"scrolling"; within:100; nocase; isdataat:10,relative; content:!"auto"; within:10; nocase; content:!"yes"; within:10; nocase; content:!"no"; within:10; nocase; pcre:"/\x3Cframe([^\x3E]+scrolling\s*\x3D(?!\s*(\x22|\x27)?\s*(yes|no|auto))){2}/i"; reference:bugtraq,17634; reference:cve,2006-1987; classtype:attempted-user; sid:17217; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari LI tag with large VALUE attribute exploit attempt"; flow:to_client,established; file_data; content:"<li"; nocase; pcre:"/^[^\x3E]+?value\s*\x3D\s*\d{10}/iR"; reference:bugtraq,17634; reference:cve,2006-1988; classtype:attempted-user; sid:17218; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime marshaled punk remote code execution"; flow:to_client,established; file_data; content:"_Marshaled_pUnk"; nocase; pcre:"/name\s*=\s*(?P<q1>\x22|\x27|)_Marshaled_pUnk(?P=q1)/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:cve,2010-1818; classtype:attempted-user; sid:17211; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox Chrome Page Loading Restriction Bypass attempt"; flow:to_client,established; content:"window|2E|open"; nocase; content:"about|3A|mozilla"; within:50; nocase; content:"document|2E|write"; distance:0; nocase; content:"about|3A|config"; within:50; fast_pattern; nocase; metadata:policy security-ips drop; reference:cve,2005-2706; reference:url,secunia.com/advisories/16911/; classtype:attempted-user; sid:17213; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari TABLE tag with large CELLSPACING attribute exploit attempt"; flow:to_client,established; file_data; content:"cellspacing"; nocase; pcre:"/^\s*\x3D\s*\d{10}/R"; reference:bugtraq,17634; reference:cve,2006-1986; classtype:attempted-user; sid:17216; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel sheet name memory corruption attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"Sheet1"; content:"|8C 00 04 00 56 00 56 00 C1 01 08 00 C1 01 00 00 80 38 01 00|"; within:20; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24691; reference:cve,2007-3490; classtype:attempted-user; sid:17227; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Kodak Imaging large offset malformed tiff - big-endian"; flow:to_client,established; flowbits:isset,http.tiff.big; content:"|01 02 00 03|"; byte_test:4,>,6,0,relative,big; reference:cve,2007-2217; reference:cve,2010-3950; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-055.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-105.mspx; classtype:attempted-user; sid:17232; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Kodak Imaging small offset malformed tiff - little-endian"; flow:to_client,established; flowbits:isset,http.tiff.little; content:"|02 01 03 00|"; byte_test:4,>,6,0,relative,little; reference:cve,2007-2217; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-055.mspx; classtype:attempted-user; sid:17231; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox nsPropertyTable PropertyList memory corruption attempt"; flow:to_client,established; content:"-moz-column-"; fast_pattern:only; content:"documentElement.style.height"; pcre:"/<html[^>]*?height[^>]*?>/smi"; pcre:"/<body[^>]*?position[^>]*?inherit[^>]*?-moz-column-(count|width)[^>]*?documentElement\.style\.height[^>]*?/smiR"; metadata:policy security-ips drop; reference:cve,2009-3070; reference:url,secunia.com/advisories/36671/; classtype:attempted-user; sid:17236; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ACD Systems ACDSee Products XBM file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.xbm; file_data; content:"|23|define"; content:"|5F|width"; distance:0; pcre:"/\x23define\s*(?=[\S]{57})\S*\x5Fwidth/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37685; reference:url,osvdb.org/show/osvdb/63643; classtype:attempted-user; sid:17238; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox image dragging exploit attempt"; flow:to_client,established; content:"|3C|img|20|"; content:"|2E|bat"; distance:0; fast_pattern; nocase; pcre:"/\x3cimg\s[^\x3e]*\x2ebat/i"; metadata:policy security-ips drop; reference:cve,2005-0230; classtype:attempted-user; sid:17245; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer createTextRange code execution attempt"; flow:to_client,established; file_data; content:".createTextRange|28 29 3B|"; fast_pattern:only; nocase; content:"<input type|3D 22|image|22|"; nocase; pcre:"/\x3Cinput\s+type\x3D\x22image\x22\s+id\x3D(?P<q1>(\x22|\x27|))(?P<t>\S+)(?P=q1).*?document\x2EgetElementById\x28(?P<q2>(\x22|\x27|))(?P=t)(?P=q2)\x29\x2EcreateTextRange/isO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,17196; reference:cve,2006-1359; classtype:attempted-user; sid:16035; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes AAC file handling integer overflow attempt"; flow:to_client,established; content:"mp4a"; content:"stsc"; distance:0; byte_jump:4,-8,relative,big; content:"stsz"; within:4; byte_test:4,<,257,-8,relative,big; byte_test:4,>,60,8,relative,big; metadata:policy security-ips drop; reference:bugtraq,18730; reference:cve,2006-1467; classtype:attempted-user; sid:16055; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint malformed data record code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|F2 03|"; content:"|AA AA AA 2F 00 C8 0F 0C 00 00 00 30 00 D2 0F 04 00|"; within:17; distance:1; metadata:policy security-ips drop; reference:bugtraq,20322; reference:cve,2006-3876; classtype:attempted-user; sid:17292; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox plugin access control bypass attempt"; flow:to_client,established; content:"file|2E|initWithPath|28 22|c|3A 5C 5C 5C 5C|booom|2E|bat"; content:"xpcom|20 2B 3D 20 27|file|2E|createUnique"; content:"outputStream|2E|init|28|file|2C|0x04|7C|0x08|7C|0x20|2C|420"; metadata:policy security-ips drop; reference:bugtraq,12655; reference:cve,2005-0527; classtype:attempted-user; sid:17265; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox XUL tree element code execution attempt"; flow:to_client,established; content:"selection|2E|timedSelect|28|1|2C|8000|29 3B|"; content:"tree|2E|view|2E|selection|3D|null|3B|"; distance:0; content:"delete|20|tree"; distance:0; content:"delete|20|selection"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34181; reference:cve,2009-1044; classtype:attempted-user; sid:17258; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer AVI parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.avi; content:"strf"; content:"|08 00|"; within:2; distance:18; byte_test:4,>,0x100,16,relative,little; metadata:policy security-ips drop; reference:bugtraq,13530; reference:cve,2005-2052; classtype:attempted-user; sid:17272; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer createTextRange code execution attempt"; flow:to_client,established; file_data; content:".createTextRange|28 29 3B|"; fast_pattern:only; nocase; content:"<input type|3D 22|checkbox|22|"; nocase; pcre:"/\x3Cinput\s+type\x3D\x22checkbox\x22\s+id\x3D(?P<q1>(\x22|\x27|))(?P<t>\S+)(?P=q1).*?document\x2EgetElementById\x28(?P<q2>(\x22|\x27|))(?P=t)(?P=q2)\x29\x2EcreateTextRange/isO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,17196; reference:cve,2006-1359; classtype:attempted-user; sid:17261; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office malformed routing slip code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"Routing|3A 20|"; content:"|B9 00 9B 05 56 04 3F 05 00 00 41 41 41 41|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,17000; reference:cve,2006-0009; classtype:attempted-user; sid:17284; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer createTextRange code execution attempt"; flow:to_client,established; file_data; content:".createTextRange|28 29 3B|"; fast_pattern:only; nocase; content:"<input type|3D 22|radio|22|"; nocase; pcre:"/\x3Cinput\s+type\x3D\x22radio\x22\s+id\x3D(?P<q1>(\x22|\x27|))(?P<t>\S+)(?P=q1).*?document\x2EgetElementById\x28(?P<q2>(\x22|\x27|))(?P=t)(?P=q2)\x29\x2EcreateTextRange/isO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,17196; reference:cve,2006-1359; classtype:attempted-user; sid:17262; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Web View script injection attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|1E 00 00 00|"; fast_pattern; content:"javascript"; distance:0; nocase; pcre:"/\x1e\x00\x00\x00.{4}[^\x00]*?\x40[^\x00]*?javascript/i"; metadata:policy security-ips drop; reference:bugtraq,13248; reference:cve,2005-1191; classtype:attempted-user; sid:17271; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint PPT file parsing memory corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|A4 37 7A 00 81 00 00 00 00 00 82 00 00 00 00 00|"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,18993; reference:cve,2006-3656; classtype:attempted-user; sid:17285; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer malformed iframe buffer overflow attempt"; flow:to_client,established; file_data; content:"<IFRAME "; nocase; pcre:"/<IFRAME\s+[^>]*?src\s*=\s*(\x22|\x27|)[^\x22\x27\s>]{400}/smi"; metadata:policy security-ips drop; reference:bugtraq,11515; reference:cve,2004-1050; classtype:attempted-user; sid:15147; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word SmartTag record code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|13 1F 14 FF 95 80 FF FF 01 00 00 00 00 00 28 2C|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30124; reference:cve,2008-2244; classtype:attempted-user; sid:17308; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word TextBox sub-document memory corruption attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|09 04 16 00 22 0C 00 00 80 57 00 00 80 57 00 00 02|"; content:"|00 00 00 00 00 00 00 00 FF FF 0F 00|"; within:12; distance:23; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,23380; reference:cve,2007-1910; classtype:attempted-user; sid:17301; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer clone object memory corruption attempt"; flow:to_client,established; content:"document|2E|createElement"; nocase; content:"|2E|cloneNode()"; distance:0; fast_pattern; nocase; content:"|2E|cloneNode()"; distance:0; nocase; reference:bugtraq,26816; reference:cve,2007-3903; classtype:attempted-user; sid:17303; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint MCAtom remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|F9 0F 04 00 00 00|"; byte_test:4,>,2147483646,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,20495; reference:cve,2006-5296; classtype:attempted-user; sid:17320; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT OpenOffice OLE File Stream Buffer Overflow"; flow:to_client,established; flowbits:isset,http.ole; content:"W|00|o|00|r|00|d|00|D|00|o|00|c|00|u|00|m|00|e|00|n|00|t|00|"; nocase; content:"|22 10 00 80|"; within:4; distance:96; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28819; reference:cve,2008-0320; classtype:attempted-user; sid:17315; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Works file converter file section header index table stack overflow attempt"; flow:to_client,established; flowbits:isset,works.download; content:"|22 07 00 00 00 22 22 22 22 00 22 06 00 00 00 02 00 46 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,27658; reference:cve,2008-0105; classtype:attempted-user; sid:17304; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint MCAtom remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|F8 0F 04 00 00 00|"; byte_test:4,>,2,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,20495; reference:cve,2006-5296; classtype:attempted-user; sid:17318; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows GRE WMF Handling Memory Read Exception attempt"; flow:to_client,established; flowbits:isset,wmf.download; file_data; content:"|00 09 00 00 03|"; content:"|04 00 00 00|"; distance:0; pcre:"/^(\x01|\x02)\x00\x09\x00{2}\x03/m"; pcre:"/\x04\x00{3}(\x26|\xff)/Rm"; metadata:policy security-ips drop; reference:bugtraq,16167; reference:cve,2006-0143; classtype:attempted-user; sid:17330; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Folder GUID Code Execution attempt"; flow:to_client,established; content:".|7B|3050F4D8-98B5-11CF-BB82-00AA00BDCE0B|7D|"; fast_pattern:only; nocase; pcre:"/\x252e\x252e\x255c[^\s\x2e]*?\x2e\x7B3050F4D8-98B5-11CF-BB82-00AA00BDCE0B\x7d/smi"; metadata:policy security-ips drop; reference:bugtraq,19389; reference:cve,2006-3281; classtype:attempted-user; sid:17316; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint MCAtom remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|FA 0F 04 00 00 00|"; byte_test:4,>,2147483646,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,20495; reference:cve,2006-5296; classtype:attempted-user; sid:17319; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Products QueryInterface method memory corruption attempt"; flow:to_client,established; file_data; content:"Components.interfaces."; content:"|2E|QueryInterface"; distance:0; pcre:"/(?P<var>\S+)\s*\x3D\s*eval\x28\s*(\x22|\x27|)Components\x2Einterfaces\x2E.*?\x2EQueryInterface\x28\s*(?P=var)\s*\x29.*?(location|navigator)/s"; metadata:policy security-ips drop; reference:bugtraq,16476; reference:cve,2006-0295; classtype:attempted-user; sid:16036; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox Javascript array.splice memory corruption attempt"; flow:to_client,established; content:"a|5B|6|5D 20 3D 20 22|toto|22 3B|"; content:"a|2E|splice|28|6|2C 20|1|29 3B|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33990; reference:cve,2009-0773; classtype:attempted-user; sid:17399; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime udta atom parsing heap overflow vulnerability"; flow:to_client,established; flowbits:isset,http.quicktime; content:"udta"; content:"|A9|nam|FF|"; distance:0; byte_test:2,>,251,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,22844; reference:cve,2007-0714; classtype:attempted-user; sid:17372; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Help Workshop HPJ OPTIONS section buffer overflow attempt"; flow:to_client,established; content:"HLP"; nocase; pcre:"/^\s*HLP\s*\x3d\s*[^\n]{257}/smi"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,22135; reference:cve,2007-0427; classtype:attempted-user; sid:17366; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer setRequestHeader overflow attempt"; flow:to_client,established; content:"XMLHttpRequest"; nocase; content:"setRequestHeader"; distance:0; nocase; pcre:"/setRequestHeader\x28[^\x29]*(Host|Referer|Content-Length)[\x22\x27][^\x2c]*[\xA0-\xFF]/smi"; reference:bugtraq,28379; reference:cve,2008-1544; classtype:attempted-user; sid:17384; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft OLE automation string manipulation overflow attempt"; flow:to_client,established; content:"|2E|substringData"; pcre:"/\x2esubstringData\s*\x28[^\x2c]*\x2c\s*0x7(f|F){6}[6-9AaBbCcDdEeFf]/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,25282; reference:cve,2007-2224; classtype:attempted-user; sid:17421; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox Animated PNG Processing integer overflow"; flow:to_client,established; flowbits:isset,file.png; content:"IHDR"; byte_test:4,>,32767,4,relative; content:"|01|"; within:1; distance:12; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4064; classtype:attempted-user; sid:17378; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel IMDATA buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|7F 00 54 01 09 00 01 00 00 00 00 00 0C 00 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,21856; reference:cve,2007-0027; classtype:attempted-user; sid:17362; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT OpenOffice EMF file EMR record parsing integer overflow attempt"; flow:to_client,established; flowbits:isset,http.emf; content:"|00 00 00 54|"; byte_test:4,>,2147483647,43,relative,little; reference:cve,2008-2238; reference:url,www.openoffice.org/security/cves/CVE-2008-2238.html; classtype:attempted-user; sid:17388; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Color Management Module buffer overflow attempt"; flow:to_client,established; content:"gXYZ"; content:"gXYZ"; within:4; distance:8; content:"bXYZ"; within:4; distance:8; byte_test:4,>,60,4,relative; metadata:policy security-ips drop; reference:bugtraq,14214; reference:cve,2005-1219; classtype:attempted-user; sid:17348; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox XBM image processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.xbm; content:"static|20|char|20|gopher|5F|binary|5F|bits|5B 5D|"; content:"0x71|2C 20|0x26|2C 20|0x01|20 20 20 20 20 20|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,14916; reference:cve,2005-2701; classtype:attempted-user; sid:17360; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer setRequestHeader overflow attempt"; flow:to_client,established; content:"XMLHttpRequest"; nocase; content:"setRequestHeader"; distance:0; nocase; pcre:"/setRequestHeader\x28[^\x29]*(Host|Referer|Content-Length).*?String.fromCharCode\x28/smi"; byte_test:3,>,160,0,relative,string; reference:bugtraq,28379; reference:cve,2008-1544; classtype:attempted-user; sid:17385; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox Javascript array.splice memory corruption attempt"; flow:to_client,established; content:"a|5B|10|5D 20 3D 20 22|AAAAAAAAAA|22 3B|"; content:"a|2E|splice|28|10|2C 20|1|29 3B|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33990; reference:cve,2009-0773; classtype:attempted-user; sid:17398; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Color Management Module buffer overflow attempt"; flow:to_client,established; content:"rXYZ"; byte_test:4,>,60,4,relative; content:"gXYZ"; within:4; distance:8; content:"bXYZ"; within:4; distance:8; metadata:policy security-ips drop; reference:bugtraq,14214; reference:cve,2005-1219; classtype:attempted-user; sid:17347; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Help Workshop CNT Help contents buffer overflow attempt"; flow:to_client,established; flowbits:isset,MS_Help_content_file; content:"Content-Type: text/plain"; fast_pattern:only; file_data; pcre:"/[^\n]{513}/Rsi"; metadata:policy security-ips drop; reference:bugtraq,22100; reference:cve,2007-0352; classtype:web-application-attack; sid:17365; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word document stream handling code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|A8 00 00 00 00 00 00 00 41 41 41 41 10 00 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,25567; reference:cve,2007-0870; classtype:attempted-user; sid:17368; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT rename of JavaScript unescape function - likely malware obfuscation"; flow:to_client,established; file_data; content:"var "; nocase; content:"unescape"; within:100; distance:5; nocase; pcre:"/var\s+[A-Z][A-Z\d\x5F]{5,}\s*=\s*unescape[\s\x3b]/smi"; flowbits:set,js.rename.unescape; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:attempted-user; sid:17400; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows DirectX Targa image file heap overflow attempt"; flow:to_client,established; file_data; content:"|00 00 0A 00 00 00 00 00 00 00 00 00 00 80 00 80 20 20|"; within:18; metadata:policy security-ips drop; reference:bugtraq,24963; reference:cve,2006-4183; classtype:attempted-user; sid:17408; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp ID3v2 Tag Handling Buffer Overflow attempt"; flow:to_client,established; file_data; content:"ID3"; within:3; pcre:"/T(PE(1|2)|IT2)/iR"; byte_test:4,>,0x190,0,relative,big; metadata:policy security-ips drop; reference:bugtraq,14276; reference:cve,2005-2310; classtype:attempted-user; sid:17351; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox Animated PNG Processing integer overflow"; flow:to_client,established; flowbits:isset,file.png; content:"IHDR"; byte_test:4,>,32767,0,relative; content:"|01|"; within:1; distance:12; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4064; classtype:attempted-user; sid:17379; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Mozilla Products IDN Spoofing Vulnerability Attempt"; flow:to_server,established; content:"xn--"; fast_pattern; nocase; pcre:"/^Host\x3A\x20(www\x2e)?xn\x2d\x2d/mi"; metadata:policy security-ips drop; reference:bugtraq,12470; reference:cve,2005-0233; classtype:attempted-user; sid:17409; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT OpenOffice RTF File parsing heap buffer overflow attempt"; flow:to_client,established; content:"rtf"; nocase; content:"|5C|prtdata"; distance:0; nocase; isdataat:200,relative; content:!"|0A|"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24450; reference:cve,2007-0245; classtype:attempted-user; sid:17403; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple computer finder DMG volume name memory corruption"; flow:to_client,established; flowbits:isset,http.dmg; content:"|00 00 00 00 4C 41 42 4C|"; byte_test:2,>,254,12,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0197; classtype:attempted-user; sid:17363; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer JPEG Decoder Vulnerabilities attempt"; flow:to_client,established; file_data; content:"|FF D8 FF|"; content:"|FF DA|"; distance:0; content:"|03|"; within:1; distance:2; content:"|01 00 02 11 01|"; within:5; metadata:policy security-ips drop; reference:bugtraq,14282; reference:cve,2005-1998; reference:cve,2005-2308; classtype:attempted-user; sid:17355; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Color Management Module buffer overflow attempt"; flow:to_client,established; content:"bXYZ"; content:"gXYZ"; within:4; distance:8; byte_test:4,>,60,4,relative; content:"bXYZ"; within:4; distance:8; metadata:policy security-ips drop; reference:bugtraq,14214; reference:cve,2005-1219; classtype:attempted-user; sid:17349; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; content:"<"; content:"onmousedown"; within:24; nocase; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^(\n|\s|>)]|\(|\))*\s*){21}/Rmi"; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17516; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft DirectShow AVI decoder buffer overflow attempt"; flow:to_client,established; content:"RIFF"; content:"strn"; distance:0; nocase; byte_test:4,>,128,0,relative, little; metadata:policy security-ips drop; reference:bugtraq,15063; reference:cve,2005-2128; classtype:attempted-user; sid:17443; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word formatted disk pages table memory corruption attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|D0 CF 11 E0 A1 B1 1A E1|"; content:"|EC A5|"; within:2; distance:504; byte_test:4,>,65535,114,relative,little; metadata:policy security-ips drop; reference:bugtraq,21589; reference:cve,2006-6561; classtype:attempted-user; sid:17505; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime SMIL File Handling Integer Overflow attempt"; flow:to_client,established; flowbits:isset,http.smil; content:"<smil>"; pcre:"/(author|copyright|information)/smiR"; content:"content|3D|"; distance:1; nocase; isdataat:1024,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,24873; reference:cve,2007-2394; classtype:attempted-user; sid:17548; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; content:"<"; content:"onmouseup"; within:22; nocase; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^(\n|\s|>)]|\(|\))*\s*){21}/Rmi"; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17514; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT BitDefender Internet Security script code execution attempt"; flow:to_client,established; file_data; content:"|52 61 72 21 1A 07 00 CF 90|"; within:9; content:"|3C 68 31 3E 20 69 64 3D 22 68 65 61 64 65 72 22 20 6F 6E 6D 6F 75 73 65 6D 6F 76 65 3D 22 61 6C 65 72 74 28 27 41 73 73 75 72 65 6E 74 20 53 65 63 75 72 65 20 54|"; within:54; distance:43; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0850; classtype:attempted-user; sid:17459; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla NNTP URL Handling Buffer Overflow attempt"; flow:to_client,established; content:"news|3A 2F 2F|"; pcre:"/news\x3a\x2f\x2f.*?\x2f?(profile|search).*?\x2f.*?\x5c[^\s\x22\x27]{0,1}/si"; metadata:policy security-ips drop; reference:bugtraq,12131; reference:cve,2004-1316; classtype:attempted-user; sid:17482; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; content:"<"; content:"onmouseover"; within:24; nocase; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^(\n|\s|>)]|\(|\))*\s*){21}/Rmi"; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17512; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows ShellExecute and IE7 snews url handling code execution attempt"; flow:to_client,established; content:"launchURL"; nocase; content:"http|3A|"; distance:0; pcre:"/[^\n]*?[\x25\x22]\x2E(com|bat|cmd|exe)/Ri"; metadata:policy security-ips alert; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-057.mspx; classtype:attempted-user; sid:17468; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox Unicode sequence handling stack corruption attempt"; flow:to_client,established; content:"Content|2D|Type|3A 20|text|2F|html"; http_header; content:"|3B 26 23|8204|3B 26 23|8204"; fast_pattern; metadata:policy security-ips drop; reference:bugtraq,14918; reference:cve,2005-2702; classtype:attempted-user; sid:17434; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel Malformed Record Code Execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|9C 00 02 00|"; byte_test:2,>,0x20,0,relative,little; metadata:policy security-ips drop; reference:bugtraq,17101; reference:cve,2006-0031; classtype:attempted-user; sid:17517; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word formatted disk pages table memory corruption attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|D0 CF 11 E0 A1 B1 1A E1|"; content:"|EC A5|"; within:2; distance:504; byte_test:4,>,65535,138,relative,little; metadata:policy security-ips drop; reference:bugtraq,21589; reference:cve,2006-6561; classtype:attempted-user; sid:17507; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word formatted disk pages table memory corruption attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|D0 CF 11 E0 A1 B1 1A E1|"; content:"|EC A5|"; within:2; distance:504; byte_test:4,>,65535,126,relative,little; metadata:policy security-ips drop; reference:bugtraq,21589; reference:cve,2006-6561; classtype:attempted-user; sid:17506; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; content:"<"; content:"onload"; within:19; nocase; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^(\n|\s|>)]|\(|\))*\s*){21}/Rmi"; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17515; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Script Action Handler buffer overflow attempt"; flow:to_client,established; content:"<"; content:"onclick"; within:20; nocase; pcre:"/[^>]\w*\s*(on(mouse(over|up|down)|load|click)=([^(\n|\s|>)]|\(|\))*\s*){21}/Rmi"; reference:bugtraq,17131; reference:cve,2006-1245; classtype:attempted-user; sid:17513; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Long URL Buffer Overflow attempt"; flow:to_client,established; content:"Location|3A|"; nocase; http_header; isdataat:600,relative; pcre:"/Location\x3A\s+[^\r\n]{600}/Hi"; reference:bugtraq,19667; reference:cve,2006-3869; classtype:attempted-user; sid:17494; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed Graphic Code Execution"; flow:to_client,established; flowbits:isset,http.xls; content:"|00 0D 10 38 00 00 00 18 01 61 00 61 00 61 00|"; pcre:"/(\x51\x10..\x01(\x02|\x00)|\x01(\x02|\x00)..\x51\x10)/smi"; metadata:policy security-ips drop; reference:bugtraq,16181; reference:cve,2006-0030; classtype:attempted-user; sid:17511; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT BitDefender Internet Security script code execution attempt"; flow:to_client,established; content:"|58 35 4F 21 50 25 40 41 50 5B 34 5C 50 5A 58 35|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0850; classtype:attempted-user; sid:17458; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT BitDefender Internet Security script code execution attempt"; flow:to_client,established; file_data; content:"PK|03 04 0A|"; within:5; content:"|3C 68 31 3E 20 69 64 3D 22 68 65 61 64 65 72 22 20 6F 6E 6D 6F 75 73 65 6D 6F 76 65 3D 22 61 6C 65 72 74 28 27 41 73 73 75 72 65 6E 74 20 53 65 63 75 72 65 20 54|"; within:54; distance:25; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0850; classtype:attempted-user; sid:17460; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows ShellExecute and IE7 snews url handling code execution attempt"; flow:to_client,established; content:"document|2E|location|2E|replace"; content:"|2E|exe"; distance:0; nocase; content:"|2E|pdf"; distance:0; nocase; pcre:"/document\x2Elocation\x2Ereplace\s*\x28\s*(\x22|\x27)[a-z0-9]+\.exe\?[a-z0-9]+\.pdf/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,25945; reference:cve,2007-3896; reference:url,www.microsoft.com/technet/security/advisory/943521.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms07-057.mspx; classtype:attempted-user; sid:17467; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Script Engine Stack Exhaustion Denial of Service attempt"; flow:to_client,established; content:"<script"; nocase; content:"javascript"; distance:0; nocase; content:"location="; distance:0; nocase; pcre:"/javascript.+function\s+(\w+)\s*\(\w*\)\s*\{.+location=[^}]+\1.+\}/sim"; metadata:policy security-ips drop; reference:bugtraq,16687; reference:cve,2006-0753; classtype:attempted-dos; sid:17487; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash ActionDefineFunction memory access vulnerability exploit attempt"; flow:to_client,established; file_data; content:"FWS|06|"; within:4; content:"|43 02|"; within:27; byte_test:1,<,64,3,relative; content:"|03|"; within:1; distance:4; pcre:"/^(\x9B|\x8E)/R"; reference:bugtraq,15334; reference:cve,2005-2628; classtype:attempted-user; sid:17457; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT GStreamer QuickTime file parsing multiple heap overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"stss"; content:"|00 00 00 00 00 00 00 03 00 00 00 01 00 FF FF FF|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33405; reference:cve,2009-0398; classtype:attempted-user; sid:17611; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla multiple products CSSValue array memory corruption attempt"; flow:to_client,established; content:"counter|2D|reset|3A|"; content:"counter|2D|increment|3A|"; distance:0; content:"|3C|ol|20|id|3D 22|id1|22 3E 0A|"; distance:0; content:"|3C|li|3E 3C 2F|li|3E 0A 3C|li|3E 3C 2F|li|3E 0A 3C|li|3E 3C 2F|li|3E 0A|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,29802; reference:cve,2008-2785; classtype:attempted-user; sid:17630; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox Chrome Page Loading Restriction Bypass attempt"; flow:to_client,established; content:"window|2E|open"; nocase; content:"about:"; within:10; nocase; content:"document|2E|write"; distance:0; nocase; content:"about:"; within:30; nocase; metadata:policy security-ips drop; reference:bugtraq,14920; reference:cve,2005-2706; classtype:attempted-user; sid:17629; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox file type memory corruption attempt"; flow:to_client,established; content:"type="; nocase; content:"file"; within:7; distance:1; nocase; content:"getElement"; nocase; pcre:"/var\s*(?P<varname>[^\s]*)\s*\x3d\s*[^\x2E]*\x2EgetElement[^\x28]*\x28(\x22|\x27)(?P<elementid>[^\x22\x27]*)(\x22|\x27)\x29.*(?P=varname)\x2etype\s*\x3D\s*(\x22|\x27)(?!file).*id\s*\x3d\s*(\x22|\x27)(?P=elementid)[^>]*type\s*=\s*(\x22|\x27)file/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32281; reference:cve,2008-5021; reference:url,www.mozilla.org/security/announce/2008/mfsa2008-55.html; classtype:attempted-user; sid:17603; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox file type memory corruption attempt"; flow:to_client,established; flowbits:isset, xul.download; content:"style="; content:"<treechildren"; nocase; content:"<treechildren"; distance:0; nocase; content:"ordinal"; content:"event.target.parentNode.removeChild"; fast_pattern:only; nocase; pcre:"/onoverflow\s*=\s*(\x22|\x27)\s*event.target.parentNode.removeChild/smi"; pcre:"/<treechildren.*ordinal=.*<treechildren/smi"; pcre:"/<tree .*tree(?!children).*<treechildren.*<treechildren/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32281; reference:cve,2008-5016; reference:url,www.mozilla.org/security/announce/2008/mfsa2008-52.html; classtype:attempted-user; sid:17601; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint Legacy file format picture object code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|FF 03 00 00 00 60 16 8F 10 00 00 00 00 5F 07 90 08 28 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34834; reference:cve,2009-0223; classtype:attempted-user; sid:17646; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ffdshow codec URL parsing buffer overflow attempt"; flow:to_client,established; content:"6BF52A52-394A-11d3-B153-00C04F79FAA6"; fast_pattern:only; nocase; content:"<param "; nocase; content:"URL"; distance:0; nocase; pcre:"/<param\s+name\s*=\s*(?P<q1>\x22|\x27|)URL(?P=q1)[^>]+?value\s*=\s*(\x22|\x27)[^\x22\x27]{500}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32438; reference:cve,2008-5381; classtype:attempted-user; sid:17573; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer SWF frame handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|78 00 05 5F 00 00 0F A0 00 00 0C 01 00 43 02 FF FF FF BF 00 39|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30370; reference:cve,2007-5400; classtype:attempted-user; sid:17633; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java Web Start malicious parameter value"; flow:to_client,established; content:"<jnlp "; nocase; content:"<resources>"; distance:0; nocase; content:" -classpath"; distance:0; fast_pattern; nocase; pcre:"/<property[^>]*?value\s*=\s*(?P<q1>\x22|\x27).*? -classpath.*?(?P=q1)/smi"; metadata:policy security-ips drop; reference:bugtraq,11726; reference:cve,2004-1029; classtype:attempted-user; sid:17586; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT GStreamer QuickTime file parsing multiple heap overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"stts"; content:"|00 00 00 00 00 00 00 01 EE 00 00 26 00 00 04 00 00|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33405; reference:cve,2009-0398; classtype:attempted-user; sid:17612; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java Web Start JNLP java-vm-args buffer overflow attempt"; flow:to_client,established; content:"|3C|j2se"; content:"java|2D|vm|2D|args"; pcre:"/\x3cj2se[^\x3e]*java\x2dvm\x2dargs\s*\x3d\s*\x22[^\x22]*\x2dea\x3a[^\s\x22\x3e]{100}/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30148; reference:cve,2008-3111; classtype:attempted-user; sid:17631; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word array data handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|01 00 00 02 01 00 00 9E 01 00 00 02 01 00 00 96 01 00 00 FF|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,23804; reference:cve,2007-0035; classtype:attempted-user; sid:17649; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS strings parsing memory corruption attempt"; flow:to_client,established; content:"text-decoration"; nocase; pcre:"/\x2E[A-Z\d_]+\s*\x7b\s*text-decoration[^\x3A]*?\x7d/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0943; reference:url,www.microsoft.com/technet/security/bulletin/ms07-045.mspx; classtype:attempted-user; sid:17645; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word Crafted Sprm memory corruption attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|01 49 66 01 00 00 00 08 D6 FD FF 05 D6 18 04 01 00 00 04 01|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32584; reference:cve,2008-4837; classtype:attempted-user; sid:17591; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT ClamAV antivirus CHM file handling DOS"; flow:to_client,established; content:"ITSF"; content:"|11 FD 01 7C AA 7B D0 11 9E 0C 00 A0 C9 22 E6 EC|"; within:16; distance:36; content:"ITSP"; distance:0; byte_test:4,<,8,12,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30994; reference:cve,2008-1389; reference:url,sourceforge.net/project/shownotes.php?group_id=86638&release_id=623661; classtype:attempted-dos; sid:17602; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox ConstructFrame with floating first-letter memory corruption attempt"; flow:to_client,established; content:"first-letter"; nocase; content:"float: right"; distance:0; nocase; content:"parentNode.removeAttribute(|22|class|22|)"; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,35765; reference:cve,2009-2462; classtype:attempted-user; sid:17642; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft XML Core Services cross-site information disclosure attempt"; flow:to_client,established; content:"<|21|DOCTYPE "; nocase; content:"SYSTEM"; distance:0; nocase; content:".parseError"; distance:0; fast_pattern; nocase; pcre:"/<\x21DOCTYPE\s+[^>]*?SYSTEM[^>]*?>.*?\x2EparseError/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,32155; reference:cve,2008-4029; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-069.mspx; classtype:attempted-recon; sid:17572; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT GStreamer QuickTime file parsing multiple heap overflow attempt"; flow:to_client,established; flowbits:isset,http.quicktime; content:"ctts"; content:"|00 00 00 00 00 00 00 8F 00 00 00 01 00 00 00 14 00 FF FF FF|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33405; reference:cve,2009-0398; classtype:attempted-user; sid:17610; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office GIF image descriptor memory corruption attempt"; flow:to_client,established; file_data; content:"GIF8"; within:4; content:"a"; within:1; distance:1; byte_test:1,!&,0x80,4,relative; pcre:"/^.{7}\x2C.{5}([\xE0-\xFF]|.{2}[\xE0-\xFF])/sR"; reference:bugtraq,18915; reference:bugtraq,22630; reference:cve,2006-0007; reference:cve,2007-1071; reference:url,www.microsoft.com/technet/security/bulletin/ms06-039.mspx; classtype:attempted-user; sid:17664; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer invalid chunk size heap overflow attempt"; flow:to_client,established; content:"Transfer-Encoding"; nocase; http_header; content:"chunked"; fast_pattern; nocase; http_header; content:"Content-Type|3A|"; nocase; http_header; pcre:"/Content-Type\x3a[^\x10\x13]*real(audio|video)/smiH"; content:"HTTP"; within:4; nocase; rawbytes; content:"|0D 0A 0D 0A|"; distance:0; isdataat:1024,relative; pcre:"/([^\x0A]{1024,}|.*?\x0A[^\x0A]{1024,})/smiR"; metadata:policy security-ips drop; reference:bugtraq,17202; reference:cve,2005-2922; classtype:attempted-user; sid:17666; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe BMP image handler buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.bmp; content:"Content-Type: text/plain|0D 0A 0D 0A|BM"; fast_pattern:only; file_data; content:"BM"; content:"|00 00 00 00|"; within:4; distance:4; byte_test:4, >, 256, 36, relative, little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28874; reference:cve,2008-1765; classtype:attempted-user; sid:17678; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft XML Core Services MIME Viewer memory corruption attempt"; flow:to_client,established; content:"getElementById"; nocase; content:"setTimeout"; fast_pattern; nocase; pcre:"/\x2esrc\s*=\s*[\x22\x27]([^\x2e]+)\x2exml\x3f[\x22\x27]\s*\x2b.*\x2esrc\s*=\s*[\x22\x27]\1\x2exml\x3f[^\x22\x27]+[\x22\x27]\s\x2b/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-0099; reference:url,www.microsoft.com/technet/security/bulletin/MS08-069.mspx; classtype:attempted-user; sid:17730; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Opera file URI handling buffer overflow"; flow:to_client,established; content:"file|3A 2F 2F|"; fast_pattern:only; nocase; pcre:"/(src|href)\s*=\s*(\x22|\x27|)file\x3a\x2f\x2f[^\s\x22\x27]{900}/smi"; reference:bugtraq,32323; reference:cve,2008-5178; classtype:attempted-user; sid:17725; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows ASF parsing memory corruption attempt"; flow:to_client,established; content:"|30 26 B2 75 8E 66 CF 11 A6 D9 00 AA 00 62 CE 6C|"; content:"|91 07 DC B7 B7 A9 CF 11 8E E6 00 C0 0C 20 53 65|"; content:"|E0 7D 90 35 15 E4 CF 11 A9 17 00 80 5F 5C 44 2B|"; byte_test:2,>,0xffc6,52,relative,little; metadata:policy balanced-ips drop, policy security-ips drop; reference:cve,2007-0064; reference:url,www.microsoft.com/technet/security/bulletin/ms07-068.mspx; classtype:attempted-user; sid:17711; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java HsbParser.getSoundBank stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,java_class_file.request; file_data; content:"|01 00 2C 28|Ljava|2F|net|2F|URL|3B 29|Ljavax|2F|sound|2F|midi|2F|Soundbank"; content:"|01 00 0C|getSoundbank"; content:"file|3A 2F 2F|"; byte_test:2,>,312,-9,relative,big; content:"|01|"; within:1; distance:-10; pcre:"/^.{2}file|3A 2F 2F|[\x21-\x7E]{305}/R"; reference:bugtraq,36881; reference:cve,2009-3867; classtype:attempted-user; sid:17776; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave Director rcsL chunk memory corruption attempt"; flow:to_client,established; flowbits:isset,http.dir; file_data; content:"rcsL"; content:"|FF F0 02 67|"; within:4; distance:203; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,42682; reference:cve,2010-2873; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:17803; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox html tag attributes memory corruption"; flow:to_client,established; content:"var tags = new Array|28 22|audio|22|, |22|a|22|, |22|base|22 29|"; nocase; content:"var html = |22|<|22| + tags[i] + |22| |22| + atts[j]"; distance:0; fast_pattern; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3765; classtype:attempted-user; sid:17804; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla products graphics and XML features integer overflows attempt"; flow:to_client,established; content:"<?xml"; content:"<svg"; distance:0; content:"<filter"; distance:0; pcre:"/^[^\x3E]*(width|height)\s*\x3D\s*(\x22|\x27)([3-9]\d{4}|\d{6})/R"; metadata:policy security-ips drop; reference:bugtraq,16476; reference:cve,2006-0297; classtype:attempted-user; sid:16037; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Possible generic javascript heap spray attempt"; flow:to_client,established; content:"%u9090%u9090"; fast_pattern:only; nocase; metadata:policy security-ips drop; reference:bugtraq,35660; classtype:attempted-user; sid:18167; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Possible generic javascript heap spray attempt"; flow:to_client,established; content:"%u4141%u4141"; fast_pattern:only; nocase; metadata:policy security-ips drop; reference:bugtraq,35660; classtype:attempted-user; sid:18168; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS importer use-after-free attempt"; flow:to_client,established; content:"@import "; content:"@import "; distance:0; content:"@import "; distance:0; pcre:"/\x40import (url\x28)?\x22([^\x22]+)\x22\x29?\x3B[^\x40]*\x40import (url\x28)?\x22\2\x22\x29?\x3B[^\x40]*\x40import (url\x28)?\x22\2\x22/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,45246; reference:cve,2010-3971; reference:url,www.microsoft.com/technet/security/bulletin/MS11-003.mspx; classtype:attempted-user; sid:18196; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT known malicious JavaScript decryption routine"; flow:to_client,established; content:"location.search.substring|28|1|29|"; nocase; content:".charCodeAt|28|"; within:200; pcre:"/var\s+(\w+)\s*=\s*location\.search\.substring\(1\).{1,200}\1\.charCodeAt\(i\x25\1\.length\)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:attempted-user; sid:18239; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS importer use-after-free attempt"; flow:to_client,established; content:"@|00|i|00|m|00|p|00|o|00|r|00|t|00| |00|"; content:"@|00|i|00|m|00|p|00|o|00|r|00|t|00| |00|"; distance:0; content:"@|00|i|00|m|00|p|00|o|00|r|00|t|00| |00|"; distance:0; pcre:"/\x40\x00i\x00m\x00p\x00o\x00r\x00t\x00 \x00(u\x00r\x00l\x00\x28\x00)?\x22\x00([^\x22]+)\x22\x00(\x29\x00)?\x3B\x00[^\x40]*\x40\x00i\x00m\x00p\x00o\x00r\x00t\x00 \x00(u\x00r\x00l\x00\x28\x00)?\x22\x00\2\x22\x00(\x29\x00)?\x3B\x00[^\x40]*\x40\x00i\x00m\x00p\x00o\x00r\x00t\x00 \x00(u\x00r\x00l\x00\x28\x00)?\x22\x00\2\x22/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,45246; reference:cve,2010-3971; reference:url,www.microsoft.com/technet/security/bulletin/MS11-003.mspx; classtype:attempted-user; sid:18240; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java browser plugin docbase overflow attempt"; flow:to_client,established; file_data; content:"launchjnlp"; fast_pattern; nocase; content:"docbase"; within:100; nocase; isdataat:80,relative; pcre:"/^([\x22\x27]\s*value)?\s*=\s*\x22[^\x22]{70}/Rsmi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,44023; reference:cve,2010-3552; reference:url,osvdb.org/show/osvdb/68873; classtype:attempted-user; sid:18244; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Fax Services Cover Page Editor overflow attempt"; flow:to_client,established; content:"FAXCOVER-VER005w"; nocase; content:"|87 00 00 00 4C 17 00 00 00 00 00 00 52 03 00 00|"; within:100; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.vupen.com/english/advisories/2010/3327; classtype:attempted-user; sid:18246; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office thumbnail bitmap invalid biClrUsed attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|E0 85 9F F2 F9 4F 68 10 AB 91 08 00 2B 27 B3 D9 30 00 00 00|"; content:"|11 00 00 00|"; distance:0; content:"|47 00 00 00|"; distance:0; content:"|08 00 00 00 28 00 00 00|"; within:8; distance:8; pcre:"/^(?=.{10}[\x01\x04\x08\x16\x24\x32]\x00)(.{3}[\x55-\xFF]|.{31}[\x80-\xFF])/sR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3970; reference:url,www.microsoft.com/technet/security/bulletin/MS11-006.mspx; classtype:attempted-user; sid:18265; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer drag-and-drop vulnerability"; flow:to_client,established; content:"CreateObject|28 22|ADODB.Connection|22 29|"; nocase; content:"dbq=http|3A 2F 2F|"; distance:0; fast_pattern; nocase; reference:bugtraq,11466; reference:cve,2005-0053; reference:url,www.microsoft.com/technet/security/bulletin/MS05-008.mspx; classtype:attempted-user; sid:18282; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer implicit drag and drop file installation attempt"; flow:to_client,established; content:"folder"; nocase; content:"|22|shell|3A|"; distance:0; nocase; pcre:"/folder\s*=\s*\x22shell\x3a/i"; metadata:policy security-ips drop; reference:bugtraq,10973; reference:cve,2004-0839; classtype:attempted-user; sid:18299; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer FTP command injection attempt"; flow:to_client,established; content:"ftp|3A 2F 2F|"; nocase; pcre:"/^[^\s]*\x250[ad]/iR"; reference:bugtraq,11826; reference:cve,2004-1166; classtype:attempted-user; sid:18300; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Vector Markup Language fill method overflow attempt"; flow:to_client,established; content:"|3A 00|f|00|i|00|l|00|l|00|"; nocase; content:"m|00|e|00|t|00|h|00|o|00|d|00|"; distance:0; nocase; pcre:"/<\x00(\w\x00)+\x3a\x00f\x00i\x00l\x00l\x00\s\x00([^>]\x00|>[^\x00])*m\x00e\x00t\x00h\x00o\x00d\x00(\s\x00)*=\x00(\s\x00)*(\x27\x00([^\x27]\x00|\x27[^\x00]){100}|\x22\x00([^\x22]\x00|\x22[^\x00]){100}|([^\s>]\x00|[\s>][^\x00]){100})/i"; metadata:policy security-ips drop; reference:bugtraq,20096; reference:cve,2006-4868; reference:url,www.microsoft.com/technet/security/bulletin/ms06-055.mspx; classtype:attempted-user; sid:18309; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader icc mluc interger overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"mluc|00 00 00 00|"; byte_test:4,>,357913941,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,43729; reference:cve,2010-3622; classtype:attempted-user; sid:18308; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer span tag memory corruption attempt"; flow:to_client,established; content:"white|2D|space|3A|normal|3B|"; nocase; pcre:"/pre\s*\x7b\s*white\x2dspace\x3a\s*normal\s*\x3b\s*\x7d/i"; content:"span|20 2F|"; distance:0; nocase; content:"span|20 2F|"; within:14; nocase; pcre:"/(\x26lt\x3b|\x3c)pre(\x26gt\x3b|\x3e)\s*(\x26lt\x3b|\x3c)span\s\x2f(\x26gt\x3b|\x3e)(\x26lt\x3b|\x3c)span\s\x2f(\x26gt\x3b|\x3e)\s*(\x26lt\x3b|\x3c)\x2fpre(\x26gt\x3b|\x3e)/i"; metadata:policy security-ips drop; reference:cve,2006-1188; classtype:attempted-user; sid:18304; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft MHTML XSS attempt"; flow:to_client,established; file_data; content:"mhtml"; fast_pattern; nocase; pcre:"/^\x3A(http|file)\x3A\x2F\x2F/Rsmi"; reference:cve,2011-0096; reference:url,www.microsoft.com/technet/security/bulletin/MS11-026.mspx; classtype:attempted-user; sid:18335; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox JS Web Worker arbitrary code execution attempt"; flow:to_client,established; content:"postMessage"; fast_pattern; content:"data.concat"; within:50; content:"Worker"; pcre:"/\x2epostMessage\s*\x28\s*([^\s]+)\x2edata\x2econcat\s*\x28\1\x2edata\s*\x29/"; reference:cve,2009-3371; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=514554; classtype:attempted-user; sid:18332; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Visio DXF variable name overflow attempt"; flow:to_client,established; flowbits:isset,http.dxf; file_data; content:"HEADER"; content:"9"; distance:0; content:"|0A 24|"; distance:0; isdataat:92,relative; content:!"|0A|"; within:92; pcre:"/HEADER[\x20\r]*\n[\x20]*9[\x20\r]*\n\x24[^\n]{92}/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39836; reference:cve,2010-1681; classtype:attempted-user; sid:18331; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Hypervisor DOS vfd download attempt"; flow:to_client,established; content:"|29 66 3A E1 58 4E 4F 20 4E 41 4D 45 20 20 20 20 46 41 54 31 32 20 20 20 6A 00|"; fast_pattern:only; reference:cve,2010-0026; reference:url,www.microsoft.com/technet/security/bulletin/MS10-010.mspx; classtype:attempted-admin; sid:18396; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes Playlist Overflow Attempt"; flow:to_client,established; flowbits:isset,http.pls; file_data; content:"[playlist]"; within:10; nocase; isdataat:1000; content:"File"; distance:0; pcre:"/^\d+\x3Dhttps?\x3a\x2f\x2f[^\n\r]{1000}/Ri"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2005-0043; classtype:attempted-user; sid:18483; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes Playlist Overflow Attempt"; flow:to_client,established; flowbits:isset,http.m3u.download; file_data; content:"|23|EXTM3U"; within:7; nocase; isdataat:1000; pcre:"/https?\x3a\x2f\x2f[^\n\r]{1000}/Ri"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2005-0043; classtype:attempted-user; sid:18484; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Adobe Photoshop Wintab32.dll dll-load exploit attempt"; flow:to_server,established; content:"Wintab32.dll"; nocase; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3127; reference:url,osvdb.org/show/osvdb/67545; classtype:attempted-user; sid:18488; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader shell metacharacter code execution attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"begin|20|"; within:6; pcre:"/^begin\s\d+\s[^\s\r\n\t]*\x60/sm"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,10931; reference:cve,2004-0630; classtype:attempted-user; sid:18527; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime FlashPix Movie file integer overflow attempt"; flow:to_client,established; content:"|00 01 00 54 C1 CE 11 85 53 00 AA 00 A1 F9 5B 01 00 00 00|"; byte_test:4,>,0x0FFFFFFF,12,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39020; reference:cve,2010-0519; classtype:attempted-user; sid:18510; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Adobe Premier Pro iacenc.dll dll-load exploit attempt"; flow:to_server,established; content:"iacenc.dll"; nocase; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3150; reference:url,osvdb.org/show/osvdb/67554; classtype:attempted-user; sid:18531; rev:1;)
alert tcp $HOME_NET 445 -> $HOME_NET any (msg:"NETBIOS Adobe Premier Pro ibfs32.dll dll-load exploit attempt"; flow:to_client,established; content:"i|00|b|00|f|00|s|00|3|00|2|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2010-3150; reference:url,osvdb.org/show/osvdb/67554; classtype:attempted-user; sid:18530; rev:1;)
alert tcp $HOME_NET 445 -> $HOME_NET any (msg:"NETBIOS Adobe Premier Pro iacenc.dll dll-load exploit attempt"; flow:to_client,established; content:"i|00|a|00|c|00|e|00|n|00|c|00|.|00|d|00|l|00|l|00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn; reference:cve,2010-3150; reference:url,osvdb.org/show/osvdb/67554; classtype:attempted-user; sid:18532; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari WebKit ParentStyleSheet exploit attempt"; flow:to_client,established; content:".sheet.rules["; fast_pattern:only; pcre:"/getElementById\(\x22(.*?)\x22\)\.sheet\.rules\[\d+\].*?([A-Z\d_]+)\s*=\s*document\.getElementById\(\x22\1\x22\).*?\s+\2\.parentElement/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,svnsearch.org/svnsearch/repos/WEBKIT/search?logMessage=51993; classtype:attempted-user; sid:18508; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Adobe Premier Pro ibfs32.dll dll-load exploit attempt"; flow:to_server,established; content:"ibfs32.dll"; nocase; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3150; reference:url,osvdb.org/show/osvdb/67554; classtype:attempted-user; sid:18529; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Multiple Vendors Microsoft Office Word file sprmTSetBrc processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|08 D6|"; byte_extract:1,2,NumOfColumns,relative; byte_jump:2,-3,relative,little; content:"|20 D6|"; within:2; distance:-1; byte_test:1,>,NumOfColumns,2,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,38218; reference:cve,2009-3302; reference:cve,2010-2563; classtype:attempted-user; sid:18535; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT OpenOffice.org XPM file processing integer overflow attempt"; flow:to_client,established; flowbits:isset,http.xpm; content:"/* XPM */"; fast_pattern; content:"static char *"; distance:0; pcre:"/^[^\x22]+\x22(\d+\x20+){2}/R"; byte_test:10,>,419062,0,relative,string; byte_test:10,>,10244,1,relative,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,38218; reference:cve,2009-2949; classtype:attempted-user; sid:18537; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT known JavaScript obfuscation routine"; flow:to_client,established; content:"String.fromCharCode|28|parseInt"; content:"String.fromCharCode|28|"; within:1000; content:".charCodeAt|28|"; within:100; content:".replace"; within:100; pcre:"/\.replace\x28\x2F[^\x2F]+\x2F[A-Z]*\x2C(\x22\x22|\x27\x27)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:attempted-user; sid:17111; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime PICT file overread buffer overflow attempt"; flow:to_client,established; content:"|00 11 02 FF 0C 00 FF|"; byte_jump:2,-17,relative,post_offset -4,big; isdataat:1,relative; content:!"|00 FF|"; within:2; metadata:policy security-ips drop; reference:bugtraq,28583; reference:cve,2008-1019; classtype:attempted-user; sid:18561; rev:2;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for login.yahoo.com detected"; flow:to_client,established; ssl_state:server_hello; content:"login.yahoo.com"; nocase; content:"|3E 75 CE D4 6B 69 30 21 21 88 30 AE 86 A8 2A 71|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18569; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate from usertrust.com detected"; flow:to_client,established; ssl_state:server_hello; content:"usertrust.com"; nocase; content:"|72 03 21 05 C5 0C 08 57 3D 8E A5 30 4E FE E8 B0|"; fast_pattern:only; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=643056; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18576; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for addons.mozilla.org detected"; flow:to_client,established; ssl_state:server_hello; content:"addons.mozilla.org"; nocase; content:"|92 39 D5 34 8F 40 D1 69 5A 74 54 70 E1 F2 3F 43|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18571; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for login.yahoo.com detected"; flow:to_client,established; ssl_state:server_hello; content:"login.yahoo.com"; nocase; content:"|D7 55 8F DA F5 F1 10 5B B2 13 28 2B 70 77 29 A3|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18567; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for global trustee detected"; flow:to_client,established; ssl_state:server_hello; content:"global trustee"; nocase; content:"|D8 F3 5F 4E B7 87 2B 2D AB 06 92 E3 15 38 2F B0|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18573; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for login.skype.com detected"; flow:to_client,established; ssl_state:server_hello; content:"login.skype.com"; nocase; content:"|E9 02 8B 95 78 E4 15 DC 1A 71 0A 2B 88 15 44 47|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18570; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for login.live.com detected"; flow:to_client,established; ssl_state:server_hello; content:"login.live.com"; nocase; content:"|B0 B7 13 3E D0 96 F9 B5 6F AE 91 C8 74 BD 3A C0|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18572; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for login.yahoo.com detected"; flow:to_client,established; ssl_state:server_hello; content:"login.yahoo.com"; nocase; content:"|39 2A 43 4F 0E 07 DF 1F 8A A3 05 DE 34 E0 C2 29|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18568; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for mail.google.com detected"; flow:to_client,established; ssl_state:server_hello; content:"mail.google.com"; nocase; content:"|04 7E CB E9 FC A5 5F 7B D0 9E AE 36 E1 0C AE 1E|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18565; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT fraudulent digital certificate for www.google.com detected"; flow:to_client,established; ssl_state:server_hello; content:"www.google.com"; nocase; content:"|F5 C8 6A F3 61 62 F1 3A 64 F5 4F 6D C9 58 7C 06|"; fast_pattern:only; reference:url,www.comodo.com/Comodo-Fraud-Incident-2011-03-23.html; reference:url,www.microsoft.com/technet/security/advisory/2524375.mspx; classtype:misc-attack; sid:18566; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows wmf integer overflow attempt"; flow:to_client,established; flowbits:isset,wmf.download; content:"|D7 CD C6 9A 00 00|"; depth:6; content:"|00 00 00 00|"; within:4; distance:10; content:"|09 00|"; within:2; distance:4; content:"|00 00|"; within:2; distance:12; byte_test:4,>,0x7fffc002,0,little,; reference:bugtraq,25302; reference:cve,2007-3034; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-046.mspx; classtype:web-application-attack; sid:18583; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office RTF malformed pfragments field"; flow:to_client,established; flowbits:isset,http.rtf; file_data; content:"pFragments"; distance:0; nocase; content:"{|5C|sv"; within:15; nocase; pcre:"/[^\x3b\x7d]*\x3b[^\x3b\x7d]*\x3b.{8}/smiR"; byte_test:4,>,4,0,relative,little, string, hex; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,44652; reference:cve,2010-3333; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:18680; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office RTF malformed second pfragments field"; flow:to_client,established; flowbits:isset,http.rtf; file_data; content:"pFragments"; distance:0; nocase; content:"{|5C|sv"; within:15; nocase; pcre:"/^[^\x3B\x7D]{0,10}\x3B[^\x3B\x7D]{64}/smiR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,44652; reference:cve,2010-3333; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:18706; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla EnsureCachedAttrPraramArrays integer overflow attempt"; flow:to_client,established; file_data; content:"<applet"; nocase; isdataat:2000,relative; content:!"</applet"; within:2000; nocase; content:"<param"; within:2000; nocase; reference:bugtraq,41842; reference:cve,2010-1214; classtype:attempted-user; sid:18809; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat/Reader JpxDecode invalid crgn memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"jp2c|FF 4F|"; content:"|FF 5E 00|"; distance:0; pcre:"/\xff\x5e\x00(\x05[\x80-\xff]|\x06\x00[\x80-\xff]|\x06[^\x00])/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,37757; reference:cve,2009-3955; classtype:attempted-user; sid:18801; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN vlc player subtitle buffer overflow attempt"; flow:to_client,established; content:"[Script Info]"; nocase; content:"[Events]"; distance:0; nocase; content:"Dialogue|3A|"; within:11; nocase; isdataat:1000,relative; content:!"|0A|"; within:1000; metadata:policy security-ips drop; reference:bugtraq,27015; reference:cve,2007-6681; classtype:attempted-admin; sid:18744; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave Director pamm chunk memory corruption attempt"; flow:to_client,established; flowbits:isset,http.dir; file_data; content:"XFIR"; within:4; content:"pamm"; distance:4; byte_test:2,>,0x14,6,relative,little; metadata:policy security-ips drop; reference:cve,2010-4084; reference:url,www.adobe.com/support/security/bulletins/apsb10-25.html; classtype:attempted-user; sid:18776; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple QuickTime streaming debug error logging buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.smil; file_data; content:"<smil"; fast_pattern:only; content:"src"; distance:0; nocase; isdataat:449,relative; pcre:"/^\s*\=\s*(?![\x22\x27]?http(|s|1|s1)\x3a\x2f{2})(\x22[^\x22]{449}|\x27[^\x27]{449}|\S{449})/iR"; reference:bugtraq,41962; reference:cve,2010-1799; classtype:attempted-user; sid:18928; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-MISC HP OpenView Network Node Manager nnmRptConfig.exe Template format string code execution attempt"; flow:to_server,established; content:"/OvCgi/nnmRptConfig.exe"; nocase; http_uri; content:"Action=Create"; nocase; pcre:"/Template\x3D[^\x26]*?\x25\d*n/i"; metadata:policy security-ips drop; reference:bugtraq,45762; reference:cve,2011-0270; classtype:attempted-user; sid:18930; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari WebKit Rendering Counter Code Execution"; flow:to_client,established; file_data; content:"counter-reset|3A|"; nocase; content:"counter-reset|3A|"; distance:0; nocase; content:"counter|28|"; distance:0; nocase; content:"document.body.removeChild|28|"; distance:0; nocase; reference:bugtraq,42036; reference:cve,2010-1784; classtype:attempted-user; sid:18903; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint bad text header txttype attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|9F 0F 04 00 00 00|"; byte_test:4,>,8,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-0022; reference:cve,2011-1269; reference:url,www.microsoft.com/technet/security/bulletin/MS06-028.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS11-036.mspx; classtype:attempted-user; sid:16188; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows MSXML2 ActiveX malformed HTTP response"; flow:to_client,established; content:"HTTP 4|0A|"; depth:7; reference:cve,2010-2561; reference:url,www.microsoft.com/technet/security/bulletin/ms10-051.mspx; classtype:attempted-dos; sid:18962; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows MSXML2 ActiveX malformed HTTP response"; flow:to_client,established; content:"HTTP 99|0A|"; depth:8; reference:cve,2010-2561; reference:url,www.microsoft.com/technet/security/bulletin/ms10-051.mspx; classtype:attempted-dos; sid:18961; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari Webkit button first-letter style rendering code execution attempt"; flow:to_client,established; file_data; content:"<style>"; nocase; content:"|3A|first-letter"; distance:0; nocase; content:"display|3A 20|block"; distance:0; nocase; pcre:"/(?P<a>\w+)\s*\x7b[^\x7d]*?display\s*\x3a\s*block.*?\x3cinput(?=[^\x3e]+type\s*\x3d\s*[\x22\x27]?(button|submit))[^\x3e]+class\s*\x3d\s*[\x22\x27]?(?P=a)/si"; reference:bugtraq,40644; reference:cve,2010-1392; classtype:attempted-user; sid:18973; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari Webkit floating point conversion memory corruption attempt"; flow:to_client,established; content:"debug|28 2D|parseFloat|28 22|NAN|28|ffffe"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,43047; reference:cve,2010-1807; classtype:attempted-user; sid:19008; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT javascript uuencoded eval statement"; flow:to_client,established; content:"unescape"; nocase; content:"%u0065"; distance:0; nocase; content:"%u0076"; distance:0; nocase; content:"%u0061"; distance:0; nocase; content:"%u006c"; distance:0; nocase; pcre:"/unescape\s*\x28[\x22\x27]\s*\x25u0065\s*\x25u0076\s*\x25u0061\s*\x25u006c/i"; metadata:policy security-ips drop; classtype:misc-activity; sid:19075; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader and Acrobat TTF SING table parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/Subtype"; nocase; content:"/TrueType"; within:20; nocase; content:"name"; within:1024; byte_test:4,=,0,8,relative; content:"SING"; byte_test:4,!=,0,8,relative; metadata:policy security-ips drop; reference:bugtraq,43057; reference:cve,2010-2883; reference:url,www.adobe.com/support/security/advisories/apsa10-02.html; classtype:attempted-user; sid:18987; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT javascript uuencoded noop sled attempt"; flow:to_client,established; content:"unescape"; nocase; content:"%u9090%u9090"; distance:0; nocase; pcre:"/unescape\s*\x28[\x22\x27]\s*\x25u9090\x25u9090/i"; metadata:policy security-ips drop; classtype:misc-activity; sid:19074; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari/Google Chrome Webkit memory corruption attempt"; flow:to_client,established; content:"|3C|dialog|20|style|3D 27|position|3A|relative|27 3E|"; fast_pattern:only; content:"|3C|h|20|style|3D 27|outline|2D|style|3A|auto|27 3E|"; metadata:policy security-ips drop; reference:bugtraq,43078; reference:cve,2010-1813; classtype:attempted-user; sid:19005; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave Player Lnam chunk processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.dir; file_data; content:"Lnam|00 00|"; content:!"|00 00|"; within:2; distance:20; content:"|FF|"; within:1; distance:22; isdataat:256; content:!"|00|"; within:256; metadata:policy security-ips drop; reference:bugtraq,44516; reference:cve,2010-3655; reference:url,www.adobe.com/support/security/bulletins/apsb10-25.html; classtype:attempted-user; sid:19011; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader and Acrobat TTF SING table parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/Subtype"; nocase; content:"/OpenType"; within:20; nocase; content:"name"; within:1024; byte_test:4,=,0,8,relative; content:"SING"; byte_test:4,!=,0,8,relative; metadata:policy security-ips drop; reference:bugtraq,43057; reference:cve,2010-2883; reference:url,www.adobe.com/support/security/advisories/apsa10-02.html; classtype:attempted-user; sid:18986; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave Player Lnam chunk processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"manL"; content:"|00 00|"; within:2; distance:2; content:!"|00 00|"; within:2; distance:18; content:"|FF|"; within:1; distance:20; isdataat:256,relative; content:!"|00|"; within:256; metadata:policy security-ips drop; reference:bugtraq,44516; reference:cve,2010-3655; reference:url,www.adobe.com/support/security/bulletins/apsb10-25.html; classtype:attempted-user; sid:19012; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari CSS font format corruption attempt"; flow:to_client,established; content:"src|3A|"; nocase; content:"url("; within:100; nocase; content:"format("; within:300; nocase; pcre:"/\x7B[^\x7D]*?src\x3A\s+url\([^\)]*\)\s+format\([^\x22\x27\)]*\)/i"; reference:bugtraq,38684; reference:cve,2010-0046; reference:url,support.apple.com/kb/HT4070; classtype:attempted-user; sid:19099; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java Soundbank resource name overflow attempt"; flow:to_client,established; content:"snd|20 00 00|"; byte_test:1,>,0x7F,2,relative; metadata:policy security-ips drop; reference:bugtraq,39070; reference:cve,2010-0839; classtype:attempted-user; sid:19100; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word malformed index code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|02 00 60 00 0C 14 FF 00 04 61 D5 00 B0 00 08 00 53 00 75 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,43766; reference:cve,2010-2750; classtype:attempted-user; sid:19153; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows MSPaint jpeg with malformed SOFx field exploit attempt"; flow:to_client,established; flowbits:isset, file.jpeg; content:"|FF C0 00 11 08 FF 37 55 99 03 01 22 00 02 11 01 03 11 01|"; metadata:policy security-ips drop; reference:cve,2010-0028; reference:url,www.microsoft.com/technet/security/bulletin/MS10-003.mspx; classtype:attempted-user; sid:19130; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player SWF file MP4 data parsing memory corruption attempt"; flow:to_client,established; flowbits:isset,http.mp4; content:"stsc"; byte_test:4,>,0xFFFF,12,relative,big; byte_jump:4,-8,relative,big; content:"stsz"; within:4; byte_test:4,>,10,8,relative,big; pcre:"/^.{12}([^\x00].{3}){10}/sR"; metadata:policy security-ips drop; reference:bugtraq,40801; reference:cve,2010-2162; reference:url,www.adobe.com/support/security/bulletins/apsb10-14.html; classtype:attempted-user; sid:19148; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Access Wizard control memory corruption ActiveX clsid access"; flow:to_client,established; flowbits:isset,http.doc; content:"|27 03 23 53 2B 17 D0 11 AD 40 00 A0 C9 0D C8 D9|"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,41442; reference:cve,2010-1881; classtype:attempted-user; sid:19141; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer malformed table tag memory corruption attempt"; flow:to_client,established; content:"colspan"; fast_pattern:only; nocase; content:"<script>"; nocase; pcre:"/<t(d|r|h|head|foot)[^>]+id\s*=\s*(?P<q1>\x22|\x27|)([^\x22\x27]+)(?P=q1).*?\3\.colspan.*?<\/script>.*?<\/table>/smi"; reference:cve,2010-2560; classtype:attempted-user; sid:19149; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player JPG header record mismatch memory corruption attempt"; flow:to_client,established; flowbits:isset,http.avi; content:"|FF D8|"; content:"|FF C0|"; within:200; content:"|FF DA|"; within:500; pcre:"/\xFF\xD8.{0,198}\xFF\xC0.{7}(?P<cnt>.).{0,490}\xFF\xDA.{2}(?!(?P=cnt))/s"; metadata:policy security-ips drop; reference:bugtraq,40464; reference:cve,2010-1880; reference:url,www.microsoft.com/technet/security/bulletin/MS10-033.mspx; classtype:attempted-user; sid:19143; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer malformed table tag memory corruption attempt"; flow:to_client,established; content:"rowspan"; fast_pattern:only; nocase; content:"<script>"; nocase; pcre:"/<t(d|r|h|head|foot)[^>]+id\s*=\s*(?P<q1>\x22|\x27|)([^\x22\x27]+)(?P=q1).*?\3\.rowspan.*?<\/script>.*?<\/table>/smi"; reference:cve,2010-2560; classtype:attempted-user; sid:19150; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer innerHTML against incomplete element heap corruption attempt"; flow:to_client,established; content:"|3C|em id|3D 22|obj|22 3E|"; content:"obj|2E|outerHTML|2B 2B|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0490; reference:url,www.microsoft.com/technet/security/bulletin/MS10-018.mspx; classtype:attempted-user; sid:19147; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Internet Explorer 8 ieshims.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|ieshims.dll"; nocase; http_uri; reference:bugtraq,46159; reference:cve,2011-0038; reference:url,www.microsoft.com/technet/security/bulletin/ms11-003.mspx; classtype:attempted-user; sid:19171; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Vista feed headlines cross-site scripting attack attempt"; flow:to_client,established; content:"<rss"; content:"<channel"; distance:0; content:"expression|28|"; distance:0; pcre:"/<title>[^>]*?(&lt|<).*?expression\x28.*?<\/title>/i"; metadata:policy security-ips drop; reference:bugtraq,25287; reference:cve,2007-3033; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-048.mspx; classtype:web-application-attack; sid:19174; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer vidplin.dll avi header parsing execution attempt"; flow:to_client,established; flowbits:isset,http.avi; content:"strlstrh"; fast_pattern; nocase; byte_jump:4,0,relative,little; content:!"strf"; within:4; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,46047; reference:cve,2010-4393; classtype:attempted-user; sid:19169; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer MsgBox arbitrary code execution attempt"; flow:to_client,established; content:"MsgBox"; content:"|22 5C 5C|"; fast_pattern; content:".hlp|22|"; within:50; pcre:"/(^|\s)(?P<var>[^\s]+)\s*=\s*\x22\x5c\x5c[^\x22]*\x2ehlp\x22.*MsgBox\s+(\x22[^\x22]*\x22|[^,]*)\s*,\s*[0-9]*\s*,\s*(\x22[^\x22]*\x22|[^,]*)\s*,\s*(?P=var)/smi"; reference:cve,2010-0483; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-022.mspx; classtype:attempted-user; sid:19204; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer layout-grid-char value exploit attempt"; flow:to_client,established; content:"layout-grid-char|3A|"; nocase; pcre:"/^\s*[0-9]*[^0-9\s\x3b]/R"; metadata:policy security-ips drop; reference:cve,2011-1260; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-admin; sid:19243; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer MsgBox arbitrary code execution attempt"; flow:to_client,established; content:"MsgBox"; content:"|22 5C 5C|"; within:300; fast_pattern; content:".hlp|22|"; within:50; pcre:"/MsgBox\s+(\x22[^\x22]*\x22|[^,]*)\s*,\s*[0-9]*\s*,\s*(\x22[^\x22]*\x22|[^,]*)\s*,\s*\x22\x5c\x5c[^\x22]*\x2ehlp\x22/smi"; reference:cve,2010-0483; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-022.mspx; classtype:attempted-user; sid:19203; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader malicious language.engtesselate.ln file download attempt"; flow:to_client,established; flowbits:isset,http.engtesselate; content:"2="; isdataat:255,relative; content:!"|0A|"; within:255; reference:cve,2011-2095; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19253; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel Series record exploit attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|03 10 0C 00|"; content:"|00 01 00|"; within:3; distance:1; byte_test:1,&,0x80,1,relative; content:"|33 10 00 00|"; within:4; distance:8; metadata:policy security-ips drop; reference:cve,2011-1278; reference:url,www.microsoft.com/technet/security/bulletin/MS11-045.mspx; classtype:attempted-user; sid:19231; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Visual Studio information disclosure attempt"; flow:to_client,established; content:"<!ENTITY"; content:"SYSTEM"; within:50; content:"<!ENTITY"; distance:0; content:"SYSTEM"; within:50; content:"http|3A 2F 2F|"; within:100; nocase; pcre:"/\x3C\x21ENTITY\s+(?P<name>\w+)\s+SYSTEM\s+\x22[a-zA-Z]\x3A\x5C.*?\x3C\x21ENTITY\s+\w+\s+SYSTEM\s+\x22[hH][tT]{2}[pP]\x3A\x2f{2}[^\x22]*\x3D\x26(?P=name)/s"; reference:cve,2011-1280; reference:url,www.microsoft.com/technet/security/bulletin/MS11-049.mspx; classtype:misc-attack; sid:19234; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer redirect to cdl protocol attempt"; flow:to_client,established; content:"302 Redirect"; nocase; content:"Location|3A 20|cdl|3A 2F 2F|"; distance:0; nocase; http_header; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1262; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-admin; sid:19245; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 8 toStaticHTML XSS attempt"; flow:to_client,established; content:"toStaticHTML("; fast_pattern; nocase; content:"expression("; within:100; nocase; pcre:"/toStaticHTML\x28.*?[\x26\x22].=expression\x28/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1252; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-user; sid:19239; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe PDF CIDFont dictionary glyph width corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|2F|Subtype|20 2F|CIDFontType2"; content:"|2F|W|20 5B|0|20 5B|778|20|0|5D 20|2|20|3|20|250|20|4|20 5B|333|20|408|5D|"; distance:0; content:"|5B|556|20|722|20|667|20|556|20|611|5D|"; distance:0; reference:cve,2011-2105; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19251; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer IE6/7/8 reload stylesheet attempt"; flow:to_client,established; file_data; content:".href"; nocase; content:".rel"; distance:0; nocase; content:"stylesheet"; distance:0; fast_pattern; nocase; content:".href"; distance:0; nocase; content:"location.reload"; distance:0; nocase; pcre:"/(?P<q1>[a-zA-Z0-9]*)\x2ehref\s*\x3d.*(?P=q1)\x2erel\s*\x3d.*(?P=q1)\x2ehref\s*\x3d/smi"; reference:cve,2011-1250; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-user; sid:19240; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader javascript in PDF go-to actions exploit attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/S /GoToR"; content:"/F |28|javascript:"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2101; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19254; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel SerAuxTrend biff record corruption attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|4B 10|"; fast_pattern; content:"|00|"; within:1; distance:2; pcre:"/^[\x00\x01\x07-\xFF]\xFF\xFF\xFF\xFF/R"; metadata:policy security-ips drop; reference:cve,2011-1274; reference:url,www.microsoft.com/technet/security/bulletin/MS11-045.mspx; classtype:attempted-user; sid:19225; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Certification service XSS attempt"; flow:to_server,established; content:"certfnsh|2E|asp"; nocase; http_uri; content:"TargetStoreFlagsObserve"; nocase; http_client_body; pcre:"/^=[^\s\x26]*[\x3C\x3E\x22\x27\x28\x29]/R"; reference:cve,2011-1264; reference:url,www.microsoft.com/technet/security/bulletin/MS11-051.mspx; classtype:attempted-user; sid:19186; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS expression defined to empty selection attempt"; flow:to_client,established; content:"expression"; nocase; content:"document.selection.empty"; within:50; pcre:"/expression\s*\x28\s*document\x2eselection\x2eempty\s*\x28\s*\x29/si"; reference:cve,2011-1261; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-admin; sid:19246; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash ActionScript float index memory corruption"; flow:to_client,established; flowbits:isset,http.swf; content:"|5F 30 64 61 79 32 5F 66 6C 61 0C 4D 61 69 6E 54 69 6D 65 6C 69 6E 65|"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2011-2110; reference:url,www.adobe.com/support/security/bulletins/apsb11-18.html; classtype:attempted-user; sid:19257; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint out of bounds value remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; file_data; content:"|C3 0B 08|"; fast_pattern; byte_test:1,<,0x1,7,relative,little; content:"|C3 0B|"; distance:0; metadata:policy security-ips drop; reference:cve,2010-0032; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:19303; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel Chart Sheet Substream memory corruption attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|02 10 10 00|"; content:"|33 10 00 00 55 08 0C 00|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,40521; reference:cve,2010-0823; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:19294; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint improper filename remote code execution attempt"; flow:to_client,established; content:"powerpoint"; fast_pattern:only; nocase; http_header; pcre:"/Content\x2DDisposition\x3A\s*attachment[^\x0D\x0A]+name\x3D[^\x0D\x0A\x5C\x2F\x3A\x2A\x3F\x22\x3C\x3E\x7C\x3D\s]{200}/iH"; metadata:policy security-ips drop; reference:cve,2010-0029; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:19296; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows AVI Header insufficient data corruption attempt"; flow:to_client,established; flowbits:isset,http.avi; content:"RIFF"; fast_pattern; content:"AVI "; within:4; distance:4; content:"avih"; distance:0; byte_extract:4,0,chunk_size,little,relative; isdataat:!chunk_size,relative; metadata:policy security-ips drop, service http; reference:bugtraq,35967; reference:cve,2009-1545; reference:url,www.microsoft.com/technet/security/bulletin/ms09-038.mspx; classtype:attempted-user; sid:19320; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Groove GroovePerfmon.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|GroovePerfmon.dll"; nocase; http_uri; reference:cve,2010-3146; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-016.mspx; classtype:attempted-user; sid:19315; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iOS 4.3.3 jailbreak for iPad download attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|28 69 90 CC 10 42 88 0A D9 21 25 52 F6 DE 23 23|"; fast_pattern:only; metadata:policy security-ips drop; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19417; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media encryption sample ID header RCE attempt"; flow:to_client,established; flowbits:isset,http.asf; content:"|CB A5 E6 14 72 C6 32 43 83 99 A9 69 52 06 5B 5A|"; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,objectsize,relative,little; content:"N|B8 98|f|FA 0A|0C|AE B2 1C 0A 98 D7 A4|M"; distance:68; fast_pattern; byte_test:4,>,objectsize,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2498; reference:url,www.microsoft.com/technet/security/bulletin/ms09-047.mspx; classtype:attempted-user; sid:19449; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp MIDI Timestamp buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mid; file_data; content:"|4D 55 53 1A C0 EB|"; within:6; content:"|81 80 80 80 48|"; within:5; distance:308; fast_pattern; metadata:policy security-ips drop; reference:bugtraq,45221; classtype:attempted-user; sid:19432; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Timecode header RCE attempt"; flow:to_client,established; flowbits:isset,http.asf; content:"|CB A5 E6 14 72 C6 32 43 83 99 A9 69 52 06 5B 5A|"; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,objectsize,relative,little; content:"|EC 95 95|9g|86|-N|8F DB 98 81|L|E7|l|1E|"; distance:68; fast_pattern; byte_test:4,>,objectsize,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2498; reference:url,www.microsoft.com/technet/security/bulletin/ms09-047.mspx; classtype:attempted-user; sid:19445; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iOS 4.3.3 jailbreak for iPad download attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|78 DA ED DD 07 5C 8E FB E3 3F FE 86 8C 86 A2 A1 41 32 22 69 A7 52 69 A2 D2 56 89 64 A5 BD 35 35|"; fast_pattern:only; metadata:policy security-ips drop; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19416; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iOS 4.3.3 jailbreak for iPod download attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|78 DA ED DD 07 3C 97 FB FF 3F 7E 23 0D 23 CA C8 28 69 90 64 13 21 44 85 B2 0A 91 68 C8 DE 5B 46|"; metadata:policy security-ips drop; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19419; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media file name header RCE attempt"; flow:to_client,established; flowbits:isset,http.asf; content:"|CB A5 E6 14 72 C6 32 43 83 99 A9 69 52 06 5B 5A|"; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,objectsize,relative,little; content:"|0E EC|e|E1 ED 19 D7|E|B4 A7|%|CB D1 E2 8E 9B|"; distance:68; fast_pattern; byte_test:4,>,objectsize,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2498; reference:url,www.microsoft.com/technet/security/bulletin/ms09-047.mspx; classtype:attempted-user; sid:19446; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media content type header RCE attempt"; flow:to_client,established; flowbits:isset,http.asf; content:"|CB A5 E6 14 72 C6 32 43 83 99 A9 69 52 06 5B 5A|"; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,objectsize,relative,little; content:" |DC 90 D5 BC 07|lC|9C F7 F3 BB FB F1 A4 DC|"; distance:68; fast_pattern; byte_test:4,>,objectsize,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2498; reference:url,www.microsoft.com/technet/security/bulletin/ms09-047.mspx; classtype:attempted-user; sid:19447; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iOS 4.3.3 jailbreak for iPhone download attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|78 DA ED DD 07 3C D7 7B FF 3F 7E 2A 29 15 1A 94 64 A5 32 B2 25 45 94 0A 89 22 85 64 25 7B CB DE|"; fast_pattern:only; metadata:policy security-ips drop; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19418; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CStyleSheetRule array memory corruption attempt"; flow:to_client,established; content:"document.styleSheets"; fast_pattern; nocase; content:"removeRule"; within:200; nocase; metadata:policy security-ips drop; reference:bugtraq,43705; reference:cve,2010-3328; reference:url,www.microsoft.com/technet/security/bulletin/MS10-071.mspx; classtype:attempted-user; sid:19436; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media encryption sample ID header RCE attempt"; flow:to_client,established; flowbits:isset,http.asf; content:"|CB A5 E6 14 72 C6 32 43 83 99 A9 69 52 06 5B 5A|"; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,objectsize,relative,little; content:"|06 AF E1 00 EC 7B D1 11 A5 82 00 C0 4F C2 9C FB|"; distance:68; fast_pattern; byte_test:4,>,objectsize,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2498; reference:url,www.microsoft.com/technet/security/bulletin/ms09-047.mspx; classtype:attempted-user; sid:19450; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media pixel aspect ratio header RCE attempt"; flow:to_client,established; flowbits:isset,http.asf; content:"|CB A5 E6 14 72 C6 32 43 83 99 A9 69 52 06 5B 5A|"; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,objectsize,relative,little; content:"T|E5 1E 1B EA F9 C8|K|82 1A|7kt|E4 C4 B8|"; distance:68; fast_pattern; byte_test:4,>,objectsize,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2498; reference:url,www.microsoft.com/technet/security/bulletin/ms09-047.mspx; classtype:attempted-user; sid:19448; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp MIDI Timestamp buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mid; file_data; content:"|4D 55 53 1A C0 EB|"; within:6; content:"|81 80 80 80 48|"; within:5; distance:180; metadata:policy security-ips drop; reference:bugtraq,45221; classtype:attempted-user; sid:19431; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media sample duration header RCE attempt"; flow:to_client,established; flowbits:isset,http.asf; content:"|CB A5 E6 14 72 C6 32 43 83 99 A9 69 52 06 5B 5A|"; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,objectsize,relative,little; content:"P|94 BD C6 7F 86 07|I|83 A3 C7|y!|B7|3|AD|"; distance:68; fast_pattern; byte_test:4,>,objectsize,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2498; reference:url,www.microsoft.com/technet/security/bulletin/ms09-047.mspx; classtype:attempted-user; sid:19444; rev:1;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Microsoft Windows CSRSS double free attempt"; flow:to_client,established; content:"|4A 10 33 C0 8B 4D FC 66 89 41 16 33 D2 8B 45 FC 66 89 50 12 8B 4D FC C7 41 0C 11 14 14 14 6A 1C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1284; reference:url,www.microsoft.com/technet/security/bulletin/MS11-056.mspx; classtype:attempted-user; sid:19463; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows CSRSS multiple consoles on a single process attempt"; flow:to_client,established; file_data; content:"|50 92 40 00 E8 8E 04 00 00 83 C0 40 50 E8 F9 03 00 00 83 C4 0C 6A 01 E8 87 03 00 00 68 9C 92 40|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1281; reference:url,www.microsoft.com/technet/security/bulletin/MS11-056.mspx; classtype:attempted-user; sid:19460; rev:3;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Microsoft Windows CSRSS negative array index code execution attempt"; flow:to_client,established; content:"|45 E0 00 80 00 00 C7 45 E4 0A 00 00 00 C7 45 E8 00 00 00 00 8B F4 8D 45 DC 50 FF 15 A8 81 41 00 3B F4 E8 3A FD FF FF 89 45 F4 8B F4 FF 15 A4 81|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1283; reference:url,www.microsoft.com/technet/security/bulletin/MS11-056.mspx; classtype:attempted-user; sid:19462; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Office Visio mfc71 dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc71"; fast_pattern; nocase; http_uri; content:".dll"; within:7; nocase; http_uri; reference:cve,2010-3148; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-055.mspx; classtype:attempted-user; sid:19466; rev:4;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Microsoft Windows CSRSS NULL Fontface pointer attempt"; flow:to_client,established; content:"|74 02 EB 19 68 00 00 01 00 0F B7 45 EC 50 68 D0 F0 42 00 E8 DA F3 FF FF 83 C4 0C EB A1 0F B7 45|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1282; reference:url,www.microsoft.com/technet/security/bulletin/MS11-056.mspx; classtype:attempted-user; sid:19461; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel format record code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|1E 04|"; byte_test:2,>,392,2,relative,little; byte_test:2,>,4,0,relative,little; byte_jump:2,0,relative,little; pcre:"/^(\x1E\x04|\xE0\x00)/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3005; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-043.mspx; classtype:attempted-user; sid:19552; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Quicktime movie record invalid version number exploit attempt"; flow:to_client,established; content:"moov"; content:"mvhd|FF|"; within:5; distance:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0956; reference:url,support.apple.com/kb/HT3591; classtype:attempted-user; sid:15480; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes PLS file parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.pls; content:"[playlist]"; nocase; content:"File"; distance:0; nocase; pcre:"/^File\d+\s*\x3D\s*[^\x2E\r\n]+\x2E[^\r\n]{32}/mi"; metadata:policy security-ips drop; reference:bugtraq,36478; reference:cve,2009-2817; classtype:attempted-user; sid:19560; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Oracle Java Runtime Environment .hotspot_compiler file load exploit attempt"; flow:to_server,established; content:"|2F|.hotspot_compiler"; nocase; http_uri; reference:url,secunia.com/advisories/45173; classtype:attempted-user; sid:19604; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Oracle Java Runtime Environment .hotspotrc file load exploit attempt"; flow:to_server,established; content:"|2F|.hotspotrc"; nocase; http_uri; reference:url,secunia.com/advisories/45173; classtype:attempted-user; sid:19603; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Adobe multiple products dwmapi.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|dwmapi.dll"; nocase; http_uri; reference:cve,2010-3127; reference:cve,2010-3131; reference:cve,2010-3191; reference:cve,2010-3976; reference:url,www.adobe.com/support/security/bulletins/apsb10-26.html; classtype:attempted-user; sid:19620; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Adobe Audition assist.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|assist.dll"; nocase; http_uri; classtype:attempted-user; sid:19619; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT MultiMedia Soft Components AdjMmsEng.dll PLS file processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.pls; content:"200 OK"; fast_pattern:only; file_data; isdataat:1024,relative; pcre:"/^(\[playlist\]\s+)?[^\r\n]{1024}/iR"; reference:bugtraq,33589; reference:cve,2009-0476; classtype:attempted-user; sid:19621; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player ActionScript 3 buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|E9 3F 00 00 00 00 00 00 D0 3F 33 33 33 33 33 33 E3 3F 7B 14 AE 47 E1 7A A4 3F 66 66 66 66 66 66 F6 3F 9A 99 99 99 99 99 B9 3F EB 09 00 07 42 6F 6F 6C 65 61 6E 04 76 6F 69 64 03 69 6E 74 0B 66|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2415; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19683; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash MP4 ref_frame allocated buffer overflow attempt"; flow:to_client,established; content:"NetStream"; nocase; content:"|16 03 16 05 16 07 18 09 16 0B 16 10 17 05 05 00 05 00 08 17 16 18 16 19 16 1A 16 1B 16 1C|"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2011-2140; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-admin; sid:19693; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Data Access Components bidlab.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|bidlab.dll"; nocase; http_uri; reference:cve,2011-1975; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-059.mspx; classtype:attempted-user; sid:19674; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Report Viewer reflect XSS attempt"; flow:to_server,established; content:"ReportID|3D|"; nocase; http_uri; content:"ControlID|3D|"; nocase; http_uri; content:"TimerMethod|3D|"; nocase; http_uri; pcre:"/TimerMethod\x3D[^\x26]*[\x3C\x28\x22\x27]/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1976; reference:url,www.microsoft.com/technet/security/bulletin/MS11-067.mspx; classtype:attempted-user; sid:19681; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer XSL refreshing memory corruption attempt"; flow:to_client,established; content:"<xsl|3A|template match"; nocase; content:"http-equiv"; distance:0; nocase; content:"refresh"; within:50; nocase; pcre:"/<xsl\x3Atemplate match\s*=\s*([\x22\x27])\x2F\1.*?<meta[^>]+http-equiv\s*=\s*(?P<q1>\x22|\x27|)refresh(?P=q1)[^>]+content\s*=\s*(\x22|\x27|)(\.\d|[12])/smi"; metadata:policy security-ips drop; reference:cve,2011-1963; reference:url,www.microsoft.com/technet/security/bulletin/MS11-057.mspx; classtype:attempted-user; sid:19671; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash ActionStoreRegister instruction length invalidation attempt"; flow:to_client,established; flowbits:isset, http.swf; content:"|00 04 03 08 61 4E 12 12 9D 02 00 4D 02 96 06 00 04 03 08 61 05 01 4F 96 02 00 08 12 1C 96 02 00|"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2011-2414; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-admin; sid:19687; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Internet Explorer telnet.exe file load exploit attempt"; flow:to_server,established; content:"|2F|telnet.exe"; nocase; http_uri; reference:cve,2011-1961; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-057.mspx; classtype:attempted-user; sid:19670; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows CSRSS SrvDeviceEvent exploit attempt"; flow:to_client,established; flowbits:isset,file.exe; content:"|06 7C BD EB 05 BA CC CC CC CC 8B 75 08 33 FF 8B C6 85 F6 74 56 8B 40 04 47 85 C0 75 F8 85 F6 74 4A 39 16 75 0F 39 56 14 75 0A 39 56 18 75 05 39|"; fast_pattern:only; reference:cve,2011-1967; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-063.mspx; classtype:attempted-user; sid:19680; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows NDISTAPI Driver code execution attempt"; flow:to_client,established; flowbits:isset,file.exe; content:"|FF 25 A8 81 41 00 FF 25 C4 82 41 00 CC CC CC CC 75 01 C3 55 8B EC 83 EC 00 50 52 53 56 57 8B 45 04 6A 00 50 E8 D0 FC FF FF 83 C4 08 5F 5E 5B 5A|"; fast_pattern:only; reference:cve,2011-1974; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-062.mspx; classtype:attempted-admin; sid:19679; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer multi-window access memory corruption attempt"; flow:to_client,established; content:"open|28 22 23|newwnd"; nocase; content:".document.open|28 29|"; distance:0; nocase; pcre:"/([A-Z\d_]+)\s*=\s*open\x28.*?\1\.document\.open\x28\x29/smi"; reference:cve,2011-1257; reference:url,www.microsoft.com/technet/security/bulletin/MS11-057.mspx; classtype:attempted-user; sid:19666; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer stylesheet dynamic access memory corruption attempt"; flow:to_client,established; content:"addBehavior|28|"; nocase; content:".onreadystatechange"; distance:0; nocase; content:".innerHTML"; distance:0; nocase; pcre:"/([A-Z\d_]+)\.addBehavior\x28.*?\.onreadystatechange\s*=\s*function[^\x7B]+\x7B[^\x7D]*\1\.innerHTML/smi"; reference:cve,2011-1964; reference:url,www.microsoft.com/technet/security/bulletin/MS11-057.mspx; classtype:attempted-user; sid:19672; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash regular expression grouping depth buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"RegExp"; nocase; content:"|28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28 28|"; within:50; metadata:policy security-ips drop; reference:cve,2011-2134; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19685; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player ActionScript 3 integer overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|0A 5C 94 BF 42 D9 62 00 00 F3 45 3D D4 6E C2 7F 22 D1 11 DD B9 EC D8 84 72 2B DD 44 F2 BB 00 05 E6 8A 7B A8 DD 89 DE 4A 86 00 FF 09 10 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2416; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19682; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Telnet protocol specifier in web page attempt"; flow:to_client,established; content:"telnet|3A 2F 2F|"; nocase; pcre:"/(src|href)\s*=\s*(\x22|\x27|)telnet\x3a\x2f\x2f/i"; classtype:policy-violation; sid:19669; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash cross-site request forgery attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|00|loadClip"; nocase; content:"|00|loadVariables"; nocase; content:"|00 8E 0F 00|loadUrl"; distance:0; nocase; metadata:policy security-ips drop; reference:cve,2011-2139; reference:url,www.adobe.com/support/security/bulletins/apsb11-21.html; classtype:attempted-user; sid:19692; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Google Chrome float rendering corruption attempt"; flow:to_client,established; content:"display: -webkit-inline-box"; fast_pattern:only; content:"removeChild|28|"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1804; classtype:attempted-user; sid:19710; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft XML core services cross-domain information disclosure attempt"; flow:to_client,established; file_data; content:"XMLHttpRequest"; pcre:"/setRequestHeader.*chunked/smiR"; content:"send"; distance:0; content:"0|5C|r|5C|n|5C|r|5C|n"; distance:0; metadata:policy security-ips drop; reference:cve,2008-4033; reference:url,www.microsoft.com/technet/security/bulletin/MS08-069.mspx; classtype:attempted-recon; sid:19818; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari Webkit SVG memory corruption attempt"; flow:to_client,established; file_data; flowbits:isset,svg_file.request; content:"|2E|svg"; distance:0; nocase; content:"documentElement"; distance:0; nocase; pcre:"/\x3cscript.*documentElement\x2e(height|preserveAspectRatio|viewBox|width|x|y)/smi"; reference:bugtraq,48844; reference:cve,2011-0222; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:19807; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer covered object memory corruption attempt"; flow:to_client,established; content:".body.innerHTML +="; nocase; content:"function |28 29| |7B|"; within:50; nocase; content:!"|7D|"; within:200; reference:cve,2011-1256; reference:url,www.microsoft.com/technet/security/bulletin/ms11-050.mspx; classtype:attempted-user; sid:19808; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer CSS style memory corruption attempt"; flow:to_client,established; file_data; content:"table"; nocase; content:"position"; nocase; content:"absolute"; distance:0; nocase; content:"clip"; nocase; pcre:"/table\s*(\/\*\*\/)?(\x7b|style)[^\x7d\x3e]*position\s*\x3a\s*absolute/i"; pcre:"/table\s*(\/\*\*\/)?(\x7b|style)[^\x7d\x3e]*clip\s*\x3a/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3962; reference:url,www.microsoft.com/technet/security/advisory/2458511.mspx; classtype:attempted-user; sid:19873; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple iTunes invalid tref box exploit attempt"; flow:to_client,established; flowbits:isset,http.mp4; content:"tref"; byte_test:4,>,19,-8,relative; pcre:"/^(\x00{4}|[\x80-\xff])/R"; reference:cve,2010-0531; reference:url,support.apple.com/kb/HT4105; classtype:attempted-dos; sid:16224; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer VML buffer overflow attempt"; flow:to_client,established; file_data; content:".length"; content:"<"; within:225; content:"="; within:150; content:"0x400000"; pcre:"/[a-z]+\.substring\x28\s+0\s+\x2c\s+0x100000\s+-\s+[a-z]+\.length\s+\x29/smi"; metadata:policy security-ips drop; reference:cve,2006-4868; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-055; classtype:attempted-user; sid:19871; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer ani file processing - remote code execution attempt"; flow:to_client,established; file_data; content:"RIFF"; depth:4; fast_pattern; content:"ACON"; within:4; distance:4; content:"anih"; content:!"|18 00 00 00|"; within:4; metadata:policy security-ips drop, service http; reference:cve,2007-0038; reference:url,www.microsoft.com/technet/security/bulletin/ms07-017; classtype:attempted-user; sid:19886; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer daxctle.ocx spline method buffer overflow attempt"; flow:to_client,established; file_data; content:"|28 28|0x200c-4|29 2F|2|29|"; fast_pattern; content:"|28|14|2F|2|29|"; within:150; metadata:policy security-ips drop; reference:cve,2006-4446; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-067; classtype:attempted-user; sid:19885; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer MDAC remote code execution attempt"; flow:to_client,established; file_data; content:"eval|28 22|r|3D|o|22|"; nocase; content:"ect|28|n|2C 27 27 29|"; distance:0; nocase; pcre:"/bj\x22[\x0D\x0A\s\t]*\x2b[\x0D\x0A\s\t]*\x22ect\x28n\x2C\x27\x27\x29/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2006-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-014; classtype:attempted-user; sid:19872; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT hidden 1x1 div tag - potential malware obfuscation"; flow:to_client,established; content:"<div style=|22|overflow|3A|hidden|3B|width|3A|1px|3B|height|3A|1px|3B 22|>"; fast_pattern:only; nocase; metadata:policy security-ips drop; classtype:misc-activity; sid:19868; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Publisher 2007 pointer dereference attempt"; flow:to_client,established; flowbits:isset,http.pub; file_data; content:"|01 2C 01 2B 01 2A 01 2F 01 2E 01 2D 01 52 00 12 12 00 00 00|"; content:"|02 00 13 00|"; within:4; distance:11; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35599; reference:cve,2009-0566; reference:url,www.microsoft.com/technet/security/bulletin/MS09-030.mspx; classtype:attempted-user; sid:19932; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Movie Maker project file heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mswmm; file_data; content:"P|00|r|00|o|00|d|00|u|00|c|00|e|00|r|00|.|00|d|00|a|00|t|00 00 00|"; fast_pattern; nocase; byte_extract:4,94,low,relative,little; content:"W|00|m|00|t|00|o|00|o|00|l|00|s|00|V|00|a|00|l|00|i|00|d|00 00 00|"; distance:0; nocase; byte_test:4,>,low,94,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0265; reference:url,www.microsoft.com/technet/security/bulletin/MS10-016.mspx; classtype:attempted-user; sid:19956; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft SYmbolic LinK stack overflow attempt"; flow:to_client,established; flowbits:isset,http.slk; content:"P|3B|"; fast_pattern:only; pcre:"/(^P\x3B[^\x3B]*\x0D\x0A){200}/mi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,48161; reference:cve,2011-1276; reference:url,www.microsoft.com/technet/security/bulletin/MS11-045.mspx; classtype:attempted-user; sid:19911; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint unbound memcpy and remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; file_data; content:"|A0 0F|"; byte_test:1,>,127,3,relative; reference:cve,2010-0034; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:19894; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel MsoDrawingGroup record remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|EB 00|"; byte_test:2,>,0,0,relative,little; byte_extract:2,0,size,relative,little; isdataat:size,relative; content:!"|EC 00|"; within:size; distance:2; content:"|5D 00|"; within:size; distance:2; content:"|15 00 12 00|"; within:4; distance:2; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0559; reference:url,www.microsoft.com/technet/security/bulletin/MS09-021.mspx; classtype:attempted-user; sid:19943; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer VML user after free attempt"; flow:to_client,established; content:"urn:schemas-microsoft-com:vml"; fast_pattern:only; pcre:"/<v\s*\x3a\s*(image|imagedata|fill|stroke)\s+id\s*=\s*\x22([^\x22]*)\x22[^\x3E]*style\s*=\s*\x22[^\x22]*\x23default\x23VML[^\x22]*\x22.*document\x2EgetElementById\s*\x28\s*\x22\2\x22\s*\x29\x2Esrc\s+\x3D/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,48173; reference:cve,2011-1266; reference:url,www.microsoft.com/technet/security/bulletin/MS11-052.mspx; classtype:attempted-user; sid:19910; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer invalid object access memory corruption attempt"; flow:to_client,established; file_data; content:".length|3B|i++"; nocase; content:"+= String.fromCharCode("; within:100; nocase; content:".charCodeAt(i)"; within:100; pcre:"/iframe\s+src\s*\x3D\s*(\x22|\x27)[^\1]+\x2Egif\1\s+onload\s*\x3D\s*(\x22|\x27)[^\2]+\x28event\x29\2/smi"; reference:cve,2010-0249; reference:url,www.microsoft.com/technet/security/bulletin/MS10-002.mspx; classtype:attempted-user; sid:19937; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java Runtime AWT setDiffICM stack buffer overflow attempt"; flow:to_client,established; file_data; content:"AppletX"; fast_pattern:only; pcre:"/\x3C\s*applet[^\x3E\n$]*code\s*=\s*[\x27\x22]AppletX[\x22\x27][^\x3E\n$]*archive\s*=\s*[\x22\x27][^\s\x3E\n$]{32}\x2Ejar[\x22\x27]/Ri"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36881; reference:cve,2009-3869; classtype:attempted-user; sid:19926; rev:2;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Hello from the VRT"; flow:to_server,established; content:"What a long strange trip it's been.  Welcome to sid 20000"; fast_pattern:only; classtype:policy-violation; sid:20000; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer arbitrary javascript command attempt"; flow:to_client,established; content:"application/smi"; fast_pattern; nocase; http_header; file_data; content:"file|3A|javascript|3A|"; pcre:"/<area\s+href=[\x22\x27]file\x3ajavascript\x3a/smi"; reference:bugtraq,8453; reference:bugtraq,9378; reference:cve,2003-0726; classtype:attempted-user; sid:2437; rev:16;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla Firefox nsTreeRange Use After Free attempt"; flow:to_client,established; file_data; content:"|2E|view|2E|selection"; nocase; content:"|2E|invalidateSelection"; distance:0; nocase; pcre:"/\x2Eview\x2Eselection.*?\x2Etree\s*\x3D\s*null.*?\x2Einvalidate/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-0073; reference:url,www.mozilla.org/security/announce/2011/mfsa2011-13.html; classtype:attempted-user; sid:20072; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows shell extensions deskpan.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|deskpan.dll"; nocase; http_uri; reference:cve,2011-1991; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-071.mspx; classtype:attempted-user; sid:20119; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer contenteditable corruption attempt"; flow:to_client,established; file_data; content:"#default#time2"; fast_pattern:only; nocase; content:"schemas-microsoft-com:time"; nocase; content:"contenteditable"; nocase; pcre:"/^\s*=\s*[\x22\x27]true[\x22\x27].*?<\s*t\s*\x3a\s*(set|animate|animateColor|animateMotion|switch|transitionFilter)/ORims"; metadata:policy security-ips drop; reference:cve,2011-1255; reference:url,www.microsoft.com/technet/security/bulletin/MS11-050.mspx; classtype:attempted-user; sid:19237; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader sandbox disable attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"|B6 84 05 8D 81 80 08 FF E3 A1 87 05 EA 88 A8 83 05 DE 8B B6 04 EA 80 80 08 D6 8B B6 04 99 D0 81 D0 06 EA 80 08 EA 80 A8 03 81 8A B6 04 D0 80 80|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-1353; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20162; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat embedded IFF file RGBA chunk memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"Subtype|2F|image"; nocase; content:"iff"; within:7; content:"TBHD"; distance:0; byte_extract:4,0,tbhd_width,relative; content:"RGBA"; distance:0; byte_test:2,>,tbhd_width,2,relative; reference:cve,2011-2436; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20149; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft MHTML XSS attempt"; flow:to_client,established; flowbits:isset,http.mht; file_data; content:"MIME-Version"; fast_pattern:only; pcre:"/(\x3C\s*script|onload|onclick|onmouseover)/ims"; reference:cve,2011-0096; reference:url,www.microsoft.com/technet/security/bulletin/MS11-026.mspx; classtype:attempted-user; sid:20133; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word document summary information string overflow attempt"; flow:to_client,established; file_data; content:"|00 00 00 00 1D 00 0F 00 03 00 00 00 00 00 FF FF FF FF FF FF FF 00 00 0D 00 02 00 01 00 0C 00 02 00 64 00 0F 00 02 00 01 00 11 00 02 00 00 00 10|"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:20141; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat embedded TIFF DotRange structure memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"Subtype|2F|image"; nocase; content:"tiff"; within:7; content:"II|2A 00|"; within:250; content:"|50 01|"; distance:0; byte_test:2,<,14,0,relative,little; byte_test:2,>,8,2,relative,little; reference:cve,2011-2432; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20144; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word document summary information string overflow attempt"; flow:to_client,established; file_data; content:"|02 D5 CD D5 9C|.|1B 10 93 97 08 00|+,|F9 AE|"; content:"|1E 00 00 00|"; distance:0; content:"|74 33 00 00 00 00 00 43 65 6C 6C 31 00 0C 10 00|"; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:20139; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat getCosObj file overwrite attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:".write|28|"; nocase; content:".getCosObj|28|"; distance:0; nocase; pcre:"/([A-Z\d_]+)\.write\x28.*?\1\.getCosObj\x28/smi"; reference:cve,2011-2442; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20156; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word document summary information string overflow attempt"; flow:to_client,established; file_data; content:"|E0 85 9F F2 F9|Oh|10 AB 91 08 00|+'|B3 D9|"; content:"|1E 00 00 00|"; distance:0; content:"|63 65 6C 00 40 00 00 00 80 4E 50 3F D6 30 C6 01 40 00 00 00 00 F3 0F 47 D6 30 C6 01 03 00 00 00|"; metadata:policy security-ips drop; reference:cve,2006-1540; reference:url,www.microsoft.com/technet/security/bulletin/ms06-038.mspx; classtype:attempted-user; sid:20140; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Possible generic javascript heap spray attempt"; flow:to_client,established; content:"%u0a0a%u0a0a"; fast_pattern:only; nocase; metadata:policy security-ips drop; reference:bugtraq,35660; classtype:attempted-user; sid:20137; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player viewSource blacklist exclusion attempt"; flow:to_client,established; file_data; content:"<?xml"; content:"navigateToURL"; distance:0; nocase; pcre:"/navigateToURL[^\n]*\x28\s*[\x22\x27]\s*(view-source|mms|rlogin)[^\n]*\x29/i"; reference:cve,2011-2429; reference:url,www.adobe.com/support/security/bulletins/apsb11-26.html; classtype:attempted-user; sid:20182; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Speex-encoded audio buffer underflow attempt"; flow:to_client,established; file_data; content:"|A9 FC EB C4 44 EA 39 DC C2 E6 7A 38 85 81 71 46 3B 43 B6 E8 69 30 D5 77 47 47 A1 DE 99 B6 32 A2 7B D4 DA AD 90 AF 76 EB F4 B0 8D 3F F2 66 C5 06 3B 18 ED 9C 13 2E 42 BB 18 50 C2 ED D2 AE 33 B2|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2130; reference:url,www.adobe.com/support/security/bulletins/apsb11-26.html; classtype:attempted-user; sid:20181; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Reader plugin bibutils.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|bibutils.dll"; nocase; http_uri; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18441; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel RealTimeData record memory corruption attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|13 08|"; byte_test:2,<,8224,0,relative,little; content:"|00 00 00 00|"; within:4; distance:14; byte_test:4,>,8207,0,relative,little; reference:cve,2011-0101; reference:url,www.microsoft.com/technet/security/bulletin/MS11-021.mspx; classtype:attempted-user; sid:18633; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Publisher Adobe Font Driver code execution attempt"; flow:to_client,established; flowbits:isset,http.otf; content:"|E0 98 FF FF FF E1 FF 5F FF E2 DF E0 DE 71 DE 9E DE 71 DC 83|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3956; reference:url,www.microsoft.com/technet/security/bulletin/MS10-091.mspx; classtype:attempted-user; sid:18233; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe field flags exploit attempt"; flow:to_client,established; content:"/Ff "; byte_test:10,!&,0x80000000,0,string,relative; byte_test:10,&,0x00100000,0,string,relative; reference:cve,2011-0589; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18419; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Flash Player nvapi.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|nvapi.dll"; nocase; http_uri; reference:cve,2011-0575; reference:url,www.adobe.com/support/security/bulletins/apsb11-02.html; classtype:attempted-user; sid:18445; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader invalid PDF JavaScript extension call"; flow:to_client,established; flowbits:isset, http.pdf; content:"printSeps"; fast_pattern:only; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-4091; reference:url,www.adobe.com/support/security/bulletins/apsb10-28.html; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-admin; sid:18102; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel macro validation arbitrary code execution attempt"; flow:to_client,established; content:"|FF FF FF FF 09 08|"; content:"|00 00|"; within:2; distance:1; content:"|05 00|"; within:2; distance:1; pcre:"/\xff\xff\xff\xff\x09\x08[\x08\x10]\x00\x00[\x05\x06]\x05\x00[^\x85]*\xdf/sm"; reference:cve,2008-0081; reference:url,www.microsoft.com/technet/security/bulletin/MS08-014.mspx; classtype:attempted-user; sid:13569; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Media Player and shell extension ehtrace.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|ehtrace.dll"; nocase; http_uri; reference:cve,2011-0032; reference:cve,2011-2009; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-015.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-076.mspx; classtype:attempted-user; sid:18496; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer object management memory corruption attempt"; flow:to_client,established; content:".onpropertychange"; nocase; content:".attributes"; within:50; nocase; content:".onpropertychange"; distance:0; nocase; content:"null"; within:50; nocase; pcre:"/([A-Z\d_]+)\.onpropertychange\s*=\s*\1\.attributes.*?\1\.onpropertychange\s*=\s*null.*?\1\.onpropertychange/smi"; metadata:policy security-ips drop; reference:cve,2011-1345; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-018.mspx; classtype:attempted-user; sid:18670; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel CrErr record integer overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|09 08 08 00 00 05|"; content:"|65 08|"; distance:0; byte_test:1,&,0x80,19,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3230; reference:url,www.microsoft.com/technet/security/bulletin/MS10-080.mspx; classtype:attempted-user; sid:17757; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 6 #default#anim attempt"; flow:to_client,established; content:"behavior:url('#default#anim')"; fast_pattern; nocase; metadata:policy balanced-ips drop, policy security-ips alert, service http; reference:cve,2010-3343; reference:url,www.microsoft.com/technet/security/bulletin/MS10-090.mspx; classtype:attempted-user; sid:18216; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Reader plugin cooltype.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|cooltype.dll"; nocase; http_uri; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18442; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Forefront UAG URL XSS alternate attempt"; flow:to_server, established; content:"signurl|2E|asp"; fast_pattern; nocase; http_uri; content:"SignUrl="; nocase; http_uri; pcre:"/SignUrl=[^\x26\s]*[\x22\x27\x28\x29\x3C\x3E]/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3936; reference:url,www.microsoft.com/technet/security/bulletin/MS10-089.mspx; classtype:attempted-admin; sid:18076; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Flashpix graphics filter fpx32.flt remote code execution attempt"; flow:to_client,established; content:"|FE FF 00 00|"; content:"|00 64 61 56 54 C1 CE 11 85 53 00 AA 00 A1 F9 5B 01 00 00 00 00 64 61 56 54 C1 CE 11 85 53 00 AA 00 A1 F9 5B|"; within:36; distance:4; byte_jump:4,0,relative,little; byte_test:4,>,0,-44,relative; content:"|00 00 00 00|"; within:4; distance:-40; byte_jump:4,0,relative,little; byte_test:4,>,0x100,-8,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3951; reference:url,www.microsoft.com/technet/security/bulletin/MS10-105.mspx; classtype:attempted-user; sid:18237; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Visual Studio MFC applications mfc90.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc90.dll"; nocase; http_uri; reference:cve,2010-3190; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-025.mspx; classtype:attempted-user; sid:18622; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader CCITT stream compression filter invalid image size heap overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|2F|CCITTFaxDecode"; nocase; content:"|2F|Columns"; within:500; nocase; byte_test:10,>,65535,0,relative,string; pcre:"/\x2FCCITTFaxDecode[^\x3E]*\x2fColumns\s+\d{5}/i"; reference:cve,2011-0567; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18507; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Media Encoder wmerrorenu.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|wmerrorenu.dll"; nocase; http_uri; reference:cve,2010-3965; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-094.mspx; classtype:attempted-user; sid:18222; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer object management memory corruption attempt"; flow:to_client,established; content:".onpropertychange"; nocase; content:".childNode"; within:50; nocase; content:".onpropertychange"; distance:0; nocase; content:"null"; within:50; nocase; pcre:"/([A-Z\d_]+)\.onpropertychange\s*=\s*\1\.childNode.*?\1\.onpropertychange\s*=\s*null.*?\1\.onpropertychange/smi"; metadata:policy security-ips drop; reference:cve,2011-1345; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-018.mspx; classtype:attempted-user; sid:18671; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Visual Studio MFC applications mfc100.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc100.dll"; nocase; http_uri; reference:cve,2010-3190; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-025.mspx; classtype:attempted-user; sid:18623; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer oversize recordset object cache size exploit attempt"; flow:to_client,established; content:"recordset"; content:".CacheSize"; within:100; pcre:"/^\s*=\s*/R"; byte_test:10,>,0x3ffffffe,0,relative,string; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1117; reference:cve,2010-1118; reference:cve,2010-1259; reference:cve,2010-1262; reference:cve,2011-0027; reference:url,www.microsoft.com/technet/security/bulletin/MS10-035.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS11-002.mspx; classtype:attempted-user; sid:18280; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word XP PLFLSInTableStream heap overflow attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|5C FE 00 01 02 5C FE 00 01 02 5C FE 00 01 02 5C FE 00 01 02 51 4A|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3220; reference:url,www.microsoft.com/technet/security/bulletin/MS10-079.mspx; classtype:attempted-user; sid:17756; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader CCITT stream compression filter invalid image size heap overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"|2F|CCF"; nocase; content:"|2F|Columns"; within:500; nocase; byte_test:10,>,65535,0,relative,string; pcre:"/\x2FCCF[^\x3E]*\x2fColumns\s+\d{5}/i"; reference:cve,2011-0567; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18506; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer select element memory corruption attempt"; flow:to_client,established; content:"http-equiv="; nocase; content:"X-UA-Compatible"; distance:0; nocase; content:"content="; nocase; content:"IE=8"; distance:0; nocase; content:"createElement"; distance:0; nocase; content:"select"; distance:0; nocase; pcre:"/createElement\s*\x28\s*(?P<a>[\x22\x27])\s*select\s*(?P=a)\s*\x29/i"; reference:bugtraq,45260; reference:cve,2010-3345; classtype:attempted-user; sid:18217; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Reader plugin sqlite.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|sqlite.dll"; nocase; http_uri; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18431; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Reader d3dref9.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|d3dref9.dll"; nocase; http_uri; reference:cve,2011-0588; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18432; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Media Encoder winietenu.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|winietenu.dll"; nocase; http_uri; reference:cve,2010-3965; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-094.mspx; classtype:attempted-user; sid:18223; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Multiple web browsers HTTP chunked transfer-encoding memory corruption attempt"; flow:to_client,established; content:"Transfer-Encoding"; nocase; http_header; content:"chunked"; fast_pattern; nocase; http_header; pkt_data; pcre:"/^Transfer-Encoding\s*\x3a\s*chunked.*\n0*[8-9a-f][0-9a-f]{7}\s*\n/smi"; metadata:policy security-ips drop; reference:bugtraq,35462; reference:cve,2005-2922; reference:cve,2009-0086; reference:cve,2009-2121; reference:url,www.microsoft.com/technet/security/bulletin/MS09-013.mspx; classtype:attempted-user; sid:15462; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office RTF parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|5C|sp"; content:"|5C|sn"; within:100; nocase; content:"pFragments"; within:100; nocase; content:"|5C|sv"; within:100; nocase; pcre:"/\x5Csv\s+[^\x7D]*?\x3B[^\x7D]*?\x3B[^\x7B]{12}/smi"; byte_test:4,>,4,8,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3333; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087; classtype:attempted-user; sid:18067; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat XML entity escape attempt"; flow:to_client,established; content:"<|21|ENTITY"; nocase; content:"SYSTEM"; within:50; nocase; content:"http|3A 2F 2F|"; within:50; nocase; content:"http|3A 2F 2F|"; within:500; nocase; pcre:"/<\x21ENTITY[^>]+SYSTEM[^>]+http\x3A\x2F\x2F[^>\s]+http\x3A\x2F\x2F/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-0604; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18456; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer datasrc overflow attempt"; flow:to_client,established; content:"document.getElementById"; content:"onCellChange"; fast_pattern:only; pcre:"/function\s+([^\s]+)\x28.*document\x2egetElementById\x28\x22([^\x22]+)\x22\x29\x2einnerHTML=\x22\x22.*id\s*=\s*\x22\2\x22.*onCellChange\s*=\s*\x22\1\x28\x29\x3b\x22/smi"; reference:cve,2011-0035; reference:url,www.microsoft.com/technet/security/bulletin/MS11-003.mspx; classtype:attempted-user; sid:18403; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Address Book wab32res.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|wab32res.dll"; nocase; http_uri; reference:cve,2010-3147; reference:cve,2011-2016; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-096.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-085.mspx; classtype:attempted-user; sid:18204; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office thumbnail bitmap invalid biClrUsed attempt"; flow:to_client,established; content:"|C0 9C 83 4A FF F8 CE 11 A0 6B 00 AA 00 A7 11 91 30 00 00 00|"; content:"T|00|h|00|u|00|m|00|b|00|n|00|a|00|i|00|l|00 00 00 41 00 00 00|"; distance:0; content:"|28 00 00 00|"; within:4; distance:4; pcre:"/^(?=.{10}[\x01\x04\x08\x16\x24\x32]\x00)(.{3}[\x55-\xFF]|.{31}[\x80-\xFF])/sR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3970; reference:url,www.microsoft.com/technet/security/bulletin/MS11-006.mspx; classtype:attempted-user; sid:18398; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer document.insertBefore memory corruption attempt"; flow:to_client,established; content:"document.insertBefore(document"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-0036; reference:url,www.microsoft.com/technet/security/bulletin/MS11-003.mspx; classtype:attempted-admin; sid:18404; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Visual Studio MFC applications mfc80.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc80.dll"; nocase; http_uri; reference:cve,2010-3190; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-025.mspx; classtype:attempted-user; sid:18621; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Reader plugin cryptocme2.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|cryptocme2.dll"; nocase; http_uri; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18443; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PICT graphics converter memory corruption attempt"; flow:to_client,established; flowbits:isset,http.pct; content:"|00 A1|"; content:"|49 43|"; within:2; distance:10; byte_test:2,>,4094,0,relative,big; metadata:policy security-ips drop; reference:cve,2010-3946; reference:url,www.microsoft.com/technet/security/bulletin/MS10-105.mspx; classtype:attempted-user; sid:18235; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Visual Studio MFC applications mfc40.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc40.dll"; nocase; http_uri; reference:cve,2010-3190; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-025.mspx; classtype:attempted-user; sid:18619; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows 7 Home peerdist.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|peerdist.dll"; nocase; http_uri; reference:cve,2010-3966; reference:url,www.microsoft.com/technet/security/bulletin/MS10-095.mspx; classtype:attempted-user; sid:18208; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Reader plugin ace.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|ace.dll"; nocase; http_uri; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18439; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Media Encoder asferrorenu.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|asferrorenu.dll"; nocase; http_uri; reference:cve,2010-3965; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-094.mspx; classtype:attempted-user; sid:18224; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows ATMFD font driver remote code execution attempt"; flow:to_client,established; flowbits:isset,http.otf; file_data; content:"|01 00 04 04 00 01 01 01 03 49 57 00 01 02 80 01 00 40 F8 0F|"; fast_pattern:only; metadata:policy security-ips drop; reference:cve,2010-3957; reference:url,www.microsoft.com/technet/security/bulletin/MS10-091.mspx; classtype:attempted-user; sid:18219; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel Workspace file FontCount record memory corruption attempt"; flow:to_client,established; flowbits:isset,http.xlw; content:"|09 04 06 00 00 04 00 01|"; content:"|30 00|"; distance:0; byte_test:2,>,2,0,relative,little; content:"|00 00|"; within:2; distance:2; metadata:policy security-ips drop; reference:cve,2011-0103; reference:url,www.microsoft.com/technet/security/bulletin/MS11-021.mspx; classtype:attempted-user; sid:18634; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Visual Studio MFC applications mfc42.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mfc42.dll"; nocase; http_uri; reference:cve,2010-3190; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-025.mspx; classtype:attempted-user; sid:18620; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Address Book msoeres32.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|msoeres32.dll"; nocase; http_uri; reference:cve,2010-3147; reference:cve,2011-2016; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-096.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-085.mspx; classtype:attempted-user; sid:18205; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer malformed table remote code execution attempt"; flow:to_client,established; content:"position"; content:"absolute"; distance:0; content:"clip:"; pcre:"/table\s*\x7B[^\x7d]*position\x3a\s*absolute[^\x7d]*clip/smi"; reference:cve,2010-3962; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-090.mspx; classtype:attempted-user; sid:18221; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Movie Maker hhctrl.ocx dll-load exploit attempt"; flow:to_server,established; content:"|2F|hhctrl.ocx"; nocase; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3967; reference:url,www.microsoft.com/technet/security/bulletin/MS10-093.mspx; classtype:attempted-user; sid:18210; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Art drawing invalid shape identifier attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|0A F0 08 00 00 00|"; fast_pattern; byte_test:1,=,0x2,-8,relative; byte_test:4,>,0x03FFD7FF,0,relative,little; metadata:policy security-ips drop; reference:cve,2010-3336; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:18069; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Acrobat Reader plugin agm.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|agm.dll"; nocase; http_uri; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18440; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Groove mso.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|mso.dll"; nocase; http_uri; reference:cve,2010-3146; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-016.mspx; classtype:attempted-user; sid:18499; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Publisher oversized oti length attempt"; flow:to_client,established; flowbits:isset,http.pub; content:"|E8 AC|"; content:"|2C 01 04 00|"; within:4; distance:2; byte_test:2,>,94,26,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-3955; reference:url,www.microsoft.com/technet/security/bulletin/MS10-103.mspx; classtype:attempted-user; sid:18231; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft product .dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|.dll"; nocase; http_uri; reference:cve,2011-0029; reference:cve,2011-0107; reference:cve,2011-1980; reference:url,www.microsoft.com/technet/security/bulletin/MS11-017.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS11-023.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS11-073.mspx; classtype:attempted-user; sid:18495; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Office pptimpconv.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|pptimpconv.dll"; nocase; http_uri; reference:cve,2010-3337; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:18071; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word malformed table record memory corruption attempt"; flow:to_client,established; content:"|00 13 3A FF FF FF 8C 0F 00 00 F0 38 00 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1903; reference:url,www.microsoft.com/technet/security/bulletin/ms10-056.mspx; classtype:attempted-user; sid:17124; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file tSAC record exploit attempt"; flow:to_client,established; content:"tSAC|B7 00 00 00 00 00 00 01 00 00 00 8F|"; content:"|00 16 00 00 00 00 00 00 00 00 00 00 00 45 00 00|"; within:16; distance:24; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17183; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel DBQueryExt record memory corruption attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|DC 00 0C 00|"; byte_test:1,&,0x04,0,relative; byte_test:1,!&,0x03,0,relative; content:"|CD 00|"; within:2; distance:12; content:"|03 08|"; distance:0; content:"|03 08 00 00|"; within:4; distance:2; content:!"|04 00|"; within:2; reference:cve,2010-1253; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16657; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel DbOrParamQry.fWeb parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|DC 00 0C 00|"; byte_test:1,&,0x03,0,relative; byte_test:1,&,0x40,0,relative; content:"|CD 00|"; within:2; distance:12; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0264; reference:url,www.microsoft.com/technet/security/bulletin/MS10-017.mspx; classtype:attempted-user; sid:16470; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe PDF File containing Flash use-after-free attack"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"|3C 3C 2F 46 69 6C 74 65 72 2F 46 6C 61 74 65 44 65 63 6F 64 65 2F 46 69 72 73 74 20 39 39 2F 4C 65 6E 67 74 68 20 35 31 31 2F 4E 20 31 35 2F 54 79 70 65 2F 4F 62 6A 53 74 6D 3E 3E 73 74 72 65 61 6D 0D 0A 68 DE 6C 52 DB 6E E2 30|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1297; classtype:attempted-user; sid:16633; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 8 non-IE8 compatibility mode htmltime remote code execution attempt"; flow:to_client,established; content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=7|22|"; nocase; content:"TIMEACTION"; nocase; pcre:"/BEGIN=[^>]+DUR=[^>]+TIMEACTION/i"; reference:cve,2010-0492; reference:url,www.microsoft.com/technet/security/bulletin/MS10-018.mspx; classtype:attempted-user; sid:16508; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word rich text format unexpected field type memory corruption attempt 3"; flow:to_client,established; content:"|5C|datafield |5C|jpegblip"; fast_pattern:only; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1901; reference:url,www.microsoft.com/technet/security/bulletin/ms10-056.mspx; classtype:attempted-user; sid:17122; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Address Book smmscrpt.dll malicious DLL load"; flow:to_server,established; content:"smmscrpt.dll"; nocase; http_uri; metadata:policy security-ips drop; reference:cve,2010-3144; reference:url,www.microsoft.com/technet/security/bulletin/MS10-097.mspx; classtype:attempted-user; sid:18202; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel OBJ record stack buffer overflow attempt - with linkFmla"; flow:to_client,established; flowbits:isset,http.xls; content:"|5D 00|"; content:"|15 00 12 00 14 00|"; within:6; distance:2; content:"|0C 00 14 00|"; within:4; distance:16; content:"|0E 00|"; within:2; distance:20; byte_jump:2,0,relative,little; content:"|13 00|"; within:2; byte_test:2,>,0,0,relative,little; byte_jump:2,2,relative,little; byte_test:2,>,1024,14,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0822; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16640; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer userdata behavior memory corruption attempt"; flow:to_client,established; content:"|7B|behavior"; nocase; content:"|23|default|23|userData"; distance:0; nocase; content:"setAttribute"; pcre:"/(?P<class>[A-Z\d_]+)\s*\x7Bbehavior\s*\x3a\s*url\x28x23default\x23userDatax29.*?(?P<obj>[A-Z\d_]+)\x2EsetAttribute\x28[^,]+,\s*[A-Z]\x29.*?\x3cMARQUEE\s*id\x3d\x22(?P=obj)\x22\s*class\x3d\x22(?P=class)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0806; reference:url,support.microsoft.com/kb/980182; classtype:attempted-user; sid:17689; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel RealTimeData record heap memory corruption attempt - 2"; flow:to_client,established; flowbits:isset,http.xls; content:"|13 08|"; content:"|13 08 00 00 00 00 00 00 00 00 00 00|"; within:12; distance:2; pcre:"/^(.{3}[\x80-\xFF]|.{7}\[\x80-\xFF])/sR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1247; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16647; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel ContinueFRT12 and MDXSet heap overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|87 08|"; byte_jump:2,0,relative,little; content:"|7F 08|"; within:2; metadata:policy security-ips drop; reference:cve,2010-0261; reference:url,www.microsoft.com/technet/security/bulletin/MS10-017.mspx; classtype:attempted-user; sid:16465; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel ExternName record stack buffer overflow attempt - 4"; flow:to_client,established; flowbits:isset,http.xls; content:"|AE 01|"; byte_jump:2,0,relative,little; content:"|23 00|"; within:2; byte_test:2,>,250,0,relative,little; byte_test:2,<,8225,0,relative,little; byte_test:1,!&,0x01,0,relative; byte_test:1,&,0x01,7,relative; byte_test:1,&,0x08,7,relative; content:"|01 00|"; within:2; distance:12; reference:cve,2010-1249; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16653; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows MSXML2 ActiveX malformed HTTP response"; flow:to_client,established; content:"HTTP 1|0A|"; depth:7; reference:cve,2010-2561; reference:url,www.microsoft.com/technet/security/bulletin/ms10-051.mspx; classtype:attempted-dos; sid:17133; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel ExternName record stack buffer overflow attempt - 1"; flow:to_client,established; flowbits:isset,http.xls; content:"|AE 01|"; byte_jump:2,0,relative,little; content:"|23 00|"; within:2; byte_test:2,>,250,0,relative,little; byte_test:2,<,8225,0,relative,little; byte_test:1,!&,0x01,0,relative; byte_test:1,!&,0x01,7,relative; byte_test:1,!&,0x08,7,relative; content:"|01|"; within:1; distance:10; reference:cve,2010-1249; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16650; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file rcsL record exploit attempt"; flow:to_client,established; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00|"; content:"|01 17 00 C0 FF FF 00 00 00 C1 00 00 01 84 00 00|"; within:16; distance:84; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17186; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel DbOrParamQry.fOdbcConn parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|DC 00 0C 00|"; byte_test:1,&,0x06,0,relative; byte_test:1,&,0x08,0,relative; content:"|CD 00|"; within:2; distance:12; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0264; reference:url,www.microsoft.com/technet/security/bulletin/MS10-017.mspx; classtype:attempted-user; sid:16469; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel Chart Sheet Substream memory corruption attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|02 10 10 00|"; content:"|33 10 00 00|"; within:4; distance:16; content:"|54 08 0C 00 54 08 00 00|"; distance:0; content:"|55 08 0C 00|"; distance:8; content:"|55 08 0C 00|"; within:4; distance:12; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0823; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16643; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer userdata behavior memory corruption attempt"; flow:to_client,established; content:"addBehavior|28|"; nocase; content:"|23|default|23|userData"; distance:0; nocase; content:"setAttribute|28|"; distance:0; nocase; pcre:"/(?P<obj>[A-Z\d_]+)\.addBehavior\x28(?P<q1>\x22|\x27|)[^\x29]*\x23default\x23userData(?P=q1)\x29.*?(?P=obj)\.setAttribute\x28[^,]+,\s*[A-Z]/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0806; reference:url,support.microsoft.com/kb/980182; classtype:attempted-user; sid:16482; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows uniscribe fonts parsing memory corruption attempt"; flow:to_client,established; content:"url|28|data|3A|font|2F|ttf|3B|"; content:"base64|2C|AAEAAAAT"; within:15; content:"A2hMVFNI5UGsngAA"; within:16; distance:48; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2738; reference:url,www.microsoft.com/technet/security/bulletin/MS10-063.mspx; classtype:attempted-user; sid:17256; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Media Player codec code execution attempt"; flow:to_client,established; flowbits:isset,http.avi; content:"strh"; content:"auds"; within:4; distance:4; fast_pattern; byte_jump:4,-8,relative,little; isdataat:16,relative; content:"strf"; within:4; content:"U|00|"; within:2; distance:4; byte_test:4,!=,48000,2,relative,little; byte_test:4,!=,44100,2,relative,little; byte_test:4,!=,32000,2,relative,little; byte_test:4,!=,24000,2,relative,little; byte_test:4,!=,22050,2,relative,little; byte_test:4,!=,16000,2,relative,little; byte_test:4,!=,12000,2,relative,little; byte_test:4,!=,11025,2,relative,little; byte_test:4,!=,8000,2,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0480; reference:url,www.microsoft.com/technet/security/bulletin/MS10-026.mspx; classtype:attempted-user; sid:16543; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file tSAC record exploit attempt"; flow:to_client,established; content:"tSAC|B7 00 00 00 00 00 00 01 00 00 00 8F|"; content:"|00 00 00 00 00 16 00 00 00 00 00 00 00 3F 00 00|"; within:16; distance:20; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17182; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel DbOrParamQry.fWeb parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|DC 00 0C 00|"; byte_test:1,!&,0x07,0,relative; byte_test:1,&,0x48,0,relative; content:"|CD 00|"; within:2; distance:12; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0264; reference:url,www.microsoft.com/technet/security/bulletin/MS10-017.mspx; classtype:attempted-user; sid:16471; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel BIFF5 ExternSheet record stack overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|16 00 02 00|"; content:"|17 00|"; within:2; distance:2; byte_test:1,>,250,2,relative; reference:cve,2010-1252; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16656; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel OBJ record stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|5D 00|"; content:"|15 00 12 00 14 00|"; within:6; distance:2; content:"|0C 00 14 00|"; within:4; distance:16; content:"|13 00|"; within:2; distance:20; byte_test:2,>,0,0,relative,little; byte_jump:2,2,relative,little; byte_test:2,>,1024,14,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0822; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16638; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash use-after-free attack"; flow:to_client,established; file_data; content:"|53 68 68 68 20 64 6F 6E 27 74 20 74 65 6C 6C 20 61 6E 79 20 6F 6E 65 20 74 68 69 73 20 69 73 20 61 20 73 65 63 72 65 74 20 6B 65 79 21 16 54 68 65 20 74 72 75 74 68 20 69 73 20 6F 75 74 20 74 68 65 72 65 08 43 4F 4D 50 4C 45 54 45 0B 72 65 6D 6F 76 65 43 68 69 6C 64 0A 55 52 4C 52 65 71 75 65 73 74 30 68 74 74 70|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1297; classtype:attempted-user; sid:16634; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 7/8 execute local file in Internet zone redirect attempt"; flow:to_client,established; content:"|0A|Location|3A|"; nocase; content:"file|3A|//127.0.0.1"; distance:0; fast_pattern; pcre:"/^Location\x3a[^\n]*file\x3a\x2f\x2f127\x2e0\x2e0\x2e1/mi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0255; reference:cve,2010-0555; reference:url,www.microsoft.com/technet/security/advisory/980088.mspx; classtype:attempted-user; sid:16423; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer invalid object access memory corruption attempt"; flow:to_client,established; content:"createEventObject"; content:"innerHTML"; distance:0; pcre:"/createEventObject[^\x7D]+innerHTML\s*\x3D\s*\S+[^\x7D]+(setTimeout|setInterval)/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0249; reference:url,www.microsoft.com/technet/security/bulletin/MS10-002.mspx; classtype:attempted-user; sid:16367; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file rcsL record exploit attempt"; flow:to_client,established; content:"|8F 41 01 45 C2 AE 00 FF 45 B0 41 24 43 46 1F 42|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17187; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file LsCM overflow attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"LsCM"; byte_test:4,>,4211081214,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2864; classtype:attempted-user; sid:17200; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows Vista Backup Tool fveapi.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|fveapi.dll"; nocase; http_uri; reference:cve,2010-3145; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-001.mspx; classtype:attempted-user; sid:18277; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel ExternName record stack buffer overflow attempt - 3"; flow:to_client,established; flowbits:isset,http.xls; content:"|AE 01|"; byte_jump:2,0,relative,little; content:"|23 00|"; within:2; byte_test:2,>,250,0,relative,little; byte_test:2,<,8225,0,relative,little; byte_test:1,!&,0x01,0,relative; byte_test:1,!&,0x01,7,relative; byte_test:1,&,0x08,7,relative; content:"|01|"; within:1; distance:12; reference:cve,2010-1249; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16652; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer use-after-free memory corruption attempt"; flow:to_client,established; content:"location.protocol"; fast_pattern:only; nocase; pcre:"/location.protocol\s*=[^=]/smi"; reference:cve,2010-2556; reference:url,www.microsoft.com/technet/security/bulletin/ms10-053.mspx; classtype:attempted-dos; sid:17129; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel out-of-bounds structure read memory corruption attempt"; flow:to_client,established; content:"|C6 00 1A 00 02 00 00 00 01 00 21 00 AA 0A 03 00 00 00 02 00|"; reference:cve,2010-2562; reference:url,www.microsoft.com/technet/security/bulletin/ms10-057.mspx; classtype:attempted-user; sid:17134; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word rich text format unexpected field type memory corruption attempt 1"; flow:to_client,established; content:"|5C|datafield |5C|emfblip"; fast_pattern:only; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1901; reference:url,www.microsoft.com/technet/security/bulletin/ms10-056.mspx; classtype:attempted-user; sid:17120; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel OBJ record stack buffer overflow attempt - with macro"; flow:to_client,established; flowbits:isset,http.xls; content:"|5D 00|"; content:"|15 00 12 00 14 00|"; within:6; distance:2; content:"|0C 00 14 00|"; within:4; distance:16; content:"|04 00|"; within:2; distance:20; byte_jump:2,0,relative,little; content:"|13 00|"; within:2; byte_test:2,>,0,0,relative,little; byte_jump:2,2,relative,little; byte_test:2,>,1024,14,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0822; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16639; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel ContinueFRT12 heap overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|86 08|"; byte_jump:2,0,relative,little; content:"|7F 08|"; within:2; metadata:policy security-ips drop; reference:cve,2010-0260; reference:url,www.microsoft.com/technet/security/bulletin/MS10-017.mspx; classtype:attempted-user; sid:16464; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer 8 parent style rendering arbitrary code execution"; flow:to_client,established; content:"parentNode.style"; fast_pattern:only; pcre:"/\s(\w+)\.parentNode\.style\..*?\1\.focus/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2559; reference:url,www.microsoft.com/technet/security/bulletin/ms10-053.mspx; classtype:attempted-user; sid:17131; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file rcsL record exploit attempt"; flow:to_client,established; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00 00 00 05 0E 00 00 05 0E 00 5C 00 40|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17185; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file file Shockwave 3D overflow attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"tSAC"; content:"Shockwave 3D"; within:100; distance:112; fast_pattern; byte_test:1,>,127,28,relative; content:"shockwave3d"; within:11; distance:33; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2866; classtype:attempted-user; sid:17202; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer userdata behavior memory corruption attempt"; flow:to_client,established; content:"|2E|style|2E|behavior"; nocase; content:"|23|default|23|userData"; distance:0; nocase; content:"setAttribute"; pcre:"/(?P<obj>[A-Z\d_]+)\x2Estyle\x2Ebehavior\s*\x3D\s*\x22url\x28\x27\x23default\x23userData\x27\x29\x22.*?(?P=obj)\x2EsetAttribute\x28[^,]+,\s*[A-Z]/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0806; reference:url,support.microsoft.com/kb/980182; classtype:attempted-user; sid:17688; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint integer underflow heap corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|42 F1 00 00 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2573; reference:url,www.microsoft.com/technet/security/bulletin/MS10-088; classtype:attempted-user; sid:18066; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer innerHTML against incomplete element heap corruption attempt"; flow:to_client,established; content:"innerHTML"; nocase; pcre:"/=\x22(\w+)\x22.*<script>.*\1\x2einnerHTML/smi"; reference:cve,2010-0490; reference:url,www.microsoft.com/technet/security/bulletin/MS10-018.mspx; classtype:attempted-user; sid:16506; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file rcsL record exploit attempt"; flow:to_client,established; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00 00 00 05 0E|"; content:"|0A 08 19 1E 1C 1E 1F 1E 44 00 43 01 57 6E A1 9C|"; within:16; distance:512; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17188; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel Lbl record stack overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|18 00|"; byte_test:1,&,0x80,5,relative; byte_jump:2,0,relative,little; pcre:"/^([\x18\xDE\x19\xEB\xFC\xFF]\x00|[\x94\x99\x93\x13\x66]\x08|\xC1\x01)/R"; reference:cve,2010-1251; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16655; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file LsCM record exploit attempt"; flow:to_client,established; content:"LsCM|3A 00 00 00 00 00 00 0C 00 00 00 01 00 04 00 00 40 05 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2864; classtype:attempted-user; sid:17181; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Micrisoft Windows Forefront UAG URL XSS attempt"; flow:to_server, established; content:"|2F|m|2F|default|2E|aspx"; fast_pattern; nocase; http_uri; content:"orig_url="; nocase; http_uri; pcre:"/orig_url=[^\x26]*[\x22\x27\x28\x29\x3C\x3E]/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2734; reference:url,www.microsoft.com/technet/security/bulletin/MS10-089.mspx; classtype:attempted-admin; sid:18074; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel OBJ record stack buffer overflow attempt - with macro and linkFmla"; flow:to_client,established; flowbits:isset,http.xls; content:"|5D 00|"; content:"|15 00 12 00 14 00|"; within:6; distance:2; content:"|0C 00 14 00|"; within:4; distance:16; content:"|04 00|"; within:2; distance:20; byte_jump:2,0,relative,little; content:"|0E 00|"; within:2; byte_jump:2,0,relative,little; content:"|13 00|"; within:2; byte_test:2,>,0,0,relative,little; byte_jump:2,2,relative,little; byte_test:2,>,1024,14,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0822; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16641; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word rich text format invalid field size memory corruption attempt"; flow:to_client,established; content:"|5C|dpcallout"; nocase; content:"|5C|dppolycount"; within:50; nocase; byte_test:5,>,50,0,string,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1902; reference:url,www.microsoft.com/technet/security/bulletin/ms10-056.mspx; classtype:attempted-user; sid:17123; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word rich text format unexpected field type memory corruption attempt 2"; flow:to_client,established; content:"|5C|datafield |5C|pngblip"; fast_pattern:only; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1901; reference:url,www.microsoft.com/technet/security/bulletin/ms10-056.mspx; classtype:attempted-user; sid:17121; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer onreadystatechange memory corruption attempt"; flow:to_client,established; content:"onreadystatechange"; nocase; pcre:"/(?P<obj>[A-Z\d_]+)\.innerHTML\s*=\s*(\x22[^\x22]*<[A-Z]+\s+[^>]*onreadystatechange\s*=|\x27[^\x27]*<[A-Z]+\s+[^>]*onreadystatechange\s*=).*?(?P=obj)\.innerHTML\s*=\s*(\x22\x22|\x27\x27)/smi"; metadata:policy security-ips drop; reference:cve,2010-0491; reference:url,www.microsoft.com/technet/security/bulletin/MS10-018.mspx; classtype:attempted-user; sid:16507; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file tSAC record exploit attempt"; flow:to_client,established; content:"tSAC|B7 00 00 00 00 00 00 01 00 00 00 8F|"; content:"|00 00 00 00 00 00 00 00 00 06 00 00 00 45 00 00|"; within:16; distance:28; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17184; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel ExternName record stack buffer overflow attempt - 2"; flow:to_client,established; flowbits:isset,http.xls; content:"|AE 01|"; byte_jump:2,0,relative,little; content:"|23 00|"; within:2; byte_test:2,>,250,0,relative,little; byte_test:2,<,8225,0,relative,little; byte_test:1,!&,0x01,0,relative; byte_test:1,&,0x01,7,relative; byte_test:1,!&,0x08,7,relative; content:"|01 00|"; within:2; distance:10; reference:cve,2010-1249; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16651; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player recursive stack overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; file_data; content:"|42 1B EB 68 C4 A9 39 96 95 4B 0E 39 71 A9 9E E8 72 CE 38 A4 3B C4 92 4B|"; metadata:policy security-ips drop; reference:cve,2011-2426; reference:url,www.adobe.com/support/security/bulletins/apsb11-26.html; classtype:attempted-user; sid:20211; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft VBE6.dll stack corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|01 00 C3 0F 18 00 00 00|"; content:"|00 00 00 00|"; within:4; distance:16; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0815; reference:url,www.microsoft.com/technet/security/bulletin/MS10-031.mspx; classtype:attempted-user; sid:16593; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file file rcsL overflow attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"rcsL"; byte_test:1,>,127,76,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2867; classtype:attempted-user; sid:17203; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer boundElements arbitrary code execution"; flow:to_client,established; content:"event.boundElements"; fast_pattern:only; content:"window.close"; pcre:"/on(load|click)\s*=\s*\x22?window\.close\s*\x28/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,42288; reference:cve,2010-2557; reference:url,www.microsoft.com/technet/security/bulletin/ms10-053.mspx; classtype:attempted-user; sid:17130; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader malformed Richmedia annotation exploit attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"/Subtype/RichMedia"; content:"/Annot"; pcre:"/\/Rect\s*\[[^\]]*\./"; metadata:policy security-ips drop; reference:cve,2010-0197; reference:cve,2010-1297; classtype:attempted-admin; sid:16545; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file pamm record exploit attempt"; flow:to_client,established; content:"pamm"; byte_test:4,>,4294967118,20,relative; content:!"|FF FF FF FF|"; within:4; distance:20; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17179; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file file mmap overflow attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"mmap"; byte_test:4,>,32768,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2870; classtype:attempted-user; sid:17204; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file LsCM record exploit attempt"; flow:to_client,established; content:"LsCM|3A 00 00 00 00 00 00 0C 00 00 40 01|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2864; classtype:attempted-user; sid:17180; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Director file rcsL record exploit attempt"; flow:to_client,established; content:"|52 02 4C 00 61 46 43 01 57 C9 41 01 06 52 43 4C|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17189; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Comctl32.dll third-party SVG viewer heap overflow attempt"; flow:to_client,established; content:"<svg "; nocase; content:"<rect "; distance:0; nocase; content:"transform"; distance:0; nocase; pcre:"/<rect[^>]+transform\s*=\s*[\x22\x27][^\x22\x27]{500}/smi"; metadata:policy security-ips drop; reference:cve,2010-2746; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-081.mspx; classtype:attempted-user; sid:18297; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel undocumented Publisher record heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|88 00 08 00|"; content:"|89 00|"; within:2; distance:8; byte_test:2,<,48,0,relative,little; reference:cve,2010-1250; reference:url,www.microsoft.com/technet/security/bulletin/MS10-038.mspx; classtype:attempted-user; sid:16654; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint file LinkedSlide10Atom record parsing heap corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|00 00 E7|.|08 00 00 00|"; byte_jump:4,4,relative,multiplier 16,little; content:"|00 00 E6|.|08 00 00 00|"; within:8; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0030; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:16410; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint HashCode10Atom memory corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|0F 00 F0 03|"; content:"|00 00|+"; within:3; distance:5; isdataat:4,relative; content:!"|04 00 00 00|"; within:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1130; reference:url,www.microsoft.com/technet/security/bulletin/MS09-017.mspx; classtype:attempted-user; sid:15505; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel Qsir and Qsif record remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|06 08|"; content:"|06 08|"; within:2; distance:2; byte_test:1,&,0x10,16,relative; byte_test:1,!&,0x40,16,relative; byte_test:4,>,0,18,relative,little; content:"|07 08|"; distance:0; content:"|07 08|"; within:2; distance:2; byte_test:1,&,8,2,relative; byte_test:1,<,0x10,2,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1134; reference:url,www.microsoft.com/technet/security/bulletin/MS09-021.mspx; classtype:attempted-user; sid:15542; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel file SxView record exploit attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|B0 00|"; byte_test:2,>,44,0,relative,little; byte_test:2,<,8225,0,relative,little; byte_test:2,<,11,4,relative,little; byte_test:2,>,10,34,relative,little; byte_jump:2,0,relative,little; pcre:"/^[\xB1\xB4-\xB6\xC5\xF1]\x00/R"; metadata:policy security-ips drop; reference:cve,2009-3128; reference:url,www.microsoft.com/technet/security/bulletin/MS09-067.mspx; classtype:attempted-user; sid:16236; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT MPlayer SMI file buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.smi; file_data; content:"|3C|SAMI|3E|"; content:"Start|3D|"; distance:0; nocase; isdataat:500,relative; content:!"Start|3D|"; within:500; nocase; metadata:policy security-ips drop; reference:url,osvdb.org/show/osvdb/74604 ; classtype:attempted-user; sid:20224; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer embed src buffer overflow attempt"; flow:to_client,established; content:"embed src"; nocase; isdataat:1000,relative; pcre:"/embed src=\s*(\x27[^\x27]{1000}|\x22[^\x22]{1000}|[^\s\x22\x27]{1000})/smi"; metadata:policy security-ips drop; reference:cve,2008-4261; reference:url,www.microsoft.com/technet/security/bulletin/MS08-073.mspx; classtype:attempted-user; sid:15114; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel SST record remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|FC 00|"; byte_test:4,>,0x10000000,6,relative,little; byte_test:2,>,10,0,relative,little; byte_test:2,<,8225,0,relative,little; byte_jump:2,0,relative,little; pcre:"/^(\xFF|\x3C)\x00/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36042; reference:cve,2009-0561; reference:cve,2009-3037; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21396492; reference:url,www.microsoft.com/technet/security/bulletin/MS09-021.mspx; classtype:attempted-user; sid:15541; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Internet Explorer Base64 encoded script overflow attempt"; flow:to_client,established; content:"//|2A|*Start Encode**#@~^"; fast_pattern; nocase; content:!"=="; within:2; distance:6; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0031; reference:url,www.microsoft.com/technet/security/bulletin/MS11-009.mspx; classtype:attempted-admin; sid:18401; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint ParaBuildAtom memory corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|01 00 09|+|10 00 00 00|"; pcre:"/\x0f\x00[\x04\x06]\x2B.{1,48}\x01\x00\x09\x2b/sm"; metadata:policy security-ips drop; reference:cve,2009-0224; reference:url,www.microsoft.com/technet/security/bulletin/MS09-017.mspx; classtype:attempted-user; sid:15501; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player JPEG parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,http.swf; content:"|FF D8 FF E0|"; content:"JFIF|00|"; within:5; distance:2; content:"|FF C0|"; distance:0; pcre:"/^.{3}([\x80-\xFF]|.{2}[\x80-\xFF])/sR"; reference:cve,2009-3794; classtype:attempted-user; sid:16331; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer marquee object handling memory corruption attempt"; flow:to_client,established; content:"MARQUEE"; nocase; content:"onstart"; distance:0; nocase; pcre:"/\x3c\s*Marquee[^\x3e]*onstart\s*\x3D\s*\x22\s*document\x2e(write|writeln|open)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0554; reference:url,www.microsoft.com/technet/security/bulletin/ms09-014.mspx; classtype:attempted-user; sid:17462; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel Formula record remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|06 00|"; byte_test:2,>,0,0,relative,little; byte_test:1,>,3,8,relative; content:"|FF FF|"; within:2; distance:14; reference:cve,2009-0560; reference:url,www.microsoft.com/technet/security/bulletin/MS09-021.mspx; classtype:attempted-user; sid:15539; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint CurrentUserAtom remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|00 00 F6 0F|"; content:"|14 00 00 00|"; within:4; distance:4; byte_test:2,>,255,8,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1131; reference:url,www.microsoft.com/technet/security/bulletin/MS09-017.mspx; classtype:attempted-user; sid:15506; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint DiagramBuildContainer memory corruption attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|0F 00 06|+"; pcre:"/.{,48}[\x00\x01]\x00[\x05\x09]\x2B/smR"; metadata:policy security-ips drop; reference:cve,2009-0224; reference:url,www.microsoft.com/technet/security/bulletin/MS09-017.mspx; classtype:attempted-user; sid:15502; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows malformed ASF voice codec memory corruption"; flow:to_client,established; content:"@|9E|i|F8|M[|CF 11 A8 FD 00 80|_|5C|D+"; isdataat:46,relative; pcre:"/^.{38}\x0a\x00..(?!(\x40\x1f|\x11\x2b|\x80\x3e|\x22\x56)\x00\x00)/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0555; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-051.mspx; classtype:attempted-user; sid:16157; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft SilverLight ImageSource remote code execution attempt"; flow:to_client,established; flowbits:isset,imagesource.redefine; content:"ImageBrush"; content:"ImageSource"; distance:0; pcre:"/ImageBrush[^\x3e]+ImageSource\s*\x3d\s*(\x22|\x27)/"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0019; reference:url,www.microsoft.com/technet/security/bulletin/MS10-060.mspx; classtype:attempted-user; sid:17114; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows javascript arguments keyword override rce attempt"; flow:to_client,established; content:"function arguments"; fast_pattern:only; pcre:"/function arguments\s*\x28[^\x29]*\x29\s*\x7b/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1920; reference:url,www.microsoft.com/technet/security/bulletin/MS09-045.mspx; classtype:attempted-user; sid:15913; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer invalid object modification exploit attempt"; flow:to_client,established; content:"callback"; pcre:"/on((before|)(de|)activate|focus(in|out))\s*\x3d\s*function[^\x7d]*callback/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1530; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:attempted-user; sid:15536; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; content:"function attack|28 29 0A|"; content:"obj=document.getElementById|28 22|barID|22 29 3B|"; within:37; distance:14; content:"obj.className=|22|poc|22 3B|"; within:20; distance:10; metadata:policy security-ips alert; reference:cve,2009-0076; reference:url,www.microsoft.com/technet/security/bulletin/MS09-002.mspx; classtype:attempted-user; sid:16169; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer object clone deletion memory corruption attempt"; flow:to_client,established; content:"cloneNode"; nocase; content:"clearAttributes"; distance:0; nocase; pcre:"/(?P<cl>\w+)\s*=\s*(?P<o>\w+)\.cloneNode.*?(?P=o)\.clearAttributes.*?(?P=o)\s*=\s*null\s*\x3B.*?(?P=cl)\.click\s*\x3B/Osmi"; metadata:policy balanced-ips alert, policy security-ips alert, service http; reference:cve,2009-0075; reference:url,www.microsoft.com/technet/security/bulletin/MS09-002.mspx; classtype:attempted-user; sid:15304; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows .NET MSIL CombineImpl suspicious usage"; flow:to_client,established; flowbits:isset,file.exe; content:"|00|CombineImpl|00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0091; reference:url,www.microsoft.com/technet/security/bulletin/MS09-061.mspx; classtype:attempted-user; sid:16183; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Embedded Open Type Font malformed name table integer overflow attempt"; flow:to_client,established; flowbits:isset,eot.download; content:"|00 01 00 00|"; content:"|00 04|"; within:2; distance:2; byte_test:2,>,35752,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0232; reference:url,www.microsoft.com/technet/security/bulletin/MS09-029.mspx; classtype:attempted-user; sid:15694; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader oversized object width attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"/width"; nocase; byte_test:7,>,1000000,1,relative,string; content:"/DCTDecode"; distance:0; nocase; pcre:"/\x2fwidth[^\x3e]+\x2fDCTDecode/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2980; classtype:attempted-user; sid:16322; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer dynamic style update memory corruption attempt"; flow:to_client,established; content:"<textarea"; nocase; content:"className"; nocase; content:"position"; nocase; content:"absolute"; distance:0; nocase; pcre:"/<(?P<tag1>\w+)\s+[^>]*class\s*=\s*(?P<q1>\x22|\x27|)\w+(?P=q1)[^>]*>(?!.*?<\/(?P=tag1)>.*?<textarea).*?<textarea/si"; pcre:"/\w+\.className\s*=\s*(?P<q2>\x22|\x27|)\w+(?P=q2)/si"; pcre:"/\x7B[^\x7B]*?position\s*\x3A\s*absolute[^\x7D]*\x7D/si"; metadata:policy security-ips alert; reference:cve,2009-0076; reference:url,www.microsoft.com/technet/security/bulletin/MS09-002.mspx; classtype:attempted-user; sid:15305; rev:6;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Microsoft Office Visio invalid ho tag attempt"; flow:to_client,established; flowbits:isset,visio.request; content:"|0D 14 00 03 00 01 00 16 00 03 00 01 01 02 FF 00 A4 02 A7 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33660; reference:cve,2009-0096; reference:url,www.microsoft.com/technet/security/bulletin/MS09-005; classtype:attempted-user; sid:15299; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Windows ISA Server cross-site scripting attempt"; flow:to_server,established; content:"CookieAuth.dll"; nocase; http_uri; content:"GetLogonRedir"; nocase; http_uri; content:"formdir"; nocase; http_uri; content:"reason=|22|"; nocase; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0237; reference:url,www.microsoft.com/technet/security/bulletin/MS09-016.mspx; classtype:attempted-user; sid:15475; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer object clone deletion memory corruption attempt - obfuscated"; flow:to_client,established; dsize:<800; content:"<html>"; nocase; content:"createElement"; distance:0; nocase; content:"cloneNode"; nocase; content:"clearAttributes"; nocase; content:"CollectGarbage"; nocase; content:"</html>"; distance:0; nocase; metadata:policy balanced-ips alert, policy security-ips alert, service http; reference:cve,2009-0075; reference:url,www.microsoft.com/technet/security/bulletin/MS09-002.mspx; classtype:attempted-user; sid:16339; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows GDI+ interlaced PNG file parsing heap overflow attempt"; flow:to_client,established; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; byte_test:4,>,59000,0,relative,big; byte_test:4,>,32000,4,relative,big; byte_test:1,>,7,8,relative; content:"|06|"; within:1; distance:9; content:"|01|"; within:1; distance:2; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3126; reference:url,www.microsoft.com/technet/security/bulletin/MS09-062.mspx; classtype:attempted-user; sid:16186; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer marquee tag onstart memory corruption"; flow:to_client,established; content:"<marquee "; nocase; content:"onstart"; distance:0; nocase; pcre:"/<marquee\s+[^>]*onstart\s*=/smi"; metadata:policy balanced-ips alert, policy security-ips drop, service http; reference:cve,2009-0554; reference:url,www.microsoft.com/technet/security/bulletin/MS09-014.mspx; classtype:attempted-user; sid:15461; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer Unexpected method call remote code execution attempt"; flow:to_client,established; content:"clearAttributes"; nocase; pcre:"/(\w+)\.insertCell.*\1\.deleteCell.*\1\.clearAttributes/smi"; reference:cve,2009-1141; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:attempted-user; sid:15531; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel Malformed MSODrawing Record"; flow:to_client,established; flowbits:isset, http.xls; content:"|EC 00|"; content:"|02 F0|"; within:2; distance:4; content:"|08 F0|"; within:2; distance:6; content:!"|03 F0|"; within:2; distance:14; content:"|00|"; within:1; distance:16; reference:cve,2010-0243; reference:url,www.microsoft.com/technet/security/bulletin/MS10-003.mspx; classtype:attempted-user; sid:16416; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel FeatHdr BIFF record remote code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"g|08|"; content:"|04 00|"; within:2; distance:14; content:"|04 00|"; within:2; distance:1; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3129; reference:url,www.microsoft.com/technet/security/bulletin/MS09-067.mspx; classtype:attempted-user; sid:16241; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer EMBED element memory corruption attempt"; flow:to_client,established; content:"function|20|open|5F|win|28 29|"; content:"document|2E|body|2E|innerHTML|20 3D|"; distance:0; content:"|22 3C|embed|20|type|3D 27|audio|2F|midi|27 3E|"; distance:0; content:"setInterval|28 27|open|5F|win|28 29 27 2C 20|1|29 3B|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34424; reference:cve,2009-0553; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-014.mspx; classtype:attempted-user; sid:17709; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave director file malformed lcsr block memory corruption attempt"; flow:to_client,established; flowbits:isset,http.dir; content:"p|00 00 00 01 00 00 00 A8 FF FB|m|10|http|3A|//www."; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3466; reference:url,www.adobe.com/support/security/bulletins/apsb09-16.html; classtype:attempted-user; sid:16220; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer setCapture heap corruption exploit attempt"; flow:to_client,established; content:"setCapture"; pcre:"/document\x2eall\x28.*?\x29\x2esetCapture\x28/s"; metadata:policy security-ips drop; reference:cve,2009-1529; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:attempted-user; sid:15535; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office WordPad and Office text converters integer underflow attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|DC A5|"; byte_test:2,<,4,140,relative,little; metadata:policy security-ips drop; reference:cve,2009-0087; reference:url,www.microsoft.com/technet/security/bulletin/MS09-010.mspx; classtype:attempted-user; sid:15469; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer onreadystatechange memory corruption attempt"; flow:to_client,established; content:"doc.replaceChild|28|doc,doc|29|"; nocase; content:"doc.removeChild|28|doc,doc|29|"; distance:0; nocase; content:"onreadystatechange"; distance:0; nocase; reference:cve,2009-1531; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:misc-attack; sid:15538; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word Document remote code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|DC A5|"; byte_test:2,<,38,0,relative,little; byte_test:4,<,250,22,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3135; reference:url,www.microsoft.com/technet/security/bulletin/MS09-068.mspx; classtype:attempted-user; sid:16234; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows malformed WMF meta escape record memory corruption"; flow:to_client,established; content:"WMFC|01 00 00 00|"; byte_test:4,>,1000000,14,relative,little; reference:cve,2009-2500; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-062.mspx; classtype:attempted-user; sid:16153; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Office Sharepoint Server elevation of privilege exploit attempt"; flow:to_server,established; content:!"/ssp/admin/_layouts"; http_uri; content:"mode=ssp"; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4032; reference:url,www.microsoft.com/technet/security/bulletin/MS08-077.mspx; classtype:attempted-admin; sid:15108; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Embedded Open Type Font malformed name table platform type 3 integer overflow attempt"; flow:to_client,established; flowbits:isset,eot.download; content:"|00 03 00|"; content:"|00 04|"; within:2; distance:3; byte_test:2,>,35752,0,relative; byte_test:1,<,2,-5,relative; metadata:policy security-ips drop; reference:cve,2009-0232; reference:url,www.microsoft.com/technet/security/bulletin/MS09-029.mspx; classtype:attempted-user; sid:15695; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Embedded Open Type Font malformed name table overflow attempt"; flow:to_client,established; flowbits:isset,eot.download; content:"|00 01 00 01 00 00 00 01 FF FF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0231; reference:url,www.microsoft.com/technet/security/bulletin/MS09-029.mspx; classtype:attempted-user; sid:15693; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer XML HttpRequest race condition exploit attempt"; flow:to_client,established; content:"ActiveXObject"; content:"Microsoft.XMLHTTP"; within:30; content:"setInterval"; distance:0; pcre:"/function\s+([a-z0-9_]+)\s*\x28.*?ActiveXObject\s*\x28\s*\x22Microsoft.XMLHTTP\x22\s*\x29.*setInterval\s*\x28\s*\x22\1/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1528; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:attempted-user; sid:15534; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe tiff oversized image length attempt"; flow:to_client,established; content:"|14 01 00 00 01 01 04 00 01 00 00 00 01 01 01 01 02 01 03 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2995; classtype:attempted-user; sid:16321; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows AVIFile truncated media file processing memory corruption attempt"; flow:to_client,established,only_stream; content:"RIFF"; content:"AVI LIST"; within:8; distance:4; content:"hdrlavih"; within:8; distance:4; byte_test:4,=,56,0,relative,little; pcre:!"/^.{60}/sR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35970; reference:cve,2009-1545; reference:cve,2009-1546; reference:url,www.microsoft.com/technet/security/bulletin/MS09-038.mspx; classtype:attempted-user; sid:16342; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows AVI DirectShow quicktime parsing overflow attempt"; flow:to_client,established; content:"moov"; content:"vide"; distance:0; content:"stsd"; distance:0; fast_pattern; byte_test:1,>,31,58,relative,big; metadata:policy balanced-ips alert, policy security-ips alert, service http; reference:bugtraq,35139; reference:cve,2009-1537; reference:url,www.microsoft.com/technet/security/advisory/971778.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS09-028.mspx; classtype:attempted-user; sid:15517; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows AVIFile media file processing memory corruption attempt"; flow:to_client,established; content:"RIFF"; content:"AVI LIST"; within:8; distance:4; content:"hdrlavih"; within:8; distance:4; byte_test:4,!=,56,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,35970; reference:cve,2009-1545; reference:cve,2009-1546; reference:url,www.microsoft.com/technet/security/bulletin/MS09-038.mspx; classtype:attempted-user; sid:15854; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer indexing service malformed parameters"; flow:to_client,established; content:"SetQueryFromURL"; nocase; content:"%%"; within:100; pcre:"/SetQueryFromURL\((?P<q1>\x22|\x27|)[^\)]*\x25{2,}[^\)]*(?P=q1)\)/smi"; reference:cve,2009-2507; reference:url,www.microsoft.com/technet/security/Bulletin/MS09-057.mspx; classtype:attempted-user; sid:16155; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Visual Basic 6.0 malformed AVI buffer overflow attempt"; flow:to_client,established; file_data; content:"RIFF"; content:"AVI "; within:4; distance:4; content:"strf"; byte_test:4,>,104,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4255; reference:url,www.microsoft.com/technet/security/bulletin/MS08-070.mspx; classtype:attempted-user; sid:15104; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Flash Player malformed getPropertyLate actioncode attempt"; flow:to_client,established; flowbits:isset,http.swf; content:",|BD 06|J|C6 01 01 80 C6 01 D6 D1 D2|O|97 06 01 D1|`|81 04|g|9D 08|f|9E 08|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3797; classtype:attempted-user; sid:16316; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word .rtf file stylesheet buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.rtf; file_data; content:"|5C|stylesheet"; nocase; content:"|5C|stylesheet"; distance:0; nocase; content:"|5C|stylesheet"; distance:0; nocase; content:"|5C|stylesheet"; distance:0; nocase; content:"|5C|stylesheet"; distance:0; nocase; content:"|5C|stylesheet"; distance:0; nocase; metadata:policy security-ips drop; reference:cve,2008-4031; reference:url,www.microsoft.com/technet/security/bulletin/MS08-072.mspx; classtype:attempted-user; sid:15107; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Shockwave tSAC pointer overwrite attempt"; flow:to_client,established; flowbits:isset, http.dir; content:"tSAC<|04 00 00 00 04 00 00 04|2|0B 00 00 01 00 00 00 14 0C 0C 0C 0C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3464; reference:url,www.adobe.com/support/security/bulletins/apsb09-16.html; classtype:attempted-user; sid:16223; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows WebDAV pathname buffer overflow attempt"; flow:to_client,established; content:"file|3A 2F 2F 5C 5C|"; nocase; pcre:"/file\x3A\x2F\x2F\x5C\x5C[^\s\x22\x27]{234}/smi"; reference:cve,2008-4259; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-073.mspx; classtype:attempted-user; sid:15115; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint invalid TextByteAtom remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; file_data; content:"|00 00 A8 0F|"; byte_test:1,&,0x80,3,relative; metadata:policy security-ips drop; reference:cve,2010-0033; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:16412; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Download of PowerPoint 4.0 file"; flow:to_client,established; content:"R|00|o|00|o|00|t|00| |00|E|00|n|00|t|00|r|00|y|00|"; content:"P|00|P|00|4|00|0|00|"; within:8; distance:108; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0220; reference:cve,2009-0223; reference:cve,2009-0226; reference:cve,2009-0227; reference:cve,2009-1137; reference:url,www.microsoft.com/technet/security/bulletin/MS09-017.mspx; classtype:attempted-user; sid:15504; rev:4;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows CryptoAPI ASN.1 integer overflow attempt"; flow:to_client,established; content:"U|04 82 80 80 80 80 80 80 80 80 80 03|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service ssl; reference:cve,2009-2511; reference:url,www.microsoft.com/technet/security/bulletin/MS09-056.mspx; classtype:attempted-user; sid:16181; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft Office PowerPoint improper filename remote code execution attempt"; flow:to_server,established; content:".ppt"; nocase; http_uri; pcre:"/[^\x5C\x2F\x3A\x2A\x3F\x22\x3C\x3E\x7C\x3D\s]{256}\x2Eppt($|\x3f)/Ui"; metadata:policy balanced-ips alert, policy security-ips alert, service http; reference:cve,2010-0029; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:16409; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word Document remote code execution attempt"; flow:to_client,established; flowbits:isset,http.doc; content:"|EC A5|"; byte_test:2,<,38,0,relative,little; byte_test:4,<,250,22,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3135; reference:url,www.microsoft.com/technet/security/bulletin/MS09-068.mspx; classtype:attempted-user; sid:16586; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer orphan DOM objects memory corruption attempt"; flow:to_client,established; content:"createElement"; nocase; content:"appendChild"; within:50; nocase; content:"innerHTML"; within:100; nocase; pcre:"/(?P<first>\S+)\x2EappendChild\x28\s*(?P<second>\S+)\s*\x29.*(?P=second)\x2E\S+\s*\x3D\s*(?P=first)\x2E\S+/is"; pcre:"/(\S+)\x2EappendChild[^\x7D]+\1\x2EinnerHTML\s*\x3D\s*\x27{2}/i"; reference:cve,2009-3674; reference:url,www.microsoft.com/technet/security/bulletin/MS09-072.mspx; classtype:attempted-user; sid:16330; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader U3D CLODMeshContinuation code execution attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:"U3D|00|"; content:"1|FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,<,16777216,12,relative,little; content:"<|FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,>,16777215,12,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36665; reference:cve,2009-2990; reference:url,www.adobe.com/support/security/bulletins/apsb09-15.html; classtype:attempted-user; sid:16373; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint LinkedSlide memory corruption"; flow:to_client,established; flowbits:isset,http.ppt; content:"|00 00 E7|.|08 00 00 00|"; byte_test:4, >, 1000000, 4, relative, little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0221; reference:url,www.microsoft.com/technet/security/bulletin/MS09-017.mspx; classtype:attempted-user; sid:15500; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel oversized ib memory corruption attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|06 00|"; content:"9A|00|A|00|"; within:5; distance:24; metadata:policy security-ips drop; reference:cve,2009-3131; reference:url,www.microsoft.com/technet/security/bulletin/MS09-067.mspx; classtype:attempted-user; sid:16229; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint 95 converter CString in ExEmbed container buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.ppt; file_data; content:"|CC 0F 00 00 FF FF 00 00|"; content:"|BA 0F 00 00|"; distance:0; byte_test:4,>,128,4,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1129; reference:url,www.microsoft.com/technet/security/bulletin/MS09-017.mspx; classtype:attempted-user; sid:15499; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer DOM memory corruption attempt"; flow:to_client,established; content:"<script"; nocase; content:"null"; distance:0; nocase; content:"CollectGarbage|28 29|"; distance:0; nocase; pcre:"/\x3d\s*null\s*\x3b[^\x7d]{0,50}\x3d\s*null\s*\x3b[^\x7d]{0,50}CollectGarbage\x28\x29/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1532; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:attempted-admin; sid:15540; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe doc.export arbitrary file write attempt"; flow:to_client,established; flowbits:isset,http.pdf; content:".export"; nocase; pcre:"/\x2eexport(AsFDF|AsText|AsXFDF|DataObject|XFAData)\x28[^\x2c\x29]*\x2c[^\x2c\x29]*\x2c[^\x29]+\x2eexe/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2993; classtype:attempted-user; sid:16324; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows search protocol handler access attempt"; flow:to_client,established; content:"search-ms|3A|"; fast_pattern:only; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4269; reference:url,www.microsoft.com/technet/security/bulletin/MS08-075.mspx; classtype:attempted-user; sid:15116; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows Shell Handler remote code execution attempt"; flow:to_client,established; content:"href"; nocase; content:"|23 3A|//"; within:500; fast_pattern; pcre:"/\<a\s+[^\>]*href\s*\x3D\s*[\x22\x27]?[^\>\x22\x27]*\x23\x3A\x2F\x2F[^\>]+\>/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0027; reference:url,www.microsoft.com/technet/security/bulletin/MS10-007.mspx; classtype:attempted-user; sid:16414; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows DirectShow QuickTime file stsc atom parsing heap corruption attempt"; flow:to_client,established; content:"stbl"; content:"stsd"; within:4; distance:4; content:"ima4"; distance:8; content:"stsc"; distance:0; byte_jump:4,4,relative,multiplier 12,big; isdataat:7,relative; content:!"stsz"; within:4; distance:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-1538; reference:url,www.microsoft.com/technet/security/bulletin/MS09-028.mspx; classtype:attempted-user; sid:15682; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer unitialized or deleted object access attempt"; flow:to_client,established; content:"createEventObject"; fast_pattern:only; nocase; pcre:"/(\w+)\s*\x3D\s*\w+\x2EcreateEventObject.*\1\x2E(Type|PropertyName|Qualifier|SrcUrn).*\x2EcreateEventObject\s*\x28\s*\1\s*\x29/smi"; metadata:policy security-ips drop; reference:cve,2009-2530; reference:url,www.microsoft.com/technet/security/bulletin/MS09-054.mspx; classtype:misc-activity; sid:16151; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer deleted object cells reference memory corruption vulnerability"; flow:to_client,established; content:"outerText"; nocase; content:"cells.item"; distance:0; nocase; pcre:"/([A-Z0-9_]+)\.outerText.*?\1\.cells\.item/smi"; reference:cve,2010-0248; classtype:attempted-user; sid:16378; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows kernel-mode drivers core font parsing integer overflow attempt"; flow:to_client,established; content:"hmtx"; content:"cmap"; content:"hhea"; pcre:"/(cmap|head|hhea|hmtx|maxp|name|OS\x2F2|post).{4}([\x80-\xFF]|.{4}[\x80-\xFF])/s"; reference:cve,2009-2514; reference:cve,2010-2862; reference:url,www.microsoft.com/technet/security/bulletin/MS09-065.mspx; classtype:attempted-admin; sid:16231; rev:6;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Microsoft Office Visio invalid ho tag attempt"; flow:to_client,established; flowbits:isset,visio.request; content:"|00 02 0B|@|00 00 00 00 00 00 00 00 FE 00 FF 00 90 03 A7 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,33660; reference:cve,2009-0096; reference:url,www.microsoft.com/technet/security/bulletin/MS09-005; classtype:attempted-user; sid:16318; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint paragraph format array inner header overflow attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|1C 00 00 00 00 80 41 41 41 41 41 41 95 00 FF FF 64|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,34833; reference:cve,2009-0220; classtype:attempted-user; sid:17695; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint out of bounds value remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|C3 0B|"; byte_test:1,>,1,8,relative; byte_test:1,<,27,8,relative; byte_test:4,>,7,4,relative,little; content:!"|FF FF FF FF|"; within:4; distance:4; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-0031; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:16411; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Visio Malformed IconBitsComponent arbitrary code execution attempt"; flow:to_client,established; flowbits:isset,visio.request; content:"|00 00| |00| |FF 00 00 14 01 00 00 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0095; reference:url,www.microsoft.com/technet/security/bulletin/ms09-005.mspx; classtype:attempted-user; sid:15303; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT MultiMedia Jukebox playlist file handling heap overflow attempt"; flow:to_client,established; flowbits:isset,http.pls; content:"http|3A 2F 2F|"; isdataat:262,relative; content:!"|0D|"; within:262; metadata:policy security-ips alert; reference:cve,2009-2650; classtype:attempted-user; sid:20237; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint TxMasterStyle10Atom atom numLevels buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|00 B2 0F|"; byte_test:2,>,5,4,relative,little; byte_test:1,<,0x90,-4,relative; byte_test:1,!&,0x01,-4,relative; byte_test:1,!&,0x02,-4,relative; byte_test:1,!&,0x04,-4,relative; byte_test:1,!&,0x08,-4,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-1455; reference:url,www.microsoft.com/technet/security/bulletin/ms08-051.mspx; classtype:attempted-user; sid:13971; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel dval record arbitrary code excecution attempt"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|B2 01|"; byte_test:4,>,4294967293,12,relative,little; metadata:policy security-ips drop; reference:cve,2008-0111; reference:url,www.microsoft.com/technet/security/bulletin/MS08-014.mspx; classtype:attempted-user; sid:13571; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer DXLUTBuilder ActiveX function call access"; flow:to_client,established; content:"DXTransform.Microsoft.DXLUTBuilder"; pcre:"/(?P<c>\w+)\s*=\s*(\x22DXTransform\.Microsoft\.DXLUTBuilder(\.\d)?\x22|\x27DXTransform\.Microsoft\.DXLUTBuilder(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22DXTransform\.Microsoft\.DXLUTBuilder(\.\d)?\x22|\x27DXTransform\.Microsoft\.DXLUTBuilder(\.\d)?\x27)\s*\)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0078; reference:url,www.microsoft.com/technet/security/bulletin/MS08-010.mspx; classtype:attempted-user; sid:13455; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows DirectX SAMI file parsing buffer overflow attempt"; flow:to_client,established; content:"<SAMI"; nocase; content:"<STYLE"; distance:0; nocase; content:"text/css"; within:200; nocase; isdataat:600,relative; content:!"</STYLE"; within:600; pcre:"/\x3Cstyle[^\x3E]+?type\s*\x3D\s*(?P<q>(\x22|\x27|))text\x2Fcss(?P=q)[^\x3E]*\x3E.*^\s*\S+\s*\x7b[^\x7d]{500}/smiO"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-1444; reference:url,www.microsoft.com/technet/security/bulletin/MS08-033.mspx; classtype:attempted-user; sid:13823; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer cross domain componentFromPoint memory corruption attempt"; flow:to_client,established; content:"|2E|componentFromPoint|28|"; nocase; pcre:"/(\S+)\s+\x3d[^\x3b]*\x2e(createElement|getElementById)\x28.*\1\x2ecomponentFromPoint\x28/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3475; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-058.mspx; classtype:attempted-user; sid:14657; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer http status response memory corruption vulnerability"; flow:to_client,established; content:"HTTP/1"; depth:6; nocase; content:"449"; within:10; fast_pattern; pcre:"/^http\/1\x2e[01][ \t]+449/i"; reference:cve,2008-2256; reference:url,www.microsoft.com/technet/security/bulletin/MS08-045.mspx; classtype:attempted-user; sid:13980; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer ExecWB security zone bypass attempt"; flow:to_client,established; content:"ExecWB"; nocase; pcre:"/ExecWB\s*\x28\s*[^\x2c\x29]*(7|IDM_PRINTPREVIEW)[^\x29]+http\x3a\x2f\x2f/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30612; reference:cve,2008-2259; reference:url,www.microsoft.com/technet/security/bulletin/MS08-045.mspx; classtype:attempted-user; sid:17692; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer static text range overflow attempt"; flow:to_client,established; content:"createTextRange"; content:"while|28 31 29|"; distance:0; content:"text ="; distance:0; metadata:policy security-ips drop; reference:cve,2008-2255; reference:url,www.microsoft.com/technet/security/bulletin/MS08-045.mspx; classtype:attempted-user; sid:13960; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer XSS mouseevent PII disclosure attempt"; flow:to_client,established; content:"Content-Type|3A| text/html"; nocase; content:"setcapture|28 29|"; distance:0; fast_pattern; nocase; content:"onclick="; nocase; content:"event"; content:"srcelement"; distance:0; nocase; pcre:"/(\w+)\x2esetcapture\x28\x29.*\1[^\x3e]*onclick\x3d/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3473; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-053.mspx; classtype:web-application-activity; sid:14656; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel invalid FRTWrapper record buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|51 08|"; byte_test:2,<,8,0,relative,little; content:"|51 08|"; within:2; distance:2; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3471; reference:url,www.microsoft.com/technet/security/bulletin/MS08-057.mspx; classtype:attempted-user; sid:14641; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Works file converter file section length headers memory corruption attempt"; flow:to_client,established; flowbits:isset,works.download; content:"STSH"; byte_test:2,>,32768,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,27657; reference:cve,2007-0216; reference:url,www.microsoft.com/technet/security/bulletin/ms08-011.mspx; classtype:attempted-user; sid:13466; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint malformed shapeid arbitrary code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; content:"|0A F0 08 00 00 00|"; byte_test:2,&,1024,4,relative,little; byte_test:2,&,8,4,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0118; reference:url,www.microsoft.com/technet/security/bulletin/ms08-016.mspx; classtype:attempted-user; sid:13572; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Apple Safari-Internet Explorer SearchPath blended threat dll request"; flow:to_server,established; content:".dll"; nocase; http_uri; content:"Safari"; http_header; pcre:"/^User\x2dAgent\x3a\s*[^\n]*Safari[^\n]*\r\n/smi"; flowbits:set,safari.dll; flowbits:noalert; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-2540; reference:url,www.microsoft.com/technet/security/bulletin/MS09-015.mspx; classtype:attempted-user; sid:15468; rev:6;)
alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"WEB-CLIENT Apple Safari-Internet Explorer SearchPath blended threat attempt"; flow:to_client,established; flowbits:isset,safari.dll; content:"MZ|90 00|"; byte_jump:4,56,relative,little; content:"PE|00 00|"; within:4; distance:-64; metadata:policy security-ips drop; reference:bugtraq,29445; reference:cve,2008-2540; reference:url,www.microsoft.com/technet/security/bulletin/MS09-015.mspx; classtype:attempted-user; sid:16319; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer request header overwrite"; flow:to_client,established; content:"XMLHttpRequest|28|"; nocase; content:"setRequestHeader|28 22|"; distance:0; nocase; pcre:"/setRequestHeader\x28\x22(host|referer|content\x2dlength)\x22\s*\x2B/i"; metadata:policy security-ips drop; reference:cve,2008-1544; reference:url,www.microsoft.com/technet/security/bulletin/MS08-031.mspx; classtype:misc-activity; sid:13834; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office eps filters memory corruption attempt"; flow:to_client,established; flowbits:isset, http.eps.download; content:"|0A C5 D0 D3 C6|"; byte_test:2, >, 32767, 24, relative, little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3019; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-044.mspx; classtype:attempted-user; sid:13970; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer XHTML element memory corruption attempt"; flow:to_client,established; content:"createElement"; nocase; pcre:"/(\w+)\s*\x3D\s*document\x2EcreateElement.*(\w+)\s*\x3D\s*document\x2EcreateElement.*\1\x2EappendChild\x28\2\x29.*appendChild\x28\1\x29/smi"; reference:cve,2008-2257; reference:url,www.microsoft.com/technet/security/bulletin/MS08-045.mspx; classtype:attempted-user; sid:13974; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel cf record arbitrary code excecution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|B1 01|"; byte_test:2,&,1,12,relative,little; byte_test:2,>,69,14,relative,little; byte_test:2,>,13,0,relative,little; byte_test:2,<,8225,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0117; reference:url,www.microsoft.com/technet/security/bulletin/MS08-014.mspx; classtype:attempted-user; sid:13570; rev:9;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer span frontier parsing memory corruption"; flow:to_client,established; content:"span"; nocase; pcre:"/span\s+ID\s*\x3d\s*(\w+).*\1\s*\x2e\s*\w+\x3d/smi"; metadata:policy security-ips drop; reference:cve,2008-2254; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-045.mspx; classtype:attempted-user; sid:13964; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer DXLUTBuilder ActiveX clsid unicode access"; flow:to_client,established; content:"1|00|e|00|5|00|4|00|3|00|3|00|3|00|b|00|-|00|2|00|a|00|0|00|0|00|-|00|1|00|1|00|d|00|1|00|-|00|8|00|1|00|9|00|8|00|-|00|0|00|0|00|0|00|0|00|f|00|8|00|7|00|5|00|5|00|7|00|d|00|b|00|"; nocase; pcre:"/1([^>]\x00)*1(?P<q2>\x22\x00|\x27\x00|)1({\x00)?1(}\x00)?(?P=q2)(?=\s\x00|>\x00)/si"; reference:cve,2008-0078; reference:url,www.microsoft.com/technet/security/bulletin/MS08-010.mspx; classtype:attempted-user; sid:13454; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer table layout access violation vulnerability"; flow:to_client,established; content:"|2E|getClientRects|28 29|"; nocase; content:"|2E|clearAttributes|28 29|"; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-2258; reference:url,www.microsoft.com/technet/security/bulletin/ms08-045.mspx; classtype:misc-attack; sid:13961; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer cross domain setExpression exploit attempt"; flow:to_client,established; content:"setexpression"; nocase; content:"clearattributes"; distance:0; fast_pattern; nocase; pcre:"/(\w+)\x2Esetexpression\s*\x28\x29.+\1\x2Eclearattributes\s*\x28\x29/smi"; metadata:policy security-ips drop; reference:cve,2008-3476; reference:url,www.microsoft.com/technet/security/bulletin/MS08-058.mspx; classtype:attempted-user; sid:14645; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel file with embedded ActiveX control"; flow:to_client,established; flowbits:isset,http.xls; content:"|00|_|00|_|00|S|00|R|00|P|00|_|00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3477; reference:url,www.microsoft.com/technet/security/bulletin/MS08-057.mspx; classtype:attempted-user; sid:14642; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer static text range overflow attempt"; flow:to_client,established; content:"createTextRange"; content:".text = |27|AAAAAAAAAAAAA"; distance:0; metadata:policy security-ips drop; reference:cve,2008-2255; reference:url,www.microsoft.com/technet/security/bulletin/MS08-045.mspx; classtype:attempted-user; sid:17720; rev:4;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer MSXML DLL memory corruption attempt"; flow:to_client,established; content:"application/xml"; pcre:"/(<[^>]+>)\1{19}/"; reference:cve,2007-0099; reference:url,www.microsoft.com/technet/security/bulletin/MS08-069.mspx; classtype:attempted-dos; sid:15012; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Word .rtf file integer overflow attempt"; flow:to_client,established; content:"|5C|dppolycount"; nocase; byte_test:5,>,8186,0,relative,string,dec; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-4025; reference:url,www.microsoft.com/technet/security/bulletin/MS08-072.mspx; classtype:misc-attack; sid:15106; rev:4;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows vbscript/jscript scripting engine end buffer overflow attempt"; flow:to_client,established; content:"VBScript.Encode"; content:"^|23|~@"; distance:0; content:!"="; within:1; distance:-6; reference:cve,2008-0083; reference:url,www.microsoft.com/technet/security/bulletin/MS08-022.mspx; classtype:attempted-user; sid:13449; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer cross-domain navigation cookie stealing attempt"; flow:to_client,established; content:"setInterval|28|'xDomainAccess|28 29|',1|29 3B|"; nocase; content:"setInterval|28 22|try { myWindow.location.href = victimLnk|3B|}"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2007-3091; reference:url,www.microsoft.com/technet/security/bulletin/MS09-019.mspx; classtype:misc-attack; sid:15529; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed formula parsing code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|07 C9 C0 00 00 06 03 00 00 18 00 FF 02 00 00 02 7C 7C 7C 7C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,28167; reference:cve,2008-0115; reference:url,www.microsoft.com/technet/security/bulletin/MS08-014.mspx; classtype:attempted-user; sid:17655; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed Label record exploit attempt"; flow:to_client,established; flowbits:isset,http.xls; file_data; content:"|09 08 08 00 00 05 05 00|"; content:"|04 02|"; distance:0; byte_test:1,&,0x80,9,relative; byte_test:2,>,8,0,relative,little; byte_test:2,<,8225,0,relative,little; metadata:policy security-ips drop; reference:cve,2004-0846; reference:cve,2011-0098; reference:url,www.microsoft.com/technet/security/bulletin/MS04-033.mspx; reference:url,www.microsoft.com/technet/security/bulletin/MS11-021.mspx; classtype:attempted-user; sid:18632; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows GDI VML gradient size heap overflow attempt"; flow:to_client,established; content:"v:fill"; nocase; content:"focussize"; nocase; pcre:"/focussize\s*\x3d\s*\x22[^\x2d\x2c\x22]*\x2d[^\x2d\x22]+\x2d/smi"; metadata:policy security-ips drop; reference:cve,2007-5348; reference:url,www.microsoft.com/technet/security/bulletin/MS08-052.mspx; classtype:attempted-user; sid:14261; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Java GIF LZW minimum code size overflow attempt"; flow:to_client,established; file_data; content:"|F3 E1 04 30 2E 7B 0A 25 A4 58 D1 E2 45 8C 19 35 6E E4 D8 D1 E3 47 90 21 45 8E 24 59 D2 E4 49 8F|"; fast_pattern:only; reference:bugtraq,34240; reference:cve,2009-1098; classtype:attempted-user; sid:20239; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer DXLUTBuilder ActiveX clsid access"; flow:to_client,established; content:"1e54333b-2a00-11d1-8198-0000f87557db"; nocase; pcre:"/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*1e54333b-2a00-11d1-8198-0000f87557db\s*}?\s*(?P=q1)(\s|>)/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0078; reference:url,www.microsoft.com/technet/security/bulletin/MS08-010.mspx; classtype:attempted-user; sid:13453; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel malformed chart arbitrary code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"A|10 12 00|"; byte_test:2,>,1,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3004; reference:url,www.microsoft.com/technet/security/bulletin/MS08-043.mspx; classtype:attempted-user; sid:13981; rev:8;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer cross domain unfocusable HTML element"; flow:to_client,established; content:"tabindex"; fast_pattern:only; content:"Content-Type|3A| text/html"; nocase; pcre:"/<s*(div|span|p)\s+[^>]*tabindex/smi"; reference:cve,2008-3472; reference:url,www.microsoft.com/technet/security/bulletin/MS08-058.mspx; classtype:attempted-user; sid:14644; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer argument validation in print preview handling vulnerability"; flow:to_client,established; content:"|2E|ExecWB"; nocase; pcre:"/\x2eExecWB\s*\x28(IDM_PRINTPREVIEW|7)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-2259; reference:url,www.microsoft.com/technet/security/bulletin/ms08-045.mspx; classtype:attempted-user; sid:13963; rev:5;)
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows vbscript/jscript scripting engine begin buffer overflow attempt"; flow:to_client,established; content:"VBScript.Encode"; content:"|23|@~^"; distance:0; isdataat:6,relative; content:!"="; within:1; distance:6; reference:cve,2008-0083; reference:url,www.microsoft.com/technet/security/bulletin/MS08-022.mspx; classtype:attempted-user; sid:13448; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer DXLUTBuilder ActiveX function call unicode access"; flow:to_client,established; content:"D|00|X|00|T|00|r|00|a|00|n|00|s|00|f|00|o|00|r|00|m|00|.|00|M|00|i|00|c|00|r|00|o|00|s|00|o|00|f|00|t|00|.|00|D|00|X|00|L|00|U|00|T|00|B|00|u|00|i|00|l|00|d|00|e|00|r|00|"; nocase; pcre:"/(?P<c>\w+)(\s\x00)*=(\s\x00)*(?P<q3>\x22|\x27|)D\x00X\x00T\x00r\x00a\x00n\x00s\x00f\x00o\x00r\x00m\x00.\x00M\x00i\x00c\x00r\x00o\x00s\x00o\x00f\x00t\x00.\x00D\x00X\x00L\x00U\x00T\x00B\x00u\x00i\x00l\x00d\x00e\x00r\x00(?P=q3)(\s|>)(\s\x00)*\x3b\x00.*(?P<v>(\w\x00)+)(\s\x00)*1\(\x00(\s\x00)*(?P=c)(\s\x00)*\)\x00|(?P<n>\w+)(\s\x00)*1\(\x00(\s\x00)*(?P<q4>\x22|\x27|)D\x00X\x00T\x00r\x00a\x00n\x00s\x00f\x00o\x00r\x00m\x00.\x00M\x00i\x00c\x00r\x00o\x00s\x00o\x00f\x00t\x00.\x00D\x00X\x00L\x00U\x00T\x00B\x00u\x00i\x00l\x00d\x00e\x00r\x00(?P=q4)(\s|>)(\s\x00)*\)\x00/smi"; reference:cve,2008-0078; reference:url,www.microsoft.com/technet/security/bulletin/MS08-010.mspx; classtype:attempted-user; sid:13456; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office OneNote iframe caller exploit attempt"; flow:to_client,established; content:"iframe"; nocase; content:"onenote|3A|"; distance:0; nocase; pcre:"/iframe[^\x3e]+onenote\x3a(\x2f|\x5c){2}[^\x3e]+(\x2fbackuppath|\x2fcachepath)/i"; reference:cve,2008-3007; reference:url,www.microsoft.com/technet/security/bulletin/MS08-055.mspx; classtype:web-application-attack; sid:14262; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows DirectX malformed mjpeg arbitrary code execution attempt"; flow:to_client,established; content:"strf"; byte_test:4,>,2147483648,12,little,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0011; reference:url,www.microsoft.com/technet/security/bulletin/MS08-033.mspx; classtype:attempted-user; sid:13824; rev:5;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft malformed saved search heap corruption attempt"; flow:to_client,established; flowbits:isset,http.search-ms; file_data; content:"type=|22|notCondition|22|"; fast_pattern:only; reference:cve,2008-1435; reference:url,www.microsoft.com/technet/security/bulletin/MS08-038.mspx; classtype:attempted-admin; sid:13893; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft GDI WMF file parsing integer overflow attempt"; flow:to_client,established; flowbits:isset, wmf.download; content:"|01 00 09 00|"; pcre:"/(\x40.{20}|\x41.{24})[\xf0-\xff].{8}\x01\x00[\x00\x01\x02\x04\x08\x10\x18\x20]\x00/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-2249; reference:url,www.microsoft.com/technet/security/bulletin/MS08-071.mspx; classtype:attempted-admin; sid:15105; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Visio DXF file invalid memory allocation exploit attempt"; flow:to_client,established; flowbits:isset,http.dxf; content:"HATCH|0D 0A|"; nocase; pcre:!"/^\s*[1-9][0-9]*\x0d\x0a/R"; metadata:policy balanced-ips drop, policy security-ips alert, service http; reference:cve,2008-1090; reference:url,www.microsoft.com/technet/security/bulletin/MS08-019.mspx; classtype:attempted-user; sid:13665; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft WebDAV MiniRedir remote code execution attempt"; flow:to_client,established; content:"<D|3A|href>"; fast_pattern; nocase; isdataat:520,relative; content:!"</D|3A|href>"; within:520; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0080; reference:url,www.microsoft.com/technet/security/bulletin/ms08-007.mspx; classtype:attempted-user; sid:13474; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer location and location.href cross domain security bypass vulnerability"; flow:to_client,established; content:"window.open"; nocase; content:".location"; nocase; pcre:"/\.location(\.href)?\s*=\s*new\s+String\s*\x28\s*\x22\s*javascript\x3A/si"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-2947; reference:url,www.microsoft.com/technet/security/bulletin/MS08-058.mspx; classtype:attempted-user; sid:14643; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer MHTML zone control bypass attempt"; flow:to_client,established; content:"mhtml|3A|"; nocase; content:"Content-Transfer-Encoding"; nocase; content:"base64"; within:10; nocase; pcre:"/(PHNjcmlw|c2NyaXB0|Y3JpcHQ+|Y3JpcHQ\x252B)/Rsi"; reference:cve,2008-1448; reference:url,www.microsoft.com/technet/security/Bulletin/MS08-048.mspx; classtype:attempted-user; sid:13962; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft SilverLight ImageSource redefine flowbit"; flow:to_client,established; content:"|2E|findName|28 22|"; content:"|2E|ImageSource"; content:"="; within:5; flowbits:set,imagesource.redefine; flowbits:noalert; classtype:misc-activity; sid:17113; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office Excel country record arbitrary code execution attempt"; flow:to_client,established; flowbits:isset,http.xls; content:"|8C 00 04 00|"; byte_test:2,>,5,4,relative,little; byte_test:2,<,4201,4,relative,little; pcre:"/^(([\xd6-\xff]\x03|.[\x04-\xff]|\x00{2})|.{2}([\xd6-\xff]\x03|.[\x04-\xff]|\x00{2}))/sR"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-3006; reference:cve,2008-4266; reference:url,www.microsoft.com/technet/security/Bulletin/ms08-043.mspx; reference:url,www.microsoft.com/technet/security/Bulletin/ms08-074.mspx; classtype:attempted-user; sid:13972; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Outlook arbitrary command line attempt"; flow:to_client,established; content:"mailto|3A|"; nocase; pcre:"/<[^>]+mailto\x3a[^>]*\?[^>]*(\x22|%22)(\x2c|%2c)/smi"; reference:cve,2008-0110; reference:url,www.microsoft.com/technet/security/bulletin/MS08-015.mspx; classtype:misc-attack; sid:13573; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer htmlfile null attribute access"; flow:to_client,established; file_data; content:"25336920-03F9-11CF-8FD0-00AA00686F13"; nocase; content:".attributes["; nocase; pcre:"/<object[^>]+id\s*=\s*[\x22\x27]?([A-Z\d]+)[\x22\x27]?[^>]+classid\s*=\s*[\x22\x27]?clsid\x3A25336920-03F9-11CF-8FD0-00AA00686F13[\x22\x27]?.*?\1\.attributes.*?for\s*\x28[^\x29]+\1.attributes\x5B/smi"; reference:cve,2011-1995; reference:url,www.microsoft.com/technet/security/bulletin/MS11-081.mspx; classtype:attempted-user; sid:20263; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Microsoft products oleacc.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|oleacc.dll"; nocase; http_uri; reference:cve,2011-1247; reference:url,www.microsoft.com/technet/security/Bulletin/MS11-075.mspx; classtype:attempted-user; sid:20254; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer onscroll DOS attempt"; flow:to_client,established; file_data; content:"function"; nocase; content:"onscroll"; distance:0; nocase; content:"createElement"; nocase; pcre:"/function\s+(?P<q2>\w).*onscroll\s*=\s*(?P<q1>\w).*function\s+(?P=q1).*createElement\s*\x28\s*(?P<q3>\x22|\x27|)\s*table\s*(?P=q3)\s*\x29.*onload\s*=\s*(?P=q2)/smi"; reference:cve,2011-1993; reference:url,www.microsoft.com/technet/security/bulletin/MS11-081.mspx; classtype:attempted-user; sid:20262; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows win32k.sys kernel mode null pointer dereference attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|68 A2 01 00 00 68 FF FF 00 00 FF 15 30|"; fast_pattern; content:"|41 00|"; within:2; distance:1; reference:cve,2011-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS11-077.mspx; classtype:attempted-admin; sid:20261; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Windows afd.sys kernel-mode memory corruption attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|8B 45 FC 50 6A|"; byte_test:1,>,24,0,relative; content:"|8D 8D A0 FD FF FF 51 68 BB 20 01 00 8B 55 F8 52 FF 15 18|"; fast_pattern; content:"|40 00|"; within:2; distance:1; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2005; reference:url,www.microsoft.com/technet/security/bulletin/MS11-080.mspx; classtype:attempted-admin; sid:20270; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML DOM invalid DHTML comment creation attempt"; flow:to_client,established; file_data; content:"window.open"; fast_pattern:only; content:"createComment"; pcre:"/(\w+)\s*=\s*\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)\s*\;.*?\w+\.(insertBefore|insertAfter|appendChild)\(\1\)\;|window.open\(\)\.\w\.(insertBefore|insertAfter|appendChild)\(\w+\.createComment\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:policy security-ips drop; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:20277; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Explorer HTML DOM invalid DHTML textnode creation attempt"; flow:to_client,established; file_data; content:"window.open"; fast_pattern:only; content:"createTextNode"; pcre:"/(\w+)\s*=\s*\w+\.createTextNode\(((\x22\x22|\x27\x27)|([A-z]\w*))\)\s*\;.*?\w+\.(insertBefore|insertAfter|appendChild)\(\1\)\;|window.open\(\)\.\w\.(insertBefore|insertAfter|appendChild)\(\w+\.createTextNode\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:policy security-ips drop; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:20278; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Internet Exploerer HTML DOM invalid DHTML textnode creation attempt"; flow:to_client,established; file_data; content:"window.open"; fast_pattern:only; content:"createTextNode"; pcre:"/(\w+)\s*=\s*\window.open\(\)s*\;.*?\1\.\w+\.(insertBefore|insertAfter|appendChild)\(\w+\.createTextNode\(((\x22\x22|\x27\x27)|([A-z]\w*))\)/s"; metadata:policy security-ips drop; reference:bugtraq,13120; reference:cve,2005-0553; reference:nessus,10861; reference:url,www.microsoft.com/technet/security/bulletin/ms05-020.mspx; classtype:attempted-user; sid:20279; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC ModPlug ReadS3M overflow attempt"; flow:to_client,established; flowbits:isset,http.s3m; file_data; content:"SCRM"; depth:4; offset:44; byte_test:2,>,65,-14,relative,little; metadata:policy security-ips drop; reference:cve,2011-1574; classtype:attempted-user; sid:20283; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT VideoLAN VLC ModPlug ReadS3M overflow attempt"; flow:to_client,established; flowbits:isset,http.s3m; file_data; content:"SCRM"; depth:4; offset:44; byte_test:2,>,65,-12,relative,little; metadata:policy security-ips drop; reference:cve,2011-1574; classtype:attempted-user; sid:20284; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT RealNetworks RealPlayer QCP parsing buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.qcp; file_data; content:"RIFF"; depth:4; content:"QLCMfmt|20|"; within:8; distance:4; byte_test:4,>,220,0,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2950; reference:url,www.zerodayinitiative.com/advisories/ZDI-11-265/; classtype:attempted-user; sid:20288; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Foxit Reader title overflow attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"/Title"; fast_pattern; nocase; pcre:"/^\s*[\x3C\x28][^\x29]{538}/Rs"; metadata:policy security-ips drop; reference:bugtraq,43785; classtype:attempted-user; sid:20445; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Acrobat Reader U3D CLODMeshDeceleration code execution attempt"; flow:to_client,established; flowbits:isset,http.pdf; file_data; content:"U3D|00|"; content:"|31 FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,>,200,12,relative,little; content:"|3C FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,<,200,12,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3953; classtype:attempted-user; sid:20429; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Oracle Java browser plugin docbase overflow attempt"; flow:to_client,established; file_data; content:"launchjnlp"; fast_pattern; nocase; content:"docbase"; within:100; nocase; isdataat:80,relative; pcre:"/^([\x22\x27]\s*value)?\s*=\s*\x27[^\x27]{70}/Rsmi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,44023; reference:cve,2010-3552; reference:url,osvdb.org/show/osvdb/68873; classtype:attempted-user; sid:20444; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Wireshark DECT packet dissector overflow attempt"; flow:to_client,established; file_data; content:"|D4 C3 B2 A1 02 00 04 00|"; depth:8; byte_test:4,>,1499,36,little; content:"|FF FF FF FF FF FF 00 00 00 00 00 00 23 23|"; depth:14; offset:40; fast_pattern; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,47392; reference:cve,2011-1591; reference:url,osvdb.org/71848; classtype:attempted-user; sid:20431; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Oracle Java Web Start BasicServiceImpl security policy bypass attempt"; flow:to_server,established; content:"java.security.policy"; fast_pattern:only; http_uri; pcre:"/jnlp\x22\x09\x22-J-Djava\.security\.policy/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,43999; reference:cve,2010-3563; classtype:attempted-user; sid:20430; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Opera Config File script access attempt"; flow:to_client,established; file_data; content:"opera|3A|config"; fast_pattern; nocase; content:"opera|3A|cache"; nocase; metadata:policy security-ips drop; reference:url,osvdb.org/66472; classtype:attempted-user; sid:20535; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp MIDI file buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.mid; file_data; content:"CTMF"; depth:4; byte_test:2,>,0x400,8,little; metadata:policy security-ips drop; reference:url,forums.winamp.com/showthread.php?t=332010; reference:url,osvdb.org/show/osvdb/76634; classtype:attempted-user; sid:20559; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp AMF file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.amf; file_data; content:"AMF"; depth:3; byte_test:1,>,12,3; byte_test:1,>,32,40; reference:url,forums.winamp.com/showthread.php?t=332010; reference:url,www.osvdb.org/show/osvdb/76635; classtype:attempted-user; sid:20566; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Un4seen Developments XMPlay crafted ASX file buffer overflow attempt"; flow:to_client,established; flowbits:isset,http.m3u.download; file_data; content:"#EXTM3U"; nocase; content:"#EXTINF|3A|0|2C|"; distance:0; nocase; content:"|0D 0A|"; distance:0; content:"|3A 5C|"; within:2; distance:1; nocase; isdataat:501,relative; pcre:"/^\S{501}/R"; metadata:policy security-ips drop; reference:bugtraq,21206; reference:cve,2006-6063; classtype:attempted-user; sid:20553; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Nullsoft Winamp AMF file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.amf; file_data; content:"AMF"; depth:3; byte_test:1,<,12,3; byte_test:1,>,16,40; reference:url,forums.winamp.com/showthread.php?t=332010; reference:url,www.osvdb.org/show/osvdb/76635; classtype:attempted-user; sid:20565; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla multiple content-type headers malicious redirect attempt"; flow:to_client,established; content:"Content|2D|Type|3A|"; nocase; http_header; content:"|0A|Content|2D|Type|3A|"; distance:0; nocase; http_header; reference:cve,2011-3000; classtype:web-application-attack; sid:20584; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Google Chrome and Apple Safari Ruby before and after memory corruption"; flow:to_client,established; file_data; content:"<ruby>"; fast_pattern:only; content:"ruby|3A|"; pcre:"/(before|after).*?((display\x3atable|counter-reset\x3a)|(counter-reset\x3a|display\x3atable)).*?ruby\s*{\s*float\x3a/siR"; reference:cve,2011-1440; classtype:attempted-user; sid:20579; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla multiple location headers malicious redirect attempt"; flow:to_client,established; content:"Location|3A|"; nocase; http_header; content:"|0A|Location|3A|"; distance:0; nocase; http_header; pcre:"/(300|301|302|303|307)/S"; reference:cve,2011-3000; classtype:web-application-attack; sid:20583; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla multiple content-disposition headers malicious redirect attempt"; flow:to_client,established; content:"Content|2D|Disposition|3A|"; nocase; http_header; content:"|0A|Content|2D|Disposition|3A|"; distance:0; nocase; http_header; reference:cve,2011-3000; classtype:web-application-attack; sid:20586; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Mozilla multiple content-length headers malicious redirect attempt"; flow:to_client,established; content:"Content|2D|Length|3A|"; nocase; http_header; content:"|0A|Content|2D|Length|3A|"; distance:0; nocase; http_header; reference:cve,2011-3000; classtype:web-application-attack; sid:20585; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 9850 (msg:"WEB-CLIENT Novell Groupwise internet agent http uri buffer overflow attempt"; flow:to_server,established; content:"gwagents|2E|css"; fast_pattern; nocase; content:"|3F|"; distance:0; isdataat:239,relative; content:!"|20| HTTP"; within:239; nocase; reference:cve,2011-0334; classtype:attempted-user; sid:20607; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 9850 (msg:"WEB-CLIENT Novell Groupwise internet agent http uri buffer overflow attempt"; flow:to_server,established; content:"gwia|2E|css"; fast_pattern; nocase; content:"|3F|"; distance:0; isdataat:239,relative; content:!"|20| HTTP"; within:239; nocase; reference:cve,2011-0334; classtype:attempted-user; sid:20608; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Apple Safari Webkit libxslt arbitrary file creation attempt"; flow:established,to_client; file_data; content:"xmlns:sx=|22|http://icl.com/saxon|22|"; fast_pattern:only; content:"sx:output"; nocase; pcre:"/\s*[^>]file=/iR"; reference:cve,2011-1774; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:20593; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-CLIENT Adobe Shockwave Flash Flex authoring tool XSS exploit attempt"; flow:to_server,established; content:"/EncDecUtils.swf|3F|"; fast_pattern; http_uri; content:"resourceModuleURLs="; nocase; http_uri; content:"http"; within:4; nocase; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2461; reference:url,www.adobe.com/support/security/bulletins/apsb11-25.html; classtype:attempted-admin; sid:20610; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Microsoft Office PowerPoint out of bounds value remote code execution attempt"; flow:to_client,established; flowbits:isset,http.ppt; file_data; content:"|C3 0B 08|"; fast_pattern; byte_test:1,>,0x18,7,relative,little; content:"|C3 0B|"; distance:0; metadata:policy security-ips drop; reference:cve,2010-0032; reference:url,www.microsoft.com/technet/security/bulletin/MS10-004.mspx; classtype:attempted-user; sid:20590; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 7144 (msg:"WEB-CLIENT Peercast Basic HTTP authentication buffer overflow attempt"; flow:to_server,established; content:"GET"; depth:3; content:"Authorization|3A| Basic"; distance:0; nocase; isdataat:128,relative; content:!"|0A|"; within:128; reference:cve,2008-2040; reference:url,bugs.debian.org/cgi-bin/bugreport.cgi?bug=478573; classtype:attempted-user; sid:20616; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5555 (msg:"WEB-CLIENT CoreHTTP Long buffer overflow attempt"; flow:to_server,established; content:"GET"; depth:3; isdataat:500; content:!"|0A|"; within:500; reference:bugtraq,25120; reference:cve,2007-4060; reference:url,osvdb.org/46831; reference:url,www.exploit-db.com/exploits/4243/; classtype:attempted-user; sid:20620; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-CLIENT Adobe Reader malformed shading modifier heap corruption attempt"; flow:to_client, established; flowbits:isset,http.pdf; file_data; content:"/U3D"; content:"|45 FF FF FF|"; distance:0; byte_jump:2,0,relative,little,post_offset 8; byte_test:4,!=,0,0,relative; byte_test:4,=,0,4,relative; reference:cve,2011-2462; reference:url,osvdb.org/77529; reference:url,www.adobe.com/support/security/advisories/apsa11-04.html; classtype:attempted-user; sid:20659; rev:1;)
